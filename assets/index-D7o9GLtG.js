(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function f2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var mv={exports:{}},Xc={},pv={exports:{}},de={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Da=Symbol.for("react.element"),m2=Symbol.for("react.portal"),p2=Symbol.for("react.fragment"),g2=Symbol.for("react.strict_mode"),y2=Symbol.for("react.profiler"),v2=Symbol.for("react.provider"),w2=Symbol.for("react.context"),_2=Symbol.for("react.forward_ref"),x2=Symbol.for("react.suspense"),E2=Symbol.for("react.memo"),T2=Symbol.for("react.lazy"),hg=Symbol.iterator;function I2(t){return t===null||typeof t!="object"?null:(t=hg&&t[hg]||t["@@iterator"],typeof t=="function"?t:null)}var gv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},yv=Object.assign,vv={};function Wi(t,e,n){this.props=t,this.context=e,this.refs=vv,this.updater=n||gv}Wi.prototype.isReactComponent={};Wi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Wi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function wv(){}wv.prototype=Wi.prototype;function pf(t,e,n){this.props=t,this.context=e,this.refs=vv,this.updater=n||gv}var gf=pf.prototype=new wv;gf.constructor=pf;yv(gf,Wi.prototype);gf.isPureReactComponent=!0;var fg=Array.isArray,_v=Object.prototype.hasOwnProperty,yf={current:null},xv={key:!0,ref:!0,__self:!0,__source:!0};function Ev(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)_v.call(e,r)&&!xv.hasOwnProperty(r)&&(s[r]=e[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:Da,type:t,key:i,ref:o,props:s,_owner:yf.current}}function b2(t,e){return{$$typeof:Da,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function vf(t){return typeof t=="object"&&t!==null&&t.$$typeof===Da}function S2(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var mg=/\/+/g;function rd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?S2(""+t.key):e.toString(36)}function Rl(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Da:case m2:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+rd(o,0):r,fg(s)?(n="",t!=null&&(n=t.replace(mg,"$&/")+"/"),Rl(s,e,n,"",function(d){return d})):s!=null&&(vf(s)&&(s=b2(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(mg,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",fg(t))for(var c=0;c<t.length;c++){i=t[c];var u=r+rd(i,c);o+=Rl(i,e,n,u,s)}else if(u=I2(t),typeof u=="function")for(t=u.call(t),c=0;!(i=t.next()).done;)i=i.value,u=r+rd(i,c++),o+=Rl(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function al(t,e,n){if(t==null)return t;var r=[],s=0;return Rl(t,r,"","",function(i){return e.call(n,i,s++)}),r}function A2(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var It={current:null},jl={transition:null},k2={ReactCurrentDispatcher:It,ReactCurrentBatchConfig:jl,ReactCurrentOwner:yf};function Tv(){throw Error("act(...) is not supported in production builds of React.")}de.Children={map:al,forEach:function(t,e,n){al(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return al(t,function(){e++}),e},toArray:function(t){return al(t,function(e){return e})||[]},only:function(t){if(!vf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};de.Component=Wi;de.Fragment=p2;de.Profiler=y2;de.PureComponent=pf;de.StrictMode=g2;de.Suspense=x2;de.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=k2;de.act=Tv;de.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=yv({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=yf.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)_v.call(e,u)&&!xv.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];r.children=c}return{$$typeof:Da,type:t.type,key:s,ref:i,props:r,_owner:o}};de.createContext=function(t){return t={$$typeof:w2,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:v2,_context:t},t.Consumer=t};de.createElement=Ev;de.createFactory=function(t){var e=Ev.bind(null,t);return e.type=t,e};de.createRef=function(){return{current:null}};de.forwardRef=function(t){return{$$typeof:_2,render:t}};de.isValidElement=vf;de.lazy=function(t){return{$$typeof:T2,_payload:{_status:-1,_result:t},_init:A2}};de.memo=function(t,e){return{$$typeof:E2,type:t,compare:e===void 0?null:e}};de.startTransition=function(t){var e=jl.transition;jl.transition={};try{t()}finally{jl.transition=e}};de.unstable_act=Tv;de.useCallback=function(t,e){return It.current.useCallback(t,e)};de.useContext=function(t){return It.current.useContext(t)};de.useDebugValue=function(){};de.useDeferredValue=function(t){return It.current.useDeferredValue(t)};de.useEffect=function(t,e){return It.current.useEffect(t,e)};de.useId=function(){return It.current.useId()};de.useImperativeHandle=function(t,e,n){return It.current.useImperativeHandle(t,e,n)};de.useInsertionEffect=function(t,e){return It.current.useInsertionEffect(t,e)};de.useLayoutEffect=function(t,e){return It.current.useLayoutEffect(t,e)};de.useMemo=function(t,e){return It.current.useMemo(t,e)};de.useReducer=function(t,e,n){return It.current.useReducer(t,e,n)};de.useRef=function(t){return It.current.useRef(t)};de.useState=function(t){return It.current.useState(t)};de.useSyncExternalStore=function(t,e,n){return It.current.useSyncExternalStore(t,e,n)};de.useTransition=function(){return It.current.useTransition()};de.version="18.3.1";pv.exports=de;var R=pv.exports;const Iv=f2(R);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N2=R,C2=Symbol.for("react.element"),P2=Symbol.for("react.fragment"),R2=Object.prototype.hasOwnProperty,j2=N2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,D2={key:!0,ref:!0,__self:!0,__source:!0};function bv(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)R2.call(e,r)&&!D2.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:C2,type:t,key:i,ref:o,props:s,_owner:j2.current}}Xc.Fragment=P2;Xc.jsx=bv;Xc.jsxs=bv;mv.exports=Xc;var l=mv.exports,nc={},Sv={exports:{}},qt={},Av={exports:{}},kv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Q,re){var ae=Q.length;Q.push(re);e:for(;0<ae;){var _e=ae-1>>>1,Ie=Q[_e];if(0<s(Ie,re))Q[_e]=re,Q[ae]=Ie,ae=_e;else break e}}function n(Q){return Q.length===0?null:Q[0]}function r(Q){if(Q.length===0)return null;var re=Q[0],ae=Q.pop();if(ae!==re){Q[0]=ae;e:for(var _e=0,Ie=Q.length,rn=Ie>>>1;_e<rn;){var lt=2*(_e+1)-1,sn=Q[lt],_t=lt+1,Wt=Q[_t];if(0>s(sn,ae))_t<Ie&&0>s(Wt,sn)?(Q[_e]=Wt,Q[_t]=ae,_e=_t):(Q[_e]=sn,Q[lt]=ae,_e=lt);else if(_t<Ie&&0>s(Wt,ae))Q[_e]=Wt,Q[_t]=ae,_e=_t;else break e}}return re}function s(Q,re){var ae=Q.sortIndex-re.sortIndex;return ae!==0?ae:Q.id-re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],d=[],f=1,p=null,g=3,E=!1,C=!1,P=!1,b=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(Q){for(var re=n(d);re!==null;){if(re.callback===null)r(d);else if(re.startTime<=Q)r(d),re.sortIndex=re.expirationTime,e(u,re);else break;re=n(d)}}function D(Q){if(P=!1,A(Q),!C)if(n(u)!==null)C=!0,wt(V);else{var re=n(d);re!==null&&Vn(D,re.startTime-Q)}}function V(Q,re){C=!1,P&&(P=!1,T(v),v=-1),E=!0;var ae=g;try{for(A(re),p=n(u);p!==null&&(!(p.expirationTime>re)||Q&&!S());){var _e=p.callback;if(typeof _e=="function"){p.callback=null,g=p.priorityLevel;var Ie=_e(p.expirationTime<=re);re=t.unstable_now(),typeof Ie=="function"?p.callback=Ie:p===n(u)&&r(u),A(re)}else r(u);p=n(u)}if(p!==null)var rn=!0;else{var lt=n(d);lt!==null&&Vn(D,lt.startTime-re),rn=!1}return rn}finally{p=null,g=ae,E=!1}}var O=!1,y=null,v=-1,I=5,N=-1;function S(){return!(t.unstable_now()-N<I)}function k(){if(y!==null){var Q=t.unstable_now();N=Q;var re=!0;try{re=y(!0,Q)}finally{re?_():(O=!1,y=null)}}else O=!1}var _;if(typeof x=="function")_=function(){x(k)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,ge=ee.port2;ee.port1.onmessage=k,_=function(){ge.postMessage(null)}}else _=function(){b(k,0)};function wt(Q){y=Q,O||(O=!0,_())}function Vn(Q,re){v=b(function(){Q(t.unstable_now())},re)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Q){Q.callback=null},t.unstable_continueExecution=function(){C||E||(C=!0,wt(V))},t.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<Q?Math.floor(1e3/Q):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(Q){switch(g){case 1:case 2:case 3:var re=3;break;default:re=g}var ae=g;g=re;try{return Q()}finally{g=ae}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Q,re){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var ae=g;g=Q;try{return re()}finally{g=ae}},t.unstable_scheduleCallback=function(Q,re,ae){var _e=t.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?_e+ae:_e):ae=_e,Q){case 1:var Ie=-1;break;case 2:Ie=250;break;case 5:Ie=1073741823;break;case 4:Ie=1e4;break;default:Ie=5e3}return Ie=ae+Ie,Q={id:f++,callback:re,priorityLevel:Q,startTime:ae,expirationTime:Ie,sortIndex:-1},ae>_e?(Q.sortIndex=ae,e(d,Q),n(u)===null&&Q===n(d)&&(P?(T(v),v=-1):P=!0,Vn(D,ae-_e))):(Q.sortIndex=Ie,e(u,Q),C||E||(C=!0,wt(V))),Q},t.unstable_shouldYield=S,t.unstable_wrapCallback=function(Q){var re=g;return function(){var ae=g;g=re;try{return Q.apply(this,arguments)}finally{g=ae}}}})(kv);Av.exports=kv;var L2=Av.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M2=R,zt=L2;function K(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Nv=new Set,ia={};function Hs(t,e){Ri(t,e),Ri(t+"Capture",e)}function Ri(t,e){for(ia[t]=e,t=0;t<e.length;t++)Nv.add(e[t])}var Zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Kd=Object.prototype.hasOwnProperty,V2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,pg={},gg={};function O2(t){return Kd.call(gg,t)?!0:Kd.call(pg,t)?!1:V2.test(t)?gg[t]=!0:(pg[t]=!0,!1)}function F2(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function U2(t,e,n,r){if(e===null||typeof e>"u"||F2(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function bt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var ot={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ot[t]=new bt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ot[e]=new bt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ot[t]=new bt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ot[t]=new bt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ot[t]=new bt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ot[t]=new bt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ot[t]=new bt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ot[t]=new bt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ot[t]=new bt(t,5,!1,t.toLowerCase(),null,!1,!1)});var wf=/[\-:]([a-z])/g;function _f(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(wf,_f);ot[e]=new bt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(wf,_f);ot[e]=new bt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(wf,_f);ot[e]=new bt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ot[t]=new bt(t,1,!1,t.toLowerCase(),null,!1,!1)});ot.xlinkHref=new bt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ot[t]=new bt(t,1,!1,t.toLowerCase(),null,!0,!0)});function xf(t,e,n,r){var s=ot.hasOwnProperty(e)?ot[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(U2(e,n,s,r)&&(n=null),r||s===null?O2(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var lr=M2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ll=Symbol.for("react.element"),ai=Symbol.for("react.portal"),li=Symbol.for("react.fragment"),Ef=Symbol.for("react.strict_mode"),Gd=Symbol.for("react.profiler"),Cv=Symbol.for("react.provider"),Pv=Symbol.for("react.context"),Tf=Symbol.for("react.forward_ref"),Qd=Symbol.for("react.suspense"),Yd=Symbol.for("react.suspense_list"),If=Symbol.for("react.memo"),_r=Symbol.for("react.lazy"),Rv=Symbol.for("react.offscreen"),yg=Symbol.iterator;function So(t){return t===null||typeof t!="object"?null:(t=yg&&t[yg]||t["@@iterator"],typeof t=="function"?t:null)}var Re=Object.assign,sd;function Do(t){if(sd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);sd=e&&e[1]||""}return`
`+sd+t}var id=!1;function od(t,e){if(!t||id)return"";id=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,c=i.length-1;1<=o&&0<=c&&s[o]!==i[c];)c--;for(;1<=o&&0<=c;o--,c--)if(s[o]!==i[c]){if(o!==1||c!==1)do if(o--,c--,0>c||s[o]!==i[c]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=c);break}}}finally{id=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Do(t):""}function B2(t){switch(t.tag){case 5:return Do(t.type);case 16:return Do("Lazy");case 13:return Do("Suspense");case 19:return Do("SuspenseList");case 0:case 2:case 15:return t=od(t.type,!1),t;case 11:return t=od(t.type.render,!1),t;case 1:return t=od(t.type,!0),t;default:return""}}function Xd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case li:return"Fragment";case ai:return"Portal";case Gd:return"Profiler";case Ef:return"StrictMode";case Qd:return"Suspense";case Yd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Pv:return(t.displayName||"Context")+".Consumer";case Cv:return(t._context.displayName||"Context")+".Provider";case Tf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case If:return e=t.displayName||null,e!==null?e:Xd(t.type)||"Memo";case _r:e=t._payload,t=t._init;try{return Xd(t(e))}catch{}}return null}function $2(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Xd(e);case 8:return e===Ef?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function $r(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function jv(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function z2(t){var e=jv(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function cl(t){t._valueTracker||(t._valueTracker=z2(t))}function Dv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=jv(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function rc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Jd(t,e){var n=e.checked;return Re({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function vg(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=$r(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Lv(t,e){e=e.checked,e!=null&&xf(t,"checked",e,!1)}function Zd(t,e){Lv(t,e);var n=$r(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?eh(t,e.type,n):e.hasOwnProperty("defaultValue")&&eh(t,e.type,$r(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function wg(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function eh(t,e,n){(e!=="number"||rc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Lo=Array.isArray;function _i(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+$r(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function th(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(K(91));return Re({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function _g(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(K(92));if(Lo(n)){if(1<n.length)throw Error(K(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:$r(n)}}function Mv(t,e){var n=$r(e.value),r=$r(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function xg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Vv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function nh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Vv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ul,Ov=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ul=ul||document.createElement("div"),ul.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ul.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function oa(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var qo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},q2=["Webkit","ms","Moz","O"];Object.keys(qo).forEach(function(t){q2.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),qo[e]=qo[t]})});function Fv(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||qo.hasOwnProperty(t)&&qo[t]?(""+e).trim():e+"px"}function Uv(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Fv(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var H2=Re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function rh(t,e){if(e){if(H2[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(K(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(K(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(K(61))}if(e.style!=null&&typeof e.style!="object")throw Error(K(62))}}function sh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ih=null;function bf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var oh=null,xi=null,Ei=null;function Eg(t){if(t=Va(t)){if(typeof oh!="function")throw Error(K(280));var e=t.stateNode;e&&(e=nu(e),oh(t.stateNode,t.type,e))}}function Bv(t){xi?Ei?Ei.push(t):Ei=[t]:xi=t}function $v(){if(xi){var t=xi,e=Ei;if(Ei=xi=null,Eg(t),e)for(t=0;t<e.length;t++)Eg(e[t])}}function zv(t,e){return t(e)}function qv(){}var ad=!1;function Hv(t,e,n){if(ad)return t(e,n);ad=!0;try{return zv(t,e,n)}finally{ad=!1,(xi!==null||Ei!==null)&&(qv(),$v())}}function aa(t,e){var n=t.stateNode;if(n===null)return null;var r=nu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(K(231,e,typeof n));return n}var ah=!1;if(Zn)try{var Ao={};Object.defineProperty(Ao,"passive",{get:function(){ah=!0}}),window.addEventListener("test",Ao,Ao),window.removeEventListener("test",Ao,Ao)}catch{ah=!1}function W2(t,e,n,r,s,i,o,c,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(f){this.onError(f)}}var Ho=!1,sc=null,ic=!1,lh=null,K2={onError:function(t){Ho=!0,sc=t}};function G2(t,e,n,r,s,i,o,c,u){Ho=!1,sc=null,W2.apply(K2,arguments)}function Q2(t,e,n,r,s,i,o,c,u){if(G2.apply(this,arguments),Ho){if(Ho){var d=sc;Ho=!1,sc=null}else throw Error(K(198));ic||(ic=!0,lh=d)}}function Ws(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Wv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Tg(t){if(Ws(t)!==t)throw Error(K(188))}function Y2(t){var e=t.alternate;if(!e){if(e=Ws(t),e===null)throw Error(K(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Tg(s),t;if(i===r)return Tg(s),e;i=i.sibling}throw Error(K(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,c=s.child;c;){if(c===n){o=!0,n=s,r=i;break}if(c===r){o=!0,r=s,n=i;break}c=c.sibling}if(!o){for(c=i.child;c;){if(c===n){o=!0,n=i,r=s;break}if(c===r){o=!0,r=i,n=s;break}c=c.sibling}if(!o)throw Error(K(189))}}if(n.alternate!==r)throw Error(K(190))}if(n.tag!==3)throw Error(K(188));return n.stateNode.current===n?t:e}function Kv(t){return t=Y2(t),t!==null?Gv(t):null}function Gv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Gv(t);if(e!==null)return e;t=t.sibling}return null}var Qv=zt.unstable_scheduleCallback,Ig=zt.unstable_cancelCallback,X2=zt.unstable_shouldYield,J2=zt.unstable_requestPaint,Fe=zt.unstable_now,Z2=zt.unstable_getCurrentPriorityLevel,Sf=zt.unstable_ImmediatePriority,Yv=zt.unstable_UserBlockingPriority,oc=zt.unstable_NormalPriority,eT=zt.unstable_LowPriority,Xv=zt.unstable_IdlePriority,Jc=null,Sn=null;function tT(t){if(Sn&&typeof Sn.onCommitFiberRoot=="function")try{Sn.onCommitFiberRoot(Jc,t,void 0,(t.current.flags&128)===128)}catch{}}var dn=Math.clz32?Math.clz32:sT,nT=Math.log,rT=Math.LN2;function sT(t){return t>>>=0,t===0?32:31-(nT(t)/rT|0)|0}var dl=64,hl=4194304;function Mo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ac(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var c=o&~s;c!==0?r=Mo(c):(i&=o,i!==0&&(r=Mo(i)))}else o=n&~s,o!==0?r=Mo(o):i!==0&&(r=Mo(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-dn(e),s=1<<n,r|=t[n],e&=~s;return r}function iT(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oT(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-dn(i),c=1<<o,u=s[o];u===-1?(!(c&n)||c&r)&&(s[o]=iT(c,e)):u<=e&&(t.expiredLanes|=c),i&=~c}}function ch(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Jv(){var t=dl;return dl<<=1,!(dl&4194240)&&(dl=64),t}function ld(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function La(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-dn(e),t[e]=n}function aT(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-dn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Af(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-dn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var we=0;function Zv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ew,kf,tw,nw,rw,uh=!1,fl=[],Pr=null,Rr=null,jr=null,la=new Map,ca=new Map,Er=[],lT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bg(t,e){switch(t){case"focusin":case"focusout":Pr=null;break;case"dragenter":case"dragleave":Rr=null;break;case"mouseover":case"mouseout":jr=null;break;case"pointerover":case"pointerout":la.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ca.delete(e.pointerId)}}function ko(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Va(e),e!==null&&kf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function cT(t,e,n,r,s){switch(e){case"focusin":return Pr=ko(Pr,t,e,n,r,s),!0;case"dragenter":return Rr=ko(Rr,t,e,n,r,s),!0;case"mouseover":return jr=ko(jr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return la.set(i,ko(la.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,ca.set(i,ko(ca.get(i)||null,t,e,n,r,s)),!0}return!1}function sw(t){var e=Ts(t.target);if(e!==null){var n=Ws(e);if(n!==null){if(e=n.tag,e===13){if(e=Wv(n),e!==null){t.blockedOn=e,rw(t.priority,function(){tw(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Dl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=dh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);ih=r,n.target.dispatchEvent(r),ih=null}else return e=Va(n),e!==null&&kf(e),t.blockedOn=n,!1;e.shift()}return!0}function Sg(t,e,n){Dl(t)&&n.delete(e)}function uT(){uh=!1,Pr!==null&&Dl(Pr)&&(Pr=null),Rr!==null&&Dl(Rr)&&(Rr=null),jr!==null&&Dl(jr)&&(jr=null),la.forEach(Sg),ca.forEach(Sg)}function No(t,e){t.blockedOn===e&&(t.blockedOn=null,uh||(uh=!0,zt.unstable_scheduleCallback(zt.unstable_NormalPriority,uT)))}function ua(t){function e(s){return No(s,t)}if(0<fl.length){No(fl[0],t);for(var n=1;n<fl.length;n++){var r=fl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Pr!==null&&No(Pr,t),Rr!==null&&No(Rr,t),jr!==null&&No(jr,t),la.forEach(e),ca.forEach(e),n=0;n<Er.length;n++)r=Er[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Er.length&&(n=Er[0],n.blockedOn===null);)sw(n),n.blockedOn===null&&Er.shift()}var Ti=lr.ReactCurrentBatchConfig,lc=!0;function dT(t,e,n,r){var s=we,i=Ti.transition;Ti.transition=null;try{we=1,Nf(t,e,n,r)}finally{we=s,Ti.transition=i}}function hT(t,e,n,r){var s=we,i=Ti.transition;Ti.transition=null;try{we=4,Nf(t,e,n,r)}finally{we=s,Ti.transition=i}}function Nf(t,e,n,r){if(lc){var s=dh(t,e,n,r);if(s===null)vd(t,e,r,cc,n),bg(t,r);else if(cT(s,t,e,n,r))r.stopPropagation();else if(bg(t,r),e&4&&-1<lT.indexOf(t)){for(;s!==null;){var i=Va(s);if(i!==null&&ew(i),i=dh(t,e,n,r),i===null&&vd(t,e,r,cc,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else vd(t,e,r,null,n)}}var cc=null;function dh(t,e,n,r){if(cc=null,t=bf(r),t=Ts(t),t!==null)if(e=Ws(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Wv(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return cc=t,null}function iw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Z2()){case Sf:return 1;case Yv:return 4;case oc:case eT:return 16;case Xv:return 536870912;default:return 16}default:return 16}}var kr=null,Cf=null,Ll=null;function ow(){if(Ll)return Ll;var t,e=Cf,n=e.length,r,s="value"in kr?kr.value:kr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Ll=s.slice(t,1<r?1-r:void 0)}function Ml(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ml(){return!0}function Ag(){return!1}function Ht(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ml:Ag,this.isPropagationStopped=Ag,this}return Re(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ml)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ml)},persist:function(){},isPersistent:ml}),e}var Ki={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pf=Ht(Ki),Ma=Re({},Ki,{view:0,detail:0}),fT=Ht(Ma),cd,ud,Co,Zc=Re({},Ma,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Co&&(Co&&t.type==="mousemove"?(cd=t.screenX-Co.screenX,ud=t.screenY-Co.screenY):ud=cd=0,Co=t),cd)},movementY:function(t){return"movementY"in t?t.movementY:ud}}),kg=Ht(Zc),mT=Re({},Zc,{dataTransfer:0}),pT=Ht(mT),gT=Re({},Ma,{relatedTarget:0}),dd=Ht(gT),yT=Re({},Ki,{animationName:0,elapsedTime:0,pseudoElement:0}),vT=Ht(yT),wT=Re({},Ki,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),_T=Ht(wT),xT=Re({},Ki,{data:0}),Ng=Ht(xT),ET={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},TT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},IT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bT(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=IT[t])?!!e[t]:!1}function Rf(){return bT}var ST=Re({},Ma,{key:function(t){if(t.key){var e=ET[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ml(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?TT[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rf,charCode:function(t){return t.type==="keypress"?Ml(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ml(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),AT=Ht(ST),kT=Re({},Zc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cg=Ht(kT),NT=Re({},Ma,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rf}),CT=Ht(NT),PT=Re({},Ki,{propertyName:0,elapsedTime:0,pseudoElement:0}),RT=Ht(PT),jT=Re({},Zc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),DT=Ht(jT),LT=[9,13,27,32],jf=Zn&&"CompositionEvent"in window,Wo=null;Zn&&"documentMode"in document&&(Wo=document.documentMode);var MT=Zn&&"TextEvent"in window&&!Wo,aw=Zn&&(!jf||Wo&&8<Wo&&11>=Wo),Pg=" ",Rg=!1;function lw(t,e){switch(t){case"keyup":return LT.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ci=!1;function VT(t,e){switch(t){case"compositionend":return cw(e);case"keypress":return e.which!==32?null:(Rg=!0,Pg);case"textInput":return t=e.data,t===Pg&&Rg?null:t;default:return null}}function OT(t,e){if(ci)return t==="compositionend"||!jf&&lw(t,e)?(t=ow(),Ll=Cf=kr=null,ci=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return aw&&e.locale!=="ko"?null:e.data;default:return null}}var FT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!FT[t.type]:e==="textarea"}function uw(t,e,n,r){Bv(r),e=uc(e,"onChange"),0<e.length&&(n=new Pf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ko=null,da=null;function UT(t){xw(t,0)}function eu(t){var e=hi(t);if(Dv(e))return t}function BT(t,e){if(t==="change")return e}var dw=!1;if(Zn){var hd;if(Zn){var fd="oninput"in document;if(!fd){var Dg=document.createElement("div");Dg.setAttribute("oninput","return;"),fd=typeof Dg.oninput=="function"}hd=fd}else hd=!1;dw=hd&&(!document.documentMode||9<document.documentMode)}function Lg(){Ko&&(Ko.detachEvent("onpropertychange",hw),da=Ko=null)}function hw(t){if(t.propertyName==="value"&&eu(da)){var e=[];uw(e,da,t,bf(t)),Hv(UT,e)}}function $T(t,e,n){t==="focusin"?(Lg(),Ko=e,da=n,Ko.attachEvent("onpropertychange",hw)):t==="focusout"&&Lg()}function zT(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return eu(da)}function qT(t,e){if(t==="click")return eu(e)}function HT(t,e){if(t==="input"||t==="change")return eu(e)}function WT(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var fn=typeof Object.is=="function"?Object.is:WT;function ha(t,e){if(fn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Kd.call(e,s)||!fn(t[s],e[s]))return!1}return!0}function Mg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Vg(t,e){var n=Mg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Mg(n)}}function fw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?fw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function mw(){for(var t=window,e=rc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=rc(t.document)}return e}function Df(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function KT(t){var e=mw(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&fw(n.ownerDocument.documentElement,n)){if(r!==null&&Df(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Vg(n,i);var o=Vg(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var GT=Zn&&"documentMode"in document&&11>=document.documentMode,ui=null,hh=null,Go=null,fh=!1;function Og(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;fh||ui==null||ui!==rc(r)||(r=ui,"selectionStart"in r&&Df(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Go&&ha(Go,r)||(Go=r,r=uc(hh,"onSelect"),0<r.length&&(e=new Pf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ui)))}function pl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var di={animationend:pl("Animation","AnimationEnd"),animationiteration:pl("Animation","AnimationIteration"),animationstart:pl("Animation","AnimationStart"),transitionend:pl("Transition","TransitionEnd")},md={},pw={};Zn&&(pw=document.createElement("div").style,"AnimationEvent"in window||(delete di.animationend.animation,delete di.animationiteration.animation,delete di.animationstart.animation),"TransitionEvent"in window||delete di.transitionend.transition);function tu(t){if(md[t])return md[t];if(!di[t])return t;var e=di[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in pw)return md[t]=e[n];return t}var gw=tu("animationend"),yw=tu("animationiteration"),vw=tu("animationstart"),ww=tu("transitionend"),_w=new Map,Fg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ts(t,e){_w.set(t,e),Hs(e,[t])}for(var pd=0;pd<Fg.length;pd++){var gd=Fg[pd],QT=gd.toLowerCase(),YT=gd[0].toUpperCase()+gd.slice(1);ts(QT,"on"+YT)}ts(gw,"onAnimationEnd");ts(yw,"onAnimationIteration");ts(vw,"onAnimationStart");ts("dblclick","onDoubleClick");ts("focusin","onFocus");ts("focusout","onBlur");ts(ww,"onTransitionEnd");Ri("onMouseEnter",["mouseout","mouseover"]);Ri("onMouseLeave",["mouseout","mouseover"]);Ri("onPointerEnter",["pointerout","pointerover"]);Ri("onPointerLeave",["pointerout","pointerover"]);Hs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Hs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Hs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Hs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Hs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Hs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),XT=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vo));function Ug(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Q2(r,e,void 0,t),t.currentTarget=null}function xw(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var c=r[o],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==i&&s.isPropagationStopped())break e;Ug(s,c,d),i=u}else for(o=0;o<r.length;o++){if(c=r[o],u=c.instance,d=c.currentTarget,c=c.listener,u!==i&&s.isPropagationStopped())break e;Ug(s,c,d),i=u}}}if(ic)throw t=lh,ic=!1,lh=null,t}function Se(t,e){var n=e[vh];n===void 0&&(n=e[vh]=new Set);var r=t+"__bubble";n.has(r)||(Ew(e,t,2,!1),n.add(r))}function yd(t,e,n){var r=0;e&&(r|=4),Ew(n,t,r,e)}var gl="_reactListening"+Math.random().toString(36).slice(2);function fa(t){if(!t[gl]){t[gl]=!0,Nv.forEach(function(n){n!=="selectionchange"&&(XT.has(n)||yd(n,!1,t),yd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[gl]||(e[gl]=!0,yd("selectionchange",!1,e))}}function Ew(t,e,n,r){switch(iw(e)){case 1:var s=dT;break;case 4:s=hT;break;default:s=Nf}n=s.bind(null,e,n,t),s=void 0,!ah||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function vd(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;c!==null;){if(o=Ts(c),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}c=c.parentNode}}r=r.return}Hv(function(){var d=i,f=bf(n),p=[];e:{var g=_w.get(t);if(g!==void 0){var E=Pf,C=t;switch(t){case"keypress":if(Ml(n)===0)break e;case"keydown":case"keyup":E=AT;break;case"focusin":C="focus",E=dd;break;case"focusout":C="blur",E=dd;break;case"beforeblur":case"afterblur":E=dd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=kg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=pT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=CT;break;case gw:case yw:case vw:E=vT;break;case ww:E=RT;break;case"scroll":E=fT;break;case"wheel":E=DT;break;case"copy":case"cut":case"paste":E=_T;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=Cg}var P=(e&4)!==0,b=!P&&t==="scroll",T=P?g!==null?g+"Capture":null:g;P=[];for(var x=d,A;x!==null;){A=x;var D=A.stateNode;if(A.tag===5&&D!==null&&(A=D,T!==null&&(D=aa(x,T),D!=null&&P.push(ma(x,D,A)))),b)break;x=x.return}0<P.length&&(g=new E(g,C,null,n,f),p.push({event:g,listeners:P}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",E=t==="mouseout"||t==="pointerout",g&&n!==ih&&(C=n.relatedTarget||n.fromElement)&&(Ts(C)||C[er]))break e;if((E||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,E?(C=n.relatedTarget||n.toElement,E=d,C=C?Ts(C):null,C!==null&&(b=Ws(C),C!==b||C.tag!==5&&C.tag!==6)&&(C=null)):(E=null,C=d),E!==C)){if(P=kg,D="onMouseLeave",T="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(P=Cg,D="onPointerLeave",T="onPointerEnter",x="pointer"),b=E==null?g:hi(E),A=C==null?g:hi(C),g=new P(D,x+"leave",E,n,f),g.target=b,g.relatedTarget=A,D=null,Ts(f)===d&&(P=new P(T,x+"enter",C,n,f),P.target=A,P.relatedTarget=b,D=P),b=D,E&&C)t:{for(P=E,T=C,x=0,A=P;A;A=ni(A))x++;for(A=0,D=T;D;D=ni(D))A++;for(;0<x-A;)P=ni(P),x--;for(;0<A-x;)T=ni(T),A--;for(;x--;){if(P===T||T!==null&&P===T.alternate)break t;P=ni(P),T=ni(T)}P=null}else P=null;E!==null&&Bg(p,g,E,P,!1),C!==null&&b!==null&&Bg(p,b,C,P,!0)}}e:{if(g=d?hi(d):window,E=g.nodeName&&g.nodeName.toLowerCase(),E==="select"||E==="input"&&g.type==="file")var V=BT;else if(jg(g))if(dw)V=HT;else{V=zT;var O=$T}else(E=g.nodeName)&&E.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(V=qT);if(V&&(V=V(t,d))){uw(p,V,n,f);break e}O&&O(t,g,d),t==="focusout"&&(O=g._wrapperState)&&O.controlled&&g.type==="number"&&eh(g,"number",g.value)}switch(O=d?hi(d):window,t){case"focusin":(jg(O)||O.contentEditable==="true")&&(ui=O,hh=d,Go=null);break;case"focusout":Go=hh=ui=null;break;case"mousedown":fh=!0;break;case"contextmenu":case"mouseup":case"dragend":fh=!1,Og(p,n,f);break;case"selectionchange":if(GT)break;case"keydown":case"keyup":Og(p,n,f)}var y;if(jf)e:{switch(t){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else ci?lw(t,n)&&(v="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(v="onCompositionStart");v&&(aw&&n.locale!=="ko"&&(ci||v!=="onCompositionStart"?v==="onCompositionEnd"&&ci&&(y=ow()):(kr=f,Cf="value"in kr?kr.value:kr.textContent,ci=!0)),O=uc(d,v),0<O.length&&(v=new Ng(v,t,null,n,f),p.push({event:v,listeners:O}),y?v.data=y:(y=cw(n),y!==null&&(v.data=y)))),(y=MT?VT(t,n):OT(t,n))&&(d=uc(d,"onBeforeInput"),0<d.length&&(f=new Ng("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:d}),f.data=y))}xw(p,e)})}function ma(t,e,n){return{instance:t,listener:e,currentTarget:n}}function uc(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=aa(t,n),i!=null&&r.unshift(ma(t,i,s)),i=aa(t,e),i!=null&&r.push(ma(t,i,s))),t=t.return}return r}function ni(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Bg(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var c=n,u=c.alternate,d=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&d!==null&&(c=d,s?(u=aa(n,i),u!=null&&o.unshift(ma(n,u,c))):s||(u=aa(n,i),u!=null&&o.push(ma(n,u,c)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var JT=/\r\n?/g,ZT=/\u0000|\uFFFD/g;function $g(t){return(typeof t=="string"?t:""+t).replace(JT,`
`).replace(ZT,"")}function yl(t,e,n){if(e=$g(e),$g(t)!==e&&n)throw Error(K(425))}function dc(){}var mh=null,ph=null;function gh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var yh=typeof setTimeout=="function"?setTimeout:void 0,eI=typeof clearTimeout=="function"?clearTimeout:void 0,zg=typeof Promise=="function"?Promise:void 0,tI=typeof queueMicrotask=="function"?queueMicrotask:typeof zg<"u"?function(t){return zg.resolve(null).then(t).catch(nI)}:yh;function nI(t){setTimeout(function(){throw t})}function wd(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),ua(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);ua(e)}function Dr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function qg(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Gi=Math.random().toString(36).slice(2),En="__reactFiber$"+Gi,pa="__reactProps$"+Gi,er="__reactContainer$"+Gi,vh="__reactEvents$"+Gi,rI="__reactListeners$"+Gi,sI="__reactHandles$"+Gi;function Ts(t){var e=t[En];if(e)return e;for(var n=t.parentNode;n;){if(e=n[er]||n[En]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=qg(t);t!==null;){if(n=t[En])return n;t=qg(t)}return e}t=n,n=t.parentNode}return null}function Va(t){return t=t[En]||t[er],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function hi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(K(33))}function nu(t){return t[pa]||null}var wh=[],fi=-1;function ns(t){return{current:t}}function ke(t){0>fi||(t.current=wh[fi],wh[fi]=null,fi--)}function Te(t,e){fi++,wh[fi]=t.current,t.current=e}var zr={},yt=ns(zr),Pt=ns(!1),Rs=zr;function ji(t,e){var n=t.type.contextTypes;if(!n)return zr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Rt(t){return t=t.childContextTypes,t!=null}function hc(){ke(Pt),ke(yt)}function Hg(t,e,n){if(yt.current!==zr)throw Error(K(168));Te(yt,e),Te(Pt,n)}function Tw(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(K(108,$2(t)||"Unknown",s));return Re({},n,r)}function fc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||zr,Rs=yt.current,Te(yt,t),Te(Pt,Pt.current),!0}function Wg(t,e,n){var r=t.stateNode;if(!r)throw Error(K(169));n?(t=Tw(t,e,Rs),r.__reactInternalMemoizedMergedChildContext=t,ke(Pt),ke(yt),Te(yt,t)):ke(Pt),Te(Pt,n)}var $n=null,ru=!1,_d=!1;function Iw(t){$n===null?$n=[t]:$n.push(t)}function iI(t){ru=!0,Iw(t)}function rs(){if(!_d&&$n!==null){_d=!0;var t=0,e=we;try{var n=$n;for(we=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}$n=null,ru=!1}catch(s){throw $n!==null&&($n=$n.slice(t+1)),Qv(Sf,rs),s}finally{we=e,_d=!1}}return null}var mi=[],pi=0,mc=null,pc=0,Kt=[],Gt=0,js=null,zn=1,qn="";function _s(t,e){mi[pi++]=pc,mi[pi++]=mc,mc=t,pc=e}function bw(t,e,n){Kt[Gt++]=zn,Kt[Gt++]=qn,Kt[Gt++]=js,js=t;var r=zn;t=qn;var s=32-dn(r)-1;r&=~(1<<s),n+=1;var i=32-dn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,zn=1<<32-dn(e)+s|n<<s|r,qn=i+t}else zn=1<<i|n<<s|r,qn=t}function Lf(t){t.return!==null&&(_s(t,1),bw(t,1,0))}function Mf(t){for(;t===mc;)mc=mi[--pi],mi[pi]=null,pc=mi[--pi],mi[pi]=null;for(;t===js;)js=Kt[--Gt],Kt[Gt]=null,qn=Kt[--Gt],Kt[Gt]=null,zn=Kt[--Gt],Kt[Gt]=null}var $t=null,Ut=null,Ne=!1,cn=null;function Sw(t,e){var n=Xt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Kg(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,$t=t,Ut=Dr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,$t=t,Ut=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=js!==null?{id:zn,overflow:qn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Xt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,$t=t,Ut=null,!0):!1;default:return!1}}function _h(t){return(t.mode&1)!==0&&(t.flags&128)===0}function xh(t){if(Ne){var e=Ut;if(e){var n=e;if(!Kg(t,e)){if(_h(t))throw Error(K(418));e=Dr(n.nextSibling);var r=$t;e&&Kg(t,e)?Sw(r,n):(t.flags=t.flags&-4097|2,Ne=!1,$t=t)}}else{if(_h(t))throw Error(K(418));t.flags=t.flags&-4097|2,Ne=!1,$t=t}}}function Gg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;$t=t}function vl(t){if(t!==$t)return!1;if(!Ne)return Gg(t),Ne=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!gh(t.type,t.memoizedProps)),e&&(e=Ut)){if(_h(t))throw Aw(),Error(K(418));for(;e;)Sw(t,e),e=Dr(e.nextSibling)}if(Gg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(K(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ut=Dr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ut=null}}else Ut=$t?Dr(t.stateNode.nextSibling):null;return!0}function Aw(){for(var t=Ut;t;)t=Dr(t.nextSibling)}function Di(){Ut=$t=null,Ne=!1}function Vf(t){cn===null?cn=[t]:cn.push(t)}var oI=lr.ReactCurrentBatchConfig;function Po(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(K(309));var r=n.stateNode}if(!r)throw Error(K(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var c=s.refs;o===null?delete c[i]:c[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(K(284));if(!n._owner)throw Error(K(290,t))}return t}function wl(t,e){throw t=Object.prototype.toString.call(e),Error(K(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Qg(t){var e=t._init;return e(t._payload)}function kw(t){function e(T,x){if(t){var A=T.deletions;A===null?(T.deletions=[x],T.flags|=16):A.push(x)}}function n(T,x){if(!t)return null;for(;x!==null;)e(T,x),x=x.sibling;return null}function r(T,x){for(T=new Map;x!==null;)x.key!==null?T.set(x.key,x):T.set(x.index,x),x=x.sibling;return T}function s(T,x){return T=Or(T,x),T.index=0,T.sibling=null,T}function i(T,x,A){return T.index=A,t?(A=T.alternate,A!==null?(A=A.index,A<x?(T.flags|=2,x):A):(T.flags|=2,x)):(T.flags|=1048576,x)}function o(T){return t&&T.alternate===null&&(T.flags|=2),T}function c(T,x,A,D){return x===null||x.tag!==6?(x=Ad(A,T.mode,D),x.return=T,x):(x=s(x,A),x.return=T,x)}function u(T,x,A,D){var V=A.type;return V===li?f(T,x,A.props.children,D,A.key):x!==null&&(x.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===_r&&Qg(V)===x.type)?(D=s(x,A.props),D.ref=Po(T,x,A),D.return=T,D):(D=zl(A.type,A.key,A.props,null,T.mode,D),D.ref=Po(T,x,A),D.return=T,D)}function d(T,x,A,D){return x===null||x.tag!==4||x.stateNode.containerInfo!==A.containerInfo||x.stateNode.implementation!==A.implementation?(x=kd(A,T.mode,D),x.return=T,x):(x=s(x,A.children||[]),x.return=T,x)}function f(T,x,A,D,V){return x===null||x.tag!==7?(x=Ns(A,T.mode,D,V),x.return=T,x):(x=s(x,A),x.return=T,x)}function p(T,x,A){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Ad(""+x,T.mode,A),x.return=T,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case ll:return A=zl(x.type,x.key,x.props,null,T.mode,A),A.ref=Po(T,null,x),A.return=T,A;case ai:return x=kd(x,T.mode,A),x.return=T,x;case _r:var D=x._init;return p(T,D(x._payload),A)}if(Lo(x)||So(x))return x=Ns(x,T.mode,A,null),x.return=T,x;wl(T,x)}return null}function g(T,x,A,D){var V=x!==null?x.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return V!==null?null:c(T,x,""+A,D);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case ll:return A.key===V?u(T,x,A,D):null;case ai:return A.key===V?d(T,x,A,D):null;case _r:return V=A._init,g(T,x,V(A._payload),D)}if(Lo(A)||So(A))return V!==null?null:f(T,x,A,D,null);wl(T,A)}return null}function E(T,x,A,D,V){if(typeof D=="string"&&D!==""||typeof D=="number")return T=T.get(A)||null,c(x,T,""+D,V);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case ll:return T=T.get(D.key===null?A:D.key)||null,u(x,T,D,V);case ai:return T=T.get(D.key===null?A:D.key)||null,d(x,T,D,V);case _r:var O=D._init;return E(T,x,A,O(D._payload),V)}if(Lo(D)||So(D))return T=T.get(A)||null,f(x,T,D,V,null);wl(x,D)}return null}function C(T,x,A,D){for(var V=null,O=null,y=x,v=x=0,I=null;y!==null&&v<A.length;v++){y.index>v?(I=y,y=null):I=y.sibling;var N=g(T,y,A[v],D);if(N===null){y===null&&(y=I);break}t&&y&&N.alternate===null&&e(T,y),x=i(N,x,v),O===null?V=N:O.sibling=N,O=N,y=I}if(v===A.length)return n(T,y),Ne&&_s(T,v),V;if(y===null){for(;v<A.length;v++)y=p(T,A[v],D),y!==null&&(x=i(y,x,v),O===null?V=y:O.sibling=y,O=y);return Ne&&_s(T,v),V}for(y=r(T,y);v<A.length;v++)I=E(y,T,v,A[v],D),I!==null&&(t&&I.alternate!==null&&y.delete(I.key===null?v:I.key),x=i(I,x,v),O===null?V=I:O.sibling=I,O=I);return t&&y.forEach(function(S){return e(T,S)}),Ne&&_s(T,v),V}function P(T,x,A,D){var V=So(A);if(typeof V!="function")throw Error(K(150));if(A=V.call(A),A==null)throw Error(K(151));for(var O=V=null,y=x,v=x=0,I=null,N=A.next();y!==null&&!N.done;v++,N=A.next()){y.index>v?(I=y,y=null):I=y.sibling;var S=g(T,y,N.value,D);if(S===null){y===null&&(y=I);break}t&&y&&S.alternate===null&&e(T,y),x=i(S,x,v),O===null?V=S:O.sibling=S,O=S,y=I}if(N.done)return n(T,y),Ne&&_s(T,v),V;if(y===null){for(;!N.done;v++,N=A.next())N=p(T,N.value,D),N!==null&&(x=i(N,x,v),O===null?V=N:O.sibling=N,O=N);return Ne&&_s(T,v),V}for(y=r(T,y);!N.done;v++,N=A.next())N=E(y,T,v,N.value,D),N!==null&&(t&&N.alternate!==null&&y.delete(N.key===null?v:N.key),x=i(N,x,v),O===null?V=N:O.sibling=N,O=N);return t&&y.forEach(function(k){return e(T,k)}),Ne&&_s(T,v),V}function b(T,x,A,D){if(typeof A=="object"&&A!==null&&A.type===li&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case ll:e:{for(var V=A.key,O=x;O!==null;){if(O.key===V){if(V=A.type,V===li){if(O.tag===7){n(T,O.sibling),x=s(O,A.props.children),x.return=T,T=x;break e}}else if(O.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===_r&&Qg(V)===O.type){n(T,O.sibling),x=s(O,A.props),x.ref=Po(T,O,A),x.return=T,T=x;break e}n(T,O);break}else e(T,O);O=O.sibling}A.type===li?(x=Ns(A.props.children,T.mode,D,A.key),x.return=T,T=x):(D=zl(A.type,A.key,A.props,null,T.mode,D),D.ref=Po(T,x,A),D.return=T,T=D)}return o(T);case ai:e:{for(O=A.key;x!==null;){if(x.key===O)if(x.tag===4&&x.stateNode.containerInfo===A.containerInfo&&x.stateNode.implementation===A.implementation){n(T,x.sibling),x=s(x,A.children||[]),x.return=T,T=x;break e}else{n(T,x);break}else e(T,x);x=x.sibling}x=kd(A,T.mode,D),x.return=T,T=x}return o(T);case _r:return O=A._init,b(T,x,O(A._payload),D)}if(Lo(A))return C(T,x,A,D);if(So(A))return P(T,x,A,D);wl(T,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,x!==null&&x.tag===6?(n(T,x.sibling),x=s(x,A),x.return=T,T=x):(n(T,x),x=Ad(A,T.mode,D),x.return=T,T=x),o(T)):n(T,x)}return b}var Li=kw(!0),Nw=kw(!1),gc=ns(null),yc=null,gi=null,Of=null;function Ff(){Of=gi=yc=null}function Uf(t){var e=gc.current;ke(gc),t._currentValue=e}function Eh(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ii(t,e){yc=t,Of=gi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ct=!0),t.firstContext=null)}function tn(t){var e=t._currentValue;if(Of!==t)if(t={context:t,memoizedValue:e,next:null},gi===null){if(yc===null)throw Error(K(308));gi=t,yc.dependencies={lanes:0,firstContext:t}}else gi=gi.next=t;return e}var Is=null;function Bf(t){Is===null?Is=[t]:Is.push(t)}function Cw(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Bf(e)):(n.next=s.next,s.next=n),e.interleaved=n,tr(t,r)}function tr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var xr=!1;function $f(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Pw(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Qn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Lr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ye&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,tr(t,n)}return s=r.interleaved,s===null?(e.next=e,Bf(r)):(e.next=s.next,s.next=e),r.interleaved=e,tr(t,n)}function Vl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Af(t,n)}}function Yg(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function vc(t,e,n,r){var s=t.updateQueue;xr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var f=t.alternate;f!==null&&(f=f.updateQueue,c=f.lastBaseUpdate,c!==o&&(c===null?f.firstBaseUpdate=d:c.next=d,f.lastBaseUpdate=u))}if(i!==null){var p=s.baseState;o=0,f=d=u=null,c=i;do{var g=c.lane,E=c.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:E,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var C=t,P=c;switch(g=e,E=n,P.tag){case 1:if(C=P.payload,typeof C=="function"){p=C.call(E,p,g);break e}p=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=P.payload,g=typeof C=="function"?C.call(E,p,g):C,g==null)break e;p=Re({},p,g);break e;case 2:xr=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[c]:g.push(c))}else E={eventTime:E,lane:g,tag:c.tag,payload:c.payload,callback:c.callback,next:null},f===null?(d=f=E,u=p):f=f.next=E,o|=g;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;g=c,c=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(f===null&&(u=p),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Ls|=o,t.lanes=o,t.memoizedState=p}}function Xg(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(K(191,s));s.call(r)}}}var Oa={},An=ns(Oa),ga=ns(Oa),ya=ns(Oa);function bs(t){if(t===Oa)throw Error(K(174));return t}function zf(t,e){switch(Te(ya,e),Te(ga,t),Te(An,Oa),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:nh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=nh(e,t)}ke(An),Te(An,e)}function Mi(){ke(An),ke(ga),ke(ya)}function Rw(t){bs(ya.current);var e=bs(An.current),n=nh(e,t.type);e!==n&&(Te(ga,t),Te(An,n))}function qf(t){ga.current===t&&(ke(An),ke(ga))}var Ce=ns(0);function wc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var xd=[];function Hf(){for(var t=0;t<xd.length;t++)xd[t]._workInProgressVersionPrimary=null;xd.length=0}var Ol=lr.ReactCurrentDispatcher,Ed=lr.ReactCurrentBatchConfig,Ds=0,Pe=null,Qe=null,et=null,_c=!1,Qo=!1,va=0,aI=0;function ct(){throw Error(K(321))}function Wf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!fn(t[n],e[n]))return!1;return!0}function Kf(t,e,n,r,s,i){if(Ds=i,Pe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ol.current=t===null||t.memoizedState===null?dI:hI,t=n(r,s),Qo){i=0;do{if(Qo=!1,va=0,25<=i)throw Error(K(301));i+=1,et=Qe=null,e.updateQueue=null,Ol.current=fI,t=n(r,s)}while(Qo)}if(Ol.current=xc,e=Qe!==null&&Qe.next!==null,Ds=0,et=Qe=Pe=null,_c=!1,e)throw Error(K(300));return t}function Gf(){var t=va!==0;return va=0,t}function _n(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return et===null?Pe.memoizedState=et=t:et=et.next=t,et}function nn(){if(Qe===null){var t=Pe.alternate;t=t!==null?t.memoizedState:null}else t=Qe.next;var e=et===null?Pe.memoizedState:et.next;if(e!==null)et=e,Qe=t;else{if(t===null)throw Error(K(310));Qe=t,t={memoizedState:Qe.memoizedState,baseState:Qe.baseState,baseQueue:Qe.baseQueue,queue:Qe.queue,next:null},et===null?Pe.memoizedState=et=t:et=et.next=t}return et}function wa(t,e){return typeof e=="function"?e(t):e}function Td(t){var e=nn(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var r=Qe,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var c=o=null,u=null,d=i;do{var f=d.lane;if((Ds&f)===f)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var p={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=p,o=r):u=u.next=p,Pe.lanes|=f,Ls|=f}d=d.next}while(d!==null&&d!==i);u===null?o=r:u.next=c,fn(r,e.memoizedState)||(Ct=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Pe.lanes|=i,Ls|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Id(t){var e=nn(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);fn(i,e.memoizedState)||(Ct=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function jw(){}function Dw(t,e){var n=Pe,r=nn(),s=e(),i=!fn(r.memoizedState,s);if(i&&(r.memoizedState=s,Ct=!0),r=r.queue,Qf(Vw.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||et!==null&&et.memoizedState.tag&1){if(n.flags|=2048,_a(9,Mw.bind(null,n,r,s,e),void 0,null),tt===null)throw Error(K(349));Ds&30||Lw(n,e,s)}return s}function Lw(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Pe.updateQueue,e===null?(e={lastEffect:null,stores:null},Pe.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Mw(t,e,n,r){e.value=n,e.getSnapshot=r,Ow(e)&&Fw(t)}function Vw(t,e,n){return n(function(){Ow(e)&&Fw(t)})}function Ow(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!fn(t,n)}catch{return!0}}function Fw(t){var e=tr(t,1);e!==null&&hn(e,t,1,-1)}function Jg(t){var e=_n();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:t},e.queue=t,t=t.dispatch=uI.bind(null,Pe,t),[e.memoizedState,t]}function _a(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Pe.updateQueue,e===null?(e={lastEffect:null,stores:null},Pe.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Uw(){return nn().memoizedState}function Fl(t,e,n,r){var s=_n();Pe.flags|=t,s.memoizedState=_a(1|e,n,void 0,r===void 0?null:r)}function su(t,e,n,r){var s=nn();r=r===void 0?null:r;var i=void 0;if(Qe!==null){var o=Qe.memoizedState;if(i=o.destroy,r!==null&&Wf(r,o.deps)){s.memoizedState=_a(e,n,i,r);return}}Pe.flags|=t,s.memoizedState=_a(1|e,n,i,r)}function Zg(t,e){return Fl(8390656,8,t,e)}function Qf(t,e){return su(2048,8,t,e)}function Bw(t,e){return su(4,2,t,e)}function $w(t,e){return su(4,4,t,e)}function zw(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function qw(t,e,n){return n=n!=null?n.concat([t]):null,su(4,4,zw.bind(null,e,t),n)}function Yf(){}function Hw(t,e){var n=nn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Wf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Ww(t,e){var n=nn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Wf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Kw(t,e,n){return Ds&21?(fn(n,e)||(n=Jv(),Pe.lanes|=n,Ls|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ct=!0),t.memoizedState=n)}function lI(t,e){var n=we;we=n!==0&&4>n?n:4,t(!0);var r=Ed.transition;Ed.transition={};try{t(!1),e()}finally{we=n,Ed.transition=r}}function Gw(){return nn().memoizedState}function cI(t,e,n){var r=Vr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qw(t))Yw(e,n);else if(n=Cw(t,e,n,r),n!==null){var s=Tt();hn(n,t,r,s),Xw(n,e,r)}}function uI(t,e,n){var r=Vr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qw(t))Yw(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,c=i(o,n);if(s.hasEagerState=!0,s.eagerState=c,fn(c,o)){var u=e.interleaved;u===null?(s.next=s,Bf(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=Cw(t,e,s,r),n!==null&&(s=Tt(),hn(n,t,r,s),Xw(n,e,r))}}function Qw(t){var e=t.alternate;return t===Pe||e!==null&&e===Pe}function Yw(t,e){Qo=_c=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Xw(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Af(t,n)}}var xc={readContext:tn,useCallback:ct,useContext:ct,useEffect:ct,useImperativeHandle:ct,useInsertionEffect:ct,useLayoutEffect:ct,useMemo:ct,useReducer:ct,useRef:ct,useState:ct,useDebugValue:ct,useDeferredValue:ct,useTransition:ct,useMutableSource:ct,useSyncExternalStore:ct,useId:ct,unstable_isNewReconciler:!1},dI={readContext:tn,useCallback:function(t,e){return _n().memoizedState=[t,e===void 0?null:e],t},useContext:tn,useEffect:Zg,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Fl(4194308,4,zw.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Fl(4194308,4,t,e)},useInsertionEffect:function(t,e){return Fl(4,2,t,e)},useMemo:function(t,e){var n=_n();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=_n();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=cI.bind(null,Pe,t),[r.memoizedState,t]},useRef:function(t){var e=_n();return t={current:t},e.memoizedState=t},useState:Jg,useDebugValue:Yf,useDeferredValue:function(t){return _n().memoizedState=t},useTransition:function(){var t=Jg(!1),e=t[0];return t=lI.bind(null,t[1]),_n().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Pe,s=_n();if(Ne){if(n===void 0)throw Error(K(407));n=n()}else{if(n=e(),tt===null)throw Error(K(349));Ds&30||Lw(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Zg(Vw.bind(null,r,i,t),[t]),r.flags|=2048,_a(9,Mw.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=_n(),e=tt.identifierPrefix;if(Ne){var n=qn,r=zn;n=(r&~(1<<32-dn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=va++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=aI++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},hI={readContext:tn,useCallback:Hw,useContext:tn,useEffect:Qf,useImperativeHandle:qw,useInsertionEffect:Bw,useLayoutEffect:$w,useMemo:Ww,useReducer:Td,useRef:Uw,useState:function(){return Td(wa)},useDebugValue:Yf,useDeferredValue:function(t){var e=nn();return Kw(e,Qe.memoizedState,t)},useTransition:function(){var t=Td(wa)[0],e=nn().memoizedState;return[t,e]},useMutableSource:jw,useSyncExternalStore:Dw,useId:Gw,unstable_isNewReconciler:!1},fI={readContext:tn,useCallback:Hw,useContext:tn,useEffect:Qf,useImperativeHandle:qw,useInsertionEffect:Bw,useLayoutEffect:$w,useMemo:Ww,useReducer:Id,useRef:Uw,useState:function(){return Id(wa)},useDebugValue:Yf,useDeferredValue:function(t){var e=nn();return Qe===null?e.memoizedState=t:Kw(e,Qe.memoizedState,t)},useTransition:function(){var t=Id(wa)[0],e=nn().memoizedState;return[t,e]},useMutableSource:jw,useSyncExternalStore:Dw,useId:Gw,unstable_isNewReconciler:!1};function an(t,e){if(t&&t.defaultProps){e=Re({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Th(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Re({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var iu={isMounted:function(t){return(t=t._reactInternals)?Ws(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Tt(),s=Vr(t),i=Qn(r,s);i.payload=e,n!=null&&(i.callback=n),e=Lr(t,i,s),e!==null&&(hn(e,t,s,r),Vl(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Tt(),s=Vr(t),i=Qn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Lr(t,i,s),e!==null&&(hn(e,t,s,r),Vl(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Tt(),r=Vr(t),s=Qn(n,r);s.tag=2,e!=null&&(s.callback=e),e=Lr(t,s,r),e!==null&&(hn(e,t,r,n),Vl(e,t,r))}};function ey(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!ha(n,r)||!ha(s,i):!0}function Jw(t,e,n){var r=!1,s=zr,i=e.contextType;return typeof i=="object"&&i!==null?i=tn(i):(s=Rt(e)?Rs:yt.current,r=e.contextTypes,i=(r=r!=null)?ji(t,s):zr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=iu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function ty(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&iu.enqueueReplaceState(e,e.state,null)}function Ih(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},$f(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=tn(i):(i=Rt(e)?Rs:yt.current,s.context=ji(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Th(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&iu.enqueueReplaceState(s,s.state,null),vc(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Vi(t,e){try{var n="",r=e;do n+=B2(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function bd(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function bh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var mI=typeof WeakMap=="function"?WeakMap:Map;function Zw(t,e,n){n=Qn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Tc||(Tc=!0,Lh=r),bh(t,e)},n}function e_(t,e,n){n=Qn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){bh(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){bh(t,e),typeof r!="function"&&(Mr===null?Mr=new Set([this]):Mr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function ny(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new mI;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=kI.bind(null,t,e,n),e.then(t,t))}function ry(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function sy(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Qn(-1,1),e.tag=2,Lr(n,e,1))),n.lanes|=1),t)}var pI=lr.ReactCurrentOwner,Ct=!1;function Et(t,e,n,r){e.child=t===null?Nw(e,null,n,r):Li(e,t.child,n,r)}function iy(t,e,n,r,s){n=n.render;var i=e.ref;return Ii(e,s),r=Kf(t,e,n,r,i,s),n=Gf(),t!==null&&!Ct?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,nr(t,e,s)):(Ne&&n&&Lf(e),e.flags|=1,Et(t,e,r,s),e.child)}function oy(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!sm(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,t_(t,e,i,r,s)):(t=zl(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:ha,n(o,r)&&t.ref===e.ref)return nr(t,e,s)}return e.flags|=1,t=Or(i,r),t.ref=e.ref,t.return=e,e.child=t}function t_(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(ha(i,r)&&t.ref===e.ref)if(Ct=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Ct=!0);else return e.lanes=t.lanes,nr(t,e,s)}return Sh(t,e,n,r,s)}function n_(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Te(vi,Ft),Ft|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Te(vi,Ft),Ft|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Te(vi,Ft),Ft|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Te(vi,Ft),Ft|=r;return Et(t,e,s,n),e.child}function r_(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Sh(t,e,n,r,s){var i=Rt(n)?Rs:yt.current;return i=ji(e,i),Ii(e,s),n=Kf(t,e,n,r,i,s),r=Gf(),t!==null&&!Ct?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,nr(t,e,s)):(Ne&&r&&Lf(e),e.flags|=1,Et(t,e,n,s),e.child)}function ay(t,e,n,r,s){if(Rt(n)){var i=!0;fc(e)}else i=!1;if(Ii(e,s),e.stateNode===null)Ul(t,e),Jw(e,n,r),Ih(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,c=e.memoizedProps;o.props=c;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=tn(d):(d=Rt(n)?Rs:yt.current,d=ji(e,d));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==r||u!==d)&&ty(e,o,r,d),xr=!1;var g=e.memoizedState;o.state=g,vc(e,r,o,s),u=e.memoizedState,c!==r||g!==u||Pt.current||xr?(typeof f=="function"&&(Th(e,n,f,r),u=e.memoizedState),(c=xr||ey(e,n,c,r,g,u,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=d,r=c):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Pw(t,e),c=e.memoizedProps,d=e.type===e.elementType?c:an(e.type,c),o.props=d,p=e.pendingProps,g=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=tn(u):(u=Rt(n)?Rs:yt.current,u=ji(e,u));var E=n.getDerivedStateFromProps;(f=typeof E=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==p||g!==u)&&ty(e,o,r,u),xr=!1,g=e.memoizedState,o.state=g,vc(e,r,o,s);var C=e.memoizedState;c!==p||g!==C||Pt.current||xr?(typeof E=="function"&&(Th(e,n,E,r),C=e.memoizedState),(d=xr||ey(e,n,d,r,g,C,u)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,C,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,C,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=C),o.props=r,o.state=C,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return Ah(t,e,n,r,i,s)}function Ah(t,e,n,r,s,i){r_(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Wg(e,n,!1),nr(t,e,i);r=e.stateNode,pI.current=e;var c=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Li(e,t.child,null,i),e.child=Li(e,null,c,i)):Et(t,e,c,i),e.memoizedState=r.state,s&&Wg(e,n,!0),e.child}function s_(t){var e=t.stateNode;e.pendingContext?Hg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Hg(t,e.context,!1),zf(t,e.containerInfo)}function ly(t,e,n,r,s){return Di(),Vf(s),e.flags|=256,Et(t,e,n,r),e.child}var kh={dehydrated:null,treeContext:null,retryLane:0};function Nh(t){return{baseLanes:t,cachePool:null,transitions:null}}function i_(t,e,n){var r=e.pendingProps,s=Ce.current,i=!1,o=(e.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(s&2)!==0),c?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Te(Ce,s&1),t===null)return xh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=lu(o,r,0,null),t=Ns(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Nh(n),e.memoizedState=kh,t):Xf(e,o));if(s=t.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return gI(t,e,o,r,c,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,c=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Or(s,u),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=Or(c,i):(i=Ns(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Nh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=kh,r}return i=t.child,t=i.sibling,r=Or(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Xf(t,e){return e=lu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function _l(t,e,n,r){return r!==null&&Vf(r),Li(e,t.child,null,n),t=Xf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function gI(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=bd(Error(K(422))),_l(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=lu({mode:"visible",children:r.children},s,0,null),i=Ns(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Li(e,t.child,null,o),e.child.memoizedState=Nh(o),e.memoizedState=kh,i);if(!(e.mode&1))return _l(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error(K(419)),r=bd(i,r,void 0),_l(t,e,o,r)}if(c=(o&t.childLanes)!==0,Ct||c){if(r=tt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,tr(t,s),hn(r,t,s,-1))}return rm(),r=bd(Error(K(421))),_l(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=NI.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Ut=Dr(s.nextSibling),$t=e,Ne=!0,cn=null,t!==null&&(Kt[Gt++]=zn,Kt[Gt++]=qn,Kt[Gt++]=js,zn=t.id,qn=t.overflow,js=e),e=Xf(e,r.children),e.flags|=4096,e)}function cy(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Eh(t.return,e,n)}function Sd(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function o_(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Et(t,e,r.children,n),r=Ce.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&cy(t,n,e);else if(t.tag===19)cy(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Te(Ce,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&wc(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Sd(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&wc(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Sd(e,!0,n,null,i);break;case"together":Sd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ul(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function nr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ls|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(K(153));if(e.child!==null){for(t=e.child,n=Or(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Or(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function yI(t,e,n){switch(e.tag){case 3:s_(e),Di();break;case 5:Rw(e);break;case 1:Rt(e.type)&&fc(e);break;case 4:zf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Te(gc,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Te(Ce,Ce.current&1),e.flags|=128,null):n&e.child.childLanes?i_(t,e,n):(Te(Ce,Ce.current&1),t=nr(t,e,n),t!==null?t.sibling:null);Te(Ce,Ce.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return o_(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Te(Ce,Ce.current),r)break;return null;case 22:case 23:return e.lanes=0,n_(t,e,n)}return nr(t,e,n)}var a_,Ch,l_,c_;a_=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Ch=function(){};l_=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,bs(An.current);var i=null;switch(n){case"input":s=Jd(t,s),r=Jd(t,r),i=[];break;case"select":s=Re({},s,{value:void 0}),r=Re({},r,{value:void 0}),i=[];break;case"textarea":s=th(t,s),r=th(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=dc)}rh(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var c=s[d];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ia.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(c=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(o in c)!c.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&c[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ia.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Se("scroll",t),i||c===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};c_=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ro(t,e){if(!Ne)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ut(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function vI(t,e,n){var r=e.pendingProps;switch(Mf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ut(e),null;case 1:return Rt(e.type)&&hc(),ut(e),null;case 3:return r=e.stateNode,Mi(),ke(Pt),ke(yt),Hf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(vl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,cn!==null&&(Oh(cn),cn=null))),Ch(t,e),ut(e),null;case 5:qf(e);var s=bs(ya.current);if(n=e.type,t!==null&&e.stateNode!=null)l_(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(K(166));return ut(e),null}if(t=bs(An.current),vl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[En]=e,r[pa]=i,t=(e.mode&1)!==0,n){case"dialog":Se("cancel",r),Se("close",r);break;case"iframe":case"object":case"embed":Se("load",r);break;case"video":case"audio":for(s=0;s<Vo.length;s++)Se(Vo[s],r);break;case"source":Se("error",r);break;case"img":case"image":case"link":Se("error",r),Se("load",r);break;case"details":Se("toggle",r);break;case"input":vg(r,i),Se("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Se("invalid",r);break;case"textarea":_g(r,i),Se("invalid",r)}rh(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var c=i[o];o==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&yl(r.textContent,c,t),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&yl(r.textContent,c,t),s=["children",""+c]):ia.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&Se("scroll",r)}switch(n){case"input":cl(r),wg(r,i,!0);break;case"textarea":cl(r),xg(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=dc)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Vv(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[En]=e,t[pa]=r,a_(t,e,!1,!1),e.stateNode=t;e:{switch(o=sh(n,r),n){case"dialog":Se("cancel",t),Se("close",t),s=r;break;case"iframe":case"object":case"embed":Se("load",t),s=r;break;case"video":case"audio":for(s=0;s<Vo.length;s++)Se(Vo[s],t);s=r;break;case"source":Se("error",t),s=r;break;case"img":case"image":case"link":Se("error",t),Se("load",t),s=r;break;case"details":Se("toggle",t),s=r;break;case"input":vg(t,r),s=Jd(t,r),Se("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Re({},r,{value:void 0}),Se("invalid",t);break;case"textarea":_g(t,r),s=th(t,r),Se("invalid",t);break;default:s=r}rh(n,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?Uv(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Ov(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&oa(t,u):typeof u=="number"&&oa(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ia.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Se("scroll",t):u!=null&&xf(t,i,u,o))}switch(n){case"input":cl(t),wg(t,r,!1);break;case"textarea":cl(t),xg(t);break;case"option":r.value!=null&&t.setAttribute("value",""+$r(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?_i(t,!!r.multiple,i,!1):r.defaultValue!=null&&_i(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=dc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ut(e),null;case 6:if(t&&e.stateNode!=null)c_(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(K(166));if(n=bs(ya.current),bs(An.current),vl(e)){if(r=e.stateNode,n=e.memoizedProps,r[En]=e,(i=r.nodeValue!==n)&&(t=$t,t!==null))switch(t.tag){case 3:yl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&yl(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[En]=e,e.stateNode=r}return ut(e),null;case 13:if(ke(Ce),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ne&&Ut!==null&&e.mode&1&&!(e.flags&128))Aw(),Di(),e.flags|=98560,i=!1;else if(i=vl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(K(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(K(317));i[En]=e}else Di(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ut(e),i=!1}else cn!==null&&(Oh(cn),cn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ce.current&1?Ye===0&&(Ye=3):rm())),e.updateQueue!==null&&(e.flags|=4),ut(e),null);case 4:return Mi(),Ch(t,e),t===null&&fa(e.stateNode.containerInfo),ut(e),null;case 10:return Uf(e.type._context),ut(e),null;case 17:return Rt(e.type)&&hc(),ut(e),null;case 19:if(ke(Ce),i=e.memoizedState,i===null)return ut(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Ro(i,!1);else{if(Ye!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=wc(t),o!==null){for(e.flags|=128,Ro(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Te(Ce,Ce.current&1|2),e.child}t=t.sibling}i.tail!==null&&Fe()>Oi&&(e.flags|=128,r=!0,Ro(i,!1),e.lanes=4194304)}else{if(!r)if(t=wc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ro(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ne)return ut(e),null}else 2*Fe()-i.renderingStartTime>Oi&&n!==1073741824&&(e.flags|=128,r=!0,Ro(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Fe(),e.sibling=null,n=Ce.current,Te(Ce,r?n&1|2:n&1),e):(ut(e),null);case 22:case 23:return nm(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ft&1073741824&&(ut(e),e.subtreeFlags&6&&(e.flags|=8192)):ut(e),null;case 24:return null;case 25:return null}throw Error(K(156,e.tag))}function wI(t,e){switch(Mf(e),e.tag){case 1:return Rt(e.type)&&hc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Mi(),ke(Pt),ke(yt),Hf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return qf(e),null;case 13:if(ke(Ce),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(K(340));Di()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ke(Ce),null;case 4:return Mi(),null;case 10:return Uf(e.type._context),null;case 22:case 23:return nm(),null;case 24:return null;default:return null}}var xl=!1,mt=!1,_I=typeof WeakSet=="function"?WeakSet:Set,Z=null;function yi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Le(t,e,r)}else n.current=null}function Ph(t,e,n){try{n()}catch(r){Le(t,e,r)}}var uy=!1;function xI(t,e){if(mh=lc,t=mw(),Df(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,c=-1,u=-1,d=0,f=0,p=t,g=null;t:for(;;){for(var E;p!==n||s!==0&&p.nodeType!==3||(c=o+s),p!==i||r!==0&&p.nodeType!==3||(u=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(E=p.firstChild)!==null;)g=p,p=E;for(;;){if(p===t)break t;if(g===n&&++d===s&&(c=o),g===i&&++f===r&&(u=o),(E=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=E}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ph={focusedElem:t,selectionRange:n},lc=!1,Z=e;Z!==null;)if(e=Z,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Z=t;else for(;Z!==null;){e=Z;try{var C=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var P=C.memoizedProps,b=C.memoizedState,T=e.stateNode,x=T.getSnapshotBeforeUpdate(e.elementType===e.type?P:an(e.type,P),b);T.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var A=e.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(K(163))}}catch(D){Le(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,Z=t;break}Z=e.return}return C=uy,uy=!1,C}function Yo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Ph(e,n,i)}s=s.next}while(s!==r)}}function ou(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Rh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function u_(t){var e=t.alternate;e!==null&&(t.alternate=null,u_(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[En],delete e[pa],delete e[vh],delete e[rI],delete e[sI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function d_(t){return t.tag===5||t.tag===3||t.tag===4}function dy(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||d_(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function jh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=dc));else if(r!==4&&(t=t.child,t!==null))for(jh(t,e,n),t=t.sibling;t!==null;)jh(t,e,n),t=t.sibling}function Dh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Dh(t,e,n),t=t.sibling;t!==null;)Dh(t,e,n),t=t.sibling}var nt=null,ln=!1;function vr(t,e,n){for(n=n.child;n!==null;)h_(t,e,n),n=n.sibling}function h_(t,e,n){if(Sn&&typeof Sn.onCommitFiberUnmount=="function")try{Sn.onCommitFiberUnmount(Jc,n)}catch{}switch(n.tag){case 5:mt||yi(n,e);case 6:var r=nt,s=ln;nt=null,vr(t,e,n),nt=r,ln=s,nt!==null&&(ln?(t=nt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):nt.removeChild(n.stateNode));break;case 18:nt!==null&&(ln?(t=nt,n=n.stateNode,t.nodeType===8?wd(t.parentNode,n):t.nodeType===1&&wd(t,n),ua(t)):wd(nt,n.stateNode));break;case 4:r=nt,s=ln,nt=n.stateNode.containerInfo,ln=!0,vr(t,e,n),nt=r,ln=s;break;case 0:case 11:case 14:case 15:if(!mt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Ph(n,e,o),s=s.next}while(s!==r)}vr(t,e,n);break;case 1:if(!mt&&(yi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){Le(n,e,c)}vr(t,e,n);break;case 21:vr(t,e,n);break;case 22:n.mode&1?(mt=(r=mt)||n.memoizedState!==null,vr(t,e,n),mt=r):vr(t,e,n);break;default:vr(t,e,n)}}function hy(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new _I),e.forEach(function(r){var s=CI.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function on(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,c=o;e:for(;c!==null;){switch(c.tag){case 5:nt=c.stateNode,ln=!1;break e;case 3:nt=c.stateNode.containerInfo,ln=!0;break e;case 4:nt=c.stateNode.containerInfo,ln=!0;break e}c=c.return}if(nt===null)throw Error(K(160));h_(i,o,s),nt=null,ln=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Le(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)f_(e,t),e=e.sibling}function f_(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(on(e,t),wn(t),r&4){try{Yo(3,t,t.return),ou(3,t)}catch(P){Le(t,t.return,P)}try{Yo(5,t,t.return)}catch(P){Le(t,t.return,P)}}break;case 1:on(e,t),wn(t),r&512&&n!==null&&yi(n,n.return);break;case 5:if(on(e,t),wn(t),r&512&&n!==null&&yi(n,n.return),t.flags&32){var s=t.stateNode;try{oa(s,"")}catch(P){Le(t,t.return,P)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&Lv(s,i),sh(c,o);var d=sh(c,i);for(o=0;o<u.length;o+=2){var f=u[o],p=u[o+1];f==="style"?Uv(s,p):f==="dangerouslySetInnerHTML"?Ov(s,p):f==="children"?oa(s,p):xf(s,f,p,d)}switch(c){case"input":Zd(s,i);break;case"textarea":Mv(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var E=i.value;E!=null?_i(s,!!i.multiple,E,!1):g!==!!i.multiple&&(i.defaultValue!=null?_i(s,!!i.multiple,i.defaultValue,!0):_i(s,!!i.multiple,i.multiple?[]:"",!1))}s[pa]=i}catch(P){Le(t,t.return,P)}}break;case 6:if(on(e,t),wn(t),r&4){if(t.stateNode===null)throw Error(K(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(P){Le(t,t.return,P)}}break;case 3:if(on(e,t),wn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ua(e.containerInfo)}catch(P){Le(t,t.return,P)}break;case 4:on(e,t),wn(t);break;case 13:on(e,t),wn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(em=Fe())),r&4&&hy(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(mt=(d=mt)||f,on(e,t),mt=d):on(e,t),wn(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!f&&t.mode&1)for(Z=t,f=t.child;f!==null;){for(p=Z=f;Z!==null;){switch(g=Z,E=g.child,g.tag){case 0:case 11:case 14:case 15:Yo(4,g,g.return);break;case 1:yi(g,g.return);var C=g.stateNode;if(typeof C.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,C.props=e.memoizedProps,C.state=e.memoizedState,C.componentWillUnmount()}catch(P){Le(r,n,P)}}break;case 5:yi(g,g.return);break;case 22:if(g.memoizedState!==null){my(p);continue}}E!==null?(E.return=g,Z=E):my(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{s=p.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=p.stateNode,u=p.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=Fv("display",o))}catch(P){Le(t,t.return,P)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(P){Le(t,t.return,P)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:on(e,t),wn(t),r&4&&hy(t);break;case 21:break;default:on(e,t),wn(t)}}function wn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(d_(n)){var r=n;break e}n=n.return}throw Error(K(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(oa(s,""),r.flags&=-33);var i=dy(t);Dh(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,c=dy(t);jh(t,c,o);break;default:throw Error(K(161))}}catch(u){Le(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function EI(t,e,n){Z=t,m_(t)}function m_(t,e,n){for(var r=(t.mode&1)!==0;Z!==null;){var s=Z,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||xl;if(!o){var c=s.alternate,u=c!==null&&c.memoizedState!==null||mt;c=xl;var d=mt;if(xl=o,(mt=u)&&!d)for(Z=s;Z!==null;)o=Z,u=o.child,o.tag===22&&o.memoizedState!==null?py(s):u!==null?(u.return=o,Z=u):py(s);for(;i!==null;)Z=i,m_(i),i=i.sibling;Z=s,xl=c,mt=d}fy(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Z=i):fy(t)}}function fy(t){for(;Z!==null;){var e=Z;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:mt||ou(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!mt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:an(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Xg(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Xg(e,o,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&ua(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(K(163))}mt||e.flags&512&&Rh(e)}catch(g){Le(e,e.return,g)}}if(e===t){Z=null;break}if(n=e.sibling,n!==null){n.return=e.return,Z=n;break}Z=e.return}}function my(t){for(;Z!==null;){var e=Z;if(e===t){Z=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Z=n;break}Z=e.return}}function py(t){for(;Z!==null;){var e=Z;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ou(4,e)}catch(u){Le(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Le(e,s,u)}}var i=e.return;try{Rh(e)}catch(u){Le(e,i,u)}break;case 5:var o=e.return;try{Rh(e)}catch(u){Le(e,o,u)}}}catch(u){Le(e,e.return,u)}if(e===t){Z=null;break}var c=e.sibling;if(c!==null){c.return=e.return,Z=c;break}Z=e.return}}var TI=Math.ceil,Ec=lr.ReactCurrentDispatcher,Jf=lr.ReactCurrentOwner,Jt=lr.ReactCurrentBatchConfig,ye=0,tt=null,$e=null,it=0,Ft=0,vi=ns(0),Ye=0,xa=null,Ls=0,au=0,Zf=0,Xo=null,kt=null,em=0,Oi=1/0,Un=null,Tc=!1,Lh=null,Mr=null,El=!1,Nr=null,Ic=0,Jo=0,Mh=null,Bl=-1,$l=0;function Tt(){return ye&6?Fe():Bl!==-1?Bl:Bl=Fe()}function Vr(t){return t.mode&1?ye&2&&it!==0?it&-it:oI.transition!==null?($l===0&&($l=Jv()),$l):(t=we,t!==0||(t=window.event,t=t===void 0?16:iw(t.type)),t):1}function hn(t,e,n,r){if(50<Jo)throw Jo=0,Mh=null,Error(K(185));La(t,n,r),(!(ye&2)||t!==tt)&&(t===tt&&(!(ye&2)&&(au|=n),Ye===4&&Tr(t,it)),jt(t,r),n===1&&ye===0&&!(e.mode&1)&&(Oi=Fe()+500,ru&&rs()))}function jt(t,e){var n=t.callbackNode;oT(t,e);var r=ac(t,t===tt?it:0);if(r===0)n!==null&&Ig(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Ig(n),e===1)t.tag===0?iI(gy.bind(null,t)):Iw(gy.bind(null,t)),tI(function(){!(ye&6)&&rs()}),n=null;else{switch(Zv(r)){case 1:n=Sf;break;case 4:n=Yv;break;case 16:n=oc;break;case 536870912:n=Xv;break;default:n=oc}n=E_(n,p_.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function p_(t,e){if(Bl=-1,$l=0,ye&6)throw Error(K(327));var n=t.callbackNode;if(bi()&&t.callbackNode!==n)return null;var r=ac(t,t===tt?it:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=bc(t,r);else{e=r;var s=ye;ye|=2;var i=y_();(tt!==t||it!==e)&&(Un=null,Oi=Fe()+500,ks(t,e));do try{SI();break}catch(c){g_(t,c)}while(!0);Ff(),Ec.current=i,ye=s,$e!==null?e=0:(tt=null,it=0,e=Ye)}if(e!==0){if(e===2&&(s=ch(t),s!==0&&(r=s,e=Vh(t,s))),e===1)throw n=xa,ks(t,0),Tr(t,r),jt(t,Fe()),n;if(e===6)Tr(t,r);else{if(s=t.current.alternate,!(r&30)&&!II(s)&&(e=bc(t,r),e===2&&(i=ch(t),i!==0&&(r=i,e=Vh(t,i))),e===1))throw n=xa,ks(t,0),Tr(t,r),jt(t,Fe()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(K(345));case 2:xs(t,kt,Un);break;case 3:if(Tr(t,r),(r&130023424)===r&&(e=em+500-Fe(),10<e)){if(ac(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Tt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=yh(xs.bind(null,t,kt,Un),e);break}xs(t,kt,Un);break;case 4:if(Tr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-dn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Fe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*TI(r/1960))-r,10<r){t.timeoutHandle=yh(xs.bind(null,t,kt,Un),r);break}xs(t,kt,Un);break;case 5:xs(t,kt,Un);break;default:throw Error(K(329))}}}return jt(t,Fe()),t.callbackNode===n?p_.bind(null,t):null}function Vh(t,e){var n=Xo;return t.current.memoizedState.isDehydrated&&(ks(t,e).flags|=256),t=bc(t,e),t!==2&&(e=kt,kt=n,e!==null&&Oh(e)),t}function Oh(t){kt===null?kt=t:kt.push.apply(kt,t)}function II(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!fn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Tr(t,e){for(e&=~Zf,e&=~au,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-dn(e),r=1<<n;t[n]=-1,e&=~r}}function gy(t){if(ye&6)throw Error(K(327));bi();var e=ac(t,0);if(!(e&1))return jt(t,Fe()),null;var n=bc(t,e);if(t.tag!==0&&n===2){var r=ch(t);r!==0&&(e=r,n=Vh(t,r))}if(n===1)throw n=xa,ks(t,0),Tr(t,e),jt(t,Fe()),n;if(n===6)throw Error(K(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,xs(t,kt,Un),jt(t,Fe()),null}function tm(t,e){var n=ye;ye|=1;try{return t(e)}finally{ye=n,ye===0&&(Oi=Fe()+500,ru&&rs())}}function Ms(t){Nr!==null&&Nr.tag===0&&!(ye&6)&&bi();var e=ye;ye|=1;var n=Jt.transition,r=we;try{if(Jt.transition=null,we=1,t)return t()}finally{we=r,Jt.transition=n,ye=e,!(ye&6)&&rs()}}function nm(){Ft=vi.current,ke(vi)}function ks(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,eI(n)),$e!==null)for(n=$e.return;n!==null;){var r=n;switch(Mf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&hc();break;case 3:Mi(),ke(Pt),ke(yt),Hf();break;case 5:qf(r);break;case 4:Mi();break;case 13:ke(Ce);break;case 19:ke(Ce);break;case 10:Uf(r.type._context);break;case 22:case 23:nm()}n=n.return}if(tt=t,$e=t=Or(t.current,null),it=Ft=e,Ye=0,xa=null,Zf=au=Ls=0,kt=Xo=null,Is!==null){for(e=0;e<Is.length;e++)if(n=Is[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Is=null}return t}function g_(t,e){do{var n=$e;try{if(Ff(),Ol.current=xc,_c){for(var r=Pe.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}_c=!1}if(Ds=0,et=Qe=Pe=null,Qo=!1,va=0,Jf.current=null,n===null||n.return===null){Ye=1,xa=e,$e=null;break}e:{var i=t,o=n.return,c=n,u=e;if(e=it,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,f=c,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var E=ry(o);if(E!==null){E.flags&=-257,sy(E,o,c,i,e),E.mode&1&&ny(i,d,e),e=E,u=d;var C=e.updateQueue;if(C===null){var P=new Set;P.add(u),e.updateQueue=P}else C.add(u);break e}else{if(!(e&1)){ny(i,d,e),rm();break e}u=Error(K(426))}}else if(Ne&&c.mode&1){var b=ry(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),sy(b,o,c,i,e),Vf(Vi(u,c));break e}}i=u=Vi(u,c),Ye!==4&&(Ye=2),Xo===null?Xo=[i]:Xo.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var T=Zw(i,u,e);Yg(i,T);break e;case 1:c=u;var x=i.type,A=i.stateNode;if(!(i.flags&128)&&(typeof x.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Mr===null||!Mr.has(A)))){i.flags|=65536,e&=-e,i.lanes|=e;var D=e_(i,c,e);Yg(i,D);break e}}i=i.return}while(i!==null)}w_(n)}catch(V){e=V,$e===n&&n!==null&&($e=n=n.return);continue}break}while(!0)}function y_(){var t=Ec.current;return Ec.current=xc,t===null?xc:t}function rm(){(Ye===0||Ye===3||Ye===2)&&(Ye=4),tt===null||!(Ls&268435455)&&!(au&268435455)||Tr(tt,it)}function bc(t,e){var n=ye;ye|=2;var r=y_();(tt!==t||it!==e)&&(Un=null,ks(t,e));do try{bI();break}catch(s){g_(t,s)}while(!0);if(Ff(),ye=n,Ec.current=r,$e!==null)throw Error(K(261));return tt=null,it=0,Ye}function bI(){for(;$e!==null;)v_($e)}function SI(){for(;$e!==null&&!X2();)v_($e)}function v_(t){var e=x_(t.alternate,t,Ft);t.memoizedProps=t.pendingProps,e===null?w_(t):$e=e,Jf.current=null}function w_(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=wI(n,e),n!==null){n.flags&=32767,$e=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ye=6,$e=null;return}}else if(n=vI(n,e,Ft),n!==null){$e=n;return}if(e=e.sibling,e!==null){$e=e;return}$e=e=t}while(e!==null);Ye===0&&(Ye=5)}function xs(t,e,n){var r=we,s=Jt.transition;try{Jt.transition=null,we=1,AI(t,e,n,r)}finally{Jt.transition=s,we=r}return null}function AI(t,e,n,r){do bi();while(Nr!==null);if(ye&6)throw Error(K(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(K(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(aT(t,i),t===tt&&($e=tt=null,it=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||El||(El=!0,E_(oc,function(){return bi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Jt.transition,Jt.transition=null;var o=we;we=1;var c=ye;ye|=4,Jf.current=null,xI(t,n),f_(n,t),KT(ph),lc=!!mh,ph=mh=null,t.current=n,EI(n),J2(),ye=c,we=o,Jt.transition=i}else t.current=n;if(El&&(El=!1,Nr=t,Ic=s),i=t.pendingLanes,i===0&&(Mr=null),tT(n.stateNode),jt(t,Fe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Tc)throw Tc=!1,t=Lh,Lh=null,t;return Ic&1&&t.tag!==0&&bi(),i=t.pendingLanes,i&1?t===Mh?Jo++:(Jo=0,Mh=t):Jo=0,rs(),null}function bi(){if(Nr!==null){var t=Zv(Ic),e=Jt.transition,n=we;try{if(Jt.transition=null,we=16>t?16:t,Nr===null)var r=!1;else{if(t=Nr,Nr=null,Ic=0,ye&6)throw Error(K(331));var s=ye;for(ye|=4,Z=t.current;Z!==null;){var i=Z,o=i.child;if(Z.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(Z=d;Z!==null;){var f=Z;switch(f.tag){case 0:case 11:case 15:Yo(8,f,i)}var p=f.child;if(p!==null)p.return=f,Z=p;else for(;Z!==null;){f=Z;var g=f.sibling,E=f.return;if(u_(f),f===d){Z=null;break}if(g!==null){g.return=E,Z=g;break}Z=E}}}var C=i.alternate;if(C!==null){var P=C.child;if(P!==null){C.child=null;do{var b=P.sibling;P.sibling=null,P=b}while(P!==null)}}Z=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Z=o;else e:for(;Z!==null;){if(i=Z,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Yo(9,i,i.return)}var T=i.sibling;if(T!==null){T.return=i.return,Z=T;break e}Z=i.return}}var x=t.current;for(Z=x;Z!==null;){o=Z;var A=o.child;if(o.subtreeFlags&2064&&A!==null)A.return=o,Z=A;else e:for(o=x;Z!==null;){if(c=Z,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:ou(9,c)}}catch(V){Le(c,c.return,V)}if(c===o){Z=null;break e}var D=c.sibling;if(D!==null){D.return=c.return,Z=D;break e}Z=c.return}}if(ye=s,rs(),Sn&&typeof Sn.onPostCommitFiberRoot=="function")try{Sn.onPostCommitFiberRoot(Jc,t)}catch{}r=!0}return r}finally{we=n,Jt.transition=e}}return!1}function yy(t,e,n){e=Vi(n,e),e=Zw(t,e,1),t=Lr(t,e,1),e=Tt(),t!==null&&(La(t,1,e),jt(t,e))}function Le(t,e,n){if(t.tag===3)yy(t,t,n);else for(;e!==null;){if(e.tag===3){yy(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Mr===null||!Mr.has(r))){t=Vi(n,t),t=e_(e,t,1),e=Lr(e,t,1),t=Tt(),e!==null&&(La(e,1,t),jt(e,t));break}}e=e.return}}function kI(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Tt(),t.pingedLanes|=t.suspendedLanes&n,tt===t&&(it&n)===n&&(Ye===4||Ye===3&&(it&130023424)===it&&500>Fe()-em?ks(t,0):Zf|=n),jt(t,e)}function __(t,e){e===0&&(t.mode&1?(e=hl,hl<<=1,!(hl&130023424)&&(hl=4194304)):e=1);var n=Tt();t=tr(t,e),t!==null&&(La(t,e,n),jt(t,n))}function NI(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),__(t,n)}function CI(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(K(314))}r!==null&&r.delete(e),__(t,n)}var x_;x_=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Pt.current)Ct=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ct=!1,yI(t,e,n);Ct=!!(t.flags&131072)}else Ct=!1,Ne&&e.flags&1048576&&bw(e,pc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ul(t,e),t=e.pendingProps;var s=ji(e,yt.current);Ii(e,n),s=Kf(null,e,r,t,s,n);var i=Gf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Rt(r)?(i=!0,fc(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,$f(e),s.updater=iu,e.stateNode=s,s._reactInternals=e,Ih(e,r,t,n),e=Ah(null,e,r,!0,i,n)):(e.tag=0,Ne&&i&&Lf(e),Et(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ul(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=RI(r),t=an(r,t),s){case 0:e=Sh(null,e,r,t,n);break e;case 1:e=ay(null,e,r,t,n);break e;case 11:e=iy(null,e,r,t,n);break e;case 14:e=oy(null,e,r,an(r.type,t),n);break e}throw Error(K(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:an(r,s),Sh(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:an(r,s),ay(t,e,r,s,n);case 3:e:{if(s_(e),t===null)throw Error(K(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Pw(t,e),vc(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Vi(Error(K(423)),e),e=ly(t,e,r,n,s);break e}else if(r!==s){s=Vi(Error(K(424)),e),e=ly(t,e,r,n,s);break e}else for(Ut=Dr(e.stateNode.containerInfo.firstChild),$t=e,Ne=!0,cn=null,n=Nw(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Di(),r===s){e=nr(t,e,n);break e}Et(t,e,r,n)}e=e.child}return e;case 5:return Rw(e),t===null&&xh(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,gh(r,s)?o=null:i!==null&&gh(r,i)&&(e.flags|=32),r_(t,e),Et(t,e,o,n),e.child;case 6:return t===null&&xh(e),null;case 13:return i_(t,e,n);case 4:return zf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Li(e,null,r,n):Et(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:an(r,s),iy(t,e,r,s,n);case 7:return Et(t,e,e.pendingProps,n),e.child;case 8:return Et(t,e,e.pendingProps.children,n),e.child;case 12:return Et(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Te(gc,r._currentValue),r._currentValue=o,i!==null)if(fn(i.value,o)){if(i.children===s.children&&!Pt.current){e=nr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var c=i.dependencies;if(c!==null){o=i.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Qn(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?u.next=u:(u.next=f.next,f.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Eh(i.return,n,e),c.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(K(341));o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),Eh(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Et(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Ii(e,n),s=tn(s),r=r(s),e.flags|=1,Et(t,e,r,n),e.child;case 14:return r=e.type,s=an(r,e.pendingProps),s=an(r.type,s),oy(t,e,r,s,n);case 15:return t_(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:an(r,s),Ul(t,e),e.tag=1,Rt(r)?(t=!0,fc(e)):t=!1,Ii(e,n),Jw(e,r,s),Ih(e,r,s,n),Ah(null,e,r,!0,t,n);case 19:return o_(t,e,n);case 22:return n_(t,e,n)}throw Error(K(156,e.tag))};function E_(t,e){return Qv(t,e)}function PI(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xt(t,e,n,r){return new PI(t,e,n,r)}function sm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function RI(t){if(typeof t=="function")return sm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Tf)return 11;if(t===If)return 14}return 2}function Or(t,e){var n=t.alternate;return n===null?(n=Xt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function zl(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")sm(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case li:return Ns(n.children,s,i,e);case Ef:o=8,s|=8;break;case Gd:return t=Xt(12,n,e,s|2),t.elementType=Gd,t.lanes=i,t;case Qd:return t=Xt(13,n,e,s),t.elementType=Qd,t.lanes=i,t;case Yd:return t=Xt(19,n,e,s),t.elementType=Yd,t.lanes=i,t;case Rv:return lu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Cv:o=10;break e;case Pv:o=9;break e;case Tf:o=11;break e;case If:o=14;break e;case _r:o=16,r=null;break e}throw Error(K(130,t==null?t:typeof t,""))}return e=Xt(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Ns(t,e,n,r){return t=Xt(7,t,r,e),t.lanes=n,t}function lu(t,e,n,r){return t=Xt(22,t,r,e),t.elementType=Rv,t.lanes=n,t.stateNode={isHidden:!1},t}function Ad(t,e,n){return t=Xt(6,t,null,e),t.lanes=n,t}function kd(t,e,n){return e=Xt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function jI(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ld(0),this.expirationTimes=ld(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ld(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function im(t,e,n,r,s,i,o,c,u){return t=new jI(t,e,n,c,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Xt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},$f(i),t}function DI(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ai,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function T_(t){if(!t)return zr;t=t._reactInternals;e:{if(Ws(t)!==t||t.tag!==1)throw Error(K(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Rt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(K(171))}if(t.tag===1){var n=t.type;if(Rt(n))return Tw(t,n,e)}return e}function I_(t,e,n,r,s,i,o,c,u){return t=im(n,r,!0,t,s,i,o,c,u),t.context=T_(null),n=t.current,r=Tt(),s=Vr(n),i=Qn(r,s),i.callback=e??null,Lr(n,i,s),t.current.lanes=s,La(t,s,r),jt(t,r),t}function cu(t,e,n,r){var s=e.current,i=Tt(),o=Vr(s);return n=T_(n),e.context===null?e.context=n:e.pendingContext=n,e=Qn(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Lr(s,e,o),t!==null&&(hn(t,s,o,i),Vl(t,s,o)),o}function Sc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function vy(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function om(t,e){vy(t,e),(t=t.alternate)&&vy(t,e)}function LI(){return null}var b_=typeof reportError=="function"?reportError:function(t){console.error(t)};function am(t){this._internalRoot=t}uu.prototype.render=am.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(K(409));cu(t,e,null,null)};uu.prototype.unmount=am.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ms(function(){cu(null,t,null,null)}),e[er]=null}};function uu(t){this._internalRoot=t}uu.prototype.unstable_scheduleHydration=function(t){if(t){var e=nw();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Er.length&&e!==0&&e<Er[n].priority;n++);Er.splice(n,0,t),n===0&&sw(t)}};function lm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function du(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function wy(){}function MI(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Sc(o);i.call(d)}}var o=I_(e,r,t,0,null,!1,!1,"",wy);return t._reactRootContainer=o,t[er]=o.current,fa(t.nodeType===8?t.parentNode:t),Ms(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var d=Sc(u);c.call(d)}}var u=im(t,0,!1,null,null,!1,!1,"",wy);return t._reactRootContainer=u,t[er]=u.current,fa(t.nodeType===8?t.parentNode:t),Ms(function(){cu(e,u,n,r)}),u}function hu(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var c=s;s=function(){var u=Sc(o);c.call(u)}}cu(e,o,t,s)}else o=MI(n,e,t,s,r);return Sc(o)}ew=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Mo(e.pendingLanes);n!==0&&(Af(e,n|1),jt(e,Fe()),!(ye&6)&&(Oi=Fe()+500,rs()))}break;case 13:Ms(function(){var r=tr(t,1);if(r!==null){var s=Tt();hn(r,t,1,s)}}),om(t,1)}};kf=function(t){if(t.tag===13){var e=tr(t,134217728);if(e!==null){var n=Tt();hn(e,t,134217728,n)}om(t,134217728)}};tw=function(t){if(t.tag===13){var e=Vr(t),n=tr(t,e);if(n!==null){var r=Tt();hn(n,t,e,r)}om(t,e)}};nw=function(){return we};rw=function(t,e){var n=we;try{return we=t,e()}finally{we=n}};oh=function(t,e,n){switch(e){case"input":if(Zd(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=nu(r);if(!s)throw Error(K(90));Dv(r),Zd(r,s)}}}break;case"textarea":Mv(t,n);break;case"select":e=n.value,e!=null&&_i(t,!!n.multiple,e,!1)}};zv=tm;qv=Ms;var VI={usingClientEntryPoint:!1,Events:[Va,hi,nu,Bv,$v,tm]},jo={findFiberByHostInstance:Ts,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},OI={bundleType:jo.bundleType,version:jo.version,rendererPackageName:jo.rendererPackageName,rendererConfig:jo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:lr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Kv(t),t===null?null:t.stateNode},findFiberByHostInstance:jo.findFiberByHostInstance||LI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Tl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tl.isDisabled&&Tl.supportsFiber)try{Jc=Tl.inject(OI),Sn=Tl}catch{}}qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=VI;qt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lm(e))throw Error(K(200));return DI(t,e,null,n)};qt.createRoot=function(t,e){if(!lm(t))throw Error(K(299));var n=!1,r="",s=b_;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=im(t,1,!1,null,null,n,!1,r,s),t[er]=e.current,fa(t.nodeType===8?t.parentNode:t),new am(e)};qt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(K(188)):(t=Object.keys(t).join(","),Error(K(268,t)));return t=Kv(e),t=t===null?null:t.stateNode,t};qt.flushSync=function(t){return Ms(t)};qt.hydrate=function(t,e,n){if(!du(e))throw Error(K(200));return hu(null,t,e,!0,n)};qt.hydrateRoot=function(t,e,n){if(!lm(t))throw Error(K(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=b_;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=I_(e,null,t,1,n??null,s,!1,i,o),t[er]=e.current,fa(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new uu(e)};qt.render=function(t,e,n){if(!du(e))throw Error(K(200));return hu(null,t,e,!1,n)};qt.unmountComponentAtNode=function(t){if(!du(t))throw Error(K(40));return t._reactRootContainer?(Ms(function(){hu(null,null,t,!1,function(){t._reactRootContainer=null,t[er]=null})}),!0):!1};qt.unstable_batchedUpdates=tm;qt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!du(n))throw Error(K(200));if(t==null||t._reactInternals===void 0)throw Error(K(38));return hu(t,e,n,!1,r)};qt.version="18.3.1-next-f1338f8080-20240426";function S_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(S_)}catch(t){console.error(t)}}S_(),Sv.exports=qt;var FI=Sv.exports,_y=FI;nc.createRoot=_y.createRoot,nc.hydrateRoot=_y.hydrateRoot;const cm=t=>l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.776 48.776 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})]}),A_=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193l-3.722.28c-.443.034-.884.176-1.286.448l-4.486 2.872c-.18.115-.383.115-.564 0l-4.486-2.873a1.875 1.875 0 01-1.286-.447l-3.722-.281a2.25 2.25 0 01-1.98-2.192v-4.286c0-.97.616-1.813 1.5-2.097m14.25-1.118a2.25 2.25 0 00-2.25-2.25h-8.25a2.25 2.25 0 00-2.25 2.25v.928c.378-.04.757-.067 1.143-.082l3.722-.281c.443-.034.884-.176 1.286-.448l4.486-2.872c.18-.115.383.115.564 0l4.486 2.873c.402.27.843.414 1.286.448l3.722.28c.386.016.764.042 1.143.082v-.928a2.25 2.25 0 00-2.25-2.25h-8.25a2.25 2.25 0 00-2.25 2.25v.928"})}),qr=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),k_=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})}),UI=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),N_=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25z"})}),Vs=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`animate-spin ${t.className}`,children:l.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),BI=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"})}),$I=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.122 2.122l7.81-7.81"})}),zI=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),qI=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 00-3 3h15.75m-12.75-3h11.218c.51 0 .962-.343 1.087-.835l1.821-6.831a1.5 1.5 0 00-1.422-2.098H5.168L4.659 3.563A1.5 1.5 0 003.132 2.25H2.25m5.25 9h10.5m-10.5-9h10.5"})}),HI=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})}),WI=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.562L16.5 21.75l-.398-1.188a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.188-.398a2.25 2.25 0 001.423-1.423L16.5 15.75l.398 1.188a2.25 2.25 0 001.423 1.423L19.5 18.75l-1.188.398a2.25 2.25 0 00-1.423 1.423z"})}),xy=t=>l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6h.008v.008H6V6z"})]}),Fh=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),KI=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z"})}),GI=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})}),QI=t=>l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),YI=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.243 4.243L6.228 6.228"})}),C_=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"})}),XI=({user:t,onNavigateHome:e,onNavigateToListing:n,onNavigateToProfile:r,onOpenTutorial:s})=>l.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-10",children:l.jsxs("div",{className:"container mx-auto px-4 md:px-8 py-4 flex items-center justify-between",children:[l.jsxs("button",{onClick:e,className:"flex items-center gap-3 cursor-pointer",children:[l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-10 w-auto"}),l.jsxs("span",{className:"text-2xl font-bold",children:[l.jsx("span",{className:"text-gray-900",children:"LA"}),l.jsx("span",{className:"text-primary",children:"BOTIGA"})]})]}),l.jsx("div",{className:"flex items-center gap-4",children:t&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:s,className:"p-2 text-gray-500 hover:text-primary hover:bg-gray-100 rounded-full transition-colors","aria-label":"Obre el tutorial",children:l.jsx(C_,{className:"w-7 h-7"})}),l.jsxs("button",{onClick:n,className:"bg-primary text-white font-semibold p-2 sm:px-4 sm:py-2 rounded-lg hover:bg-primary-700 transition-colors flex items-center gap-2",children:[l.jsx(Fh,{className:"h-5 w-5"}),l.jsx("span",{className:"hidden sm:inline",children:"Puja un article"})]}),l.jsxs("button",{onClick:r,className:"flex items-center gap-2 cursor-pointer p-1 rounded-md hover:bg-gray-100",children:[l.jsx("img",{src:t.avatarUrl,alt:t.name,className:"w-9 h-9 rounded-full border-2 border-primary-200"}),l.jsx("span",{className:"font-semibold text-gray-700 hidden md:block",children:t.name})]})]})})]})}),Hn={novedad:{label:"Novetat",emoji:"",className:"bg-blue-500 text-white"},ultimas_unidades:{label:"ltimes Unitats",emoji:"",className:"bg-yellow-500 text-black"},reservado:{label:"Reservat",emoji:"",className:"bg-orange-500 text-white"},vendido:{label:"Tracte Fet",emoji:"",className:"bg-gray-700 text-white"}},Ey=({product:t,onSelect:e})=>{const n=t.imageUrls&&t.imageUrls.length>0,r=i=>typeof i!="number"||isNaN(i)?"N/A":i.toFixed(2),s=t.tag?Hn[t.tag]:null;return l.jsxs("button",{onClick:e,className:`bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden group text-left w-full hover:shadow-lg transition-shadow duration-200 ${t.tag==="vendido"?"opacity-70":""}`,children:[l.jsxs("div",{className:"relative w-full aspect-square bg-gray-100 overflow-hidden",children:[n&&l.jsx("img",{src:t.imageUrls[0],alt:t.title,className:`w-full h-full object-cover group-hover:scale-105 transition-transform duration-300 ${t.tag==="vendido"?"grayscale":""}`}),s&&l.jsxs("div",{className:`absolute top-2 left-2 text-xs font-bold px-2 py-1 rounded-full shadow-md ${s.className}`,children:[s.emoji," ",s.label]})]}),l.jsxs("div",{className:"p-3",children:[l.jsxs("p",{className:"font-bold text-gray-800 text-lg",children:[r(t.price)," "]}),l.jsx("h3",{className:"text-gray-600 text-sm truncate",children:t.title}),l.jsxs("div",{className:"flex items-center mt-2 pt-2 border-t border-gray-100",children:[l.jsx("img",{src:t.seller.avatarUrl,alt:t.seller.name,className:"w-6 h-6 rounded-full mr-2"}),l.jsx("p",{className:"text-xs text-gray-500 truncate",children:t.seller.name})]})]})]})},JI=({userProducts:t,merchProducts:e,onProductSelect:n})=>{const[r,s]=R.useState(t),[i,o]=R.useState("");R.useEffect(()=>{const u=i.toLowerCase();if(u==="")s(t);else{const d=t.filter(f=>f.title.toLowerCase().includes(u)||f.description.toLowerCase().includes(u));s(d)}},[i,t]);const c=u=>{o(u.target.value)};return l.jsxs("main",{className:"container mx-auto p-4 md:p-8",children:[l.jsxs("div",{className:"bg-white rounded-2xl shadow-md border border-gray-200 p-6 mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Descobreix i estalvia"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Busca entre els articles de segona m a prop teu."}),l.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:l.jsxs("div",{className:"relative flex-grow",children:[l.jsx(zI,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Busca el que et calgui per practicar el millor esport del mn",value:i,onChange:c,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary bg-white text-gray-900"})]})})]}),e.length>0&&l.jsx("section",{className:"mb-12",children:l.jsxs("div",{className:"bg-primary-50 border border-primary-200 rounded-2xl p-6 shadow-sm",children:[l.jsx("div",{className:"flex justify-between items-center mb-6",children:l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Marxandatge del Club"})}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6",children:e.map(u=>l.jsx(Ey,{product:u,onSelect:()=>n(u)},u.id))})]})}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Articles destacats"}),r.length>0?l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6",children:r.map(u=>l.jsx(Ey,{product:u,onSelect:()=>n(u)},u.id))}):l.jsx("div",{className:"text-center py-16",children:l.jsx("p",{className:"text-gray-600",children:"No s'han trobat articles que coincideixin amb la teva cerca."})})]})]})},Qi=(t,e=1024,n=1024,r=.75)=>new Promise((s,i)=>{const o=new FileReader;o.readAsDataURL(t),o.onload=c=>{var d;if(!((d=c.target)!=null&&d.result))return i(new Error("No s'ha pogut llegir el fitxer."));const u=new Image;u.src=c.target.result,u.onload=()=>{const f=document.createElement("canvas");let{width:p,height:g}=u;p>g?p>e&&(g=Math.round(g*(e/p)),p=e):g>n&&(p=Math.round(p*(n/g)),g=n),f.width=p,f.height=g;const E=f.getContext("2d");if(!E)return i(new Error("No s'ha pogut obtenir el context del canvas"));E.drawImage(u,0,0,p,g),f.toBlob(C=>{C?s(C):i(new Error("La creaci del Blob des del canvas ha fallat."))},"image/jpeg",r)},u.onerror=f=>i(new Error(`Error en carregar la imatge: ${f instanceof Event?"Event":f}`))},o.onerror=c=>i(new Error(`Error en llegir el fitxer: ${c instanceof Event?"Event":c}`))}),Yi=t=>new Promise((e,n)=>{const r=new FileReader;r.onloadend=()=>e(r.result),r.onerror=n,r.readAsDataURL(t)}),On=5,ZI=({imagePreviews:t,onImagesAdded:e,onDeleteImage:n})=>{const[r,s]=R.useState(!1),[i,o]=R.useState(null),[c,u]=R.useState(!1),d=R.useRef(null),f=R.useRef(null),p=async C=>{const P=C.target.files;if(!P)return;const b=Array.from(P).slice(0,On-t.length);if(P.length>b.length?o(`Noms pots pujar un mxim de ${On} imatges.`):o(null),b.length!==0){s(!0);try{const T=b.map(A=>Qi(A)),x=await Promise.all(T);e(x)}catch(T){o("No s'ha pogut carregar una o ms imatges."),console.error(T)}finally{s(!1)}C.target.value=""}},g=()=>{var C;u(!1),(C=d.current)==null||C.click()},E=()=>{var C;u(!1),(C=f.current)==null||C.click()};return l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:l.jsx(Fh,{className:"h-6 w-6 text-primary"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"1. Puja les teves fotos"})]}),l.jsxs("p",{className:"text-sm font-medium text-gray-500",children:[t.length," / ",On]})]}),l.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-4",children:[t.map((C,P)=>l.jsxs("div",{className:"relative aspect-square group",children:[l.jsx("img",{src:C,alt:`Product image ${P+1}`,className:"w-full h-full object-cover rounded-lg border"}),l.jsx("button",{onClick:()=>n(P),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity","aria-label":"Eliminar imatge",children:l.jsx(qr,{className:"w-4 h-4"})})]},P)),r&&l.jsx("div",{className:"aspect-square flex justify-center items-center w-full h-full border-2 border-dashed border-gray-300 rounded-lg",children:l.jsx(Vs,{className:"w-8 h-8 text-primary"})}),t.length<On&&!r&&l.jsxs("button",{onClick:()=>u(!0),className:"aspect-square flex flex-col justify-center items-center w-full h-full border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-primary hover:bg-primary-50 transition-colors text-center","aria-label":`Puja ${On-t.length} imatges ms`,children:[l.jsx(Fh,{className:"mx-auto h-8 w-8 text-gray-400"}),l.jsx("p",{className:"mt-1 text-xs text-gray-600",children:l.jsx("span",{className:"font-semibold text-primary",children:"Afegeix fotos"})})]})]}),l.jsx("input",{ref:d,type:"file",onChange:p,className:"hidden",accept:"image/*",multiple:!0,disabled:t.length>=On}),l.jsx("input",{ref:f,type:"file",onChange:p,className:"hidden",accept:"image/*",capture:"environment",disabled:t.length>=On}),i&&l.jsx("p",{className:"text-red-500 text-sm mt-4",children:i}),c&&l.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4 animate-fade-in-fast",onClick:()=>u(!1),"aria-modal":"true",role:"dialog",children:[l.jsx("style",{children:`
            @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }
            .animate-fade-in-fast { animation: fade-in-fast 0.2s ease-out; }
            @keyframes scale-in { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
            .animate-scale-in { animation: scale-in 0.2s ease-out; }
          `}),l.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-xs shadow-xl animate-scale-in",onClick:C=>C.stopPropagation(),children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Tria una opci"}),l.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:l.jsx(qr,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{onClick:E,className:"w-full flex items-center gap-4 p-4 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors disabled:opacity-50",disabled:t.length>=On,children:[l.jsx(cm,{className:"w-6 h-6 text-primary"}),l.jsx("span",{className:"font-semibold text-gray-700",children:"Fes una foto"})]}),l.jsxs("button",{onClick:g,className:"w-full flex items-center gap-4 p-4 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors disabled:opacity-50",disabled:t.length>=On,children:[l.jsx(N_,{className:"w-6 h-6 text-primary"}),l.jsx("span",{className:"font-semibold text-gray-700",children:"Tria de la galeria"})]})]})]})]})]})},eb=({title:t,setTitle:e,description:n,setDescription:r})=>l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:l.jsx(WI,{className:"h-6 w-6 text-primary"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"2. Descriu el teu article"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"product-title",className:"block text-sm font-medium text-gray-700",children:"Ttol del producte"}),l.jsx("input",{id:"product-title",type:"text",value:t,onChange:s=>e(s.target.value),placeholder:'p. ex., "Jaqueta de cuir vintage"',className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{htmlFor:"product-description",className:"block text-sm font-medium text-gray-700",children:"Descripci"}),l.jsx("textarea",{id:"product-description",rows:6,value:n,onChange:s=>r(s.target.value),placeholder:"Descriu el teu article amb detall...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]})]}),tb=({imagePreviews:t,title:e,description:n,price:r,onPublish:s,isEditing:i,isPublishing:o})=>{const c=t.length>0&&e&&r;return l.jsx("div",{className:"sticky top-28",children:l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Vista prvia de l'anunci"}),l.jsx("div",{className:"w-full aspect-square bg-gray-100 rounded-lg mb-4 flex items-center justify-center",children:t&&t.length>0?l.jsx("img",{src:t[0],alt:"Vista prvia del producte",className:"w-full h-full object-cover rounded-lg"}):l.jsx(N_,{className:"w-16 h-16 text-gray-300"})}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-900 truncate",children:e||"Ttol del producte"}),l.jsx("p",{className:"text-3xl font-extrabold text-primary",children:r?`${parseFloat(r).toFixed(2)} `:"0.00 "}),l.jsx("div",{className:"border-t pt-3",children:l.jsx("p",{className:"text-gray-600 text-sm whitespace-pre-wrap h-32 overflow-y-auto",children:n||"La teva descripci generada apareixer aqu..."})}),l.jsx("button",{onClick:s,disabled:!c||o,className:"w-full bg-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:o?l.jsxs(l.Fragment,{children:[l.jsx(Vs,{className:"w-5 h-5"}),l.jsx("span",{children:i?"Desant...":"Publicant..."})]}):i?"Desa els canvis":"Publica l'anunci"})]})]})})},nb="dfmkfeqzt",rb="BOTIGAHANDBOL",ql=async t=>{try{const e=new FormData;e.append("file",t),e.append("upload_preset",rb);const n=await fetch(`https://api.cloudinary.com/v1_1/${nb}/image/upload`,{method:"POST",body:e});if(!n.ok){const s=await n.json();throw new Error(`Error en pujar a Cloudinary: ${s.error.message}`)}return(await n.json()).secure_url}catch(e){throw console.error("Error en la crrega a Cloudinary:",e),e}},sb="ListingDraftDB",ib=1,Hr="listingDrafts",um="currentListingDraft",dm=()=>new Promise((t,e)=>{const n=indexedDB.open(sb,ib);n.onerror=()=>e("Error en obrir la base de dades IndexedDB."),n.onsuccess=()=>t(n.result),n.onupgradeneeded=r=>{const s=r.target.result;s.objectStoreNames.contains(Hr)||s.createObjectStore(Hr)}}),ob=async t=>{const n=(await dm()).transaction(Hr,"readwrite");return n.objectStore(Hr).put(t,um),new Promise((s,i)=>{n.oncomplete=()=>s(),n.onerror=()=>i("Error en desar l'esborrany a IndexedDB.")})},ab=async()=>{const r=(await dm()).transaction(Hr,"readonly").objectStore(Hr).get(um);return new Promise((s,i)=>{r.onsuccess=()=>{s(r.result||null)},r.onerror=()=>i("Error en llegir l'esborrany.")})},lb=async()=>{(await dm()).transaction(Hr,"readwrite").objectStore(Hr).delete(um)},cb=({onSave:t,productToEdit:e,currentUser:n})=>{const[r,s]=R.useState([]),[i,o]=R.useState([]),[c,u]=R.useState(""),[d,f]=R.useState(""),[p,g]=R.useState(""),[E,C]=R.useState(!1),[P,b]=R.useState(""),[T,x]=R.useState(!0),[A,D]=R.useState(!1),V=!!e,O=R.useRef(null);R.useEffect(()=>{const k=r.map(_=>typeof _=="string"?_:URL.createObjectURL(_));return o(k),()=>{k.forEach(_=>{_.startsWith("blob:")&&URL.revokeObjectURL(_)})}},[r]),R.useEffect(()=>{(async()=>{var _;if(V&&e)u(e.title),f(e.description),g(((_=e.price)==null?void 0:_.toString())||""),s(e.imageUrls||[]),C(e.isMerchandise||!1),b(e.tag||"");else if(!V)try{const ee=await ab();ee&&(s(ee.imagesData||[]),u(ee.title||""),f(ee.description||""),g(ee.price||""),C(ee.isMerchandise||!1),b(ee.tag||""))}catch(ee){console.error("Error en restaurar l'esborrany:",ee)}x(!1)})()},[e,V]),R.useEffect(()=>{if(!(T||V))return O.current&&clearTimeout(O.current),O.current=window.setTimeout(()=>{ob({imagesData:r,title:c,description:d,price:p,isMerchandise:E,tag:P}).catch(_=>console.error("Error en desar l'esborrany:",_))},500),()=>{O.current&&clearTimeout(O.current)}},[r,c,d,p,E,P,T,V]);const y=async()=>{s([]),u(""),f(""),g(""),C(!1),b(""),await lb()},v=async()=>{if(i.length>0&&c&&p){D(!0);try{const k=r.map(ge=>typeof ge=="string"?Promise.resolve(ge):Yi(ge).then(wt=>ql(wt))),_=await Promise.all(k),ee={title:c,description:d,price:parseFloat(p),imageUrls:_,isMerchandise:E,tag:P||""};await t(ee,e==null?void 0:e.id),await y()}catch{console.error("La publicaci ha fallat. L'usuari ja ha estat notificat.")}finally{D(!1)}}},I={novedad:Hn.novedad,ultimas_unidades:Hn.ultimas_unidades},N={reservado:Hn.reservado,vendido:Hn.vendido},S=(n==null?void 0:n.role)==="admin"&&E?I:N;return T&&!V?l.jsx("div",{className:"flex justify-center items-center h-screen",children:l.jsx("p",{className:"text-gray-600",children:"Recuperant l'esborrany..."})}):l.jsx("main",{className:"container mx-auto p-4 md:p-8",children:l.jsxs("div",{className:"max-w-7xl mx-auto",children:[l.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",children:V?"Edita el teu anunci":"Crea el teu anunci"}),l.jsx("p",{className:"text-gray-600 mb-8",children:V?"Actualitza els detalls del teu producte.":"Fes servir les nostres eines per fer destacar el teu producte."}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8",children:[l.jsxs("div",{className:"lg:col-span-3 flex flex-col gap-8",children:[l.jsx(ZI,{imagePreviews:i,onImagesAdded:k=>s(_=>[..._,...k]),onDeleteImage:k=>s(_=>_.filter((ee,ge)=>ge!==k))}),l.jsx(eb,{title:c,setTitle:u,description:d,setDescription:f}),l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:l.jsx(xy,{className:"h-6 w-6 text-primary"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"3. Afegeix un preu"})]}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Introdueix el preu de venda del teu article."}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"product-price",className:"block text-sm font-medium text-gray-700",children:"Preu ()"}),l.jsx("input",{id:"product-price",type:"number",value:p,onChange:k=>g(k.target.value),placeholder:"p. ex., 25.50",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",step:"0.01",min:"0",required:!0})]})]}),l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:l.jsx(xy,{className:"h-6 w-6 text-primary"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"4. Etiqueta (Opcional)"})]}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Selecciona un estat per al teu article."}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("label",{className:"flex items-center gap-3 cursor-pointer p-2 rounded-lg hover:bg-gray-50",children:[l.jsx("input",{type:"radio",name:"tag",value:"",checked:P==="",onChange:k=>b(k.target.value),className:"h-5 w-5 text-primary focus:ring-primary border-gray-300"}),l.jsx("span",{className:"text-gray-700 font-medium",children:"Cap etiqueta"})]}),Object.entries(S).map(([k,_])=>l.jsxs("label",{className:"flex items-center gap-3 cursor-pointer p-2 rounded-lg hover:bg-gray-50",children:[l.jsx("input",{type:"radio",name:"tag",value:k,checked:P===k,onChange:ee=>b(ee.target.value),className:"h-5 w-5 text-primary focus:ring-primary border-gray-300"}),l.jsxs("span",{className:`text-sm font-semibold px-2 py-1 rounded-full ${_.className}`,children:[_.emoji," ",_.label]})]},k))]})]}),(n==null?void 0:n.role)==="admin"&&l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg flex items-center justify-center h-10 w-10",children:l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-6 w-auto"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Opcions d'Administrador"})]}),l.jsx("div",{className:"mt-4",children:l.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:E,onChange:k=>C(k.target.checked),className:"h-5 w-5 rounded border-gray-300 text-primary focus:ring-primary"}),l.jsx("span",{className:"text-gray-700 font-medium",children:"Afegeix com a article de merchandising oficial"})]})})]})]}),l.jsx("div",{className:"lg:col-span-2",children:l.jsx(tb,{imagePreviews:i,title:c,description:d,price:p,onPublish:v,isEditing:V,isPublishing:A})})]})]})})},ub=({message:t,type:e="success",onClose:n})=>{if(!t)return null;const r="text-white text-sm font-semibold px-4 py-3 rounded-lg shadow-lg flex items-center justify-between gap-4",s={success:"bg-green-500",error:"bg-red-500"},i={success:"hover:bg-green-600",error:"hover:bg-red-600"};return l.jsxs("div",{className:"fixed bottom-6 left-6 z-50 animate-slide-in-up",children:[l.jsx("style",{children:`
        @keyframes slide-in-up {
          0% {
            opacity: 0;
            transform: translateY(20px);
          }
          100% {
            opacity: 1;
            transform: translateY(0);
          }
        }
        .animate-slide-in-up {
          animation: slide-in-up 0.3s ease-out forwards;
        }
      `}),l.jsxs("div",{className:`${r} ${s[e]}`,children:[l.jsx("span",{children:t}),l.jsx("button",{onClick:n,className:`p-1 rounded-full flex-shrink-0 ${i[e]}`,children:l.jsx(qr,{className:"w-4 h-4"})})]})]})},db=({onClose:t,onLogin:e,onRegister:n,onPasswordReset:r,isDismissable:s=!0})=>{const[i,o]=R.useState("login"),[c,u]=R.useState(""),[d,f]=R.useState(""),[p,g]=R.useState(""),[E,C]=R.useState(!1),[P,b]=R.useState(null),T=R.useRef(null),[x,A]=R.useState(!1),[D,V]=R.useState(null),[O,y]=R.useState(null),v=async S=>{var _;const k=(_=S.target.files)==null?void 0:_[0];if(k)try{const ee=await Qi(k,512,512,.9),ge=await Yi(ee);b(ge)}catch(ee){console.error("Error en llegir el fitxer:",ee),V("No s'ha pogut processar la imatge.")}},I=async S=>{S.preventDefault(),A(!0),V(null),y(null);try{i==="login"?await e(d,p):await n(c,d,p,P)}catch(k){let _="Hi ha hagut un error. Si us plau, torna-ho a provar.";if(k.code)switch(k.code){case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":_="Correu electrnic o contrasenya incorrectes.";break;case"auth/email-already-in-use":_="Aquest correu electrnic ja est en s.";break;case"auth/weak-password":_="La contrasenya ha de tenir almenys 6 carcters.";break;case"auth/invalid-email":_="El format del correu electrnic no s vlid.";break}else k.message&&(k.message.includes("Cloudinary")?_="Error amb la imatge: Assegura't que el 'preset' de crrega a Cloudinary estigui configurat com a 'unsigned'.":_=k.message);V(_),console.error(k)}finally{A(!1)}},N=async S=>{S.preventDefault(),A(!0),V(null),y(null);try{await r(d),y("S'ha enviat l'enlla de recuperaci. Revisa el teu correu (i la carpeta de correu brossa).")}catch(k){let _="Hi ha hagut un error en enviar el correu.";(k.code==="auth/user-not-found"||k.code==="auth/invalid-email")&&(_="No s'ha trobat cap usuari amb aquest correu electrnic."),V(_)}finally{A(!1)}};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:s?t:void 0,"aria-modal":"true",role:"dialog",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden relative",onClick:S=>S.stopPropagation(),children:[s&&l.jsx("button",{onClick:t,className:"absolute top-3 right-3 text-gray-400 hover:text-gray-800 z-10 p-1 transition-colors","aria-label":"Tancar",children:l.jsx(qr,{className:"w-6 h-6"})}),l.jsx("div",{className:"p-6 sm:p-8",children:i==="forgotPassword"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-12 w-auto mx-auto"}),l.jsx("h2",{className:"mt-2 text-2xl font-bold text-gray-900",children:"Restableix la contrasenya"}),l.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Introdueix el teu correu i t'enviarem un enlla per recuperar-la."})]}),l.jsxs("form",{onSubmit:N,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email-reset",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),l.jsx("input",{id:"email-reset",name:"email",type:"email",autoComplete:"email",required:!0,value:d,onChange:S=>f(S.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"correu@exemple.com"})]}),D&&l.jsx("p",{className:"text-red-500 text-sm text-center",children:D}),O&&l.jsx("p",{className:"text-green-600 text-sm text-center",children:O}),l.jsx("div",{children:l.jsx("button",{type:"submit",disabled:x,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:x?l.jsx(Vs,{className:"w-5 h-5"}):"Envia l'enlla"})}),l.jsx("div",{children:l.jsx("button",{type:"button",onClick:()=>{o("login"),V(null),y(null),C(!1)},className:"w-full text-sm font-medium text-primary hover:underline",children:"Tornar a l'inici de sessi"})})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-12 w-auto mx-auto"}),l.jsx("h2",{className:"mt-2 text-2xl font-bold text-gray-900",children:i==="login"?l.jsxs(l.Fragment,{children:["Benvingut/da a LA",l.jsx("span",{className:"text-primary",children:"BOTIGA"})]}):"Crea el teu compte"}),l.jsx("p",{className:"text-gray-600 text-sm mt-1 px-4",children:i==="login"?"La botiga de segona m i marxandatge del Club Handbol Molins.":"Registra't per comprar i vendre material del club i molt ms."})]}),l.jsxs("div",{className:"flex border-b border-gray-200 mb-6",children:[l.jsx("button",{onClick:()=>{o("login"),V(null),y(null),C(!1)},className:`flex-1 py-3 text-sm font-semibold text-center transition-colors ${i==="login"?"text-primary border-b-2 border-primary":"text-gray-500 hover:text-gray-700"}`,children:"Inicia la sessi"}),l.jsx("button",{onClick:()=>{o("register"),V(null),y(null),C(!1)},className:`flex-1 py-3 text-sm font-semibold text-center transition-colors ${i==="register"?"text-primary border-b-2 border-primary":"text-gray-500 hover:text-gray-700"}`,children:"Registra't"})]}),l.jsxs("form",{onSubmit:I,className:"space-y-4",children:[i==="register"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex justify-center",children:[l.jsx("input",{type:"file",ref:T,onChange:v,className:"hidden",accept:"image/*"}),l.jsxs("button",{type:"button",onClick:()=>{var S;return(S=T.current)==null?void 0:S.click()},className:"relative w-24 h-24 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 hover:bg-gray-200 transition-colors",children:[P?l.jsx("img",{src:P,alt:"Avatar Preview",className:"w-full h-full object-cover rounded-full"}):l.jsx(cm,{className:"w-10 h-10"}),l.jsx("div",{className:"absolute bottom-0 right-0 bg-primary text-white rounded-full p-1 text-xs",children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nom"}),l.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:c,onChange:S=>u(S.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"El teu nom"})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),l.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:d,onChange:S=>f(S.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"correu@exemple.com"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Contrasenya"}),i==="login"&&l.jsx("button",{type:"button",onClick:()=>{o("forgotPassword"),V(null),y(null)},className:"text-sm font-medium text-primary hover:underline",children:"Heu oblidat la contrasenya?"})]}),l.jsxs("div",{className:"relative mt-1",children:[l.jsx("input",{id:"password",name:"password",type:E?"text":"password",autoComplete:"current-password",required:!0,value:p,onChange:S=>g(S.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900 pr-10",placeholder:""}),l.jsx("button",{type:"button",onClick:()=>C(!E),className:"absolute inset-y-0 right-0 flex items-center px-3 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":E?"Oculta la contrasenya":"Mostra la contrasenya",children:E?l.jsx(YI,{className:"w-5 h-5"}):l.jsx(QI,{className:"w-5 h-5"})})]})]}),D&&l.jsx("p",{className:"text-red-500 text-sm text-center",children:D}),O&&l.jsx("p",{className:"text-green-600 text-sm text-center",children:O}),l.jsx("div",{children:l.jsx("button",{type:"submit",disabled:x,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:x?l.jsx(Vs,{className:"w-5 h-5"}):i==="login"?"Inicia la sessi":"Crea el compte"})})]})]})})]})})},hb=({allUsers:t,onSendAdminMessage:e})=>{const[n,r]=R.useState("all"),[s,i]=R.useState(""),[o,c]=R.useState(!1),u=async d=>{if(d.preventDefault(),!!s.trim()){c(!0);try{await e(n,s),i(""),r("all")}catch{}finally{c(!1)}}};return l.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-2xl shadow-md border border-gray-200 mt-8",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-6 border-b",children:[l.jsx(BI,{className:"h-10 w-10 text-primary"}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Panell d'Administrador"}),l.jsx("p",{className:"text-gray-600",children:"Envia comunicats a usuaris individuals o a tothom."})]})]}),l.jsxs("form",{onSubmit:u,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"recipient",className:"block text-sm font-medium text-gray-700",children:"Destinatari"}),l.jsxs("select",{id:"recipient",value:n,onChange:d=>r(d.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",children:[l.jsx("option",{value:"all",children:"Tots els usuaris"}),t.map(d=>l.jsxs("option",{value:d.id,children:[d.name," (",d.email,")"]},d.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"admin-message",className:"block text-sm font-medium text-gray-700",children:"Missatge"}),l.jsx("textarea",{id:"admin-message",rows:5,value:s,onChange:d=>i(d.target.value),placeholder:"Escriu el teu comunicat aqu...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",required:!0})]}),l.jsx("button",{type:"submit",disabled:o||!s.trim(),className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:o?l.jsx(Vs,{className:"w-5 h-5"}):"Envia el missatge"})]})]})},fb=({user:t,onUpdateUser:e,onBack:n,onLogout:r,allUsers:s,onSendAdminMessage:i})=>{const[o,c]=R.useState(t.name),[u,d]=R.useState(null),f=R.useRef(null),[p,g]=R.useState(!1);R.useEffect(()=>{c(t.name)},[t]);const E=async P=>{var T;const b=(T=P.target.files)==null?void 0:T[0];if(b)try{const x=await Qi(b,512,512,.9),A=await Yi(x);d(A)}catch(x){console.error("Error en llegir el fitxer:",x)}},C=async P=>{P.preventDefault(),g(!0);try{await e(t.id,o,u),d(null)}catch(b){console.error(b)}finally{g(!1)}};return l.jsx("main",{className:"container mx-auto p-4 md:p-8",children:l.jsxs("div",{className:"max-w-2xl mx-auto",children:[l.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-6 border-b",children:[l.jsx(KI,{className:"h-10 w-10 text-primary"}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"El Meu Perfil"}),l.jsx("p",{className:"text-gray-600",children:"Actualitza la teva informaci personal."})]})]}),l.jsxs("form",{onSubmit:C,className:"space-y-4 sm:space-y-6",children:[l.jsxs("div",{className:"flex flex-col items-center gap-4",children:[l.jsx("input",{type:"file",ref:f,onChange:E,className:"hidden",accept:"image/*"}),l.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Foto de perfil"}),l.jsxs("button",{type:"button",onClick:()=>{var P;return(P=f.current)==null?void 0:P.click()},className:"relative w-32 h-32 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 hover:bg-gray-200 transition-colors group",children:[l.jsx("img",{src:u||t.avatarUrl,alt:"Avatar",className:"w-full h-full object-cover rounded-full"}),l.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 flex items-center justify-center rounded-full transition-opacity cursor-pointer",children:l.jsx(cm,{className:"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nom"}),l.jsx("input",{id:"name",type:"text",required:!0,value:o,onChange:P=>c(P.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),l.jsx("input",{id:"email",type:"email",value:t.email,disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm bg-gray-100 text-gray-500 cursor-not-allowed"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"joinDate",className:"block text-sm font-medium text-gray-700",children:"Membre des de"}),l.jsx("input",{id:"joinDate",type:"text",value:new Date(t.joinDate).toLocaleDateString("ca-ES",{year:"numeric",month:"long",day:"numeric"}),disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm bg-gray-100 text-gray-500 cursor-not-allowed"})]}),l.jsxs("div",{className:"flex gap-4 pt-4 border-t",children:[l.jsx("button",{type:"button",onClick:n,className:"w-full flex justify-center py-3 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:"Cancella"}),l.jsx("button",{type:"submit",disabled:p,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400",children:p?l.jsx(Vs,{className:"w-5 h-5"}):"Desa els canvis"})]})]}),l.jsx("div",{className:"mt-8 pt-6 border-t border-red-200",children:l.jsx("button",{onClick:r,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Tanca la sessi"})})]}),t.role==="admin"&&l.jsx(hb,{allUsers:s,onSendAdminMessage:i})]})})},mb=({onClick:t,unreadCount:e,isOpen:n})=>n?null:l.jsxs(l.Fragment,{children:[l.jsx("style",{children:`
        @keyframes pulse-strong {
          0%, 100% { transform: scale(1); opacity: 1; }
          50% { transform: scale(1.1); opacity: 0.95; }
        }
        .animate-pulse-strong { animation: pulse-strong 1.5s infinite ease-in-out; }
      `}),l.jsxs("button",{onClick:t,className:"fixed bottom-4 right-4 md:bottom-8 md:right-8 z-30 bg-primary text-white w-16 h-16 rounded-full shadow-lg flex items-center justify-center hover:bg-primary-700 transition-all duration-300 transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary","aria-label":"Obrir el xat",children:[e>0&&l.jsx("span",{className:"absolute top-0 right-0 h-6 w-6 rounded-full bg-red-500 border-2 border-white flex items-center justify-center text-xs font-bold animate-pulse-strong",children:e}),l.jsx("div",{className:"w-9 h-9",children:l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS.png",alt:"Xat",className:"w-full h-auto p-1"})})]})]}),pb=({message:t,currentUser:e})=>{var s,i;const n=t.senderId===e.id,r=((i=(s=t.timestamp)==null?void 0:s.toDate())==null?void 0:i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"";return l.jsx("div",{className:`flex items-end gap-2 ${n?"justify-end":"justify-start"}`,children:l.jsxs("div",{className:`max-w-xs md:max-w-md lg:max-w-lg rounded-2xl px-4 py-2 ${n?"bg-primary text-white rounded-br-none":"bg-gray-200 text-gray-800 rounded-bl-none"}`,children:[t.text&&l.jsx("p",{className:"text-sm break-words",children:t.text}),t.imageUrl&&l.jsx("div",{className:"mt-2",children:l.jsx("img",{src:t.imageUrl,alt:"Uploaded content",className:"rounded-lg max-h-60 w-full object-cover"})}),l.jsx("p",{className:`text-xs mt-1 ${n?"text-primary-200":"text-gray-500"} text-right`,children:r})]})})},gb=(t,e=1280,n=1280)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var u;if(!((u=o.target)!=null&&u.result))return s(new Error("No s'ha pogut llegir el fitxer."));const c=new Image;c.src=o.target.result,c.onload=()=>{const d=document.createElement("canvas");let{width:f,height:p}=c;f>p?f>e&&(p=Math.round(p*(e/f)),f=e):p>n&&(f=Math.round(f*(n/p)),p=n),d.width=f,d.height=p;const g=d.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(c,0,0,f,p),r(d.toDataURL("image/jpeg",.85))},c.onerror=d=>s(new Error(`Error en carregar la imatge: ${d}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),yb=({chat:t,onSelect:e,currentUser:n,onDelete:r,isConfirmingDelete:s,onStartConfirmDelete:i,onCancelConfirmDelete:o})=>{var g,E,C,P,b;const c=t.participantIds.find(T=>T!==n.id);if(!c)return null;const u=t.participants[c],d=t.unreadCount[n.id]||0,f=((C=(E=(g=t.lastMessage)==null?void 0:g.timestamp)==null?void 0:E.toDate())==null?void 0:C.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"",p=()=>{r(t.id),o()};return l.jsxs("div",{className:"w-full relative bg-white overflow-hidden group",children:[l.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center justify-end px-4 gap-2 bg-white",children:[l.jsx("button",{onClick:o,className:"text-sm font-semibold py-2 px-3 rounded-md bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors","aria-label":"Cancella l'eliminaci",children:"Cancella"}),l.jsx("button",{onClick:p,className:"text-sm font-semibold py-2 px-3 rounded-md bg-red-600 text-white hover:bg-red-700 transition-colors","aria-label":"Confirma l'eliminaci",children:"Elimina"})]}),l.jsxs("div",{className:`w-full flex items-center gap-2 px-2 py-1 bg-white relative transition-transform duration-300 ease-in-out ${s?"-translate-x-44":"translate-x-0"}`,children:[l.jsxs("button",{onClick:e,className:"w-full text-left p-2 flex items-center gap-3 rounded-lg hover:bg-gray-100 transition-colors flex-1",children:[l.jsxs("div",{className:"relative flex-shrink-0",children:[l.jsx("img",{src:u.avatarUrl,alt:u.name,className:"w-12 h-12 rounded-full object-cover"}),l.jsx("img",{src:t.productImageUrl,alt:t.productTitle,className:"w-6 h-6 rounded-full object-cover absolute -bottom-1 -right-1 border-2 border-white"})]}),l.jsxs("div",{className:"flex-1 overflow-hidden",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("p",{className:"font-bold text-gray-800 truncate",children:u.name}),l.jsx("p",{className:"text-xs text-gray-500 flex-shrink-0",children:f})]}),l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("p",{className:"text-sm text-gray-600 truncate pr-2",children:((P=t.lastMessage)==null?void 0:P.text)||((b=t.lastMessage)!=null&&b.imageUrl?"Imatge":"Cap missatge encara")}),d>0&&l.jsx("span",{className:"bg-primary text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center flex-shrink-0",children:d})]})]})]}),l.jsx("button",{onClick:i,className:"p-2 rounded-full text-gray-400 hover:bg-red-100 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100","aria-label":`Elimina el xat amb ${u.name}`,children:l.jsx(k_,{className:"w-5 h-5"})})]})]})},vb=({isOpen:t,onClose:e,chats:n,activeChat:r,messages:s,currentUser:i,onSendMessage:o,onSelectChat:c,onBackToList:u,onDeleteChat:d})=>{const[f,p]=R.useState(""),[g,E]=R.useState(null),C=R.useRef(null),P=R.useRef(null),b=()=>{var y;(y=P.current)==null||y.scrollIntoView({behavior:"smooth"})};R.useEffect(()=>{t&&r&&b()},[s,t,r]),R.useEffect(()=>{(!t||!r)&&E(null)},[t,r]);const T=()=>{f.trim()&&(o(f),p(""))},x=y=>{y.key==="Enter"&&(y.preventDefault(),T())},A=async y=>{var I;const v=(I=y.target.files)==null?void 0:I[0];if(v)try{const N=await gb(v);o("",N)}catch(N){console.error("No s'ha pogut llegir el fitxer",N)}y.target&&(y.target.value="")},D=()=>{var y;(y=C.current)==null||y.click()};if(!t||!i)return null;const V=r==null?void 0:r.participantIds.find(y=>y!==i.id),O=V?r==null?void 0:r.participants[V]:null;return l.jsxs("div",{className:"fixed bottom-0 right-0 sm:bottom-4 md:bottom-8 sm:right-4 md:right-8 z-20 w-full sm:w-96 h-[90vh] sm:h-[60vh] sm:max-h-[600px] bg-white rounded-t-lg sm:rounded-lg shadow-2xl flex flex-col border border-gray-200 transform transition-transform duration-300 ease-in-out animate-slide-in",children:[l.jsx("style",{children:`
        @keyframes slide-in {
          from { transform: translateY(100%); opacity: 0; }
          to { transform: translateY(0); opacity: 1; }
        }
        .animate-slide-in { 
            animation: slide-in 0.3s ease-out; 
        }
        @keyframes fade-in-fast {
          from { opacity: 0; transform: scale(0.8); }
          to { opacity: 1; transform: scale(1); }
        }
        .animate-fade-in-fast { 
          animation: fade-in-fast 0.2s ease-out; 
        }
      `}),l.jsxs("header",{className:"bg-primary text-white p-3 flex justify-between items-center rounded-t-lg flex-shrink-0",children:[r?l.jsxs("div",{className:"flex items-center gap-3 flex-1 overflow-hidden",children:[l.jsx("button",{onClick:u,className:"hover:bg-primary-700 p-1 rounded-full -ml-1",children:l.jsx(GI,{className:"w-6 h-6"})}),l.jsx("img",{src:O==null?void 0:O.avatarUrl,alt:O==null?void 0:O.name,className:"w-8 h-8 rounded-full object-cover"}),l.jsxs("div",{className:"overflow-hidden",children:[l.jsx("h3",{className:"font-bold text-lg truncate",children:O==null?void 0:O.name}),l.jsx("p",{className:"text-xs opacity-80 truncate",children:r.productTitle})]})]}):l.jsx("div",{className:"flex items-center justify-between w-full",children:l.jsx("h3",{className:"font-bold text-lg",children:"Converses"})}),l.jsx("button",{onClick:e,className:"hover:bg-primary-700 p-1 rounded-full",children:l.jsx(qr,{className:"w-6 h-6"})})]}),r?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex-1 p-4 overflow-y-auto space-y-4 bg-gray-50",children:[s.map(y=>l.jsx(pb,{message:y,currentUser:i},y.id)),l.jsx("div",{ref:P})]}),l.jsx("div",{className:"p-2 border-t border-gray-200 bg-gray-100 flex-shrink-0",children:l.jsxs("div",{className:"flex items-center bg-white border border-gray-300 rounded-lg px-2",children:[l.jsx("input",{type:"text",value:f,onChange:y=>p(y.target.value),onKeyPress:x,placeholder:"Escriu un missatge...",className:"flex-1 py-2 px-2 border-none focus:ring-0 text-sm bg-transparent text-gray-900","aria-label":"Entrada de missatge del xat"}),l.jsx("input",{ref:C,type:"file",onChange:A,className:"hidden",accept:"image/*"}),l.jsx("button",{onClick:D,className:"text-gray-500 hover:text-primary p-2","aria-label":"Adjunta una imatge",children:l.jsx($I,{className:"w-5 h-5"})}),l.jsx("button",{onClick:T,className:"text-white bg-primary hover:bg-primary-700 rounded-md p-2 ml-1 disabled:bg-gray-400",disabled:!f.trim(),"aria-label":"Envia el missatge",children:l.jsx(HI,{className:"w-5 h-5"})})]})})]}):l.jsx("div",{className:"flex-1 overflow-y-auto",children:n.length>0?n.map(y=>l.jsx(yb,{chat:y,onSelect:()=>c(y),currentUser:i,onDelete:d,isConfirmingDelete:g===y.id,onStartConfirmDelete:()=>E(y.id),onCancelConfirmDelete:()=>E(null)},y.id)):l.jsxs("div",{className:"text-center p-8 text-gray-500 h-full flex flex-col justify-center items-center",children:[l.jsx(A_,{className:"w-16 h-16 text-gray-300 mb-4"}),l.jsx("p",{className:"font-semibold",children:"No tens cap conversa."}),l.jsx("p",{className:"text-sm mt-1",children:"Contacta amb un venedor des d'un anunci per comenar a xatejar."})]})})]})},gs=({title:t,children:e})=>l.jsxs("section",{className:"mb-6",children:[l.jsx("h2",{className:"text-xl font-bold text-primary mb-3",children:t}),l.jsx("div",{className:"space-y-2 text-gray-700",children:e})]}),wb=({onClose:t})=>l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:t,"aria-modal":"true",role:"dialog",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col relative",onClick:e=>e.stopPropagation(),children:[l.jsxs("header",{className:"p-4 border-b flex items-center justify-between sticky top-0 bg-white z-10",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(C_,{className:"w-8 h-8 text-primary"}),l.jsxs("h1",{className:"text-2xl font-bold text-gray-800",children:["Guia Rpida de ",l.jsx("span",{className:"text-gray-900",children:"LA"}),l.jsx("span",{className:"text-primary",children:"BOTIGA"})]})]}),l.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-800 p-1 rounded-full hover:bg-gray-100","aria-label":"Tancar",children:l.jsx(qr,{className:"w-6 h-6"})})]}),l.jsxs("div",{className:"p-6 overflow-y-auto",children:[l.jsxs("section",{className:"mb-6",children:[l.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-3",children:[" Benvingut/da a ",l.jsx("span",{className:"text-gray-900",children:"LA"}),l.jsx("span",{className:"text-primary",children:"BOTIGA"}),"!"]}),l.jsx("div",{className:"space-y-2 text-gray-700",children:l.jsx("p",{children:"Aquesta s la botiga virtual del Club Handbol Molins, on pots comprar i vendre material d'handbol de segona m i adquirir el marxandatge oficial del club."})})]}),l.jsx(gs,{title:"1. Explora els Articles",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsxs("li",{children:["A la pgina principal, trobars les seccions ",l.jsx("strong",{children:"'Marxandatge del Club'"})," i ",l.jsx("strong",{children:"'Articles destacats'"}),"."]}),l.jsxs("li",{children:["Fes servir la ",l.jsx("strong",{children:"barra de cerca"})," per trobar articles especfics pel seu nom o descripci."]}),l.jsx("li",{children:"Fes clic a qualsevol article per veure'n els detalls."})]})}),l.jsx(gs,{title:"2. Comprar un Article de Segona M",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Quan trobis un article que t'interessi, fes-hi clic per obrir la vista detallada."}),l.jsxs("li",{children:[l.jsx("strong",{children:"Visualitza les imatges:"})," Fes clic a la imatge principal d'un producte per obrir-la a pantalla completa. Llisca el dit o fes servir les fletxes per veure la resta de fotos."]}),l.jsx("li",{children:"Llegeix la descripci i comprova el preu."}),l.jsxs("li",{children:["Per parlar amb el venedor, fes clic al bot ",l.jsx("strong",{children:"'Contacta amb el venedor'"}),". Aix obrir un xat privat."]}),l.jsx("li",{children:"Al xat, podeu acordar els detalls del pagament i l'entrega de forma segura."})]})}),l.jsxs(gs,{title:"3. Vendre un Article",children:[l.jsxs("p",{children:["Fes clic al bot ",l.jsx("strong",{children:"'Puja un article'"})," a la capalera per comenar."]}),l.jsxs("ul",{className:"list-decimal list-inside space-y-2 pl-4",children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Puja les teves fotos:"})," Fes clic a 'Afegeix fotos'. Podrs triar entre fer una foto amb la cmera o seleccionar-ne de la teva galeria. Pots pujar fins a 5 imatges. La primera ser la principal."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Descriu el teu article:"})," Afegeix un ttol clar i una descripci detallada. Com ms informaci, millor!"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Afegeix un preu:"})," Introdueix el preu que demanes per l'article. Pots demanar un suggeriment de preu automtic."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Vista prvia i publicaci:"})," A la dreta, veurs una vista prvia del teu anunci. Quan estiguis satisfet/a, fes clic a ",l.jsx("strong",{children:"'Publica l'anunci'"}),"."]})]})]}),l.jsx(gs,{title:"4. Gestiona els Teus Xats",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsxs("li",{children:["Fes clic a la ",l.jsx("strong",{children:"bombolla de xat"})," a la cantonada inferior dreta per veure les teves converses."]}),l.jsx("li",{children:"Un nmero vermell indicar els missatges nous que no has llegit."}),l.jsx("li",{children:"Pots enviar text i imatges a travs del xat per comunicar-te amb altres usuaris."}),l.jsx("li",{children:"Per eliminar un xat, a la llista de converses, fes clic a la icona de la paperera que apareix a la dreta en passar el cursor per sobre (ordinador). Haurs de confirmar l'acci."})]})}),l.jsx(gs,{title:"5. El Teu Perfil",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsxs("li",{children:["Fes clic a la teva ",l.jsx("strong",{children:"foto de perfil"})," a la capalera per anar a la pgina del teu perfil."]}),l.jsx("li",{children:"Aqu pots canviar el teu nom i la teva foto de perfil."}),l.jsxs("li",{children:["Tamb pots ",l.jsx("strong",{children:"tancar la sessi"})," des d'aquesta pgina de manera segura."]})]})}),l.jsx(gs,{title:"6. Comprar Marxandatge Oficial",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Els articles de la secci 'Marxandatge del Club' sn productes oficials."}),l.jsxs("li",{children:["Per comprar-ne un, fes clic a l'article i desprs al bot ",l.jsx("strong",{children:"'Realitzar comanda'"}),". Sers redirigit/da a un formulari per completar la comanda."]}),l.jsxs("li",{children:["Si tens dubtes, ara tamb pots fer clic a ",l.jsx("strong",{children:"'Contacta amb el club'"})," per iniciar un xat directe abans de fer la comanda."]})]})}),l.jsxs(gs,{title:"7. Eines d'Administrador",children:[l.jsx("p",{children:"Si tens el rol d'administrador, a la teva pgina de perfil trobars un panell addicional."}),l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsxs("li",{children:["Aquest panell et permet enviar ",l.jsx("strong",{children:"missatges massius"})," a tots els usuaris o missatges directes a un usuari especfic."]}),l.jsx("li",{children:"Aquests missatges apareixeran com una nova conversa de xat per als destinataris."})]})]})]})]})}),Ty=({direction:t,onClick:e})=>l.jsx("button",{onClick:n=>{n.stopPropagation(),e()},className:`absolute top-1/2 -translate-y-1/2 ${t==="left"?"left-2 md:left-4":"right-2 md:right-4"} z-10 bg-black bg-opacity-40 text-white p-2 rounded-full hover:bg-opacity-60 transition-all`,"aria-label":t==="left"?"Imatge anterior":"Imatge segent",children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-8 md:w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:t==="left"?"M15 19l-7-7 7-7":"M9 5l7 7-7 7"})})}),_b=({images:t,startIndex:e=0,onClose:n})=>{const[r,s]=R.useState(e),[i,o]=R.useState(null),c=R.useCallback(()=>{s(p=>p===0?t.length-1:p-1)},[t.length]),u=R.useCallback(()=>{s(p=>p===t.length-1?0:p+1)},[t.length]);R.useEffect(()=>{const p=g=>{g.key==="ArrowLeft"&&c(),g.key==="ArrowRight"&&u(),g.key==="Escape"&&n()};return window.addEventListener("keydown",p),()=>{window.removeEventListener("keydown",p)}},[c,u,n]);const d=p=>{o(p.touches[0].clientX)},f=p=>{if(i===null)return;const g=p.touches[0].clientX,E=i-g;E>50?(u(),o(null)):E<-50&&(c(),o(null))};return l.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-80 z-50 flex flex-col justify-center items-center animate-fade-in-fast",onClick:n,role:"dialog","aria-modal":"true",children:[l.jsx("style",{children:`
            @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }
            .animate-fade-in-fast { animation: fade-in-fast 0.2s ease-out; }
        `}),l.jsx("button",{onClick:p=>{p.stopPropagation(),n()},className:"absolute top-4 right-4 text-white bg-black bg-opacity-40 p-2 rounded-full hover:bg-opacity-60 transition-all","aria-label":"Tancar visor",children:l.jsx(qr,{className:"w-6 h-6"})}),l.jsxs("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:[t.length>1&&l.jsx(Ty,{direction:"left",onClick:c}),l.jsx("div",{className:"w-full h-full flex items-center justify-center",onTouchStart:d,onTouchMove:f,children:l.jsx("img",{src:t[r],alt:`Imatge ${r+1} de ${t.length}`,className:"max-w-full max-h-full object-contain select-none"})}),t.length>1&&l.jsx(Ty,{direction:"right",onClick:u})]}),t.length>1&&l.jsxs("div",{className:"absolute bottom-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm",children:[r+1," / ",t.length]})]})},xb=()=>{};var Iy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P_=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Eb=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],c=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},R_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,c=o?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,f=i>>2,p=(i&3)<<4|c>>4;let g=(c&15)<<2|d>>6,E=d&63;u||(E=64,o||(g=64)),r.push(n[f],n[p],n[g],n[E])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(P_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Eb(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],c=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const p=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||c==null||d==null||p==null)throw new Tb;const g=i<<2|c>>4;if(r.push(g),d!==64){const E=c<<4&240|d>>2;if(r.push(E),p!==64){const C=d<<6&192|p;r.push(C)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Tb extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Ib=function(t){const e=P_(t);return R_.encodeByteArray(e,!0)},Ac=function(t){return Ib(t).replace(/\./g,"")},j_=function(t){try{return R_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sb=()=>bb().__FIREBASE_DEFAULTS__,Ab=()=>{if(typeof process>"u"||typeof Iy>"u")return;const t=Iy.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},kb=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&j_(t[1]);return e&&JSON.parse(e)},fu=()=>{try{return xb()||Sb()||Ab()||kb()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},D_=t=>{var e,n;return(n=(e=fu())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},Nb=t=>{const e=D_(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},L_=()=>{var t;return(t=fu())==null?void 0:t.config},M_=t=>{var e;return(e=fu())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cb{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xi(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function V_(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pb(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Ac(JSON.stringify(n)),Ac(JSON.stringify(o)),""].join(".")}const Zo={};function Rb(){const t={prod:[],emulator:[]};for(const e of Object.keys(Zo))Zo[e]?t.emulator.push(e):t.prod.push(e);return t}function jb(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let by=!1;function O_(t,e){if(typeof window>"u"||typeof document>"u"||!Xi(window.location.host)||Zo[t]===e||Zo[t]||by)return;Zo[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=Rb().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function c(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function u(g,E){g.setAttribute("width","24"),g.setAttribute("id",E),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function d(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{by=!0,o()},g}function f(g,E){g.setAttribute("id",E),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function p(){const g=jb(r),E=n("text"),C=document.getElementById(E)||document.createElement("span"),P=n("learnmore"),b=document.getElementById(P)||document.createElement("a"),T=n("preprendIcon"),x=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const A=g.element;c(A),f(b,P);const D=d();u(x,T),A.append(x,C,b,D),document.body.appendChild(A)}i?(C.innerText="Preview backend disconnected.",x.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(x.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Db(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(vt())}function Lb(){var e;const t=(e=fu())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Mb(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Vb(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Ob(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Fb(){const t=vt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Ub(){return!Lb()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function F_(){try{return typeof indexedDB=="object"}catch{return!1}}function U_(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}function Bb(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $b="FirebaseError";class Mn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=$b,Object.setPrototypeOf(this,Mn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ks.prototype.create)}}class Ks{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?zb(i,r):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new Mn(s,c,r)}}function zb(t,e){return t.replace(qb,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const qb=/\{\$([^}]+)}/g;function Hb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Wr(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Sy(i)&&Sy(o)){if(!Wr(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Sy(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fa(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Oo(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Fo(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function Wb(t,e){const n=new Kb(t,e);return n.subscribe.bind(n)}class Kb{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Gb(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Nd),s.error===void 0&&(s.error=Nd),s.complete===void 0&&(s.complete=Nd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Gb(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Nd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ve(t){return t&&t._delegate?t._delegate:t}class mn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Es="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Cb;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Xb(e))try{this.getOrInitializeService({instanceIdentifier:Es})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Es){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Es){return this.instances.has(e)}getOptions(e=Es){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Yb(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Es){return this.component?this.component.multipleInstances?e:Es:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Yb(t){return t===Es?void 0:t}function Xb(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Qb(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var he;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(he||(he={}));const Zb={debug:he.DEBUG,verbose:he.VERBOSE,info:he.INFO,warn:he.WARN,error:he.ERROR,silent:he.SILENT},eS=he.INFO,tS={[he.DEBUG]:"log",[he.VERBOSE]:"log",[he.INFO]:"info",[he.WARN]:"warn",[he.ERROR]:"error"},nS=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=tS[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class hm{constructor(e){this.name=e,this._logLevel=eS,this._logHandler=nS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in he))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Zb[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,he.DEBUG,...e),this._logHandler(this,he.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,he.VERBOSE,...e),this._logHandler(this,he.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,he.INFO,...e),this._logHandler(this,he.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,he.WARN,...e),this._logHandler(this,he.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,he.ERROR,...e),this._logHandler(this,he.ERROR,...e)}}const rS=(t,e)=>e.some(n=>t instanceof n);let Ay,ky;function sS(){return Ay||(Ay=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function iS(){return ky||(ky=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const B_=new WeakMap,Uh=new WeakMap,$_=new WeakMap,Cd=new WeakMap,fm=new WeakMap;function oS(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Yn(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&B_.set(n,t)}).catch(()=>{}),fm.set(e,t),e}function aS(t){if(Uh.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Uh.set(t,e)}let Bh={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Uh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||$_.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Yn(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function lS(t){Bh=t(Bh)}function cS(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Pd(this),e,...n);return $_.set(r,e.sort?e.sort():[e]),Yn(r)}:iS().includes(t)?function(...e){return t.apply(Pd(this),e),Yn(B_.get(this))}:function(...e){return Yn(t.apply(Pd(this),e))}}function uS(t){return typeof t=="function"?cS(t):(t instanceof IDBTransaction&&aS(t),rS(t,sS())?new Proxy(t,Bh):t)}function Yn(t){if(t instanceof IDBRequest)return oS(t);if(Cd.has(t))return Cd.get(t);const e=uS(t);return e!==t&&(Cd.set(t,e),fm.set(e,t)),e}const Pd=t=>fm.get(t);function mu(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),c=Yn(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Yn(o.result),u.oldVersion,u.newVersion,Yn(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}function Rd(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),Yn(n).then(()=>{})}const dS=["get","getKey","getAll","getAllKeys","count"],hS=["put","add","delete","clear"],jd=new Map;function Ny(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(jd.get(e))return jd.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=hS.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||dS.includes(n)))return;const i=async function(o,...c){const u=this.transaction(o,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[n](...c),s&&u.done]))[0]};return jd.set(e,i),i}lS(t=>({...t,get:(e,n,r)=>Ny(e,n)||t.get(e,n,r),has:(e,n)=>!!Ny(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(mS(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function mS(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const $h="@firebase/app",Cy="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rr=new hm("@firebase/app"),pS="@firebase/app-compat",gS="@firebase/analytics-compat",yS="@firebase/analytics",vS="@firebase/app-check-compat",wS="@firebase/app-check",_S="@firebase/auth",xS="@firebase/auth-compat",ES="@firebase/database",TS="@firebase/data-connect",IS="@firebase/database-compat",bS="@firebase/functions",SS="@firebase/functions-compat",AS="@firebase/installations",kS="@firebase/installations-compat",NS="@firebase/messaging",CS="@firebase/messaging-compat",PS="@firebase/performance",RS="@firebase/performance-compat",jS="@firebase/remote-config",DS="@firebase/remote-config-compat",LS="@firebase/storage",MS="@firebase/storage-compat",VS="@firebase/firestore",OS="@firebase/ai",FS="@firebase/firestore-compat",US="firebase",BS="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zh="[DEFAULT]",$S={[$h]:"fire-core",[pS]:"fire-core-compat",[yS]:"fire-analytics",[gS]:"fire-analytics-compat",[wS]:"fire-app-check",[vS]:"fire-app-check-compat",[_S]:"fire-auth",[xS]:"fire-auth-compat",[ES]:"fire-rtdb",[TS]:"fire-data-connect",[IS]:"fire-rtdb-compat",[bS]:"fire-fn",[SS]:"fire-fn-compat",[AS]:"fire-iid",[kS]:"fire-iid-compat",[NS]:"fire-fcm",[CS]:"fire-fcm-compat",[PS]:"fire-perf",[RS]:"fire-perf-compat",[jS]:"fire-rc",[DS]:"fire-rc-compat",[LS]:"fire-gcs",[MS]:"fire-gcs-compat",[VS]:"fire-fst",[FS]:"fire-fst-compat",[OS]:"fire-vertex","fire-js":"fire-js",[US]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kc=new Map,zS=new Map,qh=new Map;function Py(t,e){try{t.container.addComponent(e)}catch(n){rr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Dn(t){const e=t.name;if(qh.has(e))return rr.debug(`There were multiple attempts to register component ${e}.`),!1;qh.set(e,t);for(const n of kc.values())Py(n,t);for(const n of zS.values())Py(n,t);return!0}function Ji(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Qt(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Fr=new Ks("app","Firebase",qS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new mn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Fr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zi=BS;function mm(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:zh,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Fr.create("bad-app-name",{appName:String(s)});if(n||(n=L_()),!n)throw Fr.create("no-options");const i=kc.get(s);if(i){if(Wr(n,i.options)&&Wr(r,i.config))return i;throw Fr.create("duplicate-app",{appName:s})}const o=new Jb(s);for(const u of qh.values())o.addComponent(u);const c=new HS(n,r,o);return kc.set(s,c),c}function pm(t=zh){const e=kc.get(t);if(!e&&t===zh&&L_())return mm();if(!e)throw Fr.create("no-app",{appName:t});return e}function Zt(t,e,n){let r=$S[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),rr.warn(o.join(" "));return}Dn(new mn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WS="firebase-heartbeat-database",KS=1,Ea="firebase-heartbeat-store";let Dd=null;function z_(){return Dd||(Dd=mu(WS,KS,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ea)}catch(n){console.warn(n)}}}}).catch(t=>{throw Fr.create("idb-open",{originalErrorMessage:t.message})})),Dd}async function GS(t){try{const n=(await z_()).transaction(Ea),r=await n.objectStore(Ea).get(q_(t));return await n.done,r}catch(e){if(e instanceof Mn)rr.warn(e.message);else{const n=Fr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});rr.warn(n.message)}}}async function Ry(t,e){try{const r=(await z_()).transaction(Ea,"readwrite");await r.objectStore(Ea).put(e,q_(t)),await r.done}catch(n){if(n instanceof Mn)rr.warn(n.message);else{const r=Fr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});rr.warn(r.message)}}}function q_(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QS=1024,YS=30;class XS{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new ZS(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=jy();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>YS){const o=eA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){rr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=jy(),{heartbeatsToSend:r,unsentEntries:s}=JS(this._heartbeatsCache.heartbeats),i=Ac(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return rr.warn(n),""}}}function jy(){return new Date().toISOString().substring(0,10)}function JS(t,e=QS){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Dy(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Dy(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class ZS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return F_()?U_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await GS(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Ry(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Ry(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Dy(t){return Ac(JSON.stringify({version:2,heartbeats:t})).length}function eA(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tA(t){Dn(new mn("platform-logger",e=>new fS(e),"PRIVATE")),Dn(new mn("heartbeat",e=>new XS(e),"PRIVATE")),Zt($h,Cy,t),Zt($h,Cy,"esm2020"),Zt("fire-js","")}tA("");var nA="firebase",rA="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zt(nA,rA,"app");function H_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const sA=H_,W_=new Ks("auth","Firebase",H_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nc=new hm("@firebase/auth");function iA(t,...e){Nc.logLevel<=he.WARN&&Nc.warn(`Auth (${Zi}): ${t}`,...e)}function Hl(t,...e){Nc.logLevel<=he.ERROR&&Nc.error(`Auth (${Zi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(t,...e){throw gm(t,...e)}function kn(t,...e){return gm(t,...e)}function K_(t,e,n){const r={...sA(),[e]:n};return new Ks("auth","Firebase",r).create(e,{appName:t.name})}function Xn(t){return K_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function gm(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return W_.create(t,...e)}function se(t,e,...n){if(!t)throw gm(e,...n)}function Wn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Hl(e),new Error(e)}function sr(t,e){t||Wn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hh(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function oA(){return Ly()==="http:"||Ly()==="https:"}function Ly(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aA(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(oA()||Vb()||"connection"in navigator)?navigator.onLine:!0}function lA(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e,n){this.shortDelay=e,this.longDelay=n,sr(n>e,"Short delay should be less than long delay!"),this.isMobile=Db()||Ob()}get(){return aA()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ym(t,e){sr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Wn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Wn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Wn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],dA=new Ua(3e4,6e4);function cr(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function ur(t,e,n,r,s={}){return Q_(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const c=Fa({key:t.config.apiKey,...o}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:u,...i};return Mb()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Xi(t.emulatorConfig.host)&&(d.credentials="include"),G_.fetch()(await Y_(t,t.config.apiHost,n,c),d)})}async function Q_(t,e,n){t._canInitEmulator=!1;const r={...cA,...e};try{const s=new fA(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Il(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Il(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Il(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw Il(t,"user-disabled",o);const f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw K_(t,f,d);pn(t,f)}}catch(s){if(s instanceof Mn)throw s;pn(t,"network-request-failed",{message:String(s)})}}async function Ba(t,e,n,r,s={}){const i=await ur(t,e,n,r,s);return"mfaPendingCredential"in i&&pn(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function Y_(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?ym(t.config,s):`${t.config.apiScheme}://${s}`;return uA.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function hA(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class fA{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(kn(this.auth,"network-request-failed")),dA.get())})}}function Il(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=kn(t,e,r);return s.customData._tokenResponse=n,s}function My(t){return t!==void 0&&t.enterprise!==void 0}class mA{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return hA(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function pA(t,e){return ur(t,"GET","/v2/recaptchaConfig",cr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gA(t,e){return ur(t,"POST","/v1/accounts:delete",e)}async function Cc(t,e){return ur(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ea(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function yA(t,e=!1){const n=Ve(t),r=await n.getIdToken(e),s=vm(r);se(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:ea(Ld(s.auth_time)),issuedAtTime:ea(Ld(s.iat)),expirationTime:ea(Ld(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Ld(t){return Number(t)*1e3}function vm(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Hl("JWT malformed, contained fewer than 3 sections"),null;try{const s=j_(n);return s?JSON.parse(s):(Hl("Failed to decode base64 JWT payload"),null)}catch(s){return Hl("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Vy(t){const e=vm(t);return se(e,"internal-error"),se(typeof e.exp<"u","internal-error"),se(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ta(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Mn&&vA(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function vA({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ea(this.lastLoginAt),this.creationTime=ea(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pc(t){var p;const e=t.auth,n=await t.getIdToken(),r=await Ta(t,Cc(e,{idToken:n}));se(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(p=s.providerUserInfo)!=null&&p.length?X_(s.providerUserInfo):[],o=xA(t.providerData,i),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=c?u:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Wh(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function _A(t){const e=Ve(t);await Pc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function xA(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function X_(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EA(t,e){const n=await Q_(t,{},async()=>{const r=Fa({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await Y_(t,s,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return t.emulatorConfig&&Xi(t.emulatorConfig.host)&&(u.credentials="include"),G_.fetch()(o,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function TA(t,e){return ur(t,"POST","/v2/accounts:revokeToken",cr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){se(e.idToken,"internal-error"),se(typeof e.idToken<"u","internal-error"),se(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Vy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){se(e.length!==0,"internal-error");const n=Vy(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(se(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await EA(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Si;return r&&(se(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(se(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(se(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Si,this.toJSON())}_performRefresh(){return Wn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wr(t,e){se(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class un{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new wA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Wh(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Ta(this,this.stsTokenManager.getToken(this.auth,e));return se(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return yA(this,e)}reload(){return _A(this)}_assign(e){this!==e&&(se(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new un({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){se(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Pc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qt(this.auth.app))return Promise.reject(Xn(this.auth));const e=await this.getIdToken();return await Ta(this,gA(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,c=n.tenantId??void 0,u=n._redirectEventId??void 0,d=n.createdAt??void 0,f=n.lastLoginAt??void 0,{uid:p,emailVerified:g,isAnonymous:E,providerData:C,stsTokenManager:P}=n;se(p&&P,e,"internal-error");const b=Si.fromJSON(this.name,P);se(typeof p=="string",e,"internal-error"),wr(r,e.name),wr(s,e.name),se(typeof g=="boolean",e,"internal-error"),se(typeof E=="boolean",e,"internal-error"),wr(i,e.name),wr(o,e.name),wr(c,e.name),wr(u,e.name),wr(d,e.name),wr(f,e.name);const T=new un({uid:p,auth:e,email:s,emailVerified:g,displayName:r,isAnonymous:E,photoURL:o,phoneNumber:i,tenantId:c,stsTokenManager:b,createdAt:d,lastLoginAt:f});return C&&Array.isArray(C)&&(T.providerData=C.map(x=>({...x}))),u&&(T._redirectEventId=u),T}static async _fromIdTokenResponse(e,n,r=!1){const s=new Si;s.updateFromServerResponse(n);const i=new un({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Pc(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];se(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?X_(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),c=new Si;c.updateFromIdToken(r);const u=new un({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Wh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oy=new Map;function Kn(t){sr(t instanceof Function,"Expected a class definition");let e=Oy.get(t);return e?(sr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Oy.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}J_.type="NONE";const Fy=J_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wl(t,e,n){return`firebase:${t}:${e}:${n}`}class Ai{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Wl(this.userKey,s.apiKey,i),this.fullPersistenceKey=Wl("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Cc(this.auth,{idToken:e}).catch(()=>{});return n?un._fromGetAccountInfoResponse(this.auth,n,e):null}return un._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Ai(Kn(Fy),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Kn(Fy);const o=Wl(r,e.config.apiKey,e.name);let c=null;for(const d of n)try{const f=await d._get(o);if(f){let p;if(typeof f=="string"){const g=await Cc(e,{idToken:f}).catch(()=>{});if(!g)break;p=await un._fromGetAccountInfoResponse(e,g,f)}else p=un._fromJSON(e,f);d!==i&&(c=p),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new Ai(i,e,r):(i=u[0],c&&await i._set(o,c.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new Ai(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uy(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(n1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Z_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(s1(e))return"Blackberry";if(i1(e))return"Webos";if(e1(e))return"Safari";if((e.includes("chrome/")||t1(e))&&!e.includes("edge/"))return"Chrome";if(r1(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Z_(t=vt()){return/firefox\//i.test(t)}function e1(t=vt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function t1(t=vt()){return/crios\//i.test(t)}function n1(t=vt()){return/iemobile/i.test(t)}function r1(t=vt()){return/android/i.test(t)}function s1(t=vt()){return/blackberry/i.test(t)}function i1(t=vt()){return/webos/i.test(t)}function wm(t=vt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function IA(t=vt()){var e;return wm(t)&&!!((e=window.navigator)!=null&&e.standalone)}function bA(){return Fb()&&document.documentMode===10}function o1(t=vt()){return wm(t)||r1(t)||i1(t)||s1(t)||/windows phone/i.test(t)||n1(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a1(t,e=[]){let n;switch(t){case"Browser":n=Uy(vt());break;case"Worker":n=`${Uy(vt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Zi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,c)=>{try{const u=e(i);o(u)}catch(u){c(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AA(t,e={}){return ur(t,"GET","/v2/passwordPolicy",cr(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kA=6;class NA{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??kA,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new By(this),this.idTokenSubscription=new By(this),this.beforeStateQueue=new SA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=W_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Kn(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Ai.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Cc(this,{idToken:e}),r=await un._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Qt(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,c=r==null?void 0:r._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&(u!=null&&u.user)&&(r=u.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return se(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Pc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=lA()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Qt(this.app))return Promise.reject(Xn(this));const n=e?Ve(e):null;return n&&se(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&se(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Qt(this.app)?Promise.reject(Xn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Qt(this.app)?Promise.reject(Xn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Kn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await AA(this),n=new NA(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ks("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await TA(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Kn(e)||this._popupRedirectResolver;se(n,this,"argument-error"),this.redirectPersistenceManager=await Ai.create(this,[Kn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(se(c,this,"internal-error"),c.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return se(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=a1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Qt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&iA(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function ss(t){return Ve(t)}class By{constructor(e){this.auth=e,this.observer=null,this.addObserver=Wb(n=>this.observer=n)}get next(){return se(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function PA(t){pu=t}function l1(t){return pu.loadJS(t)}function RA(){return pu.recaptchaEnterpriseScript}function jA(){return pu.gapiScript}function DA(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class LA{constructor(){this.enterprise=new MA}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class MA{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const VA="recaptcha-enterprise",c1="NO_RECAPTCHA";class OA{constructor(e){this.type=VA,this.auth=ss(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,c)=>{pA(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new mA(u);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(u=>{c(u)})})}function s(i,o,c){const u=window.grecaptcha;My(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(c1)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new LA().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(c=>{if(!n&&My(window.grecaptcha))s(c,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=RA();u.length!==0&&(u+=c),l1(u).then(()=>{s(c,i,o)}).catch(d=>{o(d)})}}).catch(c=>{o(c)})})}}async function $y(t,e,n,r=!1,s=!1){const i=new OA(t);let o;if(s)o=c1;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const c={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Rc(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await $y(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await $y(t,e,n,n==="getOobCode");return r(t,c)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FA(t,e){const n=Ji(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Wr(i,e??{}))return s;pn(s,"already-initialized")}return n.initialize({options:e})}function UA(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Kn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function BA(t,e,n){const r=ss(t);se(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=u1(e),{host:o,port:c}=$A(e),u=c===null?"":`:${c}`,d={url:`${i}//${o}${u}/`},f=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){se(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),se(Wr(d,r.config.emulator)&&Wr(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,Xi(o)?(V_(`${i}//${o}${u}`),O_("Auth",!0)):zA()}function u1(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function $A(t){const e=u1(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:zy(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:zy(o)}}}function zy(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function zA(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _m{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Wn("not implemented")}_getIdTokenResponse(e){return Wn("not implemented")}_linkToIdToken(e,n){return Wn("not implemented")}_getReauthenticationResolver(e){return Wn("not implemented")}}async function qA(t,e){return ur(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HA(t,e){return Ba(t,"POST","/v1/accounts:signInWithPassword",cr(t,e))}async function WA(t,e){return ur(t,"POST","/v1/accounts:sendOobCode",cr(t,e))}async function KA(t,e){return WA(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GA(t,e){return Ba(t,"POST","/v1/accounts:signInWithEmailLink",cr(t,e))}async function QA(t,e){return Ba(t,"POST","/v1/accounts:signInWithEmailLink",cr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia extends _m{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Ia(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Ia(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Rc(e,n,"signInWithPassword",HA);case"emailLink":return GA(e,{email:this._email,oobCode:this._password});default:pn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Rc(e,r,"signUpPassword",qA);case"emailLink":return QA(e,{idToken:n,email:this._email,oobCode:this._password});default:pn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ki(t,e){return Ba(t,"POST","/v1/accounts:signInWithIdp",cr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YA="http://localhost";class Os extends _m{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Os(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):pn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new Os(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ki(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ki(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ki(e,n)}buildRequest(){const e={requestUri:YA,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Fa(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XA(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function JA(t){const e=Oo(Fo(t)).link,n=e?Oo(Fo(e)).deep_link_id:null,r=Oo(Fo(t)).deep_link_id;return(r?Oo(Fo(r)).link:null)||r||n||e||t}class xm{constructor(e){const n=Oo(Fo(e)),r=n.apiKey??null,s=n.oobCode??null,i=XA(n.mode??null);se(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=JA(e);try{return new xm(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(){this.providerId=eo.PROVIDER_ID}static credential(e,n){return Ia._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=xm.parseLink(n);return se(r,"argument-error"),Ia._fromEmailAndCode(e,r.code,r.tenantId)}}eo.PROVIDER_ID="password";eo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";eo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a extends d1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir extends $a{constructor(){super("facebook.com")}static credential(e){return Os._fromParams({providerId:Ir.PROVIDER_ID,signInMethod:Ir.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ir.credentialFromTaggedObject(e)}static credentialFromError(e){return Ir.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ir.credential(e.oauthAccessToken)}catch{return null}}}Ir.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ir.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br extends $a{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Os._fromParams({providerId:br.PROVIDER_ID,signInMethod:br.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return br.credentialFromTaggedObject(e)}static credentialFromError(e){return br.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return br.credential(n,r)}catch{return null}}}br.GOOGLE_SIGN_IN_METHOD="google.com";br.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr extends $a{constructor(){super("github.com")}static credential(e){return Os._fromParams({providerId:Sr.PROVIDER_ID,signInMethod:Sr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Sr.credentialFromTaggedObject(e)}static credentialFromError(e){return Sr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Sr.credential(e.oauthAccessToken)}catch{return null}}}Sr.GITHUB_SIGN_IN_METHOD="github.com";Sr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar extends $a{constructor(){super("twitter.com")}static credential(e,n){return Os._fromParams({providerId:Ar.PROVIDER_ID,signInMethod:Ar.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ar.credentialFromTaggedObject(e)}static credentialFromError(e){return Ar.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ar.credential(n,r)}catch{return null}}}Ar.TWITTER_SIGN_IN_METHOD="twitter.com";Ar.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZA(t,e){return Ba(t,"POST","/v1/accounts:signUp",cr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await un._fromIdTokenResponse(e,r,s),o=qy(r);return new Fs({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=qy(r);return new Fs({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function qy(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jc extends Mn{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,jc.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new jc(e,n,r,s)}}function h1(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?jc._fromErrorAndOperation(t,i,e,r):i})}async function ek(t,e,n=!1){const r=await Ta(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Fs._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tk(t,e,n=!1){const{auth:r}=t;if(Qt(r.app))return Promise.reject(Xn(r));const s="reauthenticate";try{const i=await Ta(t,h1(r,s,e,t),n);se(i.idToken,r,"internal-error");const o=vm(i.idToken);se(o,r,"internal-error");const{sub:c}=o;return se(t.uid===c,r,"user-mismatch"),Fs._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&pn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f1(t,e,n=!1){if(Qt(t.app))return Promise.reject(Xn(t));const r="signIn",s=await h1(t,r,e),i=await Fs._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function nk(t,e){return f1(ss(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m1(t){const e=ss(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function p1(t,e,n){const r=ss(t);await Rc(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",KA)}async function g1(t,e,n){if(Qt(t.app))return Promise.reject(Xn(t));const r=ss(t),o=await Rc(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ZA).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&m1(t),u}),c=await Fs._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function y1(t,e,n){return Qt(t.app)?Promise.reject(Xn(t)):nk(Ve(t),eo.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&m1(t),r})}function rk(t,e,n,r){return Ve(t).onIdTokenChanged(e,n,r)}function sk(t,e,n){return Ve(t).beforeAuthStateChanged(e,n)}function v1(t,e,n,r){return Ve(t).onAuthStateChanged(e,n,r)}function Ni(t){return Ve(t).signOut()}const Dc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Dc,"1"),this.storage.removeItem(Dc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ik=1e3,ok=10;class _1 extends w1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=o1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);bA()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,ok):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},ik)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}_1.type="LOCAL";const ak=_1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1 extends w1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}x1.type="SESSION";const E1=x1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lk(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new gu(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(o).map(async d=>d(n.origin,i)),u=await lk(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}gu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Em(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((c,u)=>{const d=Em("",20);s.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(p){const g=p;if(g.data.eventId===d)switch(g.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(g.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nn(){return window}function uk(t){Nn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T1(){return typeof Nn().WorkerGlobalScope<"u"&&typeof Nn().importScripts=="function"}async function dk(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function hk(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function fk(){return T1()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I1="firebaseLocalStorageDb",mk=1,Lc="firebaseLocalStorage",b1="fbase_key";class za{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function yu(t,e){return t.transaction([Lc],e?"readwrite":"readonly").objectStore(Lc)}function pk(){const t=indexedDB.deleteDatabase(I1);return new za(t).toPromise()}function Kh(){const t=indexedDB.open(I1,mk);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Lc,{keyPath:b1})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Lc)?e(r):(r.close(),await pk(),e(await Kh()))})})}async function Hy(t,e,n){const r=yu(t,!0).put({[b1]:e,value:n});return new za(r).toPromise()}async function gk(t,e){const n=yu(t,!1).get(e),r=await new za(n).toPromise();return r===void 0?null:r.value}function Wy(t,e){const n=yu(t,!0).delete(e);return new za(n).toPromise()}const yk=800,vk=3;class S1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Kh(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>vk)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return T1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=gu._getInstance(fk()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await dk(),!this.activeServiceWorker)return;this.sender=new ck(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||hk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Kh();return await Hy(e,Dc,"1"),await Wy(e,Dc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Hy(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>gk(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Wy(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=yu(s,!1).getAll();return new za(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),yk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}S1.type="LOCAL";const wk=S1;new Ua(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _k(t,e){return e?Kn(e):(se(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm extends _m{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ki(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ki(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ki(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function xk(t){return f1(t.auth,new Tm(t),t.bypassAuthState)}function Ek(t){const{auth:e,user:n}=t;return se(n,e,"internal-error"),tk(n,new Tm(t),t.bypassAuthState)}async function Tk(t){const{auth:e,user:n}=t;return se(n,e,"internal-error"),ek(n,new Tm(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return xk;case"linkViaPopup":case"linkViaRedirect":return Tk;case"reauthViaPopup":case"reauthViaRedirect":return Ek;default:pn(this.auth,"internal-error")}}resolve(e){sr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){sr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ik=new Ua(2e3,1e4);class wi extends A1{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,wi.currentPopupAction&&wi.currentPopupAction.cancel(),wi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return se(e,this.auth,"internal-error"),e}async onExecution(){sr(this.filter.length===1,"Popup operations only handle one event");const e=Em();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(kn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(kn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,wi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(kn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Ik.get())};e()}}wi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bk="pendingRedirect",Kl=new Map;class Sk extends A1{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Kl.get(this.auth._key());if(!e){try{const r=await Ak(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Kl.set(this.auth._key(),e)}return this.bypassAuthState||Kl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Ak(t,e){const n=Ck(e),r=Nk(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function kk(t,e){Kl.set(t._key(),e)}function Nk(t){return Kn(t._redirectPersistence)}function Ck(t){return Wl(bk,t.config.apiKey,t.name)}async function Pk(t,e,n=!1){if(Qt(t.app))return Promise.reject(Xn(t));const r=ss(t),s=_k(r,e),o=await new Sk(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rk=10*60*1e3;class jk{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Dk(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!k1(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(kn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Rk&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ky(e))}saveEventToCache(e){this.cachedEventUids.add(Ky(e)),this.lastProcessedEventTime=Date.now()}}function Ky(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function k1({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Dk(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return k1(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lk(t,e={}){return ur(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Vk=/^https?/;async function Ok(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Lk(t);for(const n of e)try{if(Fk(n))return}catch{}pn(t,"unauthorized-domain")}function Fk(t){const e=Hh(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!Vk.test(n))return!1;if(Mk.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uk=new Ua(3e4,6e4);function Gy(){const t=Nn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Bk(t){return new Promise((e,n)=>{var s,i,o;function r(){Gy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Gy(),n(kn(t,"network-request-failed"))},timeout:Uk.get()})}if((i=(s=Nn().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Nn().gapi)!=null&&o.load)r();else{const c=DA("iframefcb");return Nn()[c]=()=>{gapi.load?r():n(kn(t,"network-request-failed"))},l1(`${jA()}?onload=${c}`).catch(u=>n(u))}}).catch(e=>{throw Gl=null,e})}let Gl=null;function $k(t){return Gl=Gl||Bk(t),Gl}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zk=new Ua(5e3,15e3),qk="__/auth/iframe",Hk="emulator/auth/iframe",Wk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Kk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Gk(t){const e=t.config;se(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?ym(e,Hk):`https://${t.config.authDomain}/${qk}`,r={apiKey:e.apiKey,appName:t.name,v:Zi},s=Kk.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Fa(r).slice(1)}`}async function Qk(t){const e=await $k(t),n=Nn().gapi;return se(n,t,"internal-error"),e.open({where:document.body,url:Gk(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Wk,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=kn(t,"network-request-failed"),c=Nn().setTimeout(()=>{i(o)},zk.get());function u(){Nn().clearTimeout(c),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yk={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Xk=500,Jk=600,Zk="_blank",eN="http://localhost";class Qy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function tN(t,e,n,r=Xk,s=Jk){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u={...Yk,width:r.toString(),height:s.toString(),top:i,left:o},d=vt().toLowerCase();n&&(c=t1(d)?Zk:n),Z_(d)&&(e=e||eN,u.scrollbars="yes");const f=Object.entries(u).reduce((g,[E,C])=>`${g}${E}=${C},`,"");if(IA(d)&&c!=="_self")return nN(e||"",c),new Qy(null);const p=window.open(e||"",c,f);se(p,t,"popup-blocked");try{p.focus()}catch{}return new Qy(p)}function nN(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rN="__/auth/handler",sN="emulator/auth/handler",iN=encodeURIComponent("fac");async function Yy(t,e,n,r,s,i){se(t.config.authDomain,t,"auth-domain-config-required"),se(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Zi,eventId:s};if(e instanceof d1){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Hb(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))o[f]=p}if(e instanceof $a){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const u=await t._getAppCheckToken(),d=u?`#${iN}=${encodeURIComponent(u)}`:"";return`${oN(t)}?${Fa(c).slice(1)}${d}`}function oN({config:t}){return t.emulator?ym(t,sN):`https://${t.authDomain}/${rN}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Md="webStorageSupport";class aN{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=E1,this._completeRedirectFn=Pk,this._overrideRedirectResult=kk}async _openPopup(e,n,r,s){var o;sr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await Yy(e,n,r,Hh(),s);return tN(e,i,Em())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await Yy(e,n,r,Hh(),s);return uk(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(sr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await Qk(e),r=new jk(e);return n.register("authEvent",s=>(se(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Md,{type:Md},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Md];i!==void 0&&n(!!i),pn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Ok(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return o1()||e1()||wm()}}const lN=aN;var Xy="@firebase/auth",Jy="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cN{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){se(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uN(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function dN(t){Dn(new mn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;se(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:a1(t)},d=new CA(r,s,i,u);return UA(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Dn(new mn("auth-internal",e=>{const n=ss(e.getProvider("auth").getImmediate());return(r=>new cN(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Zt(Xy,Jy,uN(t)),Zt(Xy,Jy,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hN=5*60,fN=M_("authIdTokenMaxAge")||hN;let Zy=null;const mN=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>fN)return;const s=n==null?void 0:n.token;Zy!==s&&(Zy=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function N1(t=pm()){const e=Ji(t,"auth");if(e.isInitialized())return e.getImmediate();const n=FA(t,{popupRedirectResolver:lN,persistence:[wk,ak,E1]}),r=M_("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=mN(i.toString());sk(n,o,()=>o(n.currentUser)),rk(n,c=>o(c))}}const s=D_("auth");return s&&BA(n,`http://${s}`),n}function pN(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}PA({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=kn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",pN().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});dN("Browser");var e0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ur,C1;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(y,v){function I(){}I.prototype=v.prototype,y.F=v.prototype,y.prototype=new I,y.prototype.constructor=y,y.D=function(N,S,k){for(var _=Array(arguments.length-2),ee=2;ee<arguments.length;ee++)_[ee-2]=arguments[ee];return v.prototype[S].apply(N,_)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(y,v,I){I||(I=0);const N=Array(16);if(typeof v=="string")for(var S=0;S<16;++S)N[S]=v.charCodeAt(I++)|v.charCodeAt(I++)<<8|v.charCodeAt(I++)<<16|v.charCodeAt(I++)<<24;else for(S=0;S<16;++S)N[S]=v[I++]|v[I++]<<8|v[I++]<<16|v[I++]<<24;v=y.g[0],I=y.g[1],S=y.g[2];let k=y.g[3],_;_=v+(k^I&(S^k))+N[0]+3614090360&4294967295,v=I+(_<<7&4294967295|_>>>25),_=k+(S^v&(I^S))+N[1]+3905402710&4294967295,k=v+(_<<12&4294967295|_>>>20),_=S+(I^k&(v^I))+N[2]+606105819&4294967295,S=k+(_<<17&4294967295|_>>>15),_=I+(v^S&(k^v))+N[3]+3250441966&4294967295,I=S+(_<<22&4294967295|_>>>10),_=v+(k^I&(S^k))+N[4]+4118548399&4294967295,v=I+(_<<7&4294967295|_>>>25),_=k+(S^v&(I^S))+N[5]+1200080426&4294967295,k=v+(_<<12&4294967295|_>>>20),_=S+(I^k&(v^I))+N[6]+2821735955&4294967295,S=k+(_<<17&4294967295|_>>>15),_=I+(v^S&(k^v))+N[7]+4249261313&4294967295,I=S+(_<<22&4294967295|_>>>10),_=v+(k^I&(S^k))+N[8]+1770035416&4294967295,v=I+(_<<7&4294967295|_>>>25),_=k+(S^v&(I^S))+N[9]+2336552879&4294967295,k=v+(_<<12&4294967295|_>>>20),_=S+(I^k&(v^I))+N[10]+4294925233&4294967295,S=k+(_<<17&4294967295|_>>>15),_=I+(v^S&(k^v))+N[11]+2304563134&4294967295,I=S+(_<<22&4294967295|_>>>10),_=v+(k^I&(S^k))+N[12]+1804603682&4294967295,v=I+(_<<7&4294967295|_>>>25),_=k+(S^v&(I^S))+N[13]+4254626195&4294967295,k=v+(_<<12&4294967295|_>>>20),_=S+(I^k&(v^I))+N[14]+2792965006&4294967295,S=k+(_<<17&4294967295|_>>>15),_=I+(v^S&(k^v))+N[15]+1236535329&4294967295,I=S+(_<<22&4294967295|_>>>10),_=v+(S^k&(I^S))+N[1]+4129170786&4294967295,v=I+(_<<5&4294967295|_>>>27),_=k+(I^S&(v^I))+N[6]+3225465664&4294967295,k=v+(_<<9&4294967295|_>>>23),_=S+(v^I&(k^v))+N[11]+643717713&4294967295,S=k+(_<<14&4294967295|_>>>18),_=I+(k^v&(S^k))+N[0]+3921069994&4294967295,I=S+(_<<20&4294967295|_>>>12),_=v+(S^k&(I^S))+N[5]+3593408605&4294967295,v=I+(_<<5&4294967295|_>>>27),_=k+(I^S&(v^I))+N[10]+38016083&4294967295,k=v+(_<<9&4294967295|_>>>23),_=S+(v^I&(k^v))+N[15]+3634488961&4294967295,S=k+(_<<14&4294967295|_>>>18),_=I+(k^v&(S^k))+N[4]+3889429448&4294967295,I=S+(_<<20&4294967295|_>>>12),_=v+(S^k&(I^S))+N[9]+568446438&4294967295,v=I+(_<<5&4294967295|_>>>27),_=k+(I^S&(v^I))+N[14]+3275163606&4294967295,k=v+(_<<9&4294967295|_>>>23),_=S+(v^I&(k^v))+N[3]+4107603335&4294967295,S=k+(_<<14&4294967295|_>>>18),_=I+(k^v&(S^k))+N[8]+1163531501&4294967295,I=S+(_<<20&4294967295|_>>>12),_=v+(S^k&(I^S))+N[13]+2850285829&4294967295,v=I+(_<<5&4294967295|_>>>27),_=k+(I^S&(v^I))+N[2]+4243563512&4294967295,k=v+(_<<9&4294967295|_>>>23),_=S+(v^I&(k^v))+N[7]+1735328473&4294967295,S=k+(_<<14&4294967295|_>>>18),_=I+(k^v&(S^k))+N[12]+2368359562&4294967295,I=S+(_<<20&4294967295|_>>>12),_=v+(I^S^k)+N[5]+4294588738&4294967295,v=I+(_<<4&4294967295|_>>>28),_=k+(v^I^S)+N[8]+2272392833&4294967295,k=v+(_<<11&4294967295|_>>>21),_=S+(k^v^I)+N[11]+1839030562&4294967295,S=k+(_<<16&4294967295|_>>>16),_=I+(S^k^v)+N[14]+4259657740&4294967295,I=S+(_<<23&4294967295|_>>>9),_=v+(I^S^k)+N[1]+2763975236&4294967295,v=I+(_<<4&4294967295|_>>>28),_=k+(v^I^S)+N[4]+1272893353&4294967295,k=v+(_<<11&4294967295|_>>>21),_=S+(k^v^I)+N[7]+4139469664&4294967295,S=k+(_<<16&4294967295|_>>>16),_=I+(S^k^v)+N[10]+3200236656&4294967295,I=S+(_<<23&4294967295|_>>>9),_=v+(I^S^k)+N[13]+681279174&4294967295,v=I+(_<<4&4294967295|_>>>28),_=k+(v^I^S)+N[0]+3936430074&4294967295,k=v+(_<<11&4294967295|_>>>21),_=S+(k^v^I)+N[3]+3572445317&4294967295,S=k+(_<<16&4294967295|_>>>16),_=I+(S^k^v)+N[6]+76029189&4294967295,I=S+(_<<23&4294967295|_>>>9),_=v+(I^S^k)+N[9]+3654602809&4294967295,v=I+(_<<4&4294967295|_>>>28),_=k+(v^I^S)+N[12]+3873151461&4294967295,k=v+(_<<11&4294967295|_>>>21),_=S+(k^v^I)+N[15]+530742520&4294967295,S=k+(_<<16&4294967295|_>>>16),_=I+(S^k^v)+N[2]+3299628645&4294967295,I=S+(_<<23&4294967295|_>>>9),_=v+(S^(I|~k))+N[0]+4096336452&4294967295,v=I+(_<<6&4294967295|_>>>26),_=k+(I^(v|~S))+N[7]+1126891415&4294967295,k=v+(_<<10&4294967295|_>>>22),_=S+(v^(k|~I))+N[14]+2878612391&4294967295,S=k+(_<<15&4294967295|_>>>17),_=I+(k^(S|~v))+N[5]+4237533241&4294967295,I=S+(_<<21&4294967295|_>>>11),_=v+(S^(I|~k))+N[12]+1700485571&4294967295,v=I+(_<<6&4294967295|_>>>26),_=k+(I^(v|~S))+N[3]+2399980690&4294967295,k=v+(_<<10&4294967295|_>>>22),_=S+(v^(k|~I))+N[10]+4293915773&4294967295,S=k+(_<<15&4294967295|_>>>17),_=I+(k^(S|~v))+N[1]+2240044497&4294967295,I=S+(_<<21&4294967295|_>>>11),_=v+(S^(I|~k))+N[8]+1873313359&4294967295,v=I+(_<<6&4294967295|_>>>26),_=k+(I^(v|~S))+N[15]+4264355552&4294967295,k=v+(_<<10&4294967295|_>>>22),_=S+(v^(k|~I))+N[6]+2734768916&4294967295,S=k+(_<<15&4294967295|_>>>17),_=I+(k^(S|~v))+N[13]+1309151649&4294967295,I=S+(_<<21&4294967295|_>>>11),_=v+(S^(I|~k))+N[4]+4149444226&4294967295,v=I+(_<<6&4294967295|_>>>26),_=k+(I^(v|~S))+N[11]+3174756917&4294967295,k=v+(_<<10&4294967295|_>>>22),_=S+(v^(k|~I))+N[2]+718787259&4294967295,S=k+(_<<15&4294967295|_>>>17),_=I+(k^(S|~v))+N[9]+3951481745&4294967295,y.g[0]=y.g[0]+v&4294967295,y.g[1]=y.g[1]+(S+(_<<21&4294967295|_>>>11))&4294967295,y.g[2]=y.g[2]+S&4294967295,y.g[3]=y.g[3]+k&4294967295}r.prototype.v=function(y,v){v===void 0&&(v=y.length);const I=v-this.blockSize,N=this.C;let S=this.h,k=0;for(;k<v;){if(S==0)for(;k<=I;)s(this,y,k),k+=this.blockSize;if(typeof y=="string"){for(;k<v;)if(N[S++]=y.charCodeAt(k++),S==this.blockSize){s(this,N),S=0;break}}else for(;k<v;)if(N[S++]=y[k++],S==this.blockSize){s(this,N),S=0;break}}this.h=S,this.o+=v},r.prototype.A=function(){var y=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);y[0]=128;for(var v=1;v<y.length-8;++v)y[v]=0;v=this.o*8;for(var I=y.length-8;I<y.length;++I)y[I]=v&255,v/=256;for(this.v(y),y=Array(16),v=0,I=0;I<4;++I)for(let N=0;N<32;N+=8)y[v++]=this.g[I]>>>N&255;return y};function i(y,v){var I=c;return Object.prototype.hasOwnProperty.call(I,y)?I[y]:I[y]=v(y)}function o(y,v){this.h=v;const I=[];let N=!0;for(let S=y.length-1;S>=0;S--){const k=y[S]|0;N&&k==v||(I[S]=k,N=!1)}this.g=I}var c={};function u(y){return-128<=y&&y<128?i(y,function(v){return new o([v|0],v<0?-1:0)}):new o([y|0],y<0?-1:0)}function d(y){if(isNaN(y)||!isFinite(y))return p;if(y<0)return b(d(-y));const v=[];let I=1;for(let N=0;y>=I;N++)v[N]=y/I|0,I*=4294967296;return new o(v,0)}function f(y,v){if(y.length==0)throw Error("number format error: empty string");if(v=v||10,v<2||36<v)throw Error("radix out of range: "+v);if(y.charAt(0)=="-")return b(f(y.substring(1),v));if(y.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=d(Math.pow(v,8));let N=p;for(let k=0;k<y.length;k+=8){var S=Math.min(8,y.length-k);const _=parseInt(y.substring(k,k+S),v);S<8?(S=d(Math.pow(v,S)),N=N.j(S).add(d(_))):(N=N.j(I),N=N.add(d(_)))}return N}var p=u(0),g=u(1),E=u(16777216);t=o.prototype,t.m=function(){if(P(this))return-b(this).m();let y=0,v=1;for(let I=0;I<this.g.length;I++){const N=this.i(I);y+=(N>=0?N:4294967296+N)*v,v*=4294967296}return y},t.toString=function(y){if(y=y||10,y<2||36<y)throw Error("radix out of range: "+y);if(C(this))return"0";if(P(this))return"-"+b(this).toString(y);const v=d(Math.pow(y,6));var I=this;let N="";for(;;){const S=D(I,v).g;I=T(I,S.j(v));let k=((I.g.length>0?I.g[0]:I.h)>>>0).toString(y);if(I=S,C(I))return k+N;for(;k.length<6;)k="0"+k;N=k+N}},t.i=function(y){return y<0?0:y<this.g.length?this.g[y]:this.h};function C(y){if(y.h!=0)return!1;for(let v=0;v<y.g.length;v++)if(y.g[v]!=0)return!1;return!0}function P(y){return y.h==-1}t.l=function(y){return y=T(this,y),P(y)?-1:C(y)?0:1};function b(y){const v=y.g.length,I=[];for(let N=0;N<v;N++)I[N]=~y.g[N];return new o(I,~y.h).add(g)}t.abs=function(){return P(this)?b(this):this},t.add=function(y){const v=Math.max(this.g.length,y.g.length),I=[];let N=0;for(let S=0;S<=v;S++){let k=N+(this.i(S)&65535)+(y.i(S)&65535),_=(k>>>16)+(this.i(S)>>>16)+(y.i(S)>>>16);N=_>>>16,k&=65535,_&=65535,I[S]=_<<16|k}return new o(I,I[I.length-1]&-2147483648?-1:0)};function T(y,v){return y.add(b(v))}t.j=function(y){if(C(this)||C(y))return p;if(P(this))return P(y)?b(this).j(b(y)):b(b(this).j(y));if(P(y))return b(this.j(b(y)));if(this.l(E)<0&&y.l(E)<0)return d(this.m()*y.m());const v=this.g.length+y.g.length,I=[];for(var N=0;N<2*v;N++)I[N]=0;for(N=0;N<this.g.length;N++)for(let S=0;S<y.g.length;S++){const k=this.i(N)>>>16,_=this.i(N)&65535,ee=y.i(S)>>>16,ge=y.i(S)&65535;I[2*N+2*S]+=_*ge,x(I,2*N+2*S),I[2*N+2*S+1]+=k*ge,x(I,2*N+2*S+1),I[2*N+2*S+1]+=_*ee,x(I,2*N+2*S+1),I[2*N+2*S+2]+=k*ee,x(I,2*N+2*S+2)}for(y=0;y<v;y++)I[y]=I[2*y+1]<<16|I[2*y];for(y=v;y<2*v;y++)I[y]=0;return new o(I,0)};function x(y,v){for(;(y[v]&65535)!=y[v];)y[v+1]+=y[v]>>>16,y[v]&=65535,v++}function A(y,v){this.g=y,this.h=v}function D(y,v){if(C(v))throw Error("division by zero");if(C(y))return new A(p,p);if(P(y))return v=D(b(y),v),new A(b(v.g),b(v.h));if(P(v))return v=D(y,b(v)),new A(b(v.g),v.h);if(y.g.length>30){if(P(y)||P(v))throw Error("slowDivide_ only works with positive integers.");for(var I=g,N=v;N.l(y)<=0;)I=V(I),N=V(N);var S=O(I,1),k=O(N,1);for(N=O(N,2),I=O(I,2);!C(N);){var _=k.add(N);_.l(y)<=0&&(S=S.add(I),k=_),N=O(N,1),I=O(I,1)}return v=T(y,S.j(v)),new A(S,v)}for(S=p;y.l(v)>=0;){for(I=Math.max(1,Math.floor(y.m()/v.m())),N=Math.ceil(Math.log(I)/Math.LN2),N=N<=48?1:Math.pow(2,N-48),k=d(I),_=k.j(v);P(_)||_.l(y)>0;)I-=N,k=d(I),_=k.j(v);C(k)&&(k=g),S=S.add(k),y=T(y,_)}return new A(S,y)}t.B=function(y){return D(this,y).h},t.and=function(y){const v=Math.max(this.g.length,y.g.length),I=[];for(let N=0;N<v;N++)I[N]=this.i(N)&y.i(N);return new o(I,this.h&y.h)},t.or=function(y){const v=Math.max(this.g.length,y.g.length),I=[];for(let N=0;N<v;N++)I[N]=this.i(N)|y.i(N);return new o(I,this.h|y.h)},t.xor=function(y){const v=Math.max(this.g.length,y.g.length),I=[];for(let N=0;N<v;N++)I[N]=this.i(N)^y.i(N);return new o(I,this.h^y.h)};function V(y){const v=y.g.length+1,I=[];for(let N=0;N<v;N++)I[N]=y.i(N)<<1|y.i(N-1)>>>31;return new o(I,y.h)}function O(y,v){const I=v>>5;v%=32;const N=y.g.length-I,S=[];for(let k=0;k<N;k++)S[k]=v>0?y.i(k+I)>>>v|y.i(k+I+1)<<32-v:y.i(k+I);return new o(S,y.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,C1=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=f,Ur=o}).apply(typeof e0<"u"?e0:typeof self<"u"?self:typeof window<"u"?window:{});var bl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var P1,Uo,R1,Ql,Gh,j1,D1,L1;(function(){var t,e=Object.defineProperty;function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof bl=="object"&&bl];for(var h=0;h<a.length;++h){var m=a[h];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=n(this);function s(a,h){if(h)e:{var m=r;a=a.split(".");for(var w=0;w<a.length-1;w++){var j=a[w];if(!(j in m))break e;m=m[j]}a=a[a.length-1],w=m[a],h=h(w),h!=w&&h!=null&&e(m,a,{configurable:!0,writable:!0,value:h})}}s("Symbol.dispose",function(a){return a||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(a){return a||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(a){return a||function(h){var m=[],w;for(w in h)Object.prototype.hasOwnProperty.call(h,w)&&m.push([w,h[w]]);return m}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function c(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function u(a,h,m){return a.call.apply(a.bind,arguments)}function d(a,h,m){return d=u,d.apply(null,arguments)}function f(a,h){var m=Array.prototype.slice.call(arguments,1);return function(){var w=m.slice();return w.push.apply(w,arguments),a.apply(this,w)}}function p(a,h){function m(){}m.prototype=h.prototype,a.Z=h.prototype,a.prototype=new m,a.prototype.constructor=a,a.Ob=function(w,j,M){for(var G=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)G[ce-2]=arguments[ce];return h.prototype[j].apply(w,G)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?a=>a&&AsyncContext.Snapshot.wrap(a):a=>a;function E(a){const h=a.length;if(h>0){const m=Array(h);for(let w=0;w<h;w++)m[w]=a[w];return m}return[]}function C(a,h){for(let w=1;w<arguments.length;w++){const j=arguments[w];var m=typeof j;if(m=m!="object"?m:j?Array.isArray(j)?"array":m:"null",m=="array"||m=="object"&&typeof j.length=="number"){m=a.length||0;const M=j.length||0;a.length=m+M;for(let G=0;G<M;G++)a[m+G]=j[G]}else a.push(j)}}class P{constructor(h,m){this.i=h,this.j=m,this.h=0,this.g=null}get(){let h;return this.h>0?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function b(a){o.setTimeout(()=>{throw a},0)}function T(){var a=y;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class x{constructor(){this.h=this.g=null}add(h,m){const w=A.get();w.set(h,m),this.h?this.h.next=w:this.g=w,this.h=w}}var A=new P(()=>new D,a=>a.reset());class D{constructor(){this.next=this.g=this.h=null}set(h,m){this.h=h,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let V,O=!1,y=new x,v=()=>{const a=Promise.resolve(void 0);V=()=>{a.then(I)}};function I(){for(var a;a=T();){try{a.h.call(a.g)}catch(m){b(m)}var h=A;h.j(a),h.h<100&&(h.h++,a.next=h.g,h.g=a)}O=!1}function N(){this.u=this.u,this.C=this.C}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function S(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}S.prototype.h=function(){this.defaultPrevented=!0};var k=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const m=()=>{};o.addEventListener("test",m,h),o.removeEventListener("test",m,h)}catch{}return a}();function _(a){return/^[\s\xa0]*$/.test(a)}function ee(a,h){S.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a&&this.init(a,h)}p(ee,S),ee.prototype.init=function(a,h){const m=this.type=a.type,w=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget,h||(m=="mouseover"?h=a.fromElement:m=="mouseout"&&(h=a.toElement)),this.relatedTarget=h,w?(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=a.pointerType,this.state=a.state,this.i=a,a.defaultPrevented&&ee.Z.h.call(this)},ee.prototype.h=function(){ee.Z.h.call(this);const a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var ge="closure_listenable_"+(Math.random()*1e6|0),wt=0;function Vn(a,h,m,w,j){this.listener=a,this.proxy=null,this.src=h,this.type=m,this.capture=!!w,this.ha=j,this.key=++wt,this.da=this.fa=!1}function Q(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function re(a,h,m){for(const w in a)h.call(m,a[w],w,a)}function ae(a,h){for(const m in a)h.call(void 0,a[m],m,a)}function _e(a){const h={};for(const m in a)h[m]=a[m];return h}const Ie="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rn(a,h){let m,w;for(let j=1;j<arguments.length;j++){w=arguments[j];for(m in w)a[m]=w[m];for(let M=0;M<Ie.length;M++)m=Ie[M],Object.prototype.hasOwnProperty.call(w,m)&&(a[m]=w[m])}}function lt(a){this.src=a,this.g={},this.h=0}lt.prototype.add=function(a,h,m,w,j){const M=a.toString();a=this.g[M],a||(a=this.g[M]=[],this.h++);const G=_t(a,h,w,j);return G>-1?(h=a[G],m||(h.fa=!1)):(h=new Vn(h,this.src,M,!!w,j),h.fa=m,a.push(h)),h};function sn(a,h){const m=h.type;if(m in a.g){var w=a.g[m],j=Array.prototype.indexOf.call(w,h,void 0),M;(M=j>=0)&&Array.prototype.splice.call(w,j,1),M&&(Q(h),a.g[m].length==0&&(delete a.g[m],a.h--))}}function _t(a,h,m,w){for(let j=0;j<a.length;++j){const M=a[j];if(!M.da&&M.listener==h&&M.capture==!!m&&M.ha==w)return j}return-1}var Wt="closure_lm_"+(Math.random()*1e6|0),as={};function Xs(a,h,m,w,j){if(Array.isArray(h)){for(let M=0;M<h.length;M++)Xs(a,h[M],m,w,j);return null}return m=L(m),a&&a[ge]?a.J(h,m,c(w)?!!w.capture:!1,j):ao(a,h,m,!1,w,j)}function ao(a,h,m,w,j,M){if(!h)throw Error("Invalid event type");const G=c(j)?!!j.capture:!!j;let ce=cs(a);if(ce||(a[Wt]=ce=new lt(a)),m=ce.add(h,m,w,G,M),m.proxy)return m;if(w=lo(),m.proxy=w,w.src=a,w.listener=m,a.addEventListener)k||(j=G),j===void 0&&(j=!1),a.addEventListener(h.toString(),w,j);else if(a.attachEvent)a.attachEvent(Js(h.toString()),w);else if(a.addListener&&a.removeListener)a.addListener(w);else throw Error("addEventListener and attachEvent are unavailable.");return m}function lo(){function a(m){return h.call(a.src,a.listener,m)}const h=co;return a}function dr(a,h,m,w,j){if(Array.isArray(h))for(var M=0;M<h.length;M++)dr(a,h[M],m,w,j);else w=c(w)?!!w.capture:!!w,m=L(m),a&&a[ge]?(a=a.i,M=String(h).toString(),M in a.g&&(h=a.g[M],m=_t(h,m,w,j),m>-1&&(Q(h[m]),Array.prototype.splice.call(h,m,1),h.length==0&&(delete a.g[M],a.h--)))):a&&(a=cs(a))&&(h=a.g[h.toString()],a=-1,h&&(a=_t(h,m,w,j)),(m=a>-1?h[a]:null)&&ls(m))}function ls(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[ge])sn(h.i,a);else{var m=a.type,w=a.proxy;h.removeEventListener?h.removeEventListener(m,w,a.capture):h.detachEvent?h.detachEvent(Js(m),w):h.addListener&&h.removeListener&&h.removeListener(w),(m=cs(h))?(sn(m,a),m.h==0&&(m.src=null,h[Wt]=null)):Q(a)}}}function Js(a){return a in as?as[a]:as[a]="on"+a}function co(a,h){if(a.da)a=!0;else{h=new ee(h,this);const m=a.listener,w=a.ha||a.src;a.fa&&ls(a),a=m.call(w,h)}return a}function cs(a){return a=a[Wt],a instanceof lt?a:null}var us="__closure_events_fn_"+(Math.random()*1e9>>>0);function L(a){return typeof a=="function"?a:(a[us]||(a[us]=function(h){return a.handleEvent(h)}),a[us])}function B(){N.call(this),this.i=new lt(this),this.M=this,this.G=null}p(B,N),B.prototype[ge]=!0,B.prototype.removeEventListener=function(a,h,m,w){dr(this,a,h,m,w)};function U(a,h){var m,w=a.G;if(w)for(m=[];w;w=w.G)m.push(w);if(a=a.M,w=h.type||h,typeof h=="string")h=new S(h,a);else if(h instanceof S)h.target=h.target||a;else{var j=h;h=new S(w,a),rn(h,j)}j=!0;let M,G;if(m)for(G=m.length-1;G>=0;G--)M=h.g=m[G],j=F(M,w,!0,h)&&j;if(M=h.g=a,j=F(M,w,!0,h)&&j,j=F(M,w,!1,h)&&j,m)for(G=0;G<m.length;G++)M=h.g=m[G],j=F(M,w,!1,h)&&j}B.prototype.N=function(){if(B.Z.N.call(this),this.i){var a=this.i;for(const h in a.g){const m=a.g[h];for(let w=0;w<m.length;w++)Q(m[w]);delete a.g[h],a.h--}}this.G=null},B.prototype.J=function(a,h,m,w){return this.i.add(String(a),h,!1,m,w)},B.prototype.K=function(a,h,m,w){return this.i.add(String(a),h,!0,m,w)};function F(a,h,m,w){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();let j=!0;for(let M=0;M<h.length;++M){const G=h[M];if(G&&!G.da&&G.capture==m){const ce=G.listener,He=G.ha||G.src;G.fa&&sn(a.i,G),j=ce.call(He,w)!==!1&&j}}return j&&!w.defaultPrevented}function W(a,h){if(typeof a!="function")if(a&&typeof a.handleEvent=="function")a=d(a.handleEvent,a);else throw Error("Invalid listener argument");return Number(h)>2147483647?-1:o.setTimeout(a,h||0)}function H(a){a.g=W(()=>{a.g=null,a.i&&(a.i=!1,H(a))},a.l);const h=a.h;a.h=null,a.m.apply(null,h)}class q extends N{constructor(h,m){super(),this.m=h,this.l=m,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:H(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function J(a){N.call(this),this.h=a,this.g={}}p(J,N);var ne=[];function ue(a){re(a.g,function(h,m){this.g.hasOwnProperty(m)&&ls(h)},a),a.g={}}J.prototype.N=function(){J.Z.N.call(this),ue(this)},J.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Lt=o.JSON.stringify,zE=o.JSON.parse,qE=class{stringify(a){return o.JSON.stringify(a,void 0)}parse(a){return o.JSON.parse(a,void 0)}};function xp(){}function Ep(){}var uo={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Bu(){S.call(this,"d")}p(Bu,S);function $u(){S.call(this,"c")}p($u,S);var ds={},Tp=null;function Ya(){return Tp=Tp||new B}ds.Ia="serverreachability";function Ip(a){S.call(this,ds.Ia,a)}p(Ip,S);function ho(a){const h=Ya();U(h,new Ip(h))}ds.STAT_EVENT="statevent";function bp(a,h){S.call(this,ds.STAT_EVENT,a),this.stat=h}p(bp,S);function xt(a){const h=Ya();U(h,new bp(h,a))}ds.Ja="timingevent";function Sp(a,h){S.call(this,ds.Ja,a),this.size=h}p(Sp,S);function fo(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){a()},h)}function mo(){this.g=!0}mo.prototype.ua=function(){this.g=!1};function HE(a,h,m,w,j,M){a.info(function(){if(a.g)if(M){var G="",ce=M.split("&");for(let xe=0;xe<ce.length;xe++){var He=ce[xe].split("=");if(He.length>1){const Je=He[0];He=He[1];const vn=Je.split("_");G=vn.length>=2&&vn[1]=="type"?G+(Je+"="+He+"&"):G+(Je+"=redacted&")}}}else G=null;else G=M;return"XMLHTTP REQ ("+w+") [attempt "+j+"]: "+h+`
`+m+`
`+G})}function WE(a,h,m,w,j,M,G){a.info(function(){return"XMLHTTP RESP ("+w+") [ attempt "+j+"]: "+h+`
`+m+`
`+M+" "+G})}function Zs(a,h,m,w){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+GE(a,m)+(w?" "+w:"")})}function KE(a,h){a.info(function(){return"TIMEOUT: "+h})}mo.prototype.info=function(){};function GE(a,h){if(!a.g)return h;if(!h)return null;try{const M=JSON.parse(h);if(M){for(a=0;a<M.length;a++)if(Array.isArray(M[a])){var m=M[a];if(!(m.length<2)){var w=m[1];if(Array.isArray(w)&&!(w.length<1)){var j=w[0];if(j!="noop"&&j!="stop"&&j!="close")for(let G=1;G<w.length;G++)w[G]=""}}}}return Lt(M)}catch{return h}}var Xa={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ap={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},kp;function zu(){}p(zu,xp),zu.prototype.g=function(){return new XMLHttpRequest},kp=new zu;function po(a){return encodeURIComponent(String(a))}function QE(a){var h=1;a=a.split(":");const m=[];for(;h>0&&a.length;)m.push(a.shift()),h--;return a.length&&m.push(a.join(":")),m}function hr(a,h,m,w){this.j=a,this.i=h,this.l=m,this.S=w||1,this.V=new J(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Np}function Np(){this.i=null,this.g="",this.h=!1}var Cp={},qu={};function Hu(a,h,m){a.M=1,a.A=Za(yn(h)),a.u=m,a.R=!0,Pp(a,null)}function Pp(a,h){a.F=Date.now(),Ja(a),a.B=yn(a.A);var m=a.B,w=a.S;Array.isArray(w)||(w=[String(w)]),qp(m.i,"t",w),a.C=0,m=a.j.L,a.h=new Np,a.g=lg(a.j,m?h:null,!a.u),a.P>0&&(a.O=new q(d(a.Y,a,a.g),a.P)),h=a.V,m=a.g,w=a.ba;var j="readystatechange";Array.isArray(j)||(j&&(ne[0]=j.toString()),j=ne);for(let M=0;M<j.length;M++){const G=Xs(m,j[M],w||h.handleEvent,!1,h.h||h);if(!G)break;h.g[G.key]=G}h=a.J?_e(a.J):{},a.u?(a.v||(a.v="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.B,a.v,a.u,h)):(a.v="GET",a.g.ea(a.B,a.v,null,h)),ho(),HE(a.i,a.v,a.B,a.l,a.S,a.u)}hr.prototype.ba=function(a){a=a.target;const h=this.O;h&&pr(a)==3?h.j():this.Y(a)},hr.prototype.Y=function(a){try{if(a==this.g)e:{const ce=pr(this.g),He=this.g.ya(),xe=this.g.ca();if(!(ce<3)&&(ce!=3||this.g&&(this.h.h||this.g.la()||Xp(this.g)))){this.K||ce!=4||He==7||(He==8||xe<=0?ho(3):ho(2)),Wu(this);var h=this.g.ca();this.X=h;var m=YE(this);if(this.o=h==200,WE(this.i,this.v,this.B,this.l,this.S,ce,h),this.o){if(this.U&&!this.L){t:{if(this.g){var w,j=this.g;if((w=j.g?j.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(w)){var M=w;break t}}M=null}if(a=M)Zs(this.i,this.l,a,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ku(this,a);else{this.o=!1,this.m=3,xt(12),hs(this),go(this);break e}}if(this.R){a=!0;let Je;for(;!this.K&&this.C<m.length;)if(Je=XE(this,m),Je==qu){ce==4&&(this.m=4,xt(14),a=!1),Zs(this.i,this.l,null,"[Incomplete Response]");break}else if(Je==Cp){this.m=4,xt(15),Zs(this.i,this.l,m,"[Invalid Chunk]"),a=!1;break}else Zs(this.i,this.l,Je,null),Ku(this,Je);if(Rp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ce!=4||m.length!=0||this.h.h||(this.m=1,xt(16),a=!1),this.o=this.o&&a,!a)Zs(this.i,this.l,m,"[Invalid Chunked Response]"),hs(this),go(this);else if(m.length>0&&!this.W){this.W=!0;var G=this.j;G.g==this&&G.aa&&!G.P&&(G.j.info("Great, no buffering proxy detected. Bytes received: "+m.length),td(G),G.P=!0,xt(11))}}else Zs(this.i,this.l,m,null),Ku(this,m);ce==4&&hs(this),this.o&&!this.K&&(ce==4?sg(this.j,this):(this.o=!1,Ja(this)))}else d2(this.g),h==400&&m.indexOf("Unknown SID")>0?(this.m=3,xt(12)):(this.m=0,xt(13)),hs(this),go(this)}}}catch{}finally{}};function YE(a){if(!Rp(a))return a.g.la();const h=Xp(a.g);if(h==="")return"";let m="";const w=h.length,j=pr(a.g)==4;if(!a.h.i){if(typeof TextDecoder>"u")return hs(a),go(a),"";a.h.i=new o.TextDecoder}for(let M=0;M<w;M++)a.h.h=!0,m+=a.h.i.decode(h[M],{stream:!(j&&M==w-1)});return h.length=0,a.h.g+=m,a.C=0,a.h.g}function Rp(a){return a.g?a.v=="GET"&&a.M!=2&&a.j.Aa:!1}function XE(a,h){var m=a.C,w=h.indexOf(`
`,m);return w==-1?qu:(m=Number(h.substring(m,w)),isNaN(m)?Cp:(w+=1,w+m>h.length?qu:(h=h.slice(w,w+m),a.C=w+m,h)))}hr.prototype.cancel=function(){this.K=!0,hs(this)};function Ja(a){a.T=Date.now()+a.H,jp(a,a.H)}function jp(a,h){if(a.D!=null)throw Error("WatchDog timer not null");a.D=fo(d(a.aa,a),h)}function Wu(a){a.D&&(o.clearTimeout(a.D),a.D=null)}hr.prototype.aa=function(){this.D=null;const a=Date.now();a-this.T>=0?(KE(this.i,this.B),this.M!=2&&(ho(),xt(17)),hs(this),this.m=2,go(this)):jp(this,this.T-a)};function go(a){a.j.I==0||a.K||sg(a.j,a)}function hs(a){Wu(a);var h=a.O;h&&typeof h.dispose=="function"&&h.dispose(),a.O=null,ue(a.V),a.g&&(h=a.g,a.g=null,h.abort(),h.dispose())}function Ku(a,h){try{var m=a.j;if(m.I!=0&&(m.g==a||Gu(m.h,a))){if(!a.L&&Gu(m.h,a)&&m.I==3){try{var w=m.Ba.g.parse(h)}catch{w=null}if(Array.isArray(w)&&w.length==3){var j=w;if(j[0]==0){e:if(!m.v){if(m.g)if(m.g.F+3e3<a.F)sl(m),nl(m);else break e;ed(m),xt(18)}}else m.xa=j[1],0<m.xa-m.K&&j[2]<37500&&m.F&&m.A==0&&!m.C&&(m.C=fo(d(m.Va,m),6e3));Mp(m.h)<=1&&m.ta&&(m.ta=void 0)}else ms(m,11)}else if((a.L||m.g==a)&&sl(m),!_(h))for(j=m.Ba.g.parse(h),h=0;h<j.length;h++){let xe=j[h];const Je=xe[0];if(!(Je<=m.K))if(m.K=Je,xe=xe[1],m.I==2)if(xe[0]=="c"){m.M=xe[1],m.ba=xe[2];const vn=xe[3];vn!=null&&(m.ka=vn,m.j.info("VER="+m.ka));const ps=xe[4];ps!=null&&(m.za=ps,m.j.info("SVER="+m.za));const gr=xe[5];gr!=null&&typeof gr=="number"&&gr>0&&(w=1.5*gr,m.O=w,m.j.info("backChannelRequestTimeoutMs_="+w)),w=m;const yr=a.g;if(yr){const ol=yr.g?yr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ol){var M=w.h;M.g||ol.indexOf("spdy")==-1&&ol.indexOf("quic")==-1&&ol.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(Qu(M,M.h),M.h=null))}if(w.G){const nd=yr.g?yr.g.getResponseHeader("X-HTTP-Session-Id"):null;nd&&(w.wa=nd,be(w.J,w.G,nd))}}m.I=3,m.l&&m.l.ra(),m.aa&&(m.T=Date.now()-a.F,m.j.info("Handshake RTT: "+m.T+"ms")),w=m;var G=a;if(w.na=ag(w,w.L?w.ba:null,w.W),G.L){Vp(w.h,G);var ce=G,He=w.O;He&&(ce.H=He),ce.D&&(Wu(ce),Ja(ce)),w.g=G}else ng(w);m.i.length>0&&rl(m)}else xe[0]!="stop"&&xe[0]!="close"||ms(m,7);else m.I==3&&(xe[0]=="stop"||xe[0]=="close"?xe[0]=="stop"?ms(m,7):Zu(m):xe[0]!="noop"&&m.l&&m.l.qa(xe),m.A=0)}}ho(4)}catch{}}var JE=class{constructor(a,h){this.g=a,this.map=h}};function Dp(a){this.l=a||10,o.PerformanceNavigationTiming?(a=o.performance.getEntriesByType("navigation"),a=a.length>0&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Lp(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Mp(a){return a.h?1:a.g?a.g.size:0}function Gu(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function Qu(a,h){a.g?a.g.add(h):a.h=h}function Vp(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}Dp.prototype.cancel=function(){if(this.i=Op(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function Op(a){if(a.h!=null)return a.i.concat(a.h.G);if(a.g!=null&&a.g.size!==0){let h=a.i;for(const m of a.g.values())h=h.concat(m.G);return h}return E(a.i)}var Fp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ZE(a,h){if(a){a=a.split("&");for(let m=0;m<a.length;m++){const w=a[m].indexOf("=");let j,M=null;w>=0?(j=a[m].substring(0,w),M=a[m].substring(w+1)):j=a[m],h(j,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function fr(a){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let h;a instanceof fr?(this.l=a.l,yo(this,a.j),this.o=a.o,this.g=a.g,vo(this,a.u),this.h=a.h,Yu(this,Hp(a.i)),this.m=a.m):a&&(h=String(a).match(Fp))?(this.l=!1,yo(this,h[1]||"",!0),this.o=wo(h[2]||""),this.g=wo(h[3]||"",!0),vo(this,h[4]),this.h=wo(h[5]||"",!0),Yu(this,h[6]||"",!0),this.m=wo(h[7]||"")):(this.l=!1,this.i=new xo(null,this.l))}fr.prototype.toString=function(){const a=[];var h=this.j;h&&a.push(_o(h,Up,!0),":");var m=this.g;return(m||h=="file")&&(a.push("//"),(h=this.o)&&a.push(_o(h,Up,!0),"@"),a.push(po(m).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.u,m!=null&&a.push(":",String(m))),(m=this.h)&&(this.g&&m.charAt(0)!="/"&&a.push("/"),a.push(_o(m,m.charAt(0)=="/"?n2:t2,!0))),(m=this.i.toString())&&a.push("?",m),(m=this.m)&&a.push("#",_o(m,s2)),a.join("")},fr.prototype.resolve=function(a){const h=yn(this);let m=!!a.j;m?yo(h,a.j):m=!!a.o,m?h.o=a.o:m=!!a.g,m?h.g=a.g:m=a.u!=null;var w=a.h;if(m)vo(h,a.u);else if(m=!!a.h){if(w.charAt(0)!="/")if(this.g&&!this.h)w="/"+w;else{var j=h.h.lastIndexOf("/");j!=-1&&(w=h.h.slice(0,j+1)+w)}if(j=w,j==".."||j==".")w="";else if(j.indexOf("./")!=-1||j.indexOf("/.")!=-1){w=j.lastIndexOf("/",0)==0,j=j.split("/");const M=[];for(let G=0;G<j.length;){const ce=j[G++];ce=="."?w&&G==j.length&&M.push(""):ce==".."?((M.length>1||M.length==1&&M[0]!="")&&M.pop(),w&&G==j.length&&M.push("")):(M.push(ce),w=!0)}w=M.join("/")}else w=j}return m?h.h=w:m=a.i.toString()!=="",m?Yu(h,Hp(a.i)):m=!!a.m,m&&(h.m=a.m),h};function yn(a){return new fr(a)}function yo(a,h,m){a.j=m?wo(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function vo(a,h){if(h){if(h=Number(h),isNaN(h)||h<0)throw Error("Bad port number "+h);a.u=h}else a.u=null}function Yu(a,h,m){h instanceof xo?(a.i=h,i2(a.i,a.l)):(m||(h=_o(h,r2)),a.i=new xo(h,a.l))}function be(a,h,m){a.i.set(h,m)}function Za(a){return be(a,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),a}function wo(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function _o(a,h,m){return typeof a=="string"?(a=encodeURI(a).replace(h,e2),m&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function e2(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Up=/[#\/\?@]/g,t2=/[#\?:]/g,n2=/[#\?]/g,r2=/[#\?@]/g,s2=/#/g;function xo(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function fs(a){a.g||(a.g=new Map,a.h=0,a.i&&ZE(a.i,function(h,m){a.add(decodeURIComponent(h.replace(/\+/g," ")),m)}))}t=xo.prototype,t.add=function(a,h){fs(this),this.i=null,a=ei(this,a);let m=this.g.get(a);return m||this.g.set(a,m=[]),m.push(h),this.h+=1,this};function Bp(a,h){fs(a),h=ei(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function $p(a,h){return fs(a),h=ei(a,h),a.g.has(h)}t.forEach=function(a,h){fs(this),this.g.forEach(function(m,w){m.forEach(function(j){a.call(h,j,w,this)},this)},this)};function zp(a,h){fs(a);let m=[];if(typeof h=="string")$p(a,h)&&(m=m.concat(a.g.get(ei(a,h))));else for(a=Array.from(a.g.values()),h=0;h<a.length;h++)m=m.concat(a[h]);return m}t.set=function(a,h){return fs(this),this.i=null,a=ei(this,a),$p(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},t.get=function(a,h){return a?(a=zp(this,a),a.length>0?String(a[0]):h):h};function qp(a,h,m){Bp(a,h),m.length>0&&(a.i=null,a.g.set(ei(a,h),E(m)),a.h+=m.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],h=Array.from(this.g.keys());for(let w=0;w<h.length;w++){var m=h[w];const j=po(m);m=zp(this,m);for(let M=0;M<m.length;M++){let G=j;m[M]!==""&&(G+="="+po(m[M])),a.push(G)}}return this.i=a.join("&")};function Hp(a){const h=new xo;return h.i=a.i,a.g&&(h.g=new Map(a.g),h.h=a.h),h}function ei(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function i2(a,h){h&&!a.j&&(fs(a),a.i=null,a.g.forEach(function(m,w){const j=w.toLowerCase();w!=j&&(Bp(this,w),qp(this,j,m))},a)),a.j=h}function o2(a,h){const m=new mo;if(o.Image){const w=new Image;w.onload=f(mr,m,"TestLoadImage: loaded",!0,h,w),w.onerror=f(mr,m,"TestLoadImage: error",!1,h,w),w.onabort=f(mr,m,"TestLoadImage: abort",!1,h,w),w.ontimeout=f(mr,m,"TestLoadImage: timeout",!1,h,w),o.setTimeout(function(){w.ontimeout&&w.ontimeout()},1e4),w.src=a}else h(!1)}function a2(a,h){const m=new mo,w=new AbortController,j=setTimeout(()=>{w.abort(),mr(m,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:w.signal}).then(M=>{clearTimeout(j),M.ok?mr(m,"TestPingServer: ok",!0,h):mr(m,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(j),mr(m,"TestPingServer: error",!1,h)})}function mr(a,h,m,w,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),w(m)}catch{}}function l2(){this.g=new qE}function Xu(a){this.i=a.Sb||null,this.h=a.ab||!1}p(Xu,xp),Xu.prototype.g=function(){return new el(this.i,this.h)};function el(a,h){B.call(this),this.H=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(el,B),t=el.prototype,t.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=a,this.D=h,this.readyState=1,To(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const h={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};a&&(h.body=a),(this.H||o).fetch(new Request(this.D,h)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Eo(this)),this.readyState=0},t.Pa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,To(this)),this.g&&(this.readyState=3,To(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Wp(this)}else a.text().then(this.Oa.bind(this),this.ga.bind(this))};function Wp(a){a.j.read().then(a.Ma.bind(a)).catch(a.ga.bind(a))}t.Ma=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.B.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?Eo(this):To(this),this.readyState==3&&Wp(this)}},t.Oa=function(a){this.g&&(this.response=this.responseText=a,Eo(this))},t.Na=function(a){this.g&&(this.response=a,Eo(this))},t.ga=function(){this.g&&Eo(this)};function Eo(a){a.readyState=4,a.l=null,a.j=null,a.B=null,To(a)}t.setRequestHeader=function(a,h){this.A.append(a,h)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],h=this.h.entries();for(var m=h.next();!m.done;)m=m.value,a.push(m[0]+": "+m[1]),m=h.next();return a.join(`\r
`)};function To(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(el.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Kp(a){let h="";return re(a,function(m,w){h+=w,h+=":",h+=m,h+=`\r
`}),h}function Ju(a,h,m){e:{for(w in m){var w=!1;break e}w=!0}w||(m=Kp(m),typeof a=="string"?m!=null&&po(m):be(a,h,m))}function De(a){B.call(this),this.headers=new Map,this.L=a||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(De,B);var c2=/^https?$/i,u2=["POST","PUT"];t=De.prototype,t.Fa=function(a){this.H=a},t.ea=function(a,h,m,w){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():kp.g(),this.g.onreadystatechange=g(d(this.Ca,this));try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(M){Gp(this,M);return}if(a=m||"",m=new Map(this.headers),w)if(Object.getPrototypeOf(w)===Object.prototype)for(var j in w)m.set(j,w[j]);else if(typeof w.keys=="function"&&typeof w.get=="function")for(const M of w.keys())m.set(M,w.get(M));else throw Error("Unknown input type for opt_headers: "+String(w));w=Array.from(m.keys()).find(M=>M.toLowerCase()=="content-type"),j=o.FormData&&a instanceof o.FormData,!(Array.prototype.indexOf.call(u2,h,void 0)>=0)||w||j||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,G]of m)this.g.setRequestHeader(M,G);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(a),this.v=!1}catch(M){Gp(this,M)}};function Gp(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.o=5,Qp(a),tl(a)}function Qp(a){a.A||(a.A=!0,U(a,"complete"),U(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=a||7,U(this,"complete"),U(this,"abort"),tl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),tl(this,!0)),De.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Yp(this):this.Xa())},t.Xa=function(){Yp(this)};function Yp(a){if(a.h&&typeof i<"u"){if(a.v&&pr(a)==4)setTimeout(a.Ca.bind(a),0);else if(U(a,"readystatechange"),pr(a)==4){a.h=!1;try{const M=a.ca();e:switch(M){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var m;if(!(m=h)){var w;if(w=M===0){let G=String(a.D).match(Fp)[1]||null;!G&&o.self&&o.self.location&&(G=o.self.location.protocol.slice(0,-1)),w=!c2.test(G?G.toLowerCase():"")}m=w}if(m)U(a,"complete"),U(a,"success");else{a.o=6;try{var j=pr(a)>2?a.g.statusText:""}catch{j=""}a.l=j+" ["+a.ca()+"]",Qp(a)}}finally{tl(a)}}}}function tl(a,h){if(a.g){a.m&&(clearTimeout(a.m),a.m=null);const m=a.g;a.g=null,h||U(a,"ready");try{m.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function pr(a){return a.g?a.g.readyState:0}t.ca=function(){try{return pr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),zE(h)}};function Xp(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.F){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function d2(a){const h={};a=(a.g&&pr(a)>=2&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let w=0;w<a.length;w++){if(_(a[w]))continue;var m=QE(a[w]);const j=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const M=h[j]||[];h[j]=M,M.push(m)}ae(h,function(w){return w.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Io(a,h,m){return m&&m.internalChannelParams&&m.internalChannelParams[a]||h}function Jp(a){this.za=0,this.i=[],this.j=new mo,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Io("failFast",!1,a),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Io("baseRetryDelayMs",5e3,a),this.Za=Io("retryDelaySeedMs",1e4,a),this.Ta=Io("forwardChannelMaxRetries",2,a),this.va=Io("forwardChannelRequestTimeoutMs",2e4,a),this.ma=a&&a.xmlHttpFactory||void 0,this.Ua=a&&a.Rb||void 0,this.Aa=a&&a.useFetchStreams||!1,this.O=void 0,this.L=a&&a.supportsCrossDomainXhr||!1,this.M="",this.h=new Dp(a&&a.concurrentRequestLimit),this.Ba=new l2,this.S=a&&a.fastHandshake||!1,this.R=a&&a.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=a&&a.Pb||!1,a&&a.ua&&this.j.ua(),a&&a.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&a&&a.detectBufferingProxy||!1,this.ia=void 0,a&&a.longPollingTimeout&&a.longPollingTimeout>0&&(this.ia=a.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Jp.prototype,t.ka=8,t.I=1,t.connect=function(a,h,m,w){xt(0),this.W=a,this.H=h||{},m&&w!==void 0&&(this.H.OSID=m,this.H.OAID=w),this.F=this.X,this.J=ag(this,null,this.W),rl(this)};function Zu(a){if(Zp(a),a.I==3){var h=a.V++,m=yn(a.J);if(be(m,"SID",a.M),be(m,"RID",h),be(m,"TYPE","terminate"),bo(a,m),h=new hr(a,a.j,h),h.M=2,h.A=Za(yn(m)),m=!1,o.navigator&&o.navigator.sendBeacon)try{m=o.navigator.sendBeacon(h.A.toString(),"")}catch{}!m&&o.Image&&(new Image().src=h.A,m=!0),m||(h.g=lg(h.j,null),h.g.ea(h.A)),h.F=Date.now(),Ja(h)}og(a)}function nl(a){a.g&&(td(a),a.g.cancel(),a.g=null)}function Zp(a){nl(a),a.v&&(o.clearTimeout(a.v),a.v=null),sl(a),a.h.cancel(),a.m&&(typeof a.m=="number"&&o.clearTimeout(a.m),a.m=null)}function rl(a){if(!Lp(a.h)&&!a.m){a.m=!0;var h=a.Ea;V||v(),O||(V(),O=!0),y.add(h,a),a.D=0}}function h2(a,h){return Mp(a.h)>=a.h.j-(a.m?1:0)?!1:a.m?(a.i=h.G.concat(a.i),!0):a.I==1||a.I==2||a.D>=(a.Sa?0:a.Ta)?!1:(a.m=fo(d(a.Ea,a,h),ig(a,a.D)),a.D++,!0)}t.Ea=function(a){if(this.m)if(this.m=null,this.I==1){if(!a){this.V=Math.floor(Math.random()*1e5),a=this.V++;const j=new hr(this,this.j,a);let M=this.o;if(this.U&&(M?(M=_e(M),rn(M,this.U)):M=this.U),this.u!==null||this.R||(j.J=M,M=null),this.S)e:{for(var h=0,m=0;m<this.i.length;m++){t:{var w=this.i[m];if("__data__"in w.map&&(w=w.map.__data__,typeof w=="string")){w=w.length;break t}w=void 0}if(w===void 0)break;if(h+=w,h>4096){h=m;break e}if(h===4096||m===this.i.length-1){h=m+1;break e}}h=1e3}else h=1e3;h=tg(this,j,h),m=yn(this.J),be(m,"RID",a),be(m,"CVER",22),this.G&&be(m,"X-HTTP-Session-Id",this.G),bo(this,m),M&&(this.R?h="headers="+po(Kp(M))+"&"+h:this.u&&Ju(m,this.u,M)),Qu(this.h,j),this.Ra&&be(m,"TYPE","init"),this.S?(be(m,"$req",h),be(m,"SID","null"),j.U=!0,Hu(j,m,null)):Hu(j,m,h),this.I=2}}else this.I==3&&(a?eg(this,a):this.i.length==0||Lp(this.h)||eg(this))};function eg(a,h){var m;h?m=h.l:m=a.V++;const w=yn(a.J);be(w,"SID",a.M),be(w,"RID",m),be(w,"AID",a.K),bo(a,w),a.u&&a.o&&Ju(w,a.u,a.o),m=new hr(a,a.j,m,a.D+1),a.u===null&&(m.J=a.o),h&&(a.i=h.G.concat(a.i)),h=tg(a,m,1e3),m.H=Math.round(a.va*.5)+Math.round(a.va*.5*Math.random()),Qu(a.h,m),Hu(m,w,h)}function bo(a,h){a.H&&re(a.H,function(m,w){be(h,w,m)}),a.l&&re({},function(m,w){be(h,w,m)})}function tg(a,h,m){m=Math.min(a.i.length,m);const w=a.l?d(a.l.Ka,a.l,a):null;e:{var j=a.i;let ce=-1;for(;;){const He=["count="+m];ce==-1?m>0?(ce=j[0].g,He.push("ofs="+ce)):ce=0:He.push("ofs="+ce);let xe=!0;for(let Je=0;Je<m;Je++){var M=j[Je].g;const vn=j[Je].map;if(M-=ce,M<0)ce=Math.max(0,j[Je].g-100),xe=!1;else try{M="req"+M+"_"||"";try{var G=vn instanceof Map?vn:Object.entries(vn);for(const[ps,gr]of G){let yr=gr;c(gr)&&(yr=Lt(gr)),He.push(M+ps+"="+encodeURIComponent(yr))}}catch(ps){throw He.push(M+"type="+encodeURIComponent("_badmap")),ps}}catch{w&&w(vn)}}if(xe){G=He.join("&");break e}}G=void 0}return a=a.i.splice(0,m),h.G=a,G}function ng(a){if(!a.g&&!a.v){a.Y=1;var h=a.Da;V||v(),O||(V(),O=!0),y.add(h,a),a.A=0}}function ed(a){return a.g||a.v||a.A>=3?!1:(a.Y++,a.v=fo(d(a.Da,a),ig(a,a.A)),a.A++,!0)}t.Da=function(){if(this.v=null,rg(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var a=4*this.T;this.j.info("BP detection timer enabled: "+a),this.B=fo(d(this.Wa,this),a)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,xt(10),nl(this),rg(this))};function td(a){a.B!=null&&(o.clearTimeout(a.B),a.B=null)}function rg(a){a.g=new hr(a,a.j,"rpc",a.Y),a.u===null&&(a.g.J=a.o),a.g.P=0;var h=yn(a.na);be(h,"RID","rpc"),be(h,"SID",a.M),be(h,"AID",a.K),be(h,"CI",a.F?"0":"1"),!a.F&&a.ia&&be(h,"TO",a.ia),be(h,"TYPE","xmlhttp"),bo(a,h),a.u&&a.o&&Ju(h,a.u,a.o),a.O&&(a.g.H=a.O);var m=a.g;a=a.ba,m.M=1,m.A=Za(yn(h)),m.u=null,m.R=!0,Pp(m,a)}t.Va=function(){this.C!=null&&(this.C=null,nl(this),ed(this),xt(19))};function sl(a){a.C!=null&&(o.clearTimeout(a.C),a.C=null)}function sg(a,h){var m=null;if(a.g==h){sl(a),td(a),a.g=null;var w=2}else if(Gu(a.h,h))m=h.G,Vp(a.h,h),w=1;else return;if(a.I!=0){if(h.o)if(w==1){m=h.u?h.u.length:0,h=Date.now()-h.F;var j=a.D;w=Ya(),U(w,new Sp(w,m)),rl(a)}else ng(a);else if(j=h.m,j==3||j==0&&h.X>0||!(w==1&&h2(a,h)||w==2&&ed(a)))switch(m&&m.length>0&&(h=a.h,h.i=h.i.concat(m)),j){case 1:ms(a,5);break;case 4:ms(a,10);break;case 3:ms(a,6);break;default:ms(a,2)}}}function ig(a,h){let m=a.Qa+Math.floor(Math.random()*a.Za);return a.isActive()||(m*=2),m*h}function ms(a,h){if(a.j.info("Error code "+h),h==2){var m=d(a.bb,a),w=a.Ua;const j=!w;w=new fr(w||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||yo(w,"https"),Za(w),j?o2(w.toString(),m):a2(w.toString(),m)}else xt(2);a.I=0,a.l&&a.l.pa(h),og(a),Zp(a)}t.bb=function(a){a?(this.j.info("Successfully pinged google.com"),xt(2)):(this.j.info("Failed to ping google.com"),xt(1))};function og(a){if(a.I=0,a.ja=[],a.l){const h=Op(a.h);(h.length!=0||a.i.length!=0)&&(C(a.ja,h),C(a.ja,a.i),a.h.i.length=0,E(a.i),a.i.length=0),a.l.oa()}}function ag(a,h,m){var w=m instanceof fr?yn(m):new fr(m);if(w.g!="")h&&(w.g=h+"."+w.g),vo(w,w.u);else{var j=o.location;w=j.protocol,h=h?h+"."+j.hostname:j.hostname,j=+j.port;const M=new fr(null);w&&yo(M,w),h&&(M.g=h),j&&vo(M,j),m&&(M.h=m),w=M}return m=a.G,h=a.wa,m&&h&&be(w,m,h),be(w,"VER",a.ka),bo(a,w),w}function lg(a,h,m){if(h&&!a.L)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Aa&&!a.ma?new De(new Xu({ab:m})):new De(a.ma),h.Fa(a.L),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function cg(){}t=cg.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function il(){}il.prototype.g=function(a,h){return new Mt(a,h)};function Mt(a,h){B.call(this),this.g=new Jp(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.sa&&(a?a["X-WebChannel-Client-Profile"]=h.sa:a={"X-WebChannel-Client-Profile":h.sa}),this.g.U=a,(a=h&&h.Qb)&&!_(a)&&(this.g.u=a),this.A=h&&h.supportsCrossDomainXhr||!1,this.v=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!_(h)&&(this.g.G=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new ti(this)}p(Mt,B),Mt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Mt.prototype.close=function(){Zu(this.g)},Mt.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var m={};m.__data__=a,a=m}else this.v&&(m={},m.__data__=Lt(a),a=m);h.i.push(new JE(h.Ya++,a)),h.I==3&&rl(h)},Mt.prototype.N=function(){this.g.l=null,delete this.j,Zu(this.g),delete this.g,Mt.Z.N.call(this)};function ug(a){Bu.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(const m in h){a=m;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}p(ug,Bu);function dg(){$u.call(this),this.status=1}p(dg,$u);function ti(a){this.g=a}p(ti,cg),ti.prototype.ra=function(){U(this.g,"a")},ti.prototype.qa=function(a){U(this.g,new ug(a))},ti.prototype.pa=function(a){U(this.g,new dg)},ti.prototype.oa=function(){U(this.g,"b")},il.prototype.createWebChannel=il.prototype.g,Mt.prototype.send=Mt.prototype.o,Mt.prototype.open=Mt.prototype.m,Mt.prototype.close=Mt.prototype.close,L1=function(){return new il},D1=function(){return Ya()},j1=ds,Gh={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Xa.NO_ERROR=0,Xa.TIMEOUT=8,Xa.HTTP_ERROR=6,Ql=Xa,Ap.COMPLETE="complete",R1=Ap,Ep.EventType=uo,uo.OPEN="a",uo.CLOSE="b",uo.ERROR="c",uo.MESSAGE="d",B.prototype.listen=B.prototype.J,Uo=Ep,De.prototype.listenOnce=De.prototype.K,De.prototype.getLastError=De.prototype.Ha,De.prototype.getLastErrorCode=De.prototype.ya,De.prototype.getStatus=De.prototype.ca,De.prototype.getResponseJson=De.prototype.La,De.prototype.getResponseText=De.prototype.la,De.prototype.send=De.prototype.ea,De.prototype.setWithCredentials=De.prototype.Fa,P1=De}).apply(typeof bl<"u"?bl:typeof self<"u"?self:typeof window<"u"?window:{});const t0="@firebase/firestore",n0="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ht.UNAUTHENTICATED=new ht(null),ht.GOOGLE_CREDENTIALS=new ht("google-credentials-uid"),ht.FIRST_PARTY=new ht("first-party-uid"),ht.MOCK_USER=new ht("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let to="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Us=new hm("@firebase/firestore");function ri(){return Us.logLevel}function X(t,...e){if(Us.logLevel<=he.DEBUG){const n=e.map(Im);Us.debug(`Firestore (${to}): ${t}`,...n)}}function ir(t,...e){if(Us.logLevel<=he.ERROR){const n=e.map(Im);Us.error(`Firestore (${to}): ${t}`,...n)}}function Fi(t,...e){if(Us.logLevel<=he.WARN){const n=e.map(Im);Us.warn(`Firestore (${to}): ${t}`,...n)}}function Im(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ie(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,M1(t,r,n)}function M1(t,e,n){let r=`FIRESTORE (${to}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw ir(r),new Error(r)}function ve(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||M1(e,s,r)}function le(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Y extends Mn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class gN{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(ht.UNAUTHENTICATED))}shutdown(){}}class yN{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class vN{constructor(e){this.t=e,this.currentUser=ht.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ve(this.o===void 0,42304);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Jn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Jn,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},c=u=>{X("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(X("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Jn)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(X("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ve(typeof r.accessToken=="string",31837,{l:r}),new V1(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ve(e===null||typeof e=="string",2055,{h:e}),new ht(e)}}class wN{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=ht.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class _N{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new wN(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(ht.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class r0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class xN{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Qt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ve(this.o===void 0,3512);const r=i=>{i.error!=null&&X("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,X("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{X("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):X("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new r0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ve(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new r0(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EN(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=EN(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function fe(t,e){return t<e?-1:t>e?1:0}function Qh(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Vd(s)===Vd(i)?fe(s,i):Vd(s)?1:-1}return fe(t.length,e.length)}const TN=55296,IN=57343;function Vd(t){const e=t.charCodeAt(0);return e>=TN&&e<=IN}function Ui(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s0="__name__";class xn{constructor(e,n,r){n===void 0?n=0:n>e.length&&ie(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&ie(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return xn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof xn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=xn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return fe(e.length,n.length)}static compareSegments(e,n){const r=xn.isNumericId(e),s=xn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?xn.extractNumericId(e).compare(xn.extractNumericId(n)):Qh(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ur.fromString(e.substring(4,e.length-2))}}class Ee extends xn{construct(e,n,r){return new Ee(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Y($.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ee(n)}static emptyPath(){return new Ee([])}}const bN=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class st extends xn{construct(e,n,r){return new st(e,n,r)}static isValidIdentifier(e){return bN.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),st.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===s0}static keyField(){return new st([s0])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new Y($.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new Y($.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Y($.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(r+=c,s++):(i(),s++)}if(i(),o)throw new Y($.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new st(n)}static emptyPath(){return new st([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(e){this.path=e}static fromPath(e){return new te(Ee.fromString(e))}static fromName(e){return new te(Ee.fromString(e).popFirst(5))}static empty(){return new te(Ee.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ee.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ee.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new te(new Ee(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O1(t,e,n){if(!n)throw new Y($.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function SN(t,e,n,r){if(e===!0&&r===!0)throw new Y($.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function i0(t){if(!te.isDocumentKey(t))throw new Y($.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function o0(t){if(te.isDocumentKey(t))throw new Y($.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function F1(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function vu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ie(12329,{type:typeof t})}function Dt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Y($.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=vu(t);throw new Y($.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qe(t,e){const n={typeString:t};return e&&(n.value=e),n}function qa(t,e){if(!F1(t))throw new Y($.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new Y($.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a0=-62135596800,l0=1e6;class Ae{static now(){return Ae.fromMillis(Date.now())}static fromDate(e){return Ae.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*l0);return new Ae(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Y($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Y($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<a0)throw new Y($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Y($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/l0}_compareTo(e){return this.seconds===e.seconds?fe(this.nanoseconds,e.nanoseconds):fe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ae._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(qa(e,Ae._jsonSchema))return new Ae(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-a0;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ae._jsonSchemaVersion="firestore/timestamp/1.0",Ae._jsonSchema={type:qe("string",Ae._jsonSchemaVersion),seconds:qe("number"),nanoseconds:qe("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{static fromTimestamp(e){return new oe(e)}static min(){return new oe(new Ae(0,0))}static max(){return new oe(new Ae(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba=-1;function AN(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=oe.fromTimestamp(r===1e9?new Ae(n+1,0):new Ae(n,r));return new Kr(s,te.empty(),e)}function kN(t){return new Kr(t.readTime,t.key,ba)}class Kr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Kr(oe.min(),te.empty(),ba)}static max(){return new Kr(oe.max(),te.empty(),ba)}}function NN(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=te.comparator(t.documentKey,e.documentKey),n!==0?n:fe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class PN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function no(t){if(t.code!==$.FAILED_PRECONDITION||t.message!==CN)throw t;X("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ie(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new z((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof z?n:z.resolve(n)}catch(n){return z.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):z.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):z.reject(n)}static resolve(e){return new z((n,r)=>{n(e)})}static reject(e){return new z((n,r)=>{r(e)})}static waitFor(e){return new z((n,r)=>{let s=0,i=0,o=!1;e.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=z.resolve(!1);for(const r of e)n=n.next(s=>s?z.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new z((r,s)=>{const i=e.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const d=u;n(e[d]).next(f=>{o[d]=f,++c,c===i&&r(o)},f=>s(f))}})}static doWhile(e,n){return new z((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function RN(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ro(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}wu.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sm=-1;function _u(t){return t==null}function Mc(t){return t===0&&1/t==-1/0}function jN(t){return typeof t=="number"&&Number.isInteger(t)&&!Mc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U1="";function DN(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=c0(e)),e=LN(t.get(n),e);return c0(e)}function LN(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case U1:n+="";break;default:n+=i}}return n}function c0(t){return t+U1+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u0(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function is(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function B1(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(e,n){this.comparator=e,this.root=n||rt.EMPTY}insert(e,n){return new je(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,rt.BLACK,null,null))}remove(e){return new je(this.comparator,this.root.remove(e,this.comparator).copy(null,null,rt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Sl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Sl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Sl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Sl(this.root,e,this.comparator,!0)}}class Sl{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class rt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??rt.RED,this.left=s??rt.EMPTY,this.right=i??rt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new rt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return rt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return rt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,rt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,rt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ie(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ie(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ie(27949);return e+(this.isRed()?0:1)}}rt.EMPTY=null,rt.RED=!0,rt.BLACK=!1;rt.EMPTY=new class{constructor(){this.size=0}get key(){throw ie(57766)}get value(){throw ie(16141)}get color(){throw ie(16727)}get left(){throw ie(29726)}get right(){throw ie(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new rt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e){this.comparator=e,this.data=new je(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new d0(this.data.getIterator())}getIteratorFrom(e){return new d0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Xe)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Xe(this.comparator);return n.data=e,n}}class d0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.fields=e,e.sort(st.comparator)}static empty(){return new Bt([])}unionWith(e){let n=new Xe(st.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Bt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ui(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new $1("Invalid base64 string: "+i):i}}(e);return new at(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new at(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return fe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}at.EMPTY_BYTE_STRING=new at("");const MN=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gr(t){if(ve(!!t,39018),typeof t=="string"){let e=0;const n=MN.exec(t);if(ve(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Oe(t.seconds),nanos:Oe(t.nanos)}}function Oe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Qr(t){return typeof t=="string"?at.fromBase64String(t):at.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z1="server_timestamp",q1="__type__",H1="__previous_value__",W1="__local_write_time__";function Am(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[q1])==null?void 0:r.stringValue)===z1}function xu(t){const e=t.mapValue.fields[H1];return Am(e)?xu(e):e}function Sa(t){const e=Gr(t.mapValue.fields[W1].timestampValue);return new Ae(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VN{constructor(e,n,r,s,i,o,c,u,d,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=f}}const Vc="(default)";class Aa{constructor(e,n){this.projectId=e,this.database=n||Vc}static empty(){return new Aa("","")}get isDefaultDatabase(){return this.database===Vc}isEqual(e){return e instanceof Aa&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K1="__type__",ON="__max__",Al={mapValue:{}},G1="__vector__",Oc="value";function Yr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Am(t)?4:UN(t)?9007199254740991:FN(t)?10:11:ie(28295,{value:t})}function Ln(t,e){if(t===e)return!0;const n=Yr(t);if(n!==Yr(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Sa(t).isEqual(Sa(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Gr(s.timestampValue),c=Gr(i.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Qr(s.bytesValue).isEqual(Qr(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Oe(s.geoPointValue.latitude)===Oe(i.geoPointValue.latitude)&&Oe(s.geoPointValue.longitude)===Oe(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Oe(s.integerValue)===Oe(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Oe(s.doubleValue),c=Oe(i.doubleValue);return o===c?Mc(o)===Mc(c):isNaN(o)&&isNaN(c)}return!1}(t,e);case 9:return Ui(t.arrayValue.values||[],e.arrayValue.values||[],Ln);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},c=i.mapValue.fields||{};if(u0(o)!==u0(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!Ln(o[u],c[u])))return!1;return!0}(t,e);default:return ie(52216,{left:t})}}function ka(t,e){return(t.values||[]).find(n=>Ln(n,e))!==void 0}function Bi(t,e){if(t===e)return 0;const n=Yr(t),r=Yr(e);if(n!==r)return fe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return fe(t.booleanValue,e.booleanValue);case 2:return function(i,o){const c=Oe(i.integerValue||i.doubleValue),u=Oe(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return h0(t.timestampValue,e.timestampValue);case 4:return h0(Sa(t),Sa(e));case 5:return Qh(t.stringValue,e.stringValue);case 6:return function(i,o){const c=Qr(i),u=Qr(o);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const c=i.split("/"),u=o.split("/");for(let d=0;d<c.length&&d<u.length;d++){const f=fe(c[d],u[d]);if(f!==0)return f}return fe(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const c=fe(Oe(i.latitude),Oe(o.latitude));return c!==0?c:fe(Oe(i.longitude),Oe(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return f0(t.arrayValue,e.arrayValue);case 10:return function(i,o){var g,E,C,P;const c=i.fields||{},u=o.fields||{},d=(g=c[Oc])==null?void 0:g.arrayValue,f=(E=u[Oc])==null?void 0:E.arrayValue,p=fe(((C=d==null?void 0:d.values)==null?void 0:C.length)||0,((P=f==null?void 0:f.values)==null?void 0:P.length)||0);return p!==0?p:f0(d,f)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Al.mapValue&&o===Al.mapValue)return 0;if(i===Al.mapValue)return 1;if(o===Al.mapValue)return-1;const c=i.fields||{},u=Object.keys(c),d=o.fields||{},f=Object.keys(d);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const g=Qh(u[p],f[p]);if(g!==0)return g;const E=Bi(c[u[p]],d[f[p]]);if(E!==0)return E}return fe(u.length,f.length)}(t.mapValue,e.mapValue);default:throw ie(23264,{he:n})}}function h0(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return fe(t,e);const n=Gr(t),r=Gr(e),s=fe(n.seconds,r.seconds);return s!==0?s:fe(n.nanos,r.nanos)}function f0(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Bi(n[s],r[s]);if(i)return i}return fe(n.length,r.length)}function $i(t){return Yh(t)}function Yh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Gr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Qr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return te.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Yh(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Yh(n.fields[o])}`;return s+"}"}(t.mapValue):ie(61005,{value:t})}function Yl(t){switch(Yr(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=xu(t);return e?16+Yl(e):16;case 5:return 2*t.stringValue.length;case 6:return Qr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Yl(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return is(r.fields,(i,o)=>{s+=i.length+Yl(o)}),s}(t.mapValue);default:throw ie(13486,{value:t})}}function m0(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Xh(t){return!!t&&"integerValue"in t}function km(t){return!!t&&"arrayValue"in t}function p0(t){return!!t&&"nullValue"in t}function g0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Xl(t){return!!t&&"mapValue"in t}function FN(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[K1])==null?void 0:r.stringValue)===G1}function ta(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return is(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ta(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ta(t.arrayValue.values[n]);return e}return{...t}}function UN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===ON}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e){this.value=e}static empty(){return new Nt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Xl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ta(n)}setAll(e){let n=st.emptyPath(),r={},s=[];e.forEach((o,c)=>{if(!n.isImmediateParentOf(c)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=c.popLast()}o?r[c.lastSegment()]=ta(o):s.push(c.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Xl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ln(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Xl(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){is(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Nt(ta(this.value))}}function Q1(t){const e=[];return is(t.fields,(n,r)=>{const s=new st([n]);if(Xl(r)){const i=Q1(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Bt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e,n,r,s,i,o,c){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=c}static newInvalidDocument(e){return new pt(e,0,oe.min(),oe.min(),oe.min(),Nt.empty(),0)}static newFoundDocument(e,n,r,s){return new pt(e,1,n,oe.min(),r,s,0)}static newNoDocument(e,n){return new pt(e,2,n,oe.min(),oe.min(),Nt.empty(),0)}static newUnknownDocument(e,n){return new pt(e,3,n,oe.min(),oe.min(),Nt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(oe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Nt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Nt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=oe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof pt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new pt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(e,n){this.position=e,this.inclusive=n}}function y0(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=te.comparator(te.fromName(o.referenceValue),n.key):r=Bi(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function v0(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ln(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(e,n="asc"){this.field=e,this.dir=n}}function BN(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{}class ze extends Y1{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new zN(e,n,r):n==="array-contains"?new WN(e,r):n==="in"?new KN(e,r):n==="not-in"?new GN(e,r):n==="array-contains-any"?new QN(e,r):new ze(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new qN(e,r):new HN(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Bi(n,this.value)):n!==null&&Yr(this.value)===Yr(n)&&this.matchesComparison(Bi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ie(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gn extends Y1{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new gn(e,n)}matches(e){return X1(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function X1(t){return t.op==="and"}function J1(t){return $N(t)&&X1(t)}function $N(t){for(const e of t.filters)if(e instanceof gn)return!1;return!0}function Jh(t){if(t instanceof ze)return t.field.canonicalString()+t.op.toString()+$i(t.value);if(J1(t))return t.filters.map(e=>Jh(e)).join(",");{const e=t.filters.map(n=>Jh(n)).join(",");return`${t.op}(${e})`}}function Z1(t,e){return t instanceof ze?function(r,s){return s instanceof ze&&r.op===s.op&&r.field.isEqual(s.field)&&Ln(r.value,s.value)}(t,e):t instanceof gn?function(r,s){return s instanceof gn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,c)=>i&&Z1(o,s.filters[c]),!0):!1}(t,e):void ie(19439)}function ex(t){return t instanceof ze?function(n){return`${n.field.canonicalString()} ${n.op} ${$i(n.value)}`}(t):t instanceof gn?function(n){return n.op.toString()+" {"+n.getFilters().map(ex).join(" ,")+"}"}(t):"Filter"}class zN extends ze{constructor(e,n,r){super(e,n,r),this.key=te.fromName(r.referenceValue)}matches(e){const n=te.comparator(e.key,this.key);return this.matchesComparison(n)}}class qN extends ze{constructor(e,n){super(e,"in",n),this.keys=tx("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class HN extends ze{constructor(e,n){super(e,"not-in",n),this.keys=tx("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function tx(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>te.fromName(r.referenceValue))}class WN extends ze{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return km(n)&&ka(n.arrayValue,this.value)}}class KN extends ze{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ka(this.value.arrayValue,n)}}class GN extends ze{constructor(e,n){super(e,"not-in",n)}matches(e){if(ka(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!ka(this.value.arrayValue,n)}}class QN extends ze{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!km(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ka(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YN{constructor(e,n=null,r=[],s=[],i=null,o=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.Te=null}}function w0(t,e=null,n=[],r=[],s=null,i=null,o=null){return new YN(t,e,n,r,s,i,o)}function Nm(t){const e=le(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Jh(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),_u(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>$i(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>$i(r)).join(",")),e.Te=n}return e.Te}function Cm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!BN(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Z1(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!v0(t.startAt,e.startAt)&&v0(t.endAt,e.endAt)}function Zh(t){return te.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e,n=null,r=[],s=[],i=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function XN(t,e,n,r,s,i,o,c){return new Ha(t,e,n,r,s,i,o,c)}function Eu(t){return new Ha(t)}function _0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function nx(t){return t.collectionGroup!==null}function na(t){const e=le(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Xe(st.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Uc(i,r))}),n.has(st.keyField().canonicalString())||e.Ie.push(new Uc(st.keyField(),r))}return e.Ie}function Cn(t){const e=le(t);return e.Ee||(e.Ee=JN(e,na(t))),e.Ee}function JN(t,e){if(t.limitType==="F")return w0(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Uc(s.field,i)});const n=t.endAt?new Fc(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Fc(t.startAt.position,t.startAt.inclusive):null;return w0(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function ef(t,e){const n=t.filters.concat([e]);return new Ha(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function tf(t,e,n){return new Ha(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Tu(t,e){return Cm(Cn(t),Cn(e))&&t.limitType===e.limitType}function rx(t){return`${Nm(Cn(t))}|lt:${t.limitType}`}function si(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>ex(s)).join(", ")}]`),_u(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>$i(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>$i(s)).join(",")),`Target(${r})`}(Cn(t))}; limitType=${t.limitType})`}function Iu(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):te.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of na(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,c,u){const d=y0(o,c,u);return o.inclusive?d<=0:d<0}(r.startAt,na(r),s)||r.endAt&&!function(o,c,u){const d=y0(o,c,u);return o.inclusive?d>=0:d>0}(r.endAt,na(r),s))}(t,e)}function ZN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function sx(t){return(e,n)=>{let r=!1;for(const s of na(t)){const i=eC(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function eC(t,e,n){const r=t.field.isKeyField()?te.comparator(e.key,n.key):function(i,o,c){const u=o.data.field(i),d=c.data.field(i);return u!==null&&d!==null?Bi(u,d):ie(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ie(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){is(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return B1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tC=new je(te.comparator);function or(){return tC}const ix=new je(te.comparator);function Bo(...t){let e=ix;for(const n of t)e=e.insert(n.key,n);return e}function ox(t){let e=ix;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ss(){return ra()}function ax(){return ra()}function ra(){return new Gs(t=>t.toString(),(t,e)=>t.isEqual(e))}const nC=new je(te.comparator),rC=new Xe(te.comparator);function me(...t){let e=rC;for(const n of t)e=e.add(n);return e}const sC=new Xe(fe);function iC(){return sC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pm(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Mc(e)?"-0":e}}function lx(t){return{integerValue:""+t}}function cx(t,e){return jN(e)?lx(e):Pm(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(){this._=void 0}}function oC(t,e,n){return t instanceof Na?function(s,i){const o={fields:{[q1]:{stringValue:z1},[W1]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Am(i)&&(i=xu(i)),i&&(o.fields[H1]=i),{mapValue:o}}(n,e):t instanceof zi?dx(t,e):t instanceof Ca?hx(t,e):function(s,i){const o=ux(s,i),c=x0(o)+x0(s.Ae);return Xh(o)&&Xh(s.Ae)?lx(c):Pm(s.serializer,c)}(t,e)}function aC(t,e,n){return t instanceof zi?dx(t,e):t instanceof Ca?hx(t,e):n}function ux(t,e){return t instanceof Pa?function(r){return Xh(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Na extends bu{}class zi extends bu{constructor(e){super(),this.elements=e}}function dx(t,e){const n=fx(e);for(const r of t.elements)n.some(s=>Ln(s,r))||n.push(r);return{arrayValue:{values:n}}}class Ca extends bu{constructor(e){super(),this.elements=e}}function hx(t,e){let n=fx(e);for(const r of t.elements)n=n.filter(s=>!Ln(s,r));return{arrayValue:{values:n}}}class Pa extends bu{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function x0(t){return Oe(t.integerValue||t.doubleValue)}function fx(t){return km(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rm{constructor(e,n){this.field=e,this.transform=n}}function lC(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof zi&&s instanceof zi||r instanceof Ca&&s instanceof Ca?Ui(r.elements,s.elements,Ln):r instanceof Pa&&s instanceof Pa?Ln(r.Ae,s.Ae):r instanceof Na&&s instanceof Na}(t.transform,e.transform)}class cC{constructor(e,n){this.version=e,this.transformResults=n}}class en{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new en}static exists(e){return new en(void 0,e)}static updateTime(e){return new en(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Jl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Su{}function mx(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new jm(t.key,en.none()):new Wa(t.key,t.data,en.none());{const n=t.data,r=Nt.empty();let s=new Xe(st.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new os(t.key,r,new Bt(s.toArray()),en.none())}}function uC(t,e,n){t instanceof Wa?function(s,i,o){const c=s.value.clone(),u=T0(s.fieldTransforms,i,o.transformResults);c.setAll(u),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):t instanceof os?function(s,i,o){if(!Jl(s.precondition,i))return void i.convertToUnknownDocument(o.version);const c=T0(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(px(s)),u.setAll(c),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function sa(t,e,n,r){return t instanceof Wa?function(i,o,c,u){if(!Jl(i.precondition,o))return c;const d=i.value.clone(),f=I0(i.fieldTransforms,u,o);return d.setAll(f),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof os?function(i,o,c,u){if(!Jl(i.precondition,o))return c;const d=I0(i.fieldTransforms,u,o),f=o.data;return f.setAll(px(i)),f.setAll(d),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(i,o,c){return Jl(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(t,e,n)}function dC(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=ux(r.transform,s||null);i!=null&&(n===null&&(n=Nt.empty()),n.set(r.field,i))}return n||null}function E0(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ui(r,s,(i,o)=>lC(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Wa extends Su{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class os extends Su{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function px(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function T0(t,e,n){const r=new Map;ve(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,c=e.data.field(i.field);r.set(i.field,aC(o,c,n[s]))}return r}function I0(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,oC(i,o,e))}return r}class jm extends Su{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class hC extends Su{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&uC(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=sa(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=sa(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=ax();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=n.has(s.key)?null:c;const u=mx(o,c);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(oe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),me())}isEqual(e){return this.batchId===e.batchId&&Ui(this.mutations,e.mutations,(n,r)=>E0(n,r))&&Ui(this.baseMutations,e.baseMutations,(n,r)=>E0(n,r))}}class Dm{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){ve(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return nC}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Dm(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ue,pe;function gC(t){switch(t){case $.OK:return ie(64938);case $.CANCELLED:case $.UNKNOWN:case $.DEADLINE_EXCEEDED:case $.RESOURCE_EXHAUSTED:case $.INTERNAL:case $.UNAVAILABLE:case $.UNAUTHENTICATED:return!1;case $.INVALID_ARGUMENT:case $.NOT_FOUND:case $.ALREADY_EXISTS:case $.PERMISSION_DENIED:case $.FAILED_PRECONDITION:case $.ABORTED:case $.OUT_OF_RANGE:case $.UNIMPLEMENTED:case $.DATA_LOSS:return!0;default:return ie(15467,{code:t})}}function gx(t){if(t===void 0)return ir("GRPC error has no .code"),$.UNKNOWN;switch(t){case Ue.OK:return $.OK;case Ue.CANCELLED:return $.CANCELLED;case Ue.UNKNOWN:return $.UNKNOWN;case Ue.DEADLINE_EXCEEDED:return $.DEADLINE_EXCEEDED;case Ue.RESOURCE_EXHAUSTED:return $.RESOURCE_EXHAUSTED;case Ue.INTERNAL:return $.INTERNAL;case Ue.UNAVAILABLE:return $.UNAVAILABLE;case Ue.UNAUTHENTICATED:return $.UNAUTHENTICATED;case Ue.INVALID_ARGUMENT:return $.INVALID_ARGUMENT;case Ue.NOT_FOUND:return $.NOT_FOUND;case Ue.ALREADY_EXISTS:return $.ALREADY_EXISTS;case Ue.PERMISSION_DENIED:return $.PERMISSION_DENIED;case Ue.FAILED_PRECONDITION:return $.FAILED_PRECONDITION;case Ue.ABORTED:return $.ABORTED;case Ue.OUT_OF_RANGE:return $.OUT_OF_RANGE;case Ue.UNIMPLEMENTED:return $.UNIMPLEMENTED;case Ue.DATA_LOSS:return $.DATA_LOSS;default:return ie(39323,{code:t})}}(pe=Ue||(Ue={}))[pe.OK=0]="OK",pe[pe.CANCELLED=1]="CANCELLED",pe[pe.UNKNOWN=2]="UNKNOWN",pe[pe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pe[pe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pe[pe.NOT_FOUND=5]="NOT_FOUND",pe[pe.ALREADY_EXISTS=6]="ALREADY_EXISTS",pe[pe.PERMISSION_DENIED=7]="PERMISSION_DENIED",pe[pe.UNAUTHENTICATED=16]="UNAUTHENTICATED",pe[pe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pe[pe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pe[pe.ABORTED=10]="ABORTED",pe[pe.OUT_OF_RANGE=11]="OUT_OF_RANGE",pe[pe.UNIMPLEMENTED=12]="UNIMPLEMENTED",pe[pe.INTERNAL=13]="INTERNAL",pe[pe.UNAVAILABLE=14]="UNAVAILABLE",pe[pe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yC(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vC=new Ur([4294967295,4294967295],0);function b0(t){const e=yC().encode(t),n=new C1;return n.update(e),new Uint8Array(n.digest())}function S0(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ur([n,r],0),new Ur([s,i],0)]}class Lm{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new $o(`Invalid padding: ${n}`);if(r<0)throw new $o(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new $o(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new $o(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Ur.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(Ur.fromNumber(r)));return s.compare(vC)===1&&(s=new Ur([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=b0(e),[r,s]=S0(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Lm(i,s,n);return r.forEach(c=>o.insert(c)),o}insert(e){if(this.ge===0)return;const n=b0(e),[r,s]=S0(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class $o extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Ka.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Au(oe.min(),s,new je(fe),or(),me())}}class Ka{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ka(r,n,me(),me(),me())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class yx{constructor(e,n){this.targetId=e,this.Ce=n}}class vx{constructor(e,n,r=at.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class A0{constructor(){this.ve=0,this.Fe=k0(),this.Me=at.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=me(),n=me(),r=me();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ie(38017,{changeType:i})}}),new Ka(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=k0()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ve(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class wC{constructor(e){this.Ge=e,this.ze=new Map,this.je=or(),this.Je=kl(),this.He=kl(),this.Ye=new je(fe)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:ie(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(Zh(i))if(r===0){const o=new te(i.path);this.et(n,o,pt.newNoDocument(o,oe.min()))}else ve(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,c;try{o=Qr(r).toUint8Array()}catch(u){if(u instanceof $1)return Fi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Lm(o,s,i)}catch(u){return Fi(u instanceof $o?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const c=this.ot(o);if(c){if(i.current&&Zh(c.target)){const u=new te(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,pt.newNoDocument(u,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=me();this.He.forEach((i,o)=>{let c=!0;o.forEachWhile(u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new Au(e,n,this.Ye,this.je,r);return this.je=or(),this.Je=kl(),this.He=kl(),this.Ye=new je(fe),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new A0,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Xe(fe),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Xe(fe),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||X("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new A0),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function kl(){return new je(te.comparator)}function k0(){return new je(te.comparator)}const _C={asc:"ASCENDING",desc:"DESCENDING"},xC={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},EC={and:"AND",or:"OR"};class TC{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function nf(t,e){return t.useProto3Json||_u(e)?e:{value:e}}function Bc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function wx(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function IC(t,e){return Bc(t,e.toTimestamp())}function Pn(t){return ve(!!t,49232),oe.fromTimestamp(function(n){const r=Gr(n);return new Ae(r.seconds,r.nanos)}(t))}function Mm(t,e){return rf(t,e).canonicalString()}function rf(t,e){const n=function(s){return new Ee(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function _x(t){const e=Ee.fromString(t);return ve(bx(e),10190,{key:e.toString()}),e}function sf(t,e){return Mm(t.databaseId,e.path)}function Od(t,e){const n=_x(e);if(n.get(1)!==t.databaseId.projectId)throw new Y($.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Y($.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new te(Ex(n))}function xx(t,e){return Mm(t.databaseId,e)}function bC(t){const e=_x(t);return e.length===4?Ee.emptyPath():Ex(e)}function of(t){return new Ee(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Ex(t){return ve(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function N0(t,e,n){return{name:sf(t,e),fields:n.value.mapValue.fields}}function SC(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ie(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,f){return d.useProto3Json?(ve(f===void 0||typeof f=="string",58123),at.fromBase64String(f||"")):(ve(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),at.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(d){const f=d.code===void 0?$.UNKNOWN:gx(d.code);return new Y(f,d.message||"")}(o);n=new vx(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Od(t,r.document.name),i=Pn(r.document.updateTime),o=r.document.createTime?Pn(r.document.createTime):oe.min(),c=new Nt({mapValue:{fields:r.document.fields}}),u=pt.newFoundDocument(s,i,o,c),d=r.targetIds||[],f=r.removedTargetIds||[];n=new Zl(d,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Od(t,r.document),i=r.readTime?Pn(r.readTime):oe.min(),o=pt.newNoDocument(s,i),c=r.removedTargetIds||[];n=new Zl([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Od(t,r.document),i=r.removedTargetIds||[];n=new Zl([],i,s,null)}else{if(!("filter"in e))return ie(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new pC(s,i),c=r.targetId;n=new yx(c,o)}}return n}function AC(t,e){let n;if(e instanceof Wa)n={update:N0(t,e.key,e.value)};else if(e instanceof jm)n={delete:sf(t,e.key)};else if(e instanceof os)n={update:N0(t,e.key,e.data),updateMask:MC(e.fieldMask)};else{if(!(e instanceof hC))return ie(16599,{Vt:e.type});n={verify:sf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const c=o.transform;if(c instanceof Na)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof zi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Ca)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Pa)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw ie(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:IC(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ie(27497)}(t,e.precondition)),n}function kC(t,e){return t&&t.length>0?(ve(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?Pn(s.updateTime):Pn(i);return o.isEqual(oe.min())&&(o=Pn(i)),new cC(o,s.transformResults||[])}(n,e))):[]}function NC(t,e){return{documents:[xx(t,e.path)]}}function CC(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=xx(t,s);const i=function(d){if(d.length!==0)return Ix(gn.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(f=>function(g){return{field:ii(g.field),direction:jC(g.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const c=nf(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function PC(t){let e=bC(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){ve(r===1,65062);const f=n.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];n.where&&(i=function(p){const g=Tx(p);return g instanceof gn&&J1(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(g=>function(C){return new Uc(oi(C.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(g))}(n.orderBy));let c=null;n.limit&&(c=function(p){let g;return g=typeof p=="object"?p.value:p,_u(g)?null:g}(n.limit));let u=null;n.startAt&&(u=function(p){const g=!!p.before,E=p.values||[];return new Fc(E,g)}(n.startAt));let d=null;return n.endAt&&(d=function(p){const g=!p.before,E=p.values||[];return new Fc(E,g)}(n.endAt)),XN(e,s,o,i,c,"F",u,d)}function RC(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ie(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Tx(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=oi(n.unaryFilter.field);return ze.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=oi(n.unaryFilter.field);return ze.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=oi(n.unaryFilter.field);return ze.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=oi(n.unaryFilter.field);return ze.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ie(61313);default:return ie(60726)}}(t):t.fieldFilter!==void 0?function(n){return ze.create(oi(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ie(58110);default:return ie(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return gn.create(n.compositeFilter.filters.map(r=>Tx(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ie(1026)}}(n.compositeFilter.op))}(t):ie(30097,{filter:t})}function jC(t){return _C[t]}function DC(t){return xC[t]}function LC(t){return EC[t]}function ii(t){return{fieldPath:t.canonicalString()}}function oi(t){return st.fromServerFormat(t.fieldPath)}function Ix(t){return t instanceof ze?function(n){if(n.op==="=="){if(g0(n.value))return{unaryFilter:{field:ii(n.field),op:"IS_NAN"}};if(p0(n.value))return{unaryFilter:{field:ii(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(g0(n.value))return{unaryFilter:{field:ii(n.field),op:"IS_NOT_NAN"}};if(p0(n.value))return{unaryFilter:{field:ii(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ii(n.field),op:DC(n.op),value:n.value}}}(t):t instanceof gn?function(n){const r=n.getFilters().map(s=>Ix(s));return r.length===1?r[0]:{compositeFilter:{op:LC(n.op),filters:r}}}(t):ie(54877,{filter:t})}function MC(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function bx(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e,n,r,s,i=oe.min(),o=oe.min(),c=at.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Cr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Cr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Cr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Cr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC{constructor(e){this.yt=e}}function OC(t){const e=PC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?tf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{constructor(){this.Cn=new UC}addToCollectionParentIndex(e,n){return this.Cn.add(n),z.resolve()}getCollectionParents(e,n){return z.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return z.resolve()}deleteFieldIndex(e,n){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,n){return z.resolve()}getDocumentsMatchingTarget(e,n){return z.resolve(null)}getIndexType(e,n){return z.resolve(0)}getFieldIndexes(e,n){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,n){return z.resolve(Kr.min())}getMinOffsetFromCollectionGroup(e,n){return z.resolve(Kr.min())}updateCollectionGroup(e,n,r){return z.resolve()}updateIndexEntries(e,n){return z.resolve()}}class UC{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Xe(Ee.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Xe(Ee.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Sx=41943040;class St{static withCacheSize(e){return new St(e,St.DEFAULT_COLLECTION_PERCENTILE,St.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */St.DEFAULT_COLLECTION_PERCENTILE=10,St.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,St.DEFAULT=new St(Sx,St.DEFAULT_COLLECTION_PERCENTILE,St.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),St.DISABLED=new St(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new qi(0)}static cr(){return new qi(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P0="LruGarbageCollector",BC=1048576;function R0([t,e],[n,r]){const s=fe(t,n);return s===0?fe(e,r):s}class $C{constructor(e){this.Ir=e,this.buffer=new Xe(R0),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();R0(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class zC{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){X(P0,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ro(n)?X(P0,"Ignoring IndexedDB error during garbage collection: ",n):await no(n)}await this.Vr(3e5)})}}class qC{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return z.resolve(wu.ce);const r=new $C(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(X("LruGarbageCollector","Garbage collection skipped; disabled"),z.resolve(C0)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(X("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),C0):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,c,u,d;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(X("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),s=this.params.maximumSequenceNumbersToCollect):s=p,o=Date.now(),this.nthSequenceNumber(e,s))).next(p=>(r=p,c=Date.now(),this.removeTargets(e,r,n))).next(p=>(i=p,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(d=Date.now(),ri()<=he.DEBUG&&X("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${s} in `+(c-o)+`ms
	Removed ${i} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(d-u)+`ms
Total Duration: ${d-f}ms`),z.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:p})))}}function HC(t,e){return new qC(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC{constructor(){this.changes=new Gs(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,pt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?z.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&sa(r.mutation,s,Bt.empty(),Ae.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,me()).next(()=>r))}getLocalViewOfDocuments(e,n,r=me()){const s=Ss();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Bo();return i.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Ss();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,me()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,c)=>{n.set(o,c)})})}computeViews(e,n,r,s){let i=or();const o=ra(),c=function(){return ra()}();return n.forEach((u,d)=>{const f=r.get(d.key);s.has(d.key)&&(f===void 0||f.mutation instanceof os)?i=i.insert(d.key,d):f!==void 0?(o.set(d.key,f.mutation.getFieldMask()),sa(f.mutation,d,f.mutation.getFieldMask(),Ae.now())):o.set(d.key,Bt.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,f)=>o.set(d,f)),n.forEach((d,f)=>c.set(d,new KC(f,o.get(d)??null))),c))}recalculateAndSaveOverlays(e,n){const r=ra();let s=new je((o,c)=>o-c),i=me();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const c of o)c.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let f=r.get(u)||Bt.empty();f=c.applyToLocalView(d,f),r.set(u,f);const p=(s.get(c.batchId)||me()).add(u);s=s.insert(c.batchId,p)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,f=u.value,p=ax();f.forEach(g=>{if(!i.has(g)){const E=mx(n.get(g),r.get(g));E!==null&&p.set(g,E),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return z.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return te.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):nx(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):z.resolve(Ss());let c=ba,u=i;return o.next(d=>z.forEach(d,(f,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),i.get(f)?z.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{u=u.insert(f,g)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,me())).next(f=>({batchId:c,changes:ox(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new te(n)).next(r=>{let s=Bo();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Bo();return this.indexManager.getCollectionParents(e,i).next(c=>z.forEach(c,u=>{const d=function(p,g){return new Ha(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(f=>{f.forEach((p,g)=>{o=o.insert(p,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,d)=>{const f=d.getKey();o.get(f)===null&&(o=o.insert(f,pt.newInvalidDocument(f)))});let c=Bo();return o.forEach((u,d)=>{const f=i.get(u);f!==void 0&&sa(f.mutation,d,Bt.empty(),Ae.now()),Iu(n,d)&&(c=c.insert(u,d))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return z.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Pn(s.createTime)}}(n)),z.resolve()}getNamedQuery(e,n){return z.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:OC(s.bundledQuery),readTime:Pn(s.readTime)}}(n)),z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(){this.overlays=new je(te.comparator),this.qr=new Map}getOverlay(e,n){return z.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ss();return z.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),z.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),z.resolve()}getOverlaysForCollection(e,n,r){const s=Ss(),i=n.length+1,o=new te(n.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return z.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new je((d,f)=>d-f);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let f=i.get(d.largestBatchId);f===null&&(f=Ss(),i=i.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const c=Ss(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,f)=>c.set(d,f)),!(c.size()>=s)););return z.resolve(c)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new mC(n,r));let i=this.qr.get(n);i===void 0&&(i=me(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(){this.sessionToken=at.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vm{constructor(){this.Qr=new Xe(Ze.$r),this.Ur=new Xe(Ze.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Ze(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Ze(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new te(new Ee([])),r=new Ze(n,e),s=new Ze(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new te(new Ee([])),r=new Ze(n,e),s=new Ze(n,e+1);let i=me();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Ze(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ze{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return te.comparator(e.key,n.key)||fe(e.Yr,n.Yr)}static Kr(e,n){return fe(e.Yr,n.Yr)||te.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Xe(Ze.$r)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new fC(i,n,r,s);this.mutationQueue.push(o);for(const c of s)this.Zr=this.Zr.add(new Ze(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return z.resolve(o)}lookupMutationBatch(e,n){return z.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return z.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?Sm:this.tr-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ze(n,0),s=new Ze(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const c=this.Xr(o.Yr);i.push(c)}),z.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Xe(fe);return n.forEach(s=>{const i=new Ze(s,0),o=new Ze(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],c=>{r=r.add(c.Yr)})}),z.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;te.isDocumentKey(i)||(i=i.child(""));const o=new Ze(new te(i),0);let c=new Xe(fe);return this.Zr.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(c=c.add(u.Yr)),!0)},o),z.resolve(this.ti(c))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){ve(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return z.forEach(n.mutations,s=>{const i=new Ze(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Ze(n,0),s=this.Zr.firstAfterOrEqual(r);return z.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(e){this.ri=e,this.docs=function(){return new je(te.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return z.resolve(r?r.document.mutableCopy():pt.newInvalidDocument(n))}getEntries(e,n){let r=or();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():pt.newInvalidDocument(s))}),z.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=or();const o=n.path,c=new te(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:f}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||NN(kN(f),r)<=0||(s.has(f.key)||Iu(n,f))&&(i=i.insert(f.key,f.mutableCopy()))}return z.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ie(9500)}ii(e,n){return z.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new eP(this)}getSize(e){return z.resolve(this.size)}}class eP extends WC{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),z.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(e){this.persistence=e,this.si=new Gs(n=>Nm(n),Cm),this.lastRemoteSnapshotVersion=oe.min(),this.highestTargetId=0,this.oi=0,this._i=new Vm,this.targetCount=0,this.ai=qi.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),z.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new qi(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,z.resolve()}updateTargetData(e,n){return this.Pr(n),z.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),z.waitFor(i).next(()=>s)}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return z.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),z.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),z.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),z.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return z.resolve(r)}containsKey(e,n){return z.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax{constructor(e,n){this.ui={},this.overlays={},this.ci=new wu(0),this.li=!1,this.li=!0,this.hi=new XC,this.referenceDelegate=e(this),this.Pi=new tP(this),this.indexManager=new FC,this.remoteDocumentCache=function(s){return new ZC(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new VC(n),this.Ii=new QC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new YC,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new JC(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){X("MemoryPersistence","Starting transaction:",e);const s=new nP(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return z.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class nP extends PN{constructor(e){super(),this.currentSequenceNumber=e}}class Om{constructor(e){this.persistence=e,this.Ri=new Vm,this.Vi=null}static mi(e){return new Om(e)}get fi(){if(this.Vi)return this.Vi;throw ie(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),z.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),z.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),z.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.fi,r=>{const s=te.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,oe.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return z.or([()=>z.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class $c{constructor(e,n){this.persistence=e,this.pi=new Gs(r=>DN(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=HC(this,n)}static mi(e,n){return new $c(e,n)}Ei(){}di(e){return z.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return z.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?z.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(c=>{c||(r++,i.removeEntry(o,oe.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),z.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),z.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),z.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),z.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Yl(e.data.value)),n}br(e,n,r){return z.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return z.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fm{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=me(),s=me();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Fm(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Ub()?8:RN(vt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new rP;return this.Ss(e,n,o).next(c=>{if(i.result=c,this.Vs)return this.bs(e,n,o,c.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(ri()<=he.DEBUG&&X("QueryEngine","SDK will not create cache indexes for query:",si(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),z.resolve()):(ri()<=he.DEBUG&&X("QueryEngine","Query:",si(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(ri()<=he.DEBUG&&X("QueryEngine","The SDK decides to create cache indexes for query:",si(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Cn(n))):z.resolve())}ys(e,n){if(_0(n))return z.resolve(null);let r=Cn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=tf(n,null,"F"),r=Cn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=me(...i);return this.ps.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.Ds(n,c);return this.Cs(n,d,o,u.readTime)?this.ys(e,tf(n,null,"F")):this.vs(e,d,n,u)}))})))}ws(e,n,r,s){return _0(n)||s.isEqual(oe.min())?z.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?z.resolve(null):(ri()<=he.DEBUG&&X("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),si(n)),this.vs(e,o,n,AN(s,ba)).next(c=>c))})}Ds(e,n){let r=new Xe(sx(e));return n.forEach((s,i)=>{Iu(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return ri()<=he.DEBUG&&X("QueryEngine","Using full collection scan to execute query:",si(n)),this.ps.getDocumentsMatchingQuery(e,n,Kr.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Um="LocalStore",iP=3e8;class oP{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new je(fe),this.xs=new Gs(i=>Nm(i),Cm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new GC(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function aP(t,e,n,r){return new oP(t,e,n,r)}async function kx(t,e){const n=le(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],c=[];let u=me();for(const d of s){o.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}for(const d of i){c.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}return n.localDocuments.getDocuments(r,u).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:c}))})})}function lP(t,e){const n=le(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(c,u,d,f){const p=d.batch,g=p.keys();let E=z.resolve();return g.forEach(C=>{E=E.next(()=>f.getEntry(u,C)).next(P=>{const b=d.docVersions.get(C);ve(b!==null,48541),P.version.compareTo(b)<0&&(p.applyToRemoteDocument(P,d),P.isValidDocument()&&(P.setReadTime(d.commitVersion),f.addEntry(P)))})}),E.next(()=>c.mutationQueue.removeMutationBatch(u,p))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let u=me();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function Nx(t){const e=le(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function cP(t,e){const n=le(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const c=[];e.targetChanges.forEach((f,p)=>{const g=s.get(p);if(!g)return;c.push(n.Pi.removeMatchingKeys(i,f.removedDocuments,p).next(()=>n.Pi.addMatchingKeys(i,f.addedDocuments,p)));let E=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(p)!==null?E=E.withResumeToken(at.EMPTY_BYTE_STRING,oe.min()).withLastLimboFreeSnapshotVersion(oe.min()):f.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(f.resumeToken,r)),s=s.insert(p,E),function(P,b,T){return P.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=iP?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(g,E,f)&&c.push(n.Pi.updateTargetData(i,E))});let u=or(),d=me();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(i,f))}),c.push(uP(i,o,e.documentUpdates).next(f=>{u=f.ks,d=f.qs})),!r.isEqual(oe.min())){const f=n.Pi.getLastRemoteSnapshotVersion(i).next(p=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(f)}return z.waitFor(c).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(n.Ms=s,i))}function uP(t,e,n){let r=me(),s=me();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=or();return n.forEach((c,u)=>{const d=i.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(oe.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):X(Um,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)}),{ks:o,qs:s}})}function dP(t,e){const n=le(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Sm),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function hP(t,e){const n=le(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,z.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new Cr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function af(t,e,n){const r=le(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!ro(o))throw o;X(Um,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function j0(t,e,n){const r=le(t);let s=oe.min(),i=me();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,f){const p=le(u),g=p.xs.get(f);return g!==void 0?z.resolve(p.Ms.get(g)):p.Pi.getTargetData(d,f)}(r,o,Cn(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,c.targetId).next(u=>{i=u})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:oe.min(),n?i:me())).next(c=>(fP(r,ZN(e),c),{documents:c,Qs:i})))}function fP(t,e,n){let r=t.Os.get(e)||oe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class D0{constructor(){this.activeTargetIds=iC()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class mP{constructor(){this.Mo=new D0,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new D0,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L0="ConnectivityMonitor";class M0{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){X(L0,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){X(L0,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nl=null;function lf(){return Nl===null?Nl=function(){return 268435456+Math.round(2147483648*Math.random())}():Nl++,"0x"+Nl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fd="RestConnection",gP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class yP{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Vc?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=lf(),c=this.zo(e,n.toUriEncodedString());X(Fd,`Sending RPC '${e}' ${o}:`,c,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,s,i);const{host:d}=new URL(c),f=Xi(d);return this.Jo(e,c,u,r,f).then(p=>(X(Fd,`Received RPC '${e}' ${o}: `,p),p),p=>{throw Fi(Fd,`RPC '${e}' ${o} failed with error: `,p,"url: ",c,"request:",r),p})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+to}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=gP[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dt="WebChannelConnection";class wP extends yP{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=lf();return new Promise((c,u)=>{const d=new P1;d.setWithCredentials(!0),d.listenOnce(R1.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Ql.NO_ERROR:const p=d.getResponseJson();X(dt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),c(p);break;case Ql.TIMEOUT:X(dt,`RPC '${e}' ${o} timed out`),u(new Y($.DEADLINE_EXCEEDED,"Request time out"));break;case Ql.HTTP_ERROR:const g=d.getStatus();if(X(dt,`RPC '${e}' ${o} failed with status:`,g,"response text:",d.getResponseText()),g>0){let E=d.getResponseJson();Array.isArray(E)&&(E=E[0]);const C=E==null?void 0:E.error;if(C&&C.status&&C.message){const P=function(T){const x=T.toLowerCase().replace(/_/g,"-");return Object.values($).indexOf(x)>=0?x:$.UNKNOWN}(C.status);u(new Y(P,C.message))}else u(new Y($.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new Y($.UNAVAILABLE,"Connection failed."));break;default:ie(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{X(dt,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(s);X(dt,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",f,r,15)})}T_(e,n,r){const s=lf(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=L1(),c=D1(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const f=i.join("");X(dt,`Creating RPC '${e}' stream ${s}: ${f}`,u);const p=o.createWebChannel(f,u);this.I_(p);let g=!1,E=!1;const C=new vP({Yo:b=>{E?X(dt,`Not sending because RPC '${e}' stream ${s} is closed:`,b):(g||(X(dt,`Opening RPC '${e}' stream ${s} transport.`),p.open(),g=!0),X(dt,`RPC '${e}' stream ${s} sending:`,b),p.send(b))},Zo:()=>p.close()}),P=(b,T,x)=>{b.listen(T,A=>{try{x(A)}catch(D){setTimeout(()=>{throw D},0)}})};return P(p,Uo.EventType.OPEN,()=>{E||(X(dt,`RPC '${e}' stream ${s} transport opened.`),C.o_())}),P(p,Uo.EventType.CLOSE,()=>{E||(E=!0,X(dt,`RPC '${e}' stream ${s} transport closed`),C.a_(),this.E_(p))}),P(p,Uo.EventType.ERROR,b=>{E||(E=!0,Fi(dt,`RPC '${e}' stream ${s} transport errored. Name:`,b.name,"Message:",b.message),C.a_(new Y($.UNAVAILABLE,"The operation could not be completed")))}),P(p,Uo.EventType.MESSAGE,b=>{var T;if(!E){const x=b.data[0];ve(!!x,16349);const A=x,D=(A==null?void 0:A.error)||((T=A[0])==null?void 0:T.error);if(D){X(dt,`RPC '${e}' stream ${s} received error:`,D);const V=D.status;let O=function(I){const N=Ue[I];if(N!==void 0)return gx(N)}(V),y=D.message;O===void 0&&(O=$.INTERNAL,y="Unknown error status: "+V+" with message "+D.message),E=!0,C.a_(new Y(O,y)),p.close()}else X(dt,`RPC '${e}' stream ${s} received:`,x),C.u_(x)}}),P(c,j1.STAT_EVENT,b=>{b.stat===Gh.PROXY?X(dt,`RPC '${e}' stream ${s} detected buffering proxy`):b.stat===Gh.NOPROXY&&X(dt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{C.__()},0),C}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function Ud(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ku(t){return new TC(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&X("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V0="PersistentStream";class Px{constructor(e,n,r,s,i,o,c,u){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Cx(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===$.RESOURCE_EXHAUSTED?(ir(n.toString()),ir("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===$.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new Y($.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return X(V0,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(X(V0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class _P extends Px{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=SC(this.serializer,e),r=function(i){if(!("targetChange"in i))return oe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?oe.min():o.readTime?Pn(o.readTime):oe.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=of(this.serializer),n.addTarget=function(i,o){let c;const u=o.target;if(c=Zh(u)?{documents:NC(i,u)}:{query:CC(i,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=wx(i,o.resumeToken);const d=nf(i,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(oe.min())>0){c.readTime=Bc(i,o.snapshotVersion.toTimestamp());const d=nf(i,o.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);const r=RC(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=of(this.serializer),n.removeTarget=e,this.q_(n)}}class xP extends Px{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ve(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ve(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ve(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=kC(e.writeResults,e.commitTime),r=Pn(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=of(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>AC(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{}class TP extends EP{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Y($.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,rf(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Y($.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Ho(e,rf(n,r),s,o,c,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Y($.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class IP{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ir(n),this.aa=!1):X("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bs="RemoteStore";class bP{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{Qs(this)&&(X(Bs,"Restarting streams for network reachability change."),await async function(u){const d=le(u);d.Ea.add(4),await Ga(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Nu(d)}(this))})}),this.Ra=new IP(r,s)}}async function Nu(t){if(Qs(t))for(const e of t.da)await e(!0)}async function Ga(t){for(const e of t.da)await e(!1)}function Rx(t,e){const n=le(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),qm(n)?zm(n):so(n).O_()&&$m(n,e))}function Bm(t,e){const n=le(t),r=so(n);n.Ia.delete(e),r.O_()&&jx(n,e),n.Ia.size===0&&(r.O_()?r.L_():Qs(n)&&n.Ra.set("Unknown"))}function $m(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(oe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}so(t).Y_(e)}function jx(t,e){t.Va.Ue(e),so(t).Z_(e)}function zm(t){t.Va=new wC({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),so(t).start(),t.Ra.ua()}function qm(t){return Qs(t)&&!so(t).x_()&&t.Ia.size>0}function Qs(t){return le(t).Ea.size===0}function Dx(t){t.Va=void 0}async function SP(t){t.Ra.set("Online")}async function AP(t){t.Ia.forEach((e,n)=>{$m(t,e)})}async function kP(t,e){Dx(t),qm(t)?(t.Ra.ha(e),zm(t)):t.Ra.set("Unknown")}async function NP(t,e,n){if(t.Ra.set("Online"),e instanceof vx&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.Ia.delete(c),s.Va.removeTarget(c))}(t,e)}catch(r){X(Bs,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await zc(t,r)}else if(e instanceof Zl?t.Va.Ze(e):e instanceof yx?t.Va.st(e):t.Va.tt(e),!n.isEqual(oe.min()))try{const r=await Nx(t.localStore);n.compareTo(r)>=0&&await function(i,o){const c=i.Va.Tt(o);return c.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const f=i.Ia.get(d);f&&i.Ia.set(d,f.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,d)=>{const f=i.Ia.get(u);if(!f)return;i.Ia.set(u,f.withResumeToken(at.EMPTY_BYTE_STRING,f.snapshotVersion)),jx(i,u);const p=new Cr(f.target,u,d,f.sequenceNumber);$m(i,p)}),i.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(r){X(Bs,"Failed to raise snapshot:",r),await zc(t,r)}}async function zc(t,e,n){if(!ro(e))throw e;t.Ea.add(1),await Ga(t),t.Ra.set("Offline"),n||(n=()=>Nx(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{X(Bs,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Nu(t)})}function Lx(t,e){return e().catch(n=>zc(t,n,e))}async function Cu(t){const e=le(t),n=Xr(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Sm;for(;CP(e);)try{const s=await dP(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,PP(e,s)}catch(s){await zc(e,s)}Mx(e)&&Vx(e)}function CP(t){return Qs(t)&&t.Ta.length<10}function PP(t,e){t.Ta.push(e);const n=Xr(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Mx(t){return Qs(t)&&!Xr(t).x_()&&t.Ta.length>0}function Vx(t){Xr(t).start()}async function RP(t){Xr(t).ra()}async function jP(t){const e=Xr(t);for(const n of t.Ta)e.ea(n.mutations)}async function DP(t,e,n){const r=t.Ta.shift(),s=Dm.from(r,e,n);await Lx(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Cu(t)}async function LP(t,e){e&&Xr(t).X_&&await async function(r,s){if(function(o){return gC(o)&&o!==$.ABORTED}(s.code)){const i=r.Ta.shift();Xr(r).B_(),await Lx(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Cu(r)}}(t,e),Mx(t)&&Vx(t)}async function O0(t,e){const n=le(t);n.asyncQueue.verifyOperationInProgress(),X(Bs,"RemoteStore received new credentials");const r=Qs(n);n.Ea.add(3),await Ga(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Nu(n)}async function MP(t,e){const n=le(t);e?(n.Ea.delete(2),await Nu(n)):e||(n.Ea.add(2),await Ga(n),n.Ra.set("Unknown"))}function so(t){return t.ma||(t.ma=function(n,r,s){const i=le(n);return i.sa(),new _P(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:SP.bind(null,t),t_:AP.bind(null,t),r_:kP.bind(null,t),H_:NP.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),qm(t)?zm(t):t.Ra.set("Unknown")):(await t.ma.stop(),Dx(t))})),t.ma}function Xr(t){return t.fa||(t.fa=function(n,r,s){const i=le(n);return i.sa(),new xP(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:RP.bind(null,t),r_:LP.bind(null,t),ta:jP.bind(null,t),na:DP.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Cu(t)):(await t.fa.stop(),t.Ta.length>0&&(X(Bs,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Jn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,c=new Hm(e,n,o,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Y($.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Wm(t,e){if(ir("AsyncQueue",`${e}: ${t}`),ro(t))return new Y($.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{static emptySet(e){return new Ci(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||te.comparator(n.key,r.key):(n,r)=>te.comparator(n.key,r.key),this.keyedMap=Bo(),this.sortedSet=new je(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ci)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ci;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{constructor(){this.ga=new je(te.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):ie(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Hi{constructor(e,n,r,s,i,o,c,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(c=>{o.push({type:0,doc:c})}),new Hi(e,n,Ci.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Tu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class OP{constructor(){this.queries=U0(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=le(n),i=s.queries;s.queries=U0(),i.forEach((o,c)=>{for(const u of c.Sa)u.onError(r)})})(this,new Y($.ABORTED,"Firestore shutting down"))}}function U0(){return new Gs(t=>rx(t),Tu)}async function Km(t,e){const n=le(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new VP,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const c=Wm(o,`Initialization of query '${si(e.query)}' failed`);return void e.onError(c)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&Qm(n)}async function Gm(t,e){const n=le(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function FP(t,e){const n=le(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const c of o.Sa)c.Fa(s)&&(r=!0);o.wa=s}}r&&Qm(n)}function UP(t,e,n){const r=le(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function Qm(t){t.Ca.forEach(e=>{e.next()})}var cf,B0;(B0=cf||(cf={})).Ma="default",B0.Cache="cache";class Ym{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Hi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Hi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==cf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(e){this.key=e}}class Fx{constructor(e){this.key=e}}class BP{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=me(),this.mutatedKeys=me(),this.eu=sx(e),this.tu=new Ci(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new F0,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,p)=>{const g=s.get(f),E=Iu(this.query,p)?p:null,C=!!g&&this.mutatedKeys.has(g.key),P=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let b=!1;g&&E?g.data.isEqual(E.data)?C!==P&&(r.track({type:3,doc:E}),b=!0):this.su(g,E)||(r.track({type:2,doc:E}),b=!0,(u&&this.eu(E,u)>0||d&&this.eu(E,d)<0)&&(c=!0)):!g&&E?(r.track({type:0,doc:E}),b=!0):g&&!E&&(r.track({type:1,doc:g}),b=!0,(u||d)&&(c=!0)),b&&(E?(o=o.add(E),i=P?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{tu:o,iu:r,Cs:c,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((f,p)=>function(E,C){const P=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ie(20277,{Rt:b})}};return P(E)-P(C)}(f.type,p.type)||this.eu(f.doc,p.doc)),this.ou(r),s=s??!1;const c=n&&!s?this._u():[],u=this.Xa.size===0&&this.current&&!s?1:0,d=u!==this.Za;return this.Za=u,o.length!==0||d?{snapshot:new Hi(this.query,e.tu,i,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new F0,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=me(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new Fx(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new Ox(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=me();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Hi.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Xm="SyncEngine";class $P{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class zP{constructor(e){this.key=e,this.hu=!1}}class qP{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Gs(c=>rx(c),Tu),this.Iu=new Map,this.Eu=new Set,this.du=new je(te.comparator),this.Au=new Map,this.Ru=new Vm,this.Vu={},this.mu=new Map,this.fu=qi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function HP(t,e,n=!0){const r=Hx(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await Ux(r,e,n,!0),s}async function WP(t,e){const n=Hx(t);await Ux(n,e,!0,!1)}async function Ux(t,e,n,r){const s=await hP(t.localStore,Cn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let c;return r&&(c=await KP(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&Rx(t.remoteStore,s),c}async function KP(t,e,n,r,s){t.pu=(p,g,E)=>async function(P,b,T,x){let A=b.view.ru(T);A.Cs&&(A=await j0(P.localStore,b.query,!1).then(({documents:y})=>b.view.ru(y,A)));const D=x&&x.targetChanges.get(b.targetId),V=x&&x.targetMismatches.get(b.targetId)!=null,O=b.view.applyChanges(A,P.isPrimaryClient,D,V);return z0(P,b.targetId,O.au),O.snapshot}(t,p,g,E);const i=await j0(t.localStore,e,!0),o=new BP(e,i.Qs),c=o.ru(i.documents),u=Ka.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(c,t.isPrimaryClient,u);z0(t,n,d.au);const f=new $P(e,n,o);return t.Tu.set(e,f),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function GP(t,e,n){const r=le(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!Tu(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await af(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Bm(r.remoteStore,s.targetId),uf(r,s.targetId)}).catch(no)):(uf(r,s.targetId),await af(r.localStore,s.targetId,!0))}async function QP(t,e){const n=le(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Bm(n.remoteStore,r.targetId))}async function YP(t,e,n){const r=rR(t);try{const s=await function(o,c){const u=le(o),d=Ae.now(),f=c.reduce((E,C)=>E.add(C.key),me());let p,g;return u.persistence.runTransaction("Locally write mutations","readwrite",E=>{let C=or(),P=me();return u.Ns.getEntries(E,f).next(b=>{C=b,C.forEach((T,x)=>{x.isValidDocument()||(P=P.add(T))})}).next(()=>u.localDocuments.getOverlayedDocuments(E,C)).next(b=>{p=b;const T=[];for(const x of c){const A=dC(x,p.get(x.key).overlayedDocument);A!=null&&T.push(new os(x.key,A,Q1(A.value.mapValue),en.exists(!0)))}return u.mutationQueue.addMutationBatch(E,d,T,c)}).next(b=>{g=b;const T=b.applyToLocalDocumentSet(p,P);return u.documentOverlayCache.saveOverlays(E,b.batchId,T)})}).then(()=>({batchId:g.batchId,changes:ox(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,c,u){let d=o.Vu[o.currentUser.toKey()];d||(d=new je(fe)),d=d.insert(c,u),o.Vu[o.currentUser.toKey()]=d}(r,s.batchId,n),await Qa(r,s.changes),await Cu(r.remoteStore)}catch(s){const i=Wm(s,"Failed to persist write");n.reject(i)}}async function Bx(t,e){const n=le(t);try{const r=await cP(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(ve(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?ve(o.hu,14607):s.removedDocuments.size>0&&(ve(o.hu,42227),o.hu=!1))}),await Qa(n,r,e)}catch(r){await no(r)}}function $0(t,e,n){const r=le(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const c=o.view.va(e);c.snapshot&&s.push(c.snapshot)}),function(o,c){const u=le(o);u.onlineState=c;let d=!1;u.queries.forEach((f,p)=>{for(const g of p.Sa)g.va(c)&&(d=!0)}),d&&Qm(u)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function XP(t,e,n){const r=le(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new je(te.comparator);o=o.insert(i,pt.newNoDocument(i,oe.min()));const c=me().add(i),u=new Au(oe.min(),new Map,new je(fe),o,c);await Bx(r,u),r.du=r.du.remove(i),r.Au.delete(e),Jm(r)}else await af(r.localStore,e,!1).then(()=>uf(r,e,n)).catch(no)}async function JP(t,e){const n=le(t),r=e.batch.batchId;try{const s=await lP(n.localStore,e);zx(n,r,null),$x(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Qa(n,s)}catch(s){await no(s)}}async function ZP(t,e,n){const r=le(t);try{const s=await function(o,c){const u=le(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return u.mutationQueue.lookupMutationBatch(d,c).next(p=>(ve(p!==null,37113),f=p.keys(),u.mutationQueue.removeMutationBatch(d,p))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>u.localDocuments.getDocuments(d,f))})}(r.localStore,e);zx(r,e,n),$x(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Qa(r,s)}catch(s){await no(s)}}function $x(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function zx(t,e,n){const r=le(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function uf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||qx(t,r)})}function qx(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Bm(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Jm(t))}function z0(t,e,n){for(const r of n)r instanceof Ox?(t.Ru.addReference(r.key,e),eR(t,r)):r instanceof Fx?(X(Xm,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||qx(t,r.key)):ie(19791,{wu:r})}function eR(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(X(Xm,"New document in limbo: "+n),t.Eu.add(r),Jm(t))}function Jm(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new te(Ee.fromString(e)),r=t.fu.next();t.Au.set(r,new zP(n)),t.du=t.du.insert(n,r),Rx(t.remoteStore,new Cr(Cn(Eu(n.path)),r,"TargetPurposeLimboResolution",wu.ce))}}async function Qa(t,e,n){const r=le(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((c,u)=>{o.push(r.pu(u,e,n).then(d=>{var f;if((d||n)&&r.isPrimaryClient){const p=d?!d.fromCache:(f=n==null?void 0:n.targetChanges.get(u.targetId))==null?void 0:f.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(d){s.push(d);const p=Fm.As(u.targetId,d);i.push(p)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(u,d){const f=le(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>z.forEach(d,g=>z.forEach(g.Es,E=>f.persistence.referenceDelegate.addReference(p,g.targetId,E)).next(()=>z.forEach(g.ds,E=>f.persistence.referenceDelegate.removeReference(p,g.targetId,E)))))}catch(p){if(!ro(p))throw p;X(Um,"Failed to update sequence numbers: "+p)}for(const p of d){const g=p.targetId;if(!p.fromCache){const E=f.Ms.get(g),C=E.snapshotVersion,P=E.withLastLimboFreeSnapshotVersion(C);f.Ms=f.Ms.insert(g,P)}}}(r.localStore,i))}async function tR(t,e){const n=le(t);if(!n.currentUser.isEqual(e)){X(Xm,"User change. New user:",e.toKey());const r=await kx(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(c=>{c.forEach(u=>{u.reject(new Y($.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Qa(n,r.Ls)}}function nR(t,e){const n=le(t),r=n.Au.get(e);if(r&&r.hu)return me().add(r.key);{let s=me();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const c=n.Tu.get(o);s=s.unionWith(c.view.nu)}return s}}function Hx(t){const e=le(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Bx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=nR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=XP.bind(null,e),e.Pu.H_=FP.bind(null,e.eventManager),e.Pu.yu=UP.bind(null,e.eventManager),e}function rR(t){const e=le(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=JP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ZP.bind(null,e),e}class qc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ku(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return aP(this.persistence,new sP,e.initialUser,this.serializer)}Cu(e){return new Ax(Om.mi,this.serializer)}Du(e){return new mP}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}qc.provider={build:()=>new qc};class sR extends qc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ve(this.persistence.referenceDelegate instanceof $c,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new zC(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?St.withCacheSize(this.cacheSizeBytes):St.DEFAULT;return new Ax(r=>$c.mi(r,n),this.serializer)}}class df{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>$0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=tR.bind(null,this.syncEngine),await MP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new OP}()}createDatastore(e){const n=ku(e.databaseInfo.databaseId),r=function(i){return new wP(i)}(e.databaseInfo);return function(i,o,c,u){return new TP(i,o,c,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,c){return new bP(r,s,i,o,c)}(this.localStore,this.datastore,e.asyncQueue,n=>$0(this.syncEngine,n,0),function(){return M0.v()?new M0:new pP}())}createSyncEngine(e,n){return function(s,i,o,c,u,d,f){const p=new qP(s,i,o,c,u,d);return f&&(p.gu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=le(s);X(Bs,"RemoteStore shutting down."),i.Ea.add(5),await Ga(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}df.provider={build:()=>new df};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zm{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ir("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr="FirestoreClient";class iR{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=ht.UNAUTHENTICATED,this.clientId=bm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{X(Jr,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(X(Jr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Jn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Wm(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Bd(t,e){t.asyncQueue.verifyOperationInProgress(),X(Jr,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await kx(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function q0(t,e){t.asyncQueue.verifyOperationInProgress();const n=await oR(t);X(Jr,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>O0(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>O0(e.remoteStore,s)),t._onlineComponents=e}async function oR(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){X(Jr,"Using user provided OfflineComponentProvider");try{await Bd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===$.FAILED_PRECONDITION||s.code===$.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Fi("Error using user provided cache. Falling back to memory cache: "+n),await Bd(t,new qc)}}else X(Jr,"Using default OfflineComponentProvider"),await Bd(t,new sR(void 0));return t._offlineComponents}async function Wx(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(X(Jr,"Using user provided OnlineComponentProvider"),await q0(t,t._uninitializedComponentsProvider._online)):(X(Jr,"Using default OnlineComponentProvider"),await q0(t,new df))),t._onlineComponents}function aR(t){return Wx(t).then(e=>e.syncEngine)}async function Hc(t){const e=await Wx(t),n=e.eventManager;return n.onListen=HP.bind(null,e.syncEngine),n.onUnlisten=GP.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=WP.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=QP.bind(null,e.syncEngine),n}function lR(t,e,n={}){const r=new Jn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,c,u,d){const f=new Zm({next:g=>{f.Nu(),o.enqueueAndForget(()=>Gm(i,p));const E=g.docs.has(c);!E&&g.fromCache?d.reject(new Y($.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&g.fromCache&&u&&u.source==="server"?d.reject(new Y($.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(g)},error:g=>d.reject(g)}),p=new Ym(Eu(c.path),f,{includeMetadataChanges:!0,qa:!0});return Km(i,p)}(await Hc(t),t.asyncQueue,e,n,r)),r.promise}function cR(t,e,n={}){const r=new Jn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,c,u,d){const f=new Zm({next:g=>{f.Nu(),o.enqueueAndForget(()=>Gm(i,p)),g.fromCache&&u.source==="server"?d.reject(new Y($.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(g)},error:g=>d.reject(g)}),p=new Ym(c,f,{includeMetadataChanges:!0,qa:!0});return Km(i,p)}(await Hc(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kx(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H0=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gx="firestore.googleapis.com",W0=!0;class K0{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Y($.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Gx,this.ssl=W0}else this.host=e.host,this.ssl=e.ssl??W0;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Sx;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<BC)throw new Y($.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}SN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Kx(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Y($.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Y($.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Y($.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Pu{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new K0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Y($.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Y($.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new K0(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new gN;switch(r.type){case"firstParty":return new _N(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Y($.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=H0.get(n);r&&(X("ComponentProvider","Removing Datastore"),H0.delete(n),r.terminate())}(this),Promise.resolve()}}function uR(t,e,n,r={}){var d;t=Dt(t,Pu);const s=Xi(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${n}`;s&&(V_(`https://${c}`),O_("Firestore",!0)),i.host!==Gx&&i.host!==c&&Fi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:c,ssl:s,emulatorOptions:r};if(!Wr(u,o)&&(t._setSettings(u),r.mockUserToken)){let f,p;if(typeof r.mockUserToken=="string")f=r.mockUserToken,p=ht.MOCK_USER;else{f=Pb(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new Y($.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new ht(g)}t._authCredentials=new yN(new V1(f,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ys(this.firestore,e,this._query)}}class Me{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Br(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Me(this.firestore,e,this._key)}toJSON(){return{type:Me._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(qa(n,Me._jsonSchema))return new Me(e,r||null,new te(Ee.fromString(n.referencePath)))}}Me._jsonSchemaVersion="firestore/documentReference/1.0",Me._jsonSchema={type:qe("string",Me._jsonSchemaVersion),referencePath:qe("string")};class Br extends Ys{constructor(e,n,r){super(e,n,Eu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Me(this.firestore,null,new te(e))}withConverter(e){return new Br(this.firestore,e,this._path)}}function Be(t,e,...n){if(t=Ve(t),O1("collection","path",e),t instanceof Pu){const r=Ee.fromString(e,...n);return o0(r),new Br(t,null,r)}{if(!(t instanceof Me||t instanceof Br))throw new Y($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ee.fromString(e,...n));return o0(r),new Br(t.firestore,null,r)}}function Ge(t,e,...n){if(t=Ve(t),arguments.length===1&&(e=bm.newId()),O1("doc","path",e),t instanceof Pu){const r=Ee.fromString(e,...n);return i0(r),new Me(t,null,new te(r))}{if(!(t instanceof Me||t instanceof Br))throw new Y($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ee.fromString(e,...n));return i0(r),new Me(t.firestore,t instanceof Br?t.converter:null,new te(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G0="AsyncQueue";class Q0{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Cx(this,"async_queue_retry"),this._c=()=>{const r=Ud();r&&X(G0,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Ud();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Ud();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Jn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ro(e))throw e;X(G0,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,ir("INTERNAL UNHANDLED ERROR: ",Y0(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=Hm.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&ie(47125,{Pc:Y0(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Y0(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X0(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class ar extends Pu{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Q0,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Q0(e),this._firestoreClient=void 0,await e}}}function Qx(t,e){const n=typeof t=="object"?t:pm(),r=typeof t=="string"?t:Vc,s=Ji(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Nb("firestore");i&&uR(s,...i)}return s}function Ru(t){if(t._terminated)throw new Y($.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||dR(t),t._firestoreClient}function dR(t){var r,s,i;const e=t._freezeSettings(),n=function(c,u,d,f){return new VN(c,u,d,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,Kx(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new iR(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Yt(at.fromBase64String(e))}catch(n){throw new Y($.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Yt(at.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Yt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(qa(e,Yt._jsonSchema))return Yt.fromBase64String(e.bytes)}}Yt._jsonSchemaVersion="firestore/bytes/1.0",Yt._jsonSchema={type:qe("string",Yt._jsonSchemaVersion),bytes:qe("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Y($.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new st(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class io{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Y($.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Y($.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return fe(this._lat,e._lat)||fe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Rn._jsonSchemaVersion}}static fromJSON(e){if(qa(e,Rn._jsonSchema))return new Rn(e.latitude,e.longitude)}}Rn._jsonSchemaVersion="firestore/geoPoint/1.0",Rn._jsonSchema={type:qe("string",Rn._jsonSchemaVersion),latitude:qe("number"),longitude:qe("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:jn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(qa(e,jn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new jn(e.vectorValues);throw new Y($.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}jn._jsonSchemaVersion="firestore/vectorValue/1.0",jn._jsonSchema={type:qe("string",jn._jsonSchemaVersion),vectorValues:qe("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hR=/^__.*__$/;class fR{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new os(e,this.data,this.fieldMask,n,this.fieldTransforms):new Wa(e,this.data,n,this.fieldTransforms)}}class Yx{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new os(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Xx(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ie(40011,{Ac:t})}}class Du{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Du({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Wc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Xx(this.Ac)&&hR.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class mR{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||ku(e)}Cc(e,n,r,s=!1){return new Du({Ac:e,methodName:n,Dc:r,path:st.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Lu(t){const e=t._freezeSettings(),n=ku(t._databaseId);return new mR(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Jx(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);rp("Data must be an object, but it was:",o,r);const c=Zx(r,o);let u,d;if(i.merge)u=new Bt(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const p of i.mergeFields){const g=hf(e,p,n);if(!o.contains(g))throw new Y($.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);tE(f,g)||f.push(g)}u=new Bt(f),d=o.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,d=o.fieldTransforms;return new fR(new Nt(c),u,d)}class Mu extends io{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Mu}}function pR(t,e,n){return new Du({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class ep extends io{_toFieldTransform(e){return new Rm(e.path,new Na)}isEqual(e){return e instanceof ep}}class tp extends io{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=pR(this,e,!0),r=this.vc.map(i=>oo(i,n)),s=new zi(r);return new Rm(e.path,s)}isEqual(e){return e instanceof tp&&Wr(this.vc,e.vc)}}class np extends io{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new Pa(e.serializer,cx(e.serializer,this.Fc));return new Rm(e.path,n)}isEqual(e){return e instanceof np&&this.Fc===e.Fc}}function gR(t,e,n,r){const s=t.Cc(1,e,n);rp("Data must be an object, but it was:",s,r);const i=[],o=Nt.empty();is(r,(u,d)=>{const f=sp(e,u,n);d=Ve(d);const p=s.yc(f);if(d instanceof Mu)i.push(f);else{const g=oo(d,p);g!=null&&(i.push(f),o.set(f,g))}});const c=new Bt(i);return new Yx(o,c,s.fieldTransforms)}function yR(t,e,n,r,s,i){const o=t.Cc(1,e,n),c=[hf(e,r,n)],u=[s];if(i.length%2!=0)throw new Y($.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)c.push(hf(e,i[g])),u.push(i[g+1]);const d=[],f=Nt.empty();for(let g=c.length-1;g>=0;--g)if(!tE(d,c[g])){const E=c[g];let C=u[g];C=Ve(C);const P=o.yc(E);if(C instanceof Mu)d.push(E);else{const b=oo(C,P);b!=null&&(d.push(E),f.set(E,b))}}const p=new Bt(d);return new Yx(f,p,o.fieldTransforms)}function vR(t,e,n,r=!1){return oo(n,t.Cc(r?4:3,e))}function oo(t,e){if(eE(t=Ve(t)))return rp("Unsupported field value:",e,t),Zx(t,e);if(t instanceof io)return function(r,s){if(!Xx(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const c of r){let u=oo(c,s.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Ve(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return cx(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Ae.fromDate(r);return{timestampValue:Bc(s.serializer,i)}}if(r instanceof Ae){const i=new Ae(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Bc(s.serializer,i)}}if(r instanceof Rn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Yt)return{bytesValue:wx(s.serializer,r._byteString)};if(r instanceof Me){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Mm(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof jn)return function(o,c){return{mapValue:{fields:{[K1]:{stringValue:G1},[Oc]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return Pm(c.serializer,d)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${vu(r)}`)}(t,e)}function Zx(t,e){const n={};return B1(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):is(t,(r,s)=>{const i=oo(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function eE(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ae||t instanceof Rn||t instanceof Yt||t instanceof Me||t instanceof io||t instanceof jn)}function rp(t,e,n){if(!eE(n)||!F1(n)){const r=vu(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function hf(t,e,n){if((e=Ve(e))instanceof ju)return e._internalPath;if(typeof e=="string")return sp(t,e);throw Wc("Field path arguments must be of type string or ",t,!1,void 0,n)}const wR=new RegExp("[~\\*/\\[\\]]");function sp(t,e,n){if(e.search(wR)>=0)throw Wc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ju(...e.split("."))._internalPath}catch{throw Wc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Wc(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new Y($.INVALID_ARGUMENT,c+t+u)}function tE(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nE{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Me(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new _R(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(ip("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class _R extends nE{data(){return super.data()}}function ip(t,e){return typeof e=="string"?sp(t,e):e instanceof ju?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Y($.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class op{}class xR extends op{}function Tn(t,e,...n){let r=[];e instanceof op&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof ap).length,c=i.filter(u=>u instanceof Vu).length;if(o>1||o>0&&c>0)throw new Y($.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Vu extends xR{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Vu(e,n,r)}_apply(e){const n=this._parse(e);return sE(e._query,n),new Ys(e.firestore,e.converter,ef(e._query,n))}_parse(e){const n=Lu(e.firestore);return function(i,o,c,u,d,f,p){let g;if(d.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new Y($.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Z0(p,f);const C=[];for(const P of p)C.push(J0(u,i,P));g={arrayValue:{values:C}}}else g=J0(u,i,p)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Z0(p,f),g=vR(c,o,p,f==="in"||f==="not-in");return ze.create(d,f,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Pi(t,e,n){const r=e,s=ip("where",t);return Vu._create(s,r,n)}class ap extends op{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new ap(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:gn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const c=i.getFlattenedFilters();for(const u of c)sE(o,u),o=ef(o,u)}(e._query,n),new Ys(e.firestore,e.converter,ef(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function J0(t,e,n){if(typeof(n=Ve(n))=="string"){if(n==="")throw new Y($.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!nx(e)&&n.indexOf("/")!==-1)throw new Y($.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ee.fromString(n));if(!te.isDocumentKey(r))throw new Y($.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return m0(t,new te(r))}if(n instanceof Me)return m0(t,n._key);throw new Y($.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${vu(n)}.`)}function Z0(t,e){if(!Array.isArray(t)||t.length===0)throw new Y($.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function sE(t,e){const n=function(s,i){for(const o of s)for(const c of o.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Y($.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Y($.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class ER{convertValue(e,n="none"){switch(Yr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Oe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Qr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ie(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return is(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[Oc].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>Oe(o.doubleValue));return new jn(n)}convertGeoPoint(e){return new Rn(Oe(e.latitude),Oe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=xu(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Sa(e));default:return null}}convertTimestamp(e){const n=Gr(e);return new Ae(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ee.fromString(e);ve(bx(r),9688,{name:e});const s=new Aa(r.get(1),r.get(3)),i=new te(r.popFirst(5));return s.isEqual(n)||ir(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iE(t,e,n){let r;return r=t?t.toFirestore(e):e,r}class zo{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Cs extends nE{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new ec(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(ip("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Y($.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Cs._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Cs._jsonSchemaVersion="firestore/documentSnapshot/1.0",Cs._jsonSchema={type:qe("string",Cs._jsonSchemaVersion),bundleSource:qe("string","DocumentSnapshot"),bundleName:qe("string"),bundle:qe("string")};class ec extends Cs{data(e={}){return super.data(e)}}class Ps{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new zo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new ec(this._firestore,this._userDataWriter,r.key,r,new zo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Y($.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(c=>{const u=new ec(s._firestore,s._userDataWriter,c.doc.key,c.doc,new zo(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const u=new ec(s._firestore,s._userDataWriter,c.doc.key,c.doc,new zo(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,f=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),f=o.indexOf(c.doc.key)),{type:TR(c.type),doc:u,oldIndex:d,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Y($.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ps._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=bm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function TR(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ie(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kc(t){t=Dt(t,Me);const e=Dt(t.firestore,ar);return lR(Ru(e),t._key).then(n=>cE(e,t,n))}Ps._jsonSchemaVersion="firestore/querySnapshot/1.0",Ps._jsonSchema={type:qe("string",Ps._jsonSchemaVersion),bundleSource:qe("string","QuerySnapshot"),bundleName:qe("string"),bundle:qe("string")};class lp extends ER{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yt(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,n)}}function oE(t){t=Dt(t,Ys);const e=Dt(t.firestore,ar),n=Ru(e),r=new lp(e);return rE(t._query),cR(n,t._query).then(s=>new Ps(e,r,t,s))}function aE(t,e,n){t=Dt(t,Me);const r=Dt(t.firestore,ar),s=iE(t.converter,e);return Ou(r,[Jx(Lu(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,en.none())])}function At(t,e,n,...r){t=Dt(t,Me);const s=Dt(t.firestore,ar),i=Lu(s);let o;return o=typeof(e=Ve(e))=="string"||e instanceof ju?yR(i,"updateDoc",t._key,e,n,r):gR(i,"updateDoc",t._key,e),Ou(s,[o.toMutation(t._key,en.exists(!0))])}function lE(t){return Ou(Dt(t.firestore,ar),[new jm(t._key,en.none())])}function In(t,e){const n=Dt(t.firestore,ar),r=Ge(t),s=iE(t.converter,e);return Ou(n,[Jx(Lu(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,en.exists(!1))]).then(()=>r)}function bn(t,...e){var u,d,f;t=Ve(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||X0(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(X0(e[r])){const p=e[r];e[r]=(u=p.next)==null?void 0:u.bind(p),e[r+1]=(d=p.error)==null?void 0:d.bind(p),e[r+2]=(f=p.complete)==null?void 0:f.bind(p)}let i,o,c;if(t instanceof Me)o=Dt(t.firestore,ar),c=Eu(t._key.path),i={next:p=>{e[r]&&e[r](cE(o,t,p))},error:e[r+1],complete:e[r+2]};else{const p=Dt(t,Ys);o=Dt(p.firestore,ar),c=p._query;const g=new lp(o);i={next:E=>{e[r]&&e[r](new Ps(o,g,p,E))},error:e[r+1],complete:e[r+2]},rE(t._query)}return function(g,E,C,P){const b=new Zm(P),T=new Ym(E,b,C);return g.asyncQueue.enqueueAndForget(async()=>Km(await Hc(g),T)),()=>{b.Nu(),g.asyncQueue.enqueueAndForget(async()=>Gm(await Hc(g),T))}}(Ru(o),c,s,i)}function Ou(t,e){return function(r,s){const i=new Jn;return r.asyncQueue.enqueueAndForget(async()=>YP(await aR(r),s,i)),i.promise}(Ru(t),e)}function cE(t,e,n){const r=n.docs.get(e._key),s=new lp(t);return new Cs(t,s,e._key,r,new zo(n.hasPendingWrites,n.fromCache),e.converter)}function ft(){return new ep("serverTimestamp")}function Gc(...t){return new tp("arrayUnion",t)}function Qc(t){return new np("increment",t)}(function(e,n=!0){(function(s){to=s})(Zi),Dn(new mn("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),c=new ar(new vN(r.getProvider("auth-internal")),new xN(o,r.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Y($.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Aa(d.options.projectId,f)}(o,s),o);return i={useFetchStreams:n,...i},c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),Zt(t0,n0,e),Zt(t0,n0,"esm2020")})();const uE="@firebase/installations",cp="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dE=1e4,hE=`w:${cp}`,fE="FIS_v2",IR="https://firebaseinstallations.googleapis.com/v1",bR=60*60*1e3,SR="installations",AR="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kR={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},$s=new Ks(SR,AR,kR);function mE(t){return t instanceof Mn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pE({projectId:t}){return`${IR}/projects/${t}/installations`}function gE(t){return{token:t.token,requestStatus:2,expiresIn:CR(t.expiresIn),creationTime:Date.now()}}async function yE(t,e){const r=(await e.json()).error;return $s.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function vE({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function NR(t,{refreshToken:e}){const n=vE(t);return n.append("Authorization",PR(e)),n}async function wE(t){const e=await t();return e.status>=500&&e.status<600?t():e}function CR(t){return Number(t.replace("s","000"))}function PR(t){return`${fE} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RR({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=pE(t),s=vE(t),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={fid:n,authVersion:fE,appId:t.appId,sdkVersion:hE},c={method:"POST",headers:s,body:JSON.stringify(o)},u=await wE(()=>fetch(r,c));if(u.ok){const d=await u.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:gE(d.authToken)}}else throw await yE("Create Installation",u)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _E(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jR(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DR=/^[cdef][\w-]{21}$/,ff="";function LR(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=MR(t);return DR.test(n)?n:ff}catch{return ff}}function MR(t){return jR(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fu(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xE=new Map;function EE(t,e){const n=Fu(t);TE(n,e),VR(n,e)}function TE(t,e){const n=xE.get(t);if(n)for(const r of n)r(e)}function VR(t,e){const n=OR();n&&n.postMessage({key:t,fid:e}),FR()}let As=null;function OR(){return!As&&"BroadcastChannel"in self&&(As=new BroadcastChannel("[Firebase] FID Change"),As.onmessage=t=>{TE(t.data.key,t.data.fid)}),As}function FR(){xE.size===0&&As&&(As.close(),As=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UR="firebase-installations-database",BR=1,zs="firebase-installations-store";let $d=null;function up(){return $d||($d=mu(UR,BR,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(zs)}}})),$d}async function Yc(t,e){const n=Fu(t),s=(await up()).transaction(zs,"readwrite"),i=s.objectStore(zs),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&EE(t,e.fid),e}async function IE(t){const e=Fu(t),r=(await up()).transaction(zs,"readwrite");await r.objectStore(zs).delete(e),await r.done}async function Uu(t,e){const n=Fu(t),s=(await up()).transaction(zs,"readwrite"),i=s.objectStore(zs),o=await i.get(n),c=e(o);return c===void 0?await i.delete(n):await i.put(c,n),await s.done,c&&(!o||o.fid!==c.fid)&&EE(t,c.fid),c}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dp(t){let e;const n=await Uu(t.appConfig,r=>{const s=$R(r),i=zR(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===ff?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function $R(t){const e=t||{fid:LR(),registrationStatus:0};return bE(e)}function zR(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject($s.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=qR(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:HR(t)}:{installationEntry:e}}async function qR(t,e){try{const n=await RR(t,e);return Yc(t.appConfig,n)}catch(n){throw mE(n)&&n.customData.serverCode===409?await IE(t.appConfig):await Yc(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function HR(t){let e=await ev(t.appConfig);for(;e.registrationStatus===1;)await _E(100),e=await ev(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await dp(t);return r||n}return e}function ev(t){return Uu(t,e=>{if(!e)throw $s.create("installation-not-found");return bE(e)})}function bE(t){return WR(t)?{fid:t.fid,registrationStatus:0}:t}function WR(t){return t.registrationStatus===1&&t.registrationTime+dE<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KR({appConfig:t,heartbeatServiceProvider:e},n){const r=GR(t,n),s=NR(t,n),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={installation:{sdkVersion:hE,appId:t.appId}},c={method:"POST",headers:s,body:JSON.stringify(o)},u=await wE(()=>fetch(r,c));if(u.ok){const d=await u.json();return gE(d)}else throw await yE("Generate Auth Token",u)}function GR(t,{fid:e}){return`${pE(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hp(t,e=!1){let n;const r=await Uu(t.appConfig,i=>{if(!SE(i))throw $s.create("not-registered");const o=i.authToken;if(!e&&XR(o))return i;if(o.requestStatus===1)return n=QR(t,e),i;{if(!navigator.onLine)throw $s.create("app-offline");const c=ZR(i);return n=YR(t,c),c}});return n?await n:r.authToken}async function QR(t,e){let n=await tv(t.appConfig);for(;n.authToken.requestStatus===1;)await _E(100),n=await tv(t.appConfig);const r=n.authToken;return r.requestStatus===0?hp(t,e):r}function tv(t){return Uu(t,e=>{if(!SE(e))throw $s.create("not-registered");const n=e.authToken;return e4(n)?{...e,authToken:{requestStatus:0}}:e})}async function YR(t,e){try{const n=await KR(t,e),r={...e,authToken:n};return await Yc(t.appConfig,r),n}catch(n){if(mE(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await IE(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await Yc(t.appConfig,r)}throw n}}function SE(t){return t!==void 0&&t.registrationStatus===2}function XR(t){return t.requestStatus===2&&!JR(t)}function JR(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+bR}function ZR(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function e4(t){return t.requestStatus===1&&t.requestTime+dE<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t4(t){const e=t,{installationEntry:n,registrationPromise:r}=await dp(e);return r?r.catch(console.error):hp(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n4(t,e=!1){const n=t;return await r4(n),(await hp(n,e)).token}async function r4(t){const{registrationPromise:e}=await dp(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s4(t){if(!t||!t.options)throw zd("App Configuration");if(!t.name)throw zd("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw zd(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function zd(t){return $s.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AE="installations",i4="installations-internal",o4=t=>{const e=t.getProvider("app").getImmediate(),n=s4(e),r=Ji(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},a4=t=>{const e=t.getProvider("app").getImmediate(),n=Ji(e,AE).getImmediate();return{getId:()=>t4(n),getToken:s=>n4(n,s)}};function l4(){Dn(new mn(AE,o4,"PUBLIC")),Dn(new mn(i4,a4,"PRIVATE"))}l4();Zt(uE,cp);Zt(uE,cp,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c4="/firebase-messaging-sw.js",u4="/firebase-cloud-messaging-push-scope",kE="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",d4="https://fcmregistrations.googleapis.com/v1",NE="google.c.a.c_id",h4="google.c.a.c_l",f4="google.c.a.ts",m4="google.c.a.e",nv=1e4;var rv;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(rv||(rv={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var Ra;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(Ra||(Ra={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bn(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function p4(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qd="fcm_token_details_db",g4=5,sv="fcm_token_object_Store";async function y4(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(qd))return null;let e=null;return(await mu(qd,g4,{upgrade:async(r,s,i,o)=>{if(s<2||!r.objectStoreNames.contains(sv))return;const c=o.objectStore(sv),u=await c.index("fcmSenderId").get(t);if(await c.clear(),!!u){if(s===2){const d=u;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:d.createTime??Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:Bn(d.vapidKey)}}}else if(s===3){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Bn(d.auth),p256dh:Bn(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Bn(d.vapidKey)}}}else if(s===4){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Bn(d.auth),p256dh:Bn(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Bn(d.vapidKey)}}}}}})).close(),await Rd(qd),await Rd("fcm_vapid_details_db"),await Rd("undefined"),v4(e)?e:null}function v4(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w4="firebase-messaging-database",_4=1,ja="firebase-messaging-store";let Hd=null;function CE(){return Hd||(Hd=mu(w4,_4,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(ja)}}})),Hd}async function x4(t){const e=PE(t),r=await(await CE()).transaction(ja).objectStore(ja).get(e);if(r)return r;{const s=await y4(t.appConfig.senderId);if(s)return await fp(t,s),s}}async function fp(t,e){const n=PE(t),s=(await CE()).transaction(ja,"readwrite");return await s.objectStore(ja).put(e,n),await s.done,e}function PE({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E4={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},gt=new Ks("messaging","Messaging",E4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T4(t,e){const n=await pp(t),r=RE(e),s={method:"POST",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(mp(t.appConfig),s)).json()}catch(o){throw gt.create("token-subscribe-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw gt.create("token-subscribe-failed",{errorInfo:o})}if(!i.token)throw gt.create("token-subscribe-no-token");return i.token}async function I4(t,e){const n=await pp(t),r=RE(e.subscriptionOptions),s={method:"PATCH",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(`${mp(t.appConfig)}/${e.token}`,s)).json()}catch(o){throw gt.create("token-update-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw gt.create("token-update-failed",{errorInfo:o})}if(!i.token)throw gt.create("token-update-no-token");return i.token}async function b4(t,e){const r={method:"DELETE",headers:await pp(t)};try{const i=await(await fetch(`${mp(t.appConfig)}/${e}`,r)).json();if(i.error){const o=i.error.message;throw gt.create("token-unsubscribe-failed",{errorInfo:o})}}catch(s){throw gt.create("token-unsubscribe-failed",{errorInfo:s==null?void 0:s.toString()})}}function mp({projectId:t}){return`${d4}/projects/${t}/registrations`}async function pp({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function RE({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const s={web:{endpoint:n,auth:e,p256dh:t}};return r!==kE&&(s.web.applicationPubKey=r),s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S4=7*24*60*60*1e3;async function A4(t){const e=await N4(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Bn(e.getKey("auth")),p256dh:Bn(e.getKey("p256dh"))},r=await x4(t.firebaseDependencies);if(r){if(C4(r.subscriptionOptions,n))return Date.now()>=r.createTime+S4?k4(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await b4(t.firebaseDependencies,r.token)}catch(s){console.warn(s)}return iv(t.firebaseDependencies,n)}else return iv(t.firebaseDependencies,n)}async function k4(t,e){try{const n=await I4(t.firebaseDependencies,e),r={...e,token:n,createTime:Date.now()};return await fp(t.firebaseDependencies,r),n}catch(n){throw n}}async function iv(t,e){const r={token:await T4(t,e),createTime:Date.now(),subscriptionOptions:e};return await fp(t,r),r.token}async function N4(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:p4(e)})}function C4(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,s=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&r&&s&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ov(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return P4(e,t),R4(e,t),j4(e,t),e}function P4(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const s=e.notification.image;s&&(t.notification.image=s);const i=e.notification.icon;i&&(t.notification.icon=i)}function R4(t,e){e.data&&(t.data=e.data)}function j4(t,e){var s,i,o,c;if(!e.fcmOptions&&!((s=e.notification)!=null&&s.click_action))return;t.fcmOptions={};const n=((i=e.fcmOptions)==null?void 0:i.link)??((o=e.notification)==null?void 0:o.click_action);n&&(t.fcmOptions.link=n);const r=(c=e.fcmOptions)==null?void 0:c.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D4(t){return typeof t=="object"&&!!t&&NE in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L4(t){if(!t||!t.options)throw Wd("App Configuration Object");if(!t.name)throw Wd("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw Wd(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function Wd(t){return gt.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=L4(e);this.firebaseDependencies={app:e,appConfig:s,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V4(t){try{t.swRegistration=await navigator.serviceWorker.register(c4,{scope:u4}),t.swRegistration.update().catch(()=>{}),await O4(t.swRegistration)}catch(e){throw gt.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}async function O4(t){return new Promise((e,n)=>{const r=setTimeout(()=>n(new Error(`Service worker not registered after ${nv} ms`)),nv),s=t.installing||t.waiting;t.active?(clearTimeout(r),e()):s?s.onstatechange=i=>{var o;((o=i.target)==null?void 0:o.state)==="activated"&&(s.onstatechange=null,clearTimeout(r),e())}:(clearTimeout(r),n(new Error("No incoming service worker found.")))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F4(t,e){if(!e&&!t.swRegistration&&await V4(t),!(!e&&t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw gt.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U4(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=kE)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jE(t,e){if(!navigator)throw gt.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw gt.create("permission-blocked");return await U4(t,e==null?void 0:e.vapidKey),await F4(t,e==null?void 0:e.serviceWorkerRegistration),A4(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B4(t,e,n){const r=$4(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[NE],message_name:n[h4],message_time:n[f4],message_device_time:Math.floor(Date.now()/1e3)})}function $4(t){switch(t){case Ra.NOTIFICATION_CLICKED:return"notification_open";case Ra.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z4(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===Ra.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(ov(n)):t.onMessageHandler.next(ov(n)));const r=n.data;D4(r)&&r[m4]==="1"&&await B4(t,n.messageType,r)}const av="@firebase/messaging",lv="0.12.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q4=t=>{const e=new M4(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>z4(e,n)),e},H4=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:r=>jE(e,r)}};function W4(){Dn(new mn("messaging",q4,"PUBLIC")),Dn(new mn("messaging-internal",H4,"PRIVATE")),Zt(av,lv),Zt(av,lv,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K4(){try{await U_()}catch{return!1}return typeof window<"u"&&F_()&&Bb()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G4(t,e){if(!navigator)throw gt.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DE(t=pm()){return K4().then(e=>{if(!e)throw gt.create("unsupported-browser")},e=>{throw gt.create("indexed-db-unsupported")}),Ji(Ve(t),"messaging").getImmediate()}async function LE(t,e){return t=Ve(t),jE(t,e)}function ME(t,e){return t=Ve(t),G4(t,e)}W4();const Q4={apiKey:"AIzaSyDgTGIPoHLYy9rfdpiQo07Y7F-1ytphaQM",authDomain:"botiga-35dc0.firebaseapp.com",projectId:"botiga-35dc0",storageBucket:"botiga-35dc0.firebasestorage.app",messagingSenderId:"671047302164",appId:"1:671047302164:web:2cc6065f3055dbd8fdbb01",measurementId:"G-C3X8Y6GG88"},gp=mm(Q4),ys=N1(gp),We=Qx(gp),Cl=typeof window<"u"?DE(gp):null,Vt=[{id:"user-0",name:"Admin CHMolins",avatarUrl:"https://i.pravatar.cc/150?u=admin",email:"admin@chmolins.com",joinDate:"2023-01-01",role:"admin"},{id:"user-1",name:"Anna L.",avatarUrl:"https://i.pravatar.cc/150?u=anna",email:"anna@example.com",joinDate:"2023-05-12",role:"user"},{id:"user-2",name:"Carles B.",avatarUrl:"https://i.pravatar.cc/150?u=carles",email:"carles@example.com",joinDate:"2023-08-20",role:"user"},{id:"user-3",name:"Laura M.",avatarUrl:"https://i.pravatar.cc/150?u=laura",email:"laura@example.com",joinDate:"2023-11-01",role:"user"},{id:"user-4",name:"David S.",avatarUrl:"https://i.pravatar.cc/150?u=david",email:"david@example.com",joinDate:"2024-02-15",role:"user"}],cv=[{id:"1",title:"Jaqueta de cuir vintage",description:"Jaqueta de cuir genu dels anys 80, en perfecte estat. Talla M.",price:75,imageUrls:["https://images.unsplash.com/photo-1551028719-00167b16eac5?q=80&w=800"],seller:Vt[1],createdAt:new Date("2024-07-20T10:00:00Z")},{id:"2",title:"Bicicleta de muntanya Scott",description:"Bicicleta Scott Aspect 970, rodes de 29 polzades, frens de disc. Poc s.",price:350,imageUrls:["https://images.unsplash.com/photo-1576426863848-c21f68c6aa98?q=80&w=800"],seller:Vt[2],createdAt:new Date("2024-07-19T15:30:00Z")},{id:"3",title:"Cmera rflex Canon EOS 2000D",description:"Inclou objectiu 18-55mm, bossa de transport i targeta de memria. Ideal per a principiants.",price:320,imageUrls:["https://images.unsplash.com/photo-1512790182412-b19e6d62bc39?q=80&w=800"],seller:Vt[3],createdAt:new Date("2024-07-19T12:00:00Z")},{id:"4",title:"Sof de 3 places gris",description:"Sof cmode i modern. Fundes rentables. Mides: 200x90cm.",price:180,imageUrls:["https://images.unsplash.com/photo-1555041469-a586c61ea9bc?q=80&w=800"],seller:Vt[4],createdAt:new Date("2024-07-18T18:45:00Z")},{id:"5",title:"Guitarra acstica Yamaha",description:"Model F310. So excellent. Perfecta per aprendre a tocar.",price:90,imageUrls:["https://images.unsplash.com/photo-1558021211-65140282a3f8?q=80&w=800"],seller:Vt[1],createdAt:new Date("2024-07-18T11:20:00Z")},{id:"6",title:"iPhone 12 - 128GB Blau",description:"En bon estat, sempre amb protector de pantalla. Salut de la bateria al 88%.",price:450,imageUrls:["https://images.unsplash.com/photo-1616348436168-de43ad0db179?q=80&w=800"],seller:Vt[3],createdAt:new Date("2024-07-17T20:00:00Z")},{id:"7",title:"Vambes Nike Air Max",description:"Talla 43. Edici limitada. Noms utilitzades un parell de vegades.",price:85,imageUrls:["https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=800"],seller:Vt[2],createdAt:new Date("2024-07-17T09:05:00Z")},{id:"8",title:"Patinet elctric Xiaomi",description:"Model Mi Electric Scooter 3. Fins a 30 km d'autonomia. Plegable i lleuger.",price:250,imageUrls:["https://images.unsplash.com/photo-1598214013444-96379d71c664?q=80&w=800"],seller:Vt[4],createdAt:new Date("2024-07-16T14:00:00Z")},{id:"9",title:"Collecci de llibres de Harry Potter",description:"Els 7 llibres de la saga, tapa dura. Edici Salamandra.",price:60,imageUrls:["https://images.unsplash.com/photo-1618965907452-a8a235327546?q=80&w=800"],seller:Vt[1],createdAt:new Date("2024-07-15T21:30:00Z")},{id:"10",title:"Planta Monstera Deliciosa",description:"Planta d'interior gran i saludable. Inclou test de cermica.",price:30,imageUrls:["https://images.unsplash.com/photo-1614594975525-e4d524c48996?q=80&w=800"],seller:Vt[3],createdAt:new Date("2024-07-15T10:15:00Z")},{id:"11",title:"Samarreta Oficial CHM",description:"Samarreta oficial del club, 100% cot. Totes les talles disponibles.",price:25,imageUrls:["https://images.unsplash.com/photo-1571455789393-8a76380c5435?q=80&w=800"],seller:Vt[0],createdAt:new Date("2024-07-21T10:00:00Z"),isMerchandise:!0},{id:"12",title:"Tassa CHM",description:"Tassa de cermica amb el logo del club. Resistent al microones i rentaplats.",price:12.5,imageUrls:["https://images.unsplash.com/photo-1594225026210-5a9b71b83b63?q=80&w=800"],seller:Vt[0],createdAt:new Date("2024-07-21T10:05:00Z"),isMerchandise:!0},{id:"13",title:"Bufanda CHM Fans",description:"Bufanda de llana per animar l'equip els dies de partit.",price:18,imageUrls:["https://images.unsplash.com/photo-1610295313555-252a71383713?q=80&w=800"],seller:Vt[0],createdAt:new Date("2024-07-21T10:10:00Z"),isMerchandise:!0}],Y4=({product:t,currentUser:e,onClose:n,onEdit:r,onContactSeller:s,onDelete:i,onOpenImageViewer:o})=>{const[c,u]=R.useState(0),[d,f]=R.useState(!1),[p,g]=R.useState(!1),E=R.useRef(null);R.useEffect(()=>()=>{E.current&&clearTimeout(E.current)},[]),R.useEffect(()=>{const A=D=>{D.key==="Escape"&&n()};return window.addEventListener("keydown",A),()=>{window.removeEventListener("keydown",A)}},[n]);const C=async()=>{d||(p?(E.current&&(clearTimeout(E.current),E.current=null),f(!0),await i(t.id)||(f(!1),g(!1))):(g(!0),E.current=window.setTimeout(()=>{g(!1),E.current=null},4e3)))},P=(e==null?void 0:e.role)==="admin",b=(e==null?void 0:e.id)===t.seller.id,T=t.imageUrls&&t.imageUrls.length>0,x=A=>typeof A!="number"||isNaN(A)?"N/A":A.toFixed(2);return l.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:n,"aria-modal":"true",role:"dialog",children:[l.jsx("style",{children:`
        @keyframes fade-in {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        .animate-fade-in { animation: fade-in 0.2s ease-out; }
      `}),l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl lg:max-w-4xl xl:max-w-5xl max-h-[90vh] overflow-hidden flex flex-col lg:flex-row relative",onClick:A=>A.stopPropagation(),children:[l.jsx("button",{onClick:n,className:"absolute top-3 right-3 text-gray-400 hover:text-gray-800 z-10 bg-white bg-opacity-50 rounded-full p-1 transition-colors","aria-label":"Tancar",children:l.jsx(qr,{className:"w-6 h-6"})}),l.jsxs("div",{className:"w-full lg:w-3/5 flex-shrink-0 flex flex-col",children:[l.jsx("div",{className:"w-full bg-gray-100 h-80 lg:h-full flex items-center justify-center lg:flex-grow",children:T&&l.jsx("img",{src:t.imageUrls[c],alt:`${t.title} - imatge ${c+1}`,className:`w-full h-full object-cover lg:rounded-l-2xl rounded-t-2xl lg:rounded-t-none cursor-pointer ${t.tag==="vendido"?"grayscale":""}`,onClick:()=>o(t.imageUrls,c)})}),T&&t.imageUrls.length>1&&l.jsx("div",{className:"flex-shrink-0 p-2 bg-white lg:bg-gray-50 flex gap-2 justify-center",children:t.imageUrls.map((A,D)=>l.jsx("button",{onClick:()=>u(D),className:`w-12 h-12 rounded-md overflow-hidden border-2 transition-colors bg-gray-100 ${c===D?"border-primary":"border-transparent hover:border-gray-400"}`,children:l.jsx("img",{src:A,alt:`miniatura ${D+1}`,className:`w-full h-full object-cover ${t.tag==="vendido"?"grayscale":""}`})},D))})]}),l.jsxs("div",{className:"p-4 md:p-6 flex flex-col flex-1 overflow-y-auto",children:[t.tag&&Hn[t.tag]&&l.jsxs("div",{className:`w-fit text-sm font-semibold px-3 py-1 rounded-full mb-3 ${Hn[t.tag].className}`,children:[Hn[t.tag].emoji," ",Hn[t.tag].label]}),l.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-gray-900 mb-2",children:t.title}),l.jsxs("p",{className:"text-3xl lg:text-4xl font-extrabold text-primary mb-4",children:[x(t.price)," "]}),l.jsxs("div",{className:"flex-grow pr-2 space-y-4",children:[l.jsxs("div",{className:"border-t pt-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"Venedor"}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("img",{src:t.seller.avatarUrl,alt:t.seller.name,className:"w-12 h-12 rounded-full mr-4"}),l.jsx("div",{children:l.jsx("p",{className:"font-semibold text-gray-800",children:t.seller.name})})]})]}),l.jsxs("div",{className:"border-t pt-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Descripci"}),l.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:t.description})]})]}),l.jsxs("div",{className:"mt-6 flex-shrink-0 space-y-3",children:[t.isMerchandise&&l.jsxs("a",{href:"https://forms.gle/wc7nmx2MubiMix8h8",target:"_blank",rel:"noopener noreferrer",className:"w-full flex items-center justify-center gap-2 bg-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors",children:[l.jsx(qI,{className:"w-5 h-5"}),l.jsx("span",{children:"Realitzar comanda"})]}),!b&&e&&l.jsxs("button",{onClick:()=>s(t),className:`w-full flex items-center justify-center gap-2 font-bold py-3 px-4 rounded-lg transition-colors ${t.isMerchandise?"bg-gray-600 text-white hover:bg-gray-700":"bg-primary text-white hover:bg-primary-700"} disabled:bg-gray-400 disabled:cursor-not-allowed`,disabled:t.tag==="vendido",children:[l.jsx(A_,{className:"w-5 h-5"}),l.jsx("span",{children:t.tag==="vendido"?"Article venut":t.isMerchandise?"Contacta amb el club":"Contacta amb el venedor"})]}),(P||b)&&l.jsxs("div",{className:"flex gap-3",children:[l.jsxs("button",{onClick:()=>r(t),disabled:d||p,className:"w-full flex items-center justify-center gap-2 bg-yellow-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-yellow-600 transition-colors disabled:opacity-50",children:[l.jsx(UI,{className:"w-5 h-5"})," Edita"]}),l.jsx("button",{onClick:C,disabled:d,className:`w-full flex items-center justify-center gap-2 text-white font-bold py-3 px-4 rounded-lg transition-all duration-200 ${p?"bg-red-700 hover:bg-red-800":"bg-red-500 hover:bg-red-600"} disabled:bg-red-400 disabled:cursor-wait`,children:d?l.jsxs(l.Fragment,{children:[l.jsx(Vs,{className:"w-5 h-5"}),l.jsx("span",{children:"Eliminant..."})]}):p?"Confirmar eliminaci":l.jsxs(l.Fragment,{children:[l.jsx(k_,{className:"w-5 h-5"}),l.jsx("span",{children:"Elimina"})]})})]})]})]})]})]})},X4=()=>{const[t,e]=R.useState("home"),[n,r]=R.useState([]),[s,i]=R.useState([]),[o,c]=R.useState(null),[u,d]=R.useState(null),[f,p]=R.useState(null),[g,E]=R.useState(null),[C,P]=R.useState(null),[b,T]=R.useState(null),[x,A]=R.useState([]),[D,V]=R.useState(!1),[O,y]=R.useState([]),[v,I]=R.useState(null),[N,S]=R.useState([]),[k,_]=R.useState(0),ee=R.useRef(new Set),[ge,wt]=R.useState(!1);R.useEffect(()=>{if(!b)return;if((async()=>{var B;if(!Cl){console.log("Firebase Messaging no est disponible en aquest navegador.");return}try{if(await window.Notification.requestPermission()==="granted"){const W=await LE(Cl,{vapidKey:"BL2B5V3vjPkyyPrTo-aW-5s5t7oW3_Ni_M9XANqYdM1uO9jY3yA9k84Xo7Z-yL3p0M_sF3g4d2c1qWj9k7l4z5k"});if(W){const H=Ge(We,"users",b.id);(((B=(await Kc(H)).data())==null?void 0:B.fcmTokens)||[]).includes(W)||await At(H,{fcmTokens:Gc(W)})}else console.log("No s'ha pogut obtenir el token de registre.")}}catch(U){console.error("Ha ocorregut un error en configurar les notificacions:",U)}})(),Cl){const B=ME(Cl,U=>{var F,W;console.log("Missatge rebut en primer pla: ",U),c({message:`${(F=U.notification)==null?void 0:F.title}: ${(W=U.notification)==null?void 0:W.body}`,type:"success"})});return()=>B()}},[b]),R.useEffect(()=>{let L=null;const B=v1(ys,U=>{if(L&&(L(),L=null),U){const F=Ge(We,"users",U.uid);L=bn(F,W=>{W.exists()?T({id:U.uid,...W.data()}):(Ni(ys),T(null))},W=>{console.error("Error en escoltar el document d'usuari:",W),Ni(ys),T(null)})}else T(null)});return()=>{B(),L&&L()}},[]),R.useEffect(()=>{if((b==null?void 0:b.role)==="admin"){const L=Tn(Be(We,"users")),B=bn(L,U=>{const F=U.docs.map(W=>({id:W.id,...W.data()}));A(F.filter(W=>W.id!==b.id))});return()=>B()}else A([])},[b]),R.useEffect(()=>{const L=Tn(Be(We,"products")),B=bn(L,U=>{const F=U.docs.map(q=>{var ue;const J=q.data(),ne=(ue=J.createdAt)!=null&&ue.toDate?J.createdAt.toDate():new Date;return{id:q.id,...J,createdAt:ne}}),W=F.filter(q=>q.isMerchandise),H=F.filter(q=>!q.isMerchandise);W.sort((q,J)=>J.createdAt.getTime()-q.createdAt.getTime()),H.sort((q,J)=>{const ne=q.tag==="vendido",ue=J.tag==="vendido";return ne&&!ue?1:!ne&&ue?-1:J.createdAt.getTime()-q.createdAt.getTime()}),i(W),r(H),E(null)},U=>{console.error("Error en el listener de Firestore (products):",U),E(U),c({message:"Error de connexi. Mostrant articles d'exemple.",type:"error"});const F=cv.filter(H=>H.isMerchandise).map(H=>({...H,createdAt:new Date(H.createdAt)})),W=cv.filter(H=>!H.isMerchandise).map(H=>({...H,createdAt:new Date(H.createdAt)}));F.sort((H,q)=>q.createdAt.getTime()-H.createdAt.getTime()),W.sort((H,q)=>q.createdAt.getTime()-H.createdAt.getTime()),i(F),r(W)});return()=>B()},[]),R.useEffect(()=>{if(!b){y([]);return}const L=Tn(Be(We,"chats"),Pi("participantIds","array-contains",b.id)),B=bn(L,U=>{let F=U.docs.map(H=>({id:H.id,...H.data()}));F=F.filter(H=>{var q;return!((q=H.hiddenFor)!=null&&q.includes(b.id))&&!ee.current.has(H.id)}),F.sort((H,q)=>{var ue,Lt;const J=((ue=H.updatedAt)==null?void 0:ue.toMillis())||0;return(((Lt=q.updatedAt)==null?void 0:Lt.toMillis())||0)-J});const W=F.reduce((H,q)=>H+(q.unreadCount[b.id]||0),0);_(W),y(F),E(null)},U=>{console.error("Error fetching chats:",U),E(U)});return()=>B()},[b]),R.useEffect(()=>{if(!v){S([]);return}const L=Tn(Be(We,"chats",v.id,"messages")),B=bn(L,U=>{const F=U.docs.map(W=>({id:W.id,...W.data()}));F.sort((W,H)=>{var ne,ue;const q=((ne=W.timestamp)==null?void 0:ne.toMillis())||0,J=((ue=H.timestamp)==null?void 0:ue.toMillis())||0;return q-J}),S(F)});return()=>B()},[v]),R.useEffect(()=>{if(o){const L=setTimeout(()=>c(null),8e3);return()=>clearTimeout(L)}},[o]),R.useEffect(()=>{const L="LABOTIGA";k>0?document.title=`(${k}) ${L}`:document.title=L},[k]),R.useEffect(()=>(u||D||!b||ge||C?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[u,D,b,ge,C]);const Vn=async(L,B)=>{await y1(ys,L,B),c({message:"Benvingut/da de nou!",type:"success"})},Q=(L,B)=>{const W=`<svg xmlns="http://www.w3.org/2000/svg" width="150" height="150" viewBox="0 0 150 150">
                    <rect width="100%" height="100%" fill="${(H=>{let q=0;for(let ne=0;ne<H.length;ne++)q=H.charCodeAt(ne)+((q<<5)-q);let J="#";for(let ne=0;ne<3;ne++){const ue=q>>ne*8&255;J+=("00"+ue.toString(16)).substr(-2)}return J})(B)}" />
                    <text x="50%" y="55%" dominant-baseline="middle" text-anchor="middle" font-family="Arial, sans-serif" font-size="60" fill="#ffffff">${L}</text>
                 </svg>`;return`data:image/svg+xml;base64,${btoa(W)}`},re=async(L,B,U,F)=>{let W="",H=F;if(!H){const ue=L.split(" ").map(Lt=>Lt[0]).slice(0,2).join("").toUpperCase();H=Q(ue,L)}try{W=await ql(H)}catch(ue){throw console.error("La pujada de la imatge ha fallat:",ue),new Error("No s'ha pogut pujar la imatge. Revisa la teva configuraci de Cloudinary i que el 'preset' sigui 'unsigned'.")}if(!W)throw new Error("Cloudinary no ha retornat una URL vlida.");const J=(await g1(ys,B,U)).user,ne={name:L,email:B,avatarUrl:W,joinDate:new Date().toISOString(),role:"user",fcmTokens:[]};await aE(Ge(We,"users",J.uid),ne),T({id:J.uid,...ne}),c({message:`Benvingut/da, ${L}! El teu compte ha estat creat.`,type:"success"})},ae=async L=>{try{await p1(ys,L),c({message:"S'ha enviat un correu per restablir la contrasenya. Revisa la teva bstia d'entrada.",type:"success"})}catch(B){throw console.error("Error en restablir la contrasenya:",B),B}},_e=async()=>{e("home"),await Ni(ys),c({message:"Sessi tancada correctament.",type:"success"})},Ie=()=>{e("home"),p(null)},rn=()=>{p(null),e("listing")},lt=()=>{b&&e("profile")},sn=async(L,B,U)=>{if(!b||b.id!==L)throw c({message:"No autoritzat.",type:"error"}),new Error("No autoritzat.");if(B===b.name&&!U){c({message:"No s'han detectat canvis.",type:"success"});return}try{const F={name:B};U&&(F.avatarUrl=await ql(U));const W=Ge(We,"users",L);await At(W,F),c({message:"Perfil actualitzat correctament!",type:"success"})}catch(F){throw console.error("Error actualitzant l'usuari:",F),c({message:`Error en actualitzar: ${F.message||"Error desconegut."}`,type:"error"}),F}},_t=async(L,B)=>{var U;if(!b)throw c({message:"Has d'iniciar la sessi per desar un producte.",type:"error"}),new Error("L'usuari no ha iniciat la sessi.");try{const F=L.imageUrls.map(q=>q.startsWith("data:image")?ql(q):Promise.resolve(q)),W=await Promise.all(F),H={...L,imageUrls:W};if(B){const q=Ge(We,"products",B),J=(U=(await Kc(q)).data())==null?void 0:U.seller;await At(q,{...H,seller:J}),c({message:"Anunci actualitzat correctament!",type:"success"})}else{const q={...H,seller:{id:b.id,name:b.name,avatarUrl:b.avatarUrl},createdAt:new Date};await In(Be(We,"products"),q),c({message:"Anunci publicat amb xit!",type:"success"})}e("home"),p(null)}catch(F){throw console.error("Error al desar el producte:",F),c({message:`Error en desar: ${F.message||"Error desconegut."}`,type:"error"}),F}},Wt=L=>{p(L),d(null),e("listing")},as=async L=>{try{return await lE(Ge(We,"products",L)),c({message:"Anunci eliminat correctament.",type:"success"}),d(null),!0}catch(B){console.error("Error en eliminar el producte: ",B);const U=`Error en eliminar: ${B.code||B.message||"Error desconegut."}`;return c({message:U,type:"error"}),!1}},Xs=L=>{d(L)},ao=()=>{d(null)},lo=async L=>{if(!b)return;const B=L.seller.id,U=b.id,F=Be(We,"chats"),W=Tn(F,Pi("productId","==",L.id),Pi("participantIds","array-contains",U)),H=await oE(W);let q=null;if(H.forEach(J=>{const ne={id:J.id,...J.data()};ne.participantIds.includes(B)&&(q=ne)}),q)await dr(q);else{const J={participantIds:[U,B],participants:{[U]:{name:b.name,avatarUrl:b.avatarUrl},[B]:{name:L.seller.name,avatarUrl:L.seller.avatarUrl}},productId:L.id,productTitle:L.title,productImageUrl:L.imageUrls[0]||"",lastMessage:null,createdAt:ft(),updatedAt:ft(),unreadCount:{[U]:0,[B]:0},hiddenFor:[]},ne=await In(Be(We,"chats"),J);I({id:ne.id,...J})}d(null),V(!0)},dr=async L=>{if(I(L),b&&(L.unreadCount[b.id]||0)>0){const B=Ge(We,"chats",L.id);await At(B,{[`unreadCount.${b.id}`]:0})}},ls=async(L,B)=>{if(!b||!v)return;const U=b.id,F=v.participantIds.find(q=>q!==U);if(!F)return;const W={senderId:U,text:L,timestamp:ft(),...B&&{imageUrl:B}};await In(Be(We,"chats",v.id,"messages"),W);const H=Ge(We,"chats",v.id);await At(H,{lastMessage:{...W,timestamp:new Date},updatedAt:ft(),[`unreadCount.${F}`]:Qc(1)})},Js=()=>{I(null)},co=()=>{V(!1),I(null)},cs=async L=>{if(!b)return;ee.current.add(L),y(U=>U.filter(F=>F.id!==L)),(v==null?void 0:v.id)===L&&I(null);const B=Ge(We,"chats",L);try{await At(B,{hiddenFor:Gc(b.id)}),ee.current.delete(L)}catch(U){console.error("Error en eliminar el xat:",U),c({message:"No s'ha pogut eliminar el xat. La conversa es restaurar.",type:"error"}),ee.current.delete(L)}},us=async(L,B)=>{if(!b||b.role!=="admin"){c({message:"No autoritzat.",type:"error"});return}const U=L==="all"?x:x.filter(F=>F.id===L);if(U.length===0){c({message:"No s'han trobat destinataris.",type:"error"});return}try{for(const F of U){const W=`admin-message-${b.id}-${F.id}-${Date.now()}`,H={participantIds:[b.id,F.id],participants:{[b.id]:{name:b.name,avatarUrl:b.avatarUrl},[F.id]:{name:F.name,avatarUrl:F.avatarUrl}},productId:W,productTitle:"Missatge de l'administrador",productImageUrl:b.avatarUrl,lastMessage:null,createdAt:ft(),updatedAt:ft(),unreadCount:{[b.id]:0,[F.id]:0},hiddenFor:[]},q=await In(Be(We,"chats"),H),J={senderId:b.id,text:B,timestamp:ft()};await In(Be(We,"chats",q.id,"messages"),J),await At(q,{lastMessage:{...J,timestamp:new Date},updatedAt:ft(),[`unreadCount.${F.id}`]:Qc(1)})}c({message:`Missatge enviat a ${U.length} usuari(s).`,type:"success"})}catch(F){throw console.error("Error en enviar el missatge d'administrador:",F),c({message:"No s'ha pogut enviar el missatge.",type:"error"}),F}};return b?l.jsxs("div",{className:"min-h-screen bg-gray-50 font-sans text-gray-800",children:[l.jsx(XI,{user:b,onNavigateHome:Ie,onNavigateToListing:rn,onNavigateToProfile:lt,onOpenTutorial:()=>wt(!0)}),l.jsx(ub,{message:(o==null?void 0:o.message)||null,type:o==null?void 0:o.type,onClose:()=>c(null)}),t==="home"&&l.jsx(JI,{userProducts:n,merchProducts:s,onProductSelect:Xs,firebaseError:g,currentUser:b}),t==="listing"&&l.jsx(cb,{onSave:_t,productToEdit:f,currentUser:b}),t==="profile"&&l.jsx(fb,{user:b,onUpdateUser:sn,onBack:()=>e("home"),onLogout:_e,allUsers:x,onSendAdminMessage:us}),u&&l.jsx(Y4,{product:u,currentUser:b,onClose:ao,onEdit:Wt,onContactSeller:lo,onDelete:as,onOpenImageViewer:(L,B)=>P({images:L,startIndex:B})}),ge&&l.jsx(wb,{onClose:()=>wt(!1)}),C&&l.jsx(_b,{images:C.images,startIndex:C.startIndex,onClose:()=>P(null)}),l.jsx(mb,{isOpen:D,onClick:()=>V(!D),unreadCount:k}),l.jsx(vb,{isOpen:D,onClose:co,chats:O,activeChat:v,messages:N,currentUser:b,onSendMessage:ls,onSelectChat:dr,onBackToList:Js,onDeleteChat:cs})]}):l.jsxs("div",{className:"min-h-screen bg-cover bg-center flex items-center justify-center p-4",style:{backgroundImage:"url('https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/Bandera%20Club%20Handbol%20Molins.png')"},children:[l.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"}),l.jsx("div",{className:"relative z-10",children:l.jsx(db,{onLogin:Vn,onRegister:re,onPasswordReset:ae,isDismissable:!1})})]})},VE=document.getElementById("root");if(!VE)throw new Error("Could not find root element to mount to");const J4=nc.createRoot(VE);J4.render(l.jsx(Iv.StrictMode,{children:l.jsx(X4,{})}));const yp=t=>l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.776 48.776 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})]}),OE=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193l-3.722.28c-.443.034-.884.176-1.286.448l-4.486 2.872c-.18.115-.383.115-.564 0l-4.486-2.873a1.875 1.875 0 01-1.286-.447l-3.722-.281a2.25 2.25 0 01-1.98-2.192v-4.286c0-.97.616-1.813 1.5-2.097m14.25-1.118a2.25 2.25 0 00-2.25-2.25h-8.25a2.25 2.25 0 00-2.25 2.25v.928c.378-.04.757-.067 1.143-.082l3.722-.281c.443-.034.884-.176 1.286-.448l4.486-2.872c.18-.115.383.115.564 0l4.486 2.873c.402.27.843.414 1.286.448l3.722.28c.386.016.764.042 1.143.082v-.928a2.25 2.25 0 00-2.25-2.25h-8.25a2.25 2.25 0 00-2.25 2.25v.928"})}),Zr=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),FE=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})}),Z4=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),UE=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25z"})}),qs=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`animate-spin ${t.className}`,children:l.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),e5=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"})}),t5=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.122 2.122l7.81-7.81"})}),n5=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),r5=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 00-3 3h15.75m-12.75-3h11.218c.51 0 .962-.343 1.087-.835l1.821-6.831a1.5 1.5 0 00-1.422-2.098H5.168L4.659 3.563A1.5 1.5 0 003.132 2.25H2.25m5.25 9h10.5m-10.5-9h10.5"})}),s5=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})}),i5=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.562L16.5 21.75l-.398-1.188a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.188-.398a2.25 2.25 0 001.423-1.423L16.5 15.75l.398 1.188a2.25 2.25 0 001.423 1.423L19.5 18.75l-1.188.398a2.25 2.25 0 00-1.423 1.423z"})}),uv=t=>l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6h.008v.008H6V6z"})]}),mf=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),o5=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z"})}),a5=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})}),l5=t=>l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),c5=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.243 4.243L6.228 6.228"})}),BE=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"})}),u5=({user:t,onNavigateHome:e,onNavigateToListing:n,onNavigateToProfile:r,onOpenTutorial:s})=>l.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-10",children:l.jsxs("div",{className:"container mx-auto px-4 md:px-8 py-4 flex items-center justify-between",children:[l.jsxs("button",{onClick:e,className:"flex items-center gap-3 cursor-pointer",children:[l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-10 w-auto"}),l.jsxs("span",{className:"text-2xl font-bold",children:[l.jsx("span",{className:"text-gray-900",children:"LA"}),l.jsx("span",{className:"text-primary",children:"BOTIGA"})]})]}),l.jsx("div",{className:"flex items-center gap-4",children:t&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:s,className:"p-2 text-gray-500 hover:text-primary hover:bg-gray-100 rounded-full transition-colors","aria-label":"Obre el tutorial",children:l.jsx(BE,{className:"w-7 h-7"})}),l.jsxs("button",{onClick:n,className:"bg-primary text-white font-semibold p-2 sm:px-4 sm:py-2 rounded-lg hover:bg-primary-700 transition-colors flex items-center gap-2",children:[l.jsx(mf,{className:"h-5 w-5"}),l.jsx("span",{className:"hidden sm:inline",children:"Puja un article"})]}),l.jsxs("button",{onClick:r,className:"flex items-center gap-2 cursor-pointer p-1 rounded-md hover:bg-gray-100",children:[l.jsx("img",{src:t.avatarUrl,alt:t.name,className:"w-9 h-9 rounded-full border-2 border-primary-200"}),l.jsx("span",{className:"font-semibold text-gray-700 hidden md:block",children:t.name})]})]})})]})}),Gn={novedad:{label:"Novetat",emoji:"",className:"bg-blue-500 text-white"},ultimas_unidades:{label:"ltimes Unitats",emoji:"",className:"bg-yellow-500 text-black"},reservado:{label:"Reservat",emoji:"",className:"bg-orange-500 text-white"},vendido:{label:"Tracte Fet",emoji:"",className:"bg-gray-700 text-white"}},dv=({product:t,onSelect:e})=>{const n=t.imageUrls&&t.imageUrls.length>0,r=i=>typeof i!="number"||isNaN(i)?"N/A":i.toFixed(2),s=t.tag?Gn[t.tag]:null;return l.jsxs("button",{onClick:e,className:`bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden group text-left w-full hover:shadow-lg transition-shadow duration-200 ${t.tag==="vendido"?"opacity-70":""}`,children:[l.jsxs("div",{className:"relative w-full aspect-square bg-gray-100 overflow-hidden",children:[n&&l.jsx("img",{src:t.imageUrls[0],alt:t.title,className:`w-full h-full object-cover group-hover:scale-105 transition-transform duration-300 ${t.tag==="vendido"?"grayscale":""}`}),s&&l.jsxs("div",{className:`absolute top-2 left-2 text-xs font-bold px-2 py-1 rounded-full shadow-md ${s.className}`,children:[s.emoji," ",s.label]})]}),l.jsxs("div",{className:"p-3",children:[l.jsxs("p",{className:"font-bold text-gray-800 text-lg",children:[r(t.price)," "]}),l.jsx("h3",{className:"text-gray-600 text-sm truncate",children:t.title}),l.jsxs("div",{className:"flex items-center mt-2 pt-2 border-t border-gray-100",children:[l.jsx("img",{src:t.seller.avatarUrl,alt:t.seller.name,className:"w-6 h-6 rounded-full mr-2"}),l.jsx("p",{className:"text-xs text-gray-500 truncate",children:t.seller.name})]})]})]})},d5=({userProducts:t,merchProducts:e,onProductSelect:n,firebaseError:r,currentUser:s})=>{const[i,o]=R.useState(t),[c,u]=R.useState("");R.useEffect(()=>{const f=c.toLowerCase();if(f==="")o(t);else{const p=t.filter(g=>g.title.toLowerCase().includes(f)||g.description.toLowerCase().includes(f));o(p)}},[c,t]);const d=f=>{u(f.target.value)};return l.jsxs("main",{className:"container mx-auto p-4 md:p-8",children:[l.jsxs("div",{className:"bg-white rounded-2xl shadow-md border border-gray-200 p-6 mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Descobreix i estalvia"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Busca entre els articles de segona m a prop teu."}),l.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:l.jsxs("div",{className:"relative flex-grow",children:[l.jsx(n5,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Busca el que et calgui per practicar el millor esport del mn",value:c,onChange:d,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary bg-white text-gray-900"})]})})]}),e.length>0&&l.jsx("section",{className:"mb-12",children:l.jsxs("div",{className:"bg-primary-50 border border-primary-200 rounded-2xl p-6 shadow-sm",children:[l.jsx("div",{className:"flex justify-between items-center mb-6",children:l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Marxandatge del Club"})}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6",children:e.map(f=>l.jsx(dv,{product:f,onSelect:()=>n(f)},f.id))})]})}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Articles destacats"}),i.length>0?l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6",children:i.map(f=>l.jsx(dv,{product:f,onSelect:()=>n(f)},f.id))}):l.jsx("div",{className:"text-center py-16",children:l.jsx("p",{className:"text-gray-600",children:"No s'han trobat articles que coincideixin amb la teva cerca."})})]})]})},Fn=5,h5=({imagePreviews:t,onImagesAdded:e,onDeleteImage:n})=>{const[r,s]=R.useState(!1),[i,o]=R.useState(null),[c,u]=R.useState(!1),d=R.useRef(null),f=R.useRef(null),p=async C=>{const P=C.target.files;if(!P)return;const b=Array.from(P).slice(0,Fn-t.length);if(P.length>b.length?o(`Noms pots pujar un mxim de ${Fn} imatges.`):o(null),b.length!==0){s(!0);try{const T=b.map(A=>Qi(A)),x=await Promise.all(T);e(x)}catch(T){o("No s'ha pogut carregar una o ms imatges."),console.error(T)}finally{s(!1)}C.target.value=""}},g=()=>{var C;u(!1),(C=d.current)==null||C.click()},E=()=>{var C;u(!1),(C=f.current)==null||C.click()};return l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:l.jsx(mf,{className:"h-6 w-6 text-primary"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"1. Puja les teves fotos"})]}),l.jsxs("p",{className:"text-sm font-medium text-gray-500",children:[t.length," / ",Fn]})]}),l.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-4",children:[t.map((C,P)=>l.jsxs("div",{className:"relative aspect-square group",children:[l.jsx("img",{src:C,alt:`Product image ${P+1}`,className:"w-full h-full object-cover rounded-lg border"}),l.jsx("button",{onClick:()=>n(P),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity","aria-label":"Eliminar imatge",children:l.jsx(Zr,{className:"w-4 h-4"})})]},P)),r&&l.jsx("div",{className:"aspect-square flex justify-center items-center w-full h-full border-2 border-dashed border-gray-300 rounded-lg",children:l.jsx(qs,{className:"w-8 h-8 text-primary"})}),t.length<Fn&&!r&&l.jsxs("button",{onClick:()=>u(!0),className:"aspect-square flex flex-col justify-center items-center w-full h-full border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-primary hover:bg-primary-50 transition-colors text-center","aria-label":`Puja ${Fn-t.length} imatges ms`,children:[l.jsx(mf,{className:"mx-auto h-8 w-8 text-gray-400"}),l.jsx("p",{className:"mt-1 text-xs text-gray-600",children:l.jsx("span",{className:"font-semibold text-primary",children:"Afegeix fotos"})})]})]}),l.jsx("input",{ref:d,type:"file",onChange:p,className:"hidden",accept:"image/*",multiple:!0,disabled:t.length>=Fn}),l.jsx("input",{ref:f,type:"file",onChange:p,className:"hidden",accept:"image/*",capture:"environment",disabled:t.length>=Fn}),i&&l.jsx("p",{className:"text-red-500 text-sm mt-4",children:i}),c&&l.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4 animate-fade-in-fast",onClick:()=>u(!1),"aria-modal":"true",role:"dialog",children:[l.jsx("style",{children:`
            @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }
            .animate-fade-in-fast { animation: fade-in-fast 0.2s ease-out; }
            @keyframes scale-in { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
            .animate-scale-in { animation: scale-in 0.2s ease-out; }
          `}),l.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-xs shadow-xl animate-scale-in",onClick:C=>C.stopPropagation(),children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Tria una opci"}),l.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:l.jsx(Zr,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{onClick:E,className:"w-full flex items-center gap-4 p-4 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors disabled:opacity-50",disabled:t.length>=Fn,children:[l.jsx(yp,{className:"w-6 h-6 text-primary"}),l.jsx("span",{className:"font-semibold text-gray-700",children:"Fes una foto"})]}),l.jsxs("button",{onClick:g,className:"w-full flex items-center gap-4 p-4 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors disabled:opacity-50",disabled:t.length>=Fn,children:[l.jsx(UE,{className:"w-6 h-6 text-primary"}),l.jsx("span",{className:"font-semibold text-gray-700",children:"Tria de la galeria"})]})]})]})]})]})},f5=({title:t,setTitle:e,description:n,setDescription:r})=>l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:l.jsx(i5,{className:"h-6 w-6 text-primary"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"2. Descriu el teu article"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"product-title",className:"block text-sm font-medium text-gray-700",children:"Ttol del producte"}),l.jsx("input",{id:"product-title",type:"text",value:t,onChange:s=>e(s.target.value),placeholder:'p. ex., "Jaqueta de cuir vintage"',className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{htmlFor:"product-description",className:"block text-sm font-medium text-gray-700",children:"Descripci"}),l.jsx("textarea",{id:"product-description",rows:6,value:n,onChange:s=>r(s.target.value),placeholder:"Descriu el teu article amb detall...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]})]}),m5=({imagePreviews:t,title:e,description:n,price:r,onPublish:s,isEditing:i,isPublishing:o})=>{const c=t.length>0&&e&&r;return l.jsx("div",{className:"sticky top-28",children:l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Vista prvia de l'anunci"}),l.jsx("div",{className:"w-full aspect-square bg-gray-100 rounded-lg mb-4 flex items-center justify-center",children:t&&t.length>0?l.jsx("img",{src:t[0],alt:"Vista prvia del producte",className:"w-full h-full object-cover rounded-lg"}):l.jsx(UE,{className:"w-16 h-16 text-gray-300"})}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-900 truncate",children:e||"Ttol del producte"}),l.jsx("p",{className:"text-3xl font-extrabold text-primary",children:r?`${parseFloat(r).toFixed(2)} `:"0.00 "}),l.jsx("div",{className:"border-t pt-3",children:l.jsx("p",{className:"text-gray-600 text-sm whitespace-pre-wrap h-32 overflow-y-auto",children:n||"La teva descripci generada apareixer aqu..."})}),l.jsx("button",{onClick:s,disabled:!c||o,className:"w-full bg-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:o?l.jsxs(l.Fragment,{children:[l.jsx(qs,{className:"w-5 h-5"}),l.jsx("span",{children:i?"Desant...":"Publicant..."})]}):i?"Desa els canvis":"Publica l'anunci"})]})]})})},p5="dfmkfeqzt",g5="BOTIGAHANDBOL",tc=async t=>{try{const e=new FormData;e.append("file",t),e.append("upload_preset",g5);const n=await fetch(`https://api.cloudinary.com/v1_1/${p5}/image/upload`,{method:"POST",body:e});if(!n.ok){const s=await n.json();throw new Error(`Error en pujar a Cloudinary: ${s.error.message}`)}return(await n.json()).secure_url}catch(e){throw console.error("Error en la crrega a Cloudinary:",e),e}},y5="ListingDraftDB",v5=1,es="listingDrafts",vp="currentListingDraft",wp=()=>new Promise((t,e)=>{const n=indexedDB.open(y5,v5);n.onerror=()=>e("Error en obrir la base de dades IndexedDB."),n.onsuccess=()=>t(n.result),n.onupgradeneeded=r=>{const s=r.target.result;s.objectStoreNames.contains(es)||s.createObjectStore(es)}}),w5=async t=>{const n=(await wp()).transaction(es,"readwrite");return n.objectStore(es).put(t,vp),new Promise((s,i)=>{n.oncomplete=()=>s(),n.onerror=()=>i("Error en desar l'esborrany a IndexedDB.")})},_5=async()=>{const r=(await wp()).transaction(es,"readonly").objectStore(es).get(vp);return new Promise((s,i)=>{r.onsuccess=()=>{s(r.result||null)},r.onerror=()=>i("Error en llegir l'esborrany.")})},x5=async()=>{(await wp()).transaction(es,"readwrite").objectStore(es).delete(vp)},E5=({onSave:t,productToEdit:e,currentUser:n})=>{const[r,s]=R.useState([]),[i,o]=R.useState([]),[c,u]=R.useState(""),[d,f]=R.useState(""),[p,g]=R.useState(""),[E,C]=R.useState(!1),[P,b]=R.useState(""),[T,x]=R.useState(!0),[A,D]=R.useState(!1),V=!!e,O=R.useRef(null);R.useEffect(()=>{const k=r.map(_=>typeof _=="string"?_:URL.createObjectURL(_));return o(k),()=>{k.forEach(_=>{_.startsWith("blob:")&&URL.revokeObjectURL(_)})}},[r]),R.useEffect(()=>{(async()=>{var _;if(V&&e)u(e.title),f(e.description),g(((_=e.price)==null?void 0:_.toString())||""),s(e.imageUrls||[]),C(e.isMerchandise||!1),b(e.tag||"");else if(!V)try{const ee=await _5();ee&&(s(ee.imagesData||[]),u(ee.title||""),f(ee.description||""),g(ee.price||""),C(ee.isMerchandise||!1),b(ee.tag||""))}catch(ee){console.error("Error en restaurar l'esborrany:",ee)}x(!1)})()},[e,V]),R.useEffect(()=>{if(!(T||V))return O.current&&clearTimeout(O.current),O.current=window.setTimeout(()=>{w5({imagesData:r,title:c,description:d,price:p,isMerchandise:E,tag:P}).catch(_=>console.error("Error en desar l'esborrany:",_))},500),()=>{O.current&&clearTimeout(O.current)}},[r,c,d,p,E,P,T,V]);const y=async()=>{s([]),u(""),f(""),g(""),C(!1),b(""),await x5()},v=async()=>{if(i.length>0&&c&&p){D(!0);try{const k=r.map(ge=>typeof ge=="string"?Promise.resolve(ge):Yi(ge).then(wt=>tc(wt))),_=await Promise.all(k),ee={title:c,description:d,price:parseFloat(p),imageUrls:_,isMerchandise:E,tag:P||""};await t(ee,e==null?void 0:e.id),await y()}catch{console.error("La publicaci ha fallat. L'usuari ja ha estat notificat.")}finally{D(!1)}}},I={novedad:Gn.novedad,ultimas_unidades:Gn.ultimas_unidades},N={reservado:Gn.reservado,vendido:Gn.vendido},S=(n==null?void 0:n.role)==="admin"&&E?I:N;return T&&!V?l.jsx("div",{className:"flex justify-center items-center h-screen",children:l.jsx("p",{className:"text-gray-600",children:"Recuperant l'esborrany..."})}):l.jsx("main",{className:"container mx-auto p-4 md:p-8",children:l.jsxs("div",{className:"max-w-7xl mx-auto",children:[l.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",children:V?"Edita el teu anunci":"Crea el teu anunci"}),l.jsx("p",{className:"text-gray-600 mb-8",children:V?"Actualitza els detalls del teu producte.":"Fes servir les nostres eines per fer destacar el teu producte."}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8",children:[l.jsxs("div",{className:"lg:col-span-3 flex flex-col gap-8",children:[l.jsx(h5,{imagePreviews:i,onImagesAdded:k=>s(_=>[..._,...k]),onDeleteImage:k=>s(_=>_.filter((ee,ge)=>ge!==k))}),l.jsx(f5,{title:c,setTitle:u,description:d,setDescription:f}),l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:l.jsx(uv,{className:"h-6 w-6 text-primary"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"3. Afegeix un preu"})]}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Introdueix el preu de venda del teu article."}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"product-price",className:"block text-sm font-medium text-gray-700",children:"Preu ()"}),l.jsx("input",{id:"product-price",type:"number",value:p,onChange:k=>g(k.target.value),placeholder:"p. ex., 25.50",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",step:"0.01",min:"0",required:!0})]})]}),l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:l.jsx(uv,{className:"h-6 w-6 text-primary"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"4. Etiqueta (Opcional)"})]}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Selecciona un estat per al teu article."}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("label",{className:"flex items-center gap-3 cursor-pointer p-2 rounded-lg hover:bg-gray-50",children:[l.jsx("input",{type:"radio",name:"tag",value:"",checked:P==="",onChange:k=>b(k.target.value),className:"h-5 w-5 text-primary focus:ring-primary border-gray-300"}),l.jsx("span",{className:"text-gray-700 font-medium",children:"Cap etiqueta"})]}),Object.entries(S).map(([k,_])=>l.jsxs("label",{className:"flex items-center gap-3 cursor-pointer p-2 rounded-lg hover:bg-gray-50",children:[l.jsx("input",{type:"radio",name:"tag",value:k,checked:P===k,onChange:ee=>b(ee.target.value),className:"h-5 w-5 text-primary focus:ring-primary border-gray-300"}),l.jsxs("span",{className:`text-sm font-semibold px-2 py-1 rounded-full ${_.className}`,children:[_.emoji," ",_.label]})]},k))]})]}),(n==null?void 0:n.role)==="admin"&&l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg flex items-center justify-center h-10 w-10",children:l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-6 w-auto"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Opcions d'Administrador"})]}),l.jsx("div",{className:"mt-4",children:l.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:E,onChange:k=>C(k.target.checked),className:"h-5 w-5 rounded border-gray-300 text-primary focus:ring-primary"}),l.jsx("span",{className:"text-gray-700 font-medium",children:"Afegeix com a article de merchandising oficial"})]})})]})]}),l.jsx("div",{className:"lg:col-span-2",children:l.jsx(m5,{imagePreviews:i,title:c,description:d,price:p,onPublish:v,isEditing:V,isPublishing:A})})]})]})})},T5=({message:t,type:e="success",onClose:n})=>{if(!t)return null;const r="text-white text-sm font-semibold px-4 py-3 rounded-lg shadow-lg flex items-center justify-between gap-4",s={success:"bg-green-500",error:"bg-red-500"},i={success:"hover:bg-green-600",error:"hover:bg-red-600"};return l.jsxs("div",{className:"fixed bottom-6 left-6 z-50 animate-slide-in-up",children:[l.jsx("style",{children:`
        @keyframes slide-in-up {
          0% {
            opacity: 0;
            transform: translateY(20px);
          }
          100% {
            opacity: 1;
            transform: translateY(0);
          }
        }
        .animate-slide-in-up {
          animation: slide-in-up 0.3s ease-out forwards;
        }
      `}),l.jsxs("div",{className:`${r} ${s[e]}`,children:[l.jsx("span",{children:t}),l.jsx("button",{onClick:n,className:`p-1 rounded-full flex-shrink-0 ${i[e]}`,children:l.jsx(Zr,{className:"w-4 h-4"})})]})]})},I5=({onClose:t,onLogin:e,onRegister:n,onPasswordReset:r,isDismissable:s=!0})=>{const[i,o]=R.useState("login"),[c,u]=R.useState(""),[d,f]=R.useState(""),[p,g]=R.useState(""),[E,C]=R.useState(!1),[P,b]=R.useState(null),T=R.useRef(null),[x,A]=R.useState(!1),[D,V]=R.useState(null),[O,y]=R.useState(null),v=async S=>{var _;const k=(_=S.target.files)==null?void 0:_[0];if(k)try{const ee=await Qi(k,512,512,.9),ge=await Yi(ee);b(ge)}catch(ee){console.error("Error en llegir el fitxer:",ee),V("No s'ha pogut processar la imatge.")}},I=async S=>{S.preventDefault(),A(!0),V(null),y(null);try{i==="login"?await e(d,p):await n(c,d,p,P)}catch(k){let _="Hi ha hagut un error. Si us plau, torna-ho a provar.";if(k.code)switch(k.code){case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":_="Correu electrnic o contrasenya incorrectes.";break;case"auth/email-already-in-use":_="Aquest correu electrnic ja est en s.";break;case"auth/weak-password":_="La contrasenya ha de tenir almenys 6 carcters.";break;case"auth/invalid-email":_="El format del correu electrnic no s vlid.";break}else k.message&&(k.message.includes("Cloudinary")?_="Error amb la imatge: Assegura't que el 'preset' de crrega a Cloudinary estigui configurat com a 'unsigned'.":_=k.message);V(_),console.error(k)}finally{A(!1)}},N=async S=>{S.preventDefault(),A(!0),V(null),y(null);try{await r(d),y("S'ha enviat l'enlla de recuperaci. Revisa el teu correu (i la carpeta de correu brossa).")}catch(k){let _="Hi ha hagut un error en enviar el correu.";(k.code==="auth/user-not-found"||k.code==="auth/invalid-email")&&(_="No s'ha trobat cap usuari amb aquest correu electrnic."),V(_)}finally{A(!1)}};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:s?t:void 0,"aria-modal":"true",role:"dialog",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden relative",onClick:S=>S.stopPropagation(),children:[s&&l.jsx("button",{onClick:t,className:"absolute top-3 right-3 text-gray-400 hover:text-gray-800 z-10 p-1 transition-colors","aria-label":"Tancar",children:l.jsx(Zr,{className:"w-6 h-6"})}),l.jsx("div",{className:"p-6 sm:p-8",children:i==="forgotPassword"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-12 w-auto mx-auto"}),l.jsx("h2",{className:"mt-2 text-2xl font-bold text-gray-900",children:"Restableix la contrasenya"}),l.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Introdueix el teu correu i t'enviarem un enlla per recuperar-la."})]}),l.jsxs("form",{onSubmit:N,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email-reset",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),l.jsx("input",{id:"email-reset",name:"email",type:"email",autoComplete:"email",required:!0,value:d,onChange:S=>f(S.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"correu@exemple.com"})]}),D&&l.jsx("p",{className:"text-red-500 text-sm text-center",children:D}),O&&l.jsx("p",{className:"text-green-600 text-sm text-center",children:O}),l.jsx("div",{children:l.jsx("button",{type:"submit",disabled:x,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:x?l.jsx(qs,{className:"w-5 h-5"}):"Envia l'enlla"})}),l.jsx("div",{children:l.jsx("button",{type:"button",onClick:()=>{o("login"),V(null),y(null),C(!1)},className:"w-full text-sm font-medium text-primary hover:underline",children:"Tornar a l'inici de sessi"})})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-12 w-auto mx-auto"}),l.jsx("h2",{className:"mt-2 text-2xl font-bold text-gray-900",children:i==="login"?l.jsxs(l.Fragment,{children:["Benvingut/da a LA",l.jsx("span",{className:"text-primary",children:"BOTIGA"})]}):"Crea el teu compte"}),l.jsx("p",{className:"text-gray-600 text-sm mt-1 px-4",children:i==="login"?"La botiga de segona m i marxandatge del Club Handbol Molins.":"Registra't per comprar i vendre material del club i molt ms."})]}),l.jsxs("div",{className:"flex border-b border-gray-200 mb-6",children:[l.jsx("button",{onClick:()=>{o("login"),V(null),y(null),C(!1)},className:`flex-1 py-3 text-sm font-semibold text-center transition-colors ${i==="login"?"text-primary border-b-2 border-primary":"text-gray-500 hover:text-gray-700"}`,children:"Inicia la sessi"}),l.jsx("button",{onClick:()=>{o("register"),V(null),y(null),C(!1)},className:`flex-1 py-3 text-sm font-semibold text-center transition-colors ${i==="register"?"text-primary border-b-2 border-primary":"text-gray-500 hover:text-gray-700"}`,children:"Registra't"})]}),l.jsxs("form",{onSubmit:I,className:"space-y-4",children:[i==="register"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex justify-center",children:[l.jsx("input",{type:"file",ref:T,onChange:v,className:"hidden",accept:"image/*"}),l.jsxs("button",{type:"button",onClick:()=>{var S;return(S=T.current)==null?void 0:S.click()},className:"relative w-24 h-24 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 hover:bg-gray-200 transition-colors",children:[P?l.jsx("img",{src:P,alt:"Avatar Preview",className:"w-full h-full object-cover rounded-full"}):l.jsx(yp,{className:"w-10 h-10"}),l.jsx("div",{className:"absolute bottom-0 right-0 bg-primary text-white rounded-full p-1 text-xs",children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nom"}),l.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:c,onChange:S=>u(S.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"El teu nom"})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),l.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:d,onChange:S=>f(S.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"correu@exemple.com"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Contrasenya"}),i==="login"&&l.jsx("button",{type:"button",onClick:()=>{o("forgotPassword"),V(null),y(null)},className:"text-sm font-medium text-primary hover:underline",children:"Heu oblidat la contrasenya?"})]}),l.jsxs("div",{className:"relative mt-1",children:[l.jsx("input",{id:"password",name:"password",type:E?"text":"password",autoComplete:"current-password",required:!0,value:p,onChange:S=>g(S.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900 pr-10",placeholder:""}),l.jsx("button",{type:"button",onClick:()=>C(!E),className:"absolute inset-y-0 right-0 flex items-center px-3 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":E?"Oculta la contrasenya":"Mostra la contrasenya",children:E?l.jsx(c5,{className:"w-5 h-5"}):l.jsx(l5,{className:"w-5 h-5"})})]})]}),D&&l.jsx("p",{className:"text-red-500 text-sm text-center",children:D}),O&&l.jsx("p",{className:"text-green-600 text-sm text-center",children:O}),l.jsx("div",{children:l.jsx("button",{type:"submit",disabled:x,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:x?l.jsx(qs,{className:"w-5 h-5"}):i==="login"?"Inicia la sessi":"Crea el compte"})})]})]})})]})})},b5=({allUsers:t,onSendAdminMessage:e})=>{const[n,r]=R.useState("all"),[s,i]=R.useState(""),[o,c]=R.useState(!1),u=async d=>{if(d.preventDefault(),!!s.trim()){c(!0);try{await e(n,s),i(""),r("all")}catch{}finally{c(!1)}}};return l.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-2xl shadow-md border border-gray-200 mt-8",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-6 border-b",children:[l.jsx(e5,{className:"h-10 w-10 text-primary"}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Panell d'Administrador"}),l.jsx("p",{className:"text-gray-600",children:"Envia comunicats a usuaris individuals o a tothom."})]})]}),l.jsxs("form",{onSubmit:u,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"recipient",className:"block text-sm font-medium text-gray-700",children:"Destinatari"}),l.jsxs("select",{id:"recipient",value:n,onChange:d=>r(d.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",children:[l.jsx("option",{value:"all",children:"Tots els usuaris"}),t.map(d=>l.jsxs("option",{value:d.id,children:[d.name," (",d.email,")"]},d.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"admin-message",className:"block text-sm font-medium text-gray-700",children:"Missatge"}),l.jsx("textarea",{id:"admin-message",rows:5,value:s,onChange:d=>i(d.target.value),placeholder:"Escriu el teu comunicat aqu...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",required:!0})]}),l.jsx("button",{type:"submit",disabled:o||!s.trim(),className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:o?l.jsx(qs,{className:"w-5 h-5"}):"Envia el missatge"})]})]})},S5=({user:t,onUpdateUser:e,onBack:n,onLogout:r,allUsers:s,onSendAdminMessage:i})=>{const[o,c]=R.useState(t.name),[u,d]=R.useState(null),f=R.useRef(null),[p,g]=R.useState(!1);R.useEffect(()=>{c(t.name)},[t]);const E=async P=>{var T;const b=(T=P.target.files)==null?void 0:T[0];if(b)try{const x=await Qi(b,512,512,.9),A=await Yi(x);d(A)}catch(x){console.error("Error en llegir el fitxer:",x)}},C=async P=>{P.preventDefault(),g(!0);try{await e(t.id,o,u),d(null)}catch(b){console.error(b)}finally{g(!1)}};return l.jsx("main",{className:"container mx-auto p-4 md:p-8",children:l.jsxs("div",{className:"max-w-2xl mx-auto",children:[l.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-6 border-b",children:[l.jsx(o5,{className:"h-10 w-10 text-primary"}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"El Meu Perfil"}),l.jsx("p",{className:"text-gray-600",children:"Actualitza la teva informaci personal."})]})]}),l.jsxs("form",{onSubmit:C,className:"space-y-4 sm:space-y-6",children:[l.jsxs("div",{className:"flex flex-col items-center gap-4",children:[l.jsx("input",{type:"file",ref:f,onChange:E,className:"hidden",accept:"image/*"}),l.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Foto de perfil"}),l.jsxs("button",{type:"button",onClick:()=>{var P;return(P=f.current)==null?void 0:P.click()},className:"relative w-32 h-32 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 hover:bg-gray-200 transition-colors group",children:[l.jsx("img",{src:u||t.avatarUrl,alt:"Avatar",className:"w-full h-full object-cover rounded-full"}),l.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 flex items-center justify-center rounded-full transition-opacity cursor-pointer",children:l.jsx(yp,{className:"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nom"}),l.jsx("input",{id:"name",type:"text",required:!0,value:o,onChange:P=>c(P.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),l.jsx("input",{id:"email",type:"email",value:t.email,disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm bg-gray-100 text-gray-500 cursor-not-allowed"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"joinDate",className:"block text-sm font-medium text-gray-700",children:"Membre des de"}),l.jsx("input",{id:"joinDate",type:"text",value:new Date(t.joinDate).toLocaleDateString("ca-ES",{year:"numeric",month:"long",day:"numeric"}),disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm bg-gray-100 text-gray-500 cursor-not-allowed"})]}),l.jsxs("div",{className:"flex gap-4 pt-4 border-t",children:[l.jsx("button",{type:"button",onClick:n,className:"w-full flex justify-center py-3 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:"Cancella"}),l.jsx("button",{type:"submit",disabled:p,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400",children:p?l.jsx(qs,{className:"w-5 h-5"}):"Desa els canvis"})]})]}),l.jsx("div",{className:"mt-8 pt-6 border-t border-red-200",children:l.jsx("button",{onClick:r,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Tanca la sessi"})})]}),t.role==="admin"&&l.jsx(b5,{allUsers:s,onSendAdminMessage:i})]})})},A5=({onClick:t,unreadCount:e,isOpen:n})=>n?null:l.jsxs(l.Fragment,{children:[l.jsx("style",{children:`
        @keyframes pulse-strong {
          0%, 100% { transform: scale(1); opacity: 1; }
          50% { transform: scale(1.1); opacity: 0.95; }
        }
        .animate-pulse-strong { animation: pulse-strong 1.5s infinite ease-in-out; }
      `}),l.jsxs("button",{onClick:t,className:"fixed bottom-4 right-4 md:bottom-8 md:right-8 z-30 bg-primary text-white w-16 h-16 rounded-full shadow-lg flex items-center justify-center hover:bg-primary-700 transition-all duration-300 transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary","aria-label":"Obrir el xat",children:[e>0&&l.jsx("span",{className:"absolute top-0 right-0 h-6 w-6 rounded-full bg-red-500 border-2 border-white flex items-center justify-center text-xs font-bold animate-pulse-strong",children:e}),l.jsx("div",{className:"w-9 h-9",children:l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS.png",alt:"Xat",className:"w-full h-auto p-1"})})]})]}),k5=({message:t,currentUser:e})=>{var s,i;const n=t.senderId===e.id,r=((i=(s=t.timestamp)==null?void 0:s.toDate())==null?void 0:i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"";return l.jsx("div",{className:`flex items-end gap-2 ${n?"justify-end":"justify-start"}`,children:l.jsxs("div",{className:`max-w-xs md:max-w-md lg:max-w-lg rounded-2xl px-4 py-2 ${n?"bg-primary text-white rounded-br-none":"bg-gray-200 text-gray-800 rounded-bl-none"}`,children:[t.text&&l.jsx("p",{className:"text-sm break-words",children:t.text}),t.imageUrl&&l.jsx("div",{className:"mt-2",children:l.jsx("img",{src:t.imageUrl,alt:"Uploaded content",className:"rounded-lg max-h-60 w-full object-cover"})}),l.jsx("p",{className:`text-xs mt-1 ${n?"text-primary-200":"text-gray-500"} text-right`,children:r})]})})},N5=(t,e=1280,n=1280)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var u;if(!((u=o.target)!=null&&u.result))return s(new Error("No s'ha pogut llegir el fitxer."));const c=new Image;c.src=o.target.result,c.onload=()=>{const d=document.createElement("canvas");let{width:f,height:p}=c;f>p?f>e&&(p=Math.round(p*(e/f)),f=e):p>n&&(f=Math.round(f*(n/p)),p=n),d.width=f,d.height=p;const g=d.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(c,0,0,f,p),r(d.toDataURL("image/jpeg",.85))},c.onerror=d=>s(new Error(`Error en carregar la imatge: ${d}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),C5=({chat:t,onSelect:e,currentUser:n,onDelete:r,isConfirmingDelete:s,onStartConfirmDelete:i,onCancelConfirmDelete:o})=>{var g,E,C,P,b;const c=t.participantIds.find(T=>T!==n.id);if(!c)return null;const u=t.participants[c],d=t.unreadCount[n.id]||0,f=((C=(E=(g=t.lastMessage)==null?void 0:g.timestamp)==null?void 0:E.toDate())==null?void 0:C.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"",p=()=>{r(t.id),o()};return l.jsxs("div",{className:"w-full relative bg-white overflow-hidden group",children:[l.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center justify-end px-4 gap-2 bg-white",children:[l.jsx("button",{onClick:o,className:"text-sm font-semibold py-2 px-3 rounded-md bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors","aria-label":"Cancella l'eliminaci",children:"Cancella"}),l.jsx("button",{onClick:p,className:"text-sm font-semibold py-2 px-3 rounded-md bg-red-600 text-white hover:bg-red-700 transition-colors","aria-label":"Confirma l'eliminaci",children:"Elimina"})]}),l.jsxs("div",{className:`w-full flex items-center gap-2 px-2 py-1 bg-white relative transition-transform duration-300 ease-in-out ${s?"-translate-x-44":"translate-x-0"}`,children:[l.jsxs("button",{onClick:e,className:"w-full text-left p-2 flex items-center gap-3 rounded-lg hover:bg-gray-100 transition-colors flex-1",children:[l.jsxs("div",{className:"relative flex-shrink-0",children:[l.jsx("img",{src:u.avatarUrl,alt:u.name,className:"w-12 h-12 rounded-full object-cover"}),l.jsx("img",{src:t.productImageUrl,alt:t.productTitle,className:"w-6 h-6 rounded-full object-cover absolute -bottom-1 -right-1 border-2 border-white"})]}),l.jsxs("div",{className:"flex-1 overflow-hidden",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("p",{className:"font-bold text-gray-800 truncate",children:u.name}),l.jsx("p",{className:"text-xs text-gray-500 flex-shrink-0",children:f})]}),l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("p",{className:"text-sm text-gray-600 truncate pr-2",children:((P=t.lastMessage)==null?void 0:P.text)||((b=t.lastMessage)!=null&&b.imageUrl?"Imatge":"Cap missatge encara")}),d>0&&l.jsx("span",{className:"bg-primary text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center flex-shrink-0",children:d})]})]})]}),l.jsx("button",{onClick:i,className:"p-2 rounded-full text-gray-400 hover:bg-red-100 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100","aria-label":`Elimina el xat amb ${u.name}`,children:l.jsx(FE,{className:"w-5 h-5"})})]})]})},P5=({isOpen:t,onClose:e,chats:n,activeChat:r,messages:s,currentUser:i,onSendMessage:o,onSelectChat:c,onBackToList:u,onDeleteChat:d})=>{const[f,p]=R.useState(""),[g,E]=R.useState(null),C=R.useRef(null),P=R.useRef(null),b=()=>{var y;(y=P.current)==null||y.scrollIntoView({behavior:"smooth"})};R.useEffect(()=>{t&&r&&b()},[s,t,r]),R.useEffect(()=>{(!t||!r)&&E(null)},[t,r]);const T=()=>{f.trim()&&(o(f),p(""))},x=y=>{y.key==="Enter"&&(y.preventDefault(),T())},A=async y=>{var I;const v=(I=y.target.files)==null?void 0:I[0];if(v)try{const N=await N5(v);o("",N)}catch(N){console.error("No s'ha pogut llegir el fitxer",N)}y.target&&(y.target.value="")},D=()=>{var y;(y=C.current)==null||y.click()};if(!t||!i)return null;const V=r==null?void 0:r.participantIds.find(y=>y!==i.id),O=V?r==null?void 0:r.participants[V]:null;return l.jsxs("div",{className:"fixed bottom-0 right-0 sm:bottom-4 md:bottom-8 sm:right-4 md:right-8 z-20 w-full sm:w-96 h-[90vh] sm:h-[60vh] sm:max-h-[600px] bg-white rounded-t-lg sm:rounded-lg shadow-2xl flex flex-col border border-gray-200 transform transition-transform duration-300 ease-in-out animate-slide-in",children:[l.jsx("style",{children:`
        @keyframes slide-in {
          from { transform: translateY(100%); opacity: 0; }
          to { transform: translateY(0); opacity: 1; }
        }
        .animate-slide-in { 
            animation: slide-in 0.3s ease-out; 
        }
        @keyframes fade-in-fast {
          from { opacity: 0; transform: scale(0.8); }
          to { opacity: 1; transform: scale(1); }
        }
        .animate-fade-in-fast { 
          animation: fade-in-fast 0.2s ease-out; 
        }
      `}),l.jsxs("header",{className:"bg-primary text-white p-3 flex justify-between items-center rounded-t-lg flex-shrink-0",children:[r?l.jsxs("div",{className:"flex items-center gap-3 flex-1 overflow-hidden",children:[l.jsx("button",{onClick:u,className:"hover:bg-primary-700 p-1 rounded-full -ml-1",children:l.jsx(a5,{className:"w-6 h-6"})}),l.jsx("img",{src:O==null?void 0:O.avatarUrl,alt:O==null?void 0:O.name,className:"w-8 h-8 rounded-full object-cover"}),l.jsxs("div",{className:"overflow-hidden",children:[l.jsx("h3",{className:"font-bold text-lg truncate",children:O==null?void 0:O.name}),l.jsx("p",{className:"text-xs opacity-80 truncate",children:r.productTitle})]})]}):l.jsx("div",{className:"flex items-center justify-between w-full",children:l.jsx("h3",{className:"font-bold text-lg",children:"Converses"})}),l.jsx("button",{onClick:e,className:"hover:bg-primary-700 p-1 rounded-full",children:l.jsx(Zr,{className:"w-6 h-6"})})]}),r?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex-1 p-4 overflow-y-auto space-y-4 bg-gray-50",children:[s.map(y=>l.jsx(k5,{message:y,currentUser:i},y.id)),l.jsx("div",{ref:P})]}),l.jsx("div",{className:"p-2 border-t border-gray-200 bg-gray-100 flex-shrink-0",children:l.jsxs("div",{className:"flex items-center bg-white border border-gray-300 rounded-lg px-2",children:[l.jsx("input",{type:"text",value:f,onChange:y=>p(y.target.value),onKeyPress:x,placeholder:"Escriu un missatge...",className:"flex-1 py-2 px-2 border-none focus:ring-0 text-sm bg-transparent text-gray-900","aria-label":"Entrada de missatge del xat"}),l.jsx("input",{ref:C,type:"file",onChange:A,className:"hidden",accept:"image/*"}),l.jsx("button",{onClick:D,className:"text-gray-500 hover:text-primary p-2","aria-label":"Adjunta una imatge",children:l.jsx(t5,{className:"w-5 h-5"})}),l.jsx("button",{onClick:T,className:"text-white bg-primary hover:bg-primary-700 rounded-md p-2 ml-1 disabled:bg-gray-400",disabled:!f.trim(),"aria-label":"Envia el missatge",children:l.jsx(s5,{className:"w-5 h-5"})})]})})]}):l.jsx("div",{className:"flex-1 overflow-y-auto",children:n.length>0?n.map(y=>l.jsx(C5,{chat:y,onSelect:()=>c(y),currentUser:i,onDelete:d,isConfirmingDelete:g===y.id,onStartConfirmDelete:()=>E(y.id),onCancelConfirmDelete:()=>E(null)},y.id)):l.jsxs("div",{className:"text-center p-8 text-gray-500 h-full flex flex-col justify-center items-center",children:[l.jsx(OE,{className:"w-16 h-16 text-gray-300 mb-4"}),l.jsx("p",{className:"font-semibold",children:"No tens cap conversa."}),l.jsx("p",{className:"text-sm mt-1",children:"Contacta amb un venedor des d'un anunci per comenar a xatejar."})]})})]})},vs=({title:t,children:e})=>l.jsxs("section",{className:"mb-6",children:[l.jsx("h2",{className:"text-xl font-bold text-primary mb-3",children:t}),l.jsx("div",{className:"space-y-2 text-gray-700",children:e})]}),R5=({onClose:t})=>l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:t,"aria-modal":"true",role:"dialog",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col relative",onClick:e=>e.stopPropagation(),children:[l.jsxs("header",{className:"p-4 border-b flex items-center justify-between sticky top-0 bg-white z-10",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(BE,{className:"w-8 h-8 text-primary"}),l.jsxs("h1",{className:"text-2xl font-bold text-gray-800",children:["Guia Rpida de ",l.jsx("span",{className:"text-gray-900",children:"LA"}),l.jsx("span",{className:"text-primary",children:"BOTIGA"})]})]}),l.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-800 p-1 rounded-full hover:bg-gray-100","aria-label":"Tancar",children:l.jsx(Zr,{className:"w-6 h-6"})})]}),l.jsxs("div",{className:"p-6 overflow-y-auto",children:[l.jsxs("section",{className:"mb-6",children:[l.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-3",children:[" Benvingut/da a ",l.jsx("span",{className:"text-gray-900",children:"LA"}),l.jsx("span",{className:"text-primary",children:"BOTIGA"}),"!"]}),l.jsx("div",{className:"space-y-2 text-gray-700",children:l.jsx("p",{children:"Aquesta s la botiga virtual del Club Handbol Molins, on pots comprar i vendre material d'handbol de segona m i adquirir el marxandatge oficial del club."})})]}),l.jsx(vs,{title:"1. Explora els Articles",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsxs("li",{children:["A la pgina principal, trobars les seccions ",l.jsx("strong",{children:"'Marxandatge del Club'"})," i ",l.jsx("strong",{children:"'Articles destacats'"}),"."]}),l.jsxs("li",{children:["Fes servir la ",l.jsx("strong",{children:"barra de cerca"})," per trobar articles especfics pel seu nom o descripci."]}),l.jsx("li",{children:"Fes clic a qualsevol article per veure'n els detalls."})]})}),l.jsx(vs,{title:"2. Comprar un Article de Segona M",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Quan trobis un article que t'interessi, fes-hi clic per obrir la vista detallada."}),l.jsxs("li",{children:[l.jsx("strong",{children:"Visualitza les imatges:"})," Fes clic a la imatge principal d'un producte per obrir-la a pantalla completa. Llisca el dit o fes servir les fletxes per veure la resta de fotos."]}),l.jsx("li",{children:"Llegeix la descripci i comprova el preu."}),l.jsxs("li",{children:["Per parlar amb el venedor, fes clic al bot ",l.jsx("strong",{children:"'Contacta amb el venedor'"}),". Aix obrir un xat privat."]}),l.jsx("li",{children:"Al xat, podeu acordar els detalls del pagament i l'entrega de forma segura."})]})}),l.jsxs(vs,{title:"3. Vendre un Article",children:[l.jsxs("p",{children:["Fes clic al bot ",l.jsx("strong",{children:"'Puja un article'"})," a la capalera per comenar."]}),l.jsxs("ul",{className:"list-decimal list-inside space-y-2 pl-4",children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Puja les teves fotos:"})," Fes clic a 'Afegeix fotos'. Podrs triar entre fer una foto amb la cmera o seleccionar-ne de la teva galeria. Pots pujar fins a 5 imatges. La primera ser la principal."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Descriu el teu article:"})," Afegeix un ttol clar i una descripci detallada. Com ms informaci, millor!"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Afegeix un preu:"})," Introdueix el preu que demanes per l'article. Pots demanar un suggeriment de preu automtic."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Vista prvia i publicaci:"})," A la dreta, veurs una vista prvia del teu anunci. Quan estiguis satisfet/a, fes clic a ",l.jsx("strong",{children:"'Publica l'anunci'"}),"."]})]})]}),l.jsx(vs,{title:"4. Gestiona els Teus Xats",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsxs("li",{children:["Fes clic a la ",l.jsx("strong",{children:"bombolla de xat"})," a la cantonada inferior dreta per veure les teves converses."]}),l.jsx("li",{children:"Un nmero vermell indicar els missatges nous que no has llegit."}),l.jsx("li",{children:"Pots enviar text i imatges a travs del xat per comunicar-te amb altres usuaris."}),l.jsx("li",{children:"Per eliminar un xat, a la llista de converses, fes clic a la icona de la paperera que apareix a la dreta en passar el cursor per sobre (ordinador). Haurs de confirmar l'acci."})]})}),l.jsx(vs,{title:"5. El Teu Perfil",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsxs("li",{children:["Fes clic a la teva ",l.jsx("strong",{children:"foto de perfil"})," a la capalera per anar a la pgina del teu perfil."]}),l.jsx("li",{children:"Aqu pots canviar el teu nom i la teva foto de perfil."}),l.jsxs("li",{children:["Tamb pots ",l.jsx("strong",{children:"tancar la sessi"})," des d'aquesta pgina de manera segura."]})]})}),l.jsx(vs,{title:"6. Comprar Marxandatge Oficial",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Els articles de la secci 'Marxandatge del Club' sn productes oficials."}),l.jsxs("li",{children:["Per comprar-ne un, fes clic a l'article i desprs al bot ",l.jsx("strong",{children:"'Realitzar comanda'"}),". Sers redirigit/da a un formulari per completar la comanda."]}),l.jsxs("li",{children:["Si tens dubtes, ara tamb pots fer clic a ",l.jsx("strong",{children:"'Contacta amb el club'"})," per iniciar un xat directe abans de fer la comanda."]})]})}),l.jsxs(vs,{title:"7. Eines d'Administrador",children:[l.jsx("p",{children:"Si tens el rol d'administrador, a la teva pgina de perfil trobars un panell addicional."}),l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsxs("li",{children:["Aquest panell et permet enviar ",l.jsx("strong",{children:"missatges massius"})," a tots els usuaris o missatges directes a un usuari especfic."]}),l.jsx("li",{children:"Aquests missatges apareixeran com una nova conversa de xat per als destinataris."})]})]})]})]})}),hv=({direction:t,onClick:e})=>l.jsx("button",{onClick:n=>{n.stopPropagation(),e()},className:`absolute top-1/2 -translate-y-1/2 ${t==="left"?"left-2 md:left-4":"right-2 md:right-4"} z-10 bg-black bg-opacity-40 text-white p-2 rounded-full hover:bg-opacity-60 transition-all`,"aria-label":t==="left"?"Imatge anterior":"Imatge segent",children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-8 md:w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:t==="left"?"M15 19l-7-7 7-7":"M9 5l7 7-7 7"})})}),j5=({images:t,startIndex:e=0,onClose:n})=>{const[r,s]=R.useState(e),[i,o]=R.useState(null),c=R.useCallback(()=>{s(p=>p===0?t.length-1:p-1)},[t.length]),u=R.useCallback(()=>{s(p=>p===t.length-1?0:p+1)},[t.length]);R.useEffect(()=>{const p=g=>{g.key==="ArrowLeft"&&c(),g.key==="ArrowRight"&&u(),g.key==="Escape"&&n()};return window.addEventListener("keydown",p),()=>{window.removeEventListener("keydown",p)}},[c,u,n]);const d=p=>{o(p.touches[0].clientX)},f=p=>{if(i===null)return;const g=p.touches[0].clientX,E=i-g;E>50?(u(),o(null)):E<-50&&(c(),o(null))};return l.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-80 z-50 flex flex-col justify-center items-center animate-fade-in-fast",onClick:n,role:"dialog","aria-modal":"true",children:[l.jsx("style",{children:`
            @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }
            .animate-fade-in-fast { animation: fade-in-fast 0.2s ease-out; }
        `}),l.jsx("button",{onClick:p=>{p.stopPropagation(),n()},className:"absolute top-4 right-4 text-white bg-black bg-opacity-40 p-2 rounded-full hover:bg-opacity-60 transition-all","aria-label":"Tancar visor",children:l.jsx(Zr,{className:"w-6 h-6"})}),l.jsxs("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:[t.length>1&&l.jsx(hv,{direction:"left",onClick:c}),l.jsx("div",{className:"w-full h-full flex items-center justify-center",onTouchStart:d,onTouchMove:f,children:l.jsx("img",{src:t[r],alt:`Imatge ${r+1} de ${t.length}`,className:"max-w-full max-h-full object-contain select-none"})}),t.length>1&&l.jsx(hv,{direction:"right",onClick:u})]}),t.length>1&&l.jsxs("div",{className:"absolute bottom-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm",children:[r+1," / ",t.length]})]})},D5={apiKey:"AIzaSyDgTGIPoHLYy9rfdpiQo07Y7F-1ytphaQM",authDomain:"botiga-35dc0.firebaseapp.com",projectId:"botiga-35dc0",storageBucket:"botiga-35dc0.firebasestorage.app",messagingSenderId:"671047302164",appId:"1:671047302164:web:2cc6065f3055dbd8fdbb01",measurementId:"G-C3X8Y6GG88"},_p=mm(D5),ws=N1(_p),Ke=Qx(_p),Pl=typeof window<"u"?DE(_p):null,Ot=[{id:"user-0",name:"Admin CHMolins",avatarUrl:"https://i.pravatar.cc/150?u=admin",email:"admin@chmolins.com",joinDate:"2023-01-01",role:"admin"},{id:"user-1",name:"Anna L.",avatarUrl:"https://i.pravatar.cc/150?u=anna",email:"anna@example.com",joinDate:"2023-05-12",role:"user"},{id:"user-2",name:"Carles B.",avatarUrl:"https://i.pravatar.cc/150?u=carles",email:"carles@example.com",joinDate:"2023-08-20",role:"user"},{id:"user-3",name:"Laura M.",avatarUrl:"https://i.pravatar.cc/150?u=laura",email:"laura@example.com",joinDate:"2023-11-01",role:"user"},{id:"user-4",name:"David S.",avatarUrl:"https://i.pravatar.cc/150?u=david",email:"david@example.com",joinDate:"2024-02-15",role:"user"}],fv=[{id:"1",title:"Jaqueta de cuir vintage",description:"Jaqueta de cuir genu dels anys 80, en perfecte estat. Talla M.",price:75,imageUrls:["https://images.unsplash.com/photo-1551028719-00167b16eac5?q=80&w=800"],seller:Ot[1],createdAt:new Date("2024-07-20T10:00:00Z")},{id:"2",title:"Bicicleta de muntanya Scott",description:"Bicicleta Scott Aspect 970, rodes de 29 polzades, frens de disc. Poc s.",price:350,imageUrls:["https://images.unsplash.com/photo-1576426863848-c21f68c6aa98?q=80&w=800"],seller:Ot[2],createdAt:new Date("2024-07-19T15:30:00Z")},{id:"3",title:"Cmera rflex Canon EOS 2000D",description:"Inclou objectiu 18-55mm, bossa de transport i targeta de memria. Ideal per a principiants.",price:320,imageUrls:["https://images.unsplash.com/photo-1512790182412-b19e6d62bc39?q=80&w=800"],seller:Ot[3],createdAt:new Date("2024-07-19T12:00:00Z")},{id:"4",title:"Sof de 3 places gris",description:"Sof cmode i modern. Fundes rentables. Mides: 200x90cm.",price:180,imageUrls:["https://images.unsplash.com/photo-1555041469-a586c61ea9bc?q=80&w=800"],seller:Ot[4],createdAt:new Date("2024-07-18T18:45:00Z")},{id:"5",title:"Guitarra acstica Yamaha",description:"Model F310. So excellent. Perfecta per aprendre a tocar.",price:90,imageUrls:["https://images.unsplash.com/photo-1558021211-65140282a3f8?q=80&w=800"],seller:Ot[1],createdAt:new Date("2024-07-18T11:20:00Z")},{id:"6",title:"iPhone 12 - 128GB Blau",description:"En bon estat, sempre amb protector de pantalla. Salut de la bateria al 88%.",price:450,imageUrls:["https://images.unsplash.com/photo-1616348436168-de43ad0db179?q=80&w=800"],seller:Ot[3],createdAt:new Date("2024-07-17T20:00:00Z")},{id:"7",title:"Vambes Nike Air Max",description:"Talla 43. Edici limitada. Noms utilitzades un parell de vegades.",price:85,imageUrls:["https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=800"],seller:Ot[2],createdAt:new Date("2024-07-17T09:05:00Z")},{id:"8",title:"Patinet elctric Xiaomi",description:"Model Mi Electric Scooter 3. Fins a 30 km d'autonomia. Plegable i lleuger.",price:250,imageUrls:["https://images.unsplash.com/photo-1598214013444-96379d71c664?q=80&w=800"],seller:Ot[4],createdAt:new Date("2024-07-16T14:00:00Z")},{id:"9",title:"Collecci de llibres de Harry Potter",description:"Els 7 llibres de la saga, tapa dura. Edici Salamandra.",price:60,imageUrls:["https://images.unsplash.com/photo-1618965907452-a8a235327546?q=80&w=800"],seller:Ot[1],createdAt:new Date("2024-07-15T21:30:00Z")},{id:"10",title:"Planta Monstera Deliciosa",description:"Planta d'interior gran i saludable. Inclou test de cermica.",price:30,imageUrls:["https://images.unsplash.com/photo-1614594975525-e4d524c48996?q=80&w=800"],seller:Ot[3],createdAt:new Date("2024-07-15T10:15:00Z")},{id:"11",title:"Samarreta Oficial CHM",description:"Samarreta oficial del club, 100% cot. Totes les talles disponibles.",price:25,imageUrls:["https://images.unsplash.com/photo-1571455789393-8a76380c5435?q=80&w=800"],seller:Ot[0],createdAt:new Date("2024-07-21T10:00:00Z"),isMerchandise:!0},{id:"12",title:"Tassa CHM",description:"Tassa de cermica amb el logo del club. Resistent al microones i rentaplats.",price:12.5,imageUrls:["https://images.unsplash.com/photo-1594225026210-5a9b71b83b63?q=80&w=800"],seller:Ot[0],createdAt:new Date("2024-07-21T10:05:00Z"),isMerchandise:!0},{id:"13",title:"Bufanda CHM Fans",description:"Bufanda de llana per animar l'equip els dies de partit.",price:18,imageUrls:["https://images.unsplash.com/photo-1610295313555-252a71383713?q=80&w=800"],seller:Ot[0],createdAt:new Date("2024-07-21T10:10:00Z"),isMerchandise:!0}],L5=({product:t,currentUser:e,onClose:n,onEdit:r,onContactSeller:s,onDelete:i,onOpenImageViewer:o})=>{const[c,u]=R.useState(0),[d,f]=R.useState(!1),[p,g]=R.useState(!1),E=R.useRef(null);R.useEffect(()=>()=>{E.current&&clearTimeout(E.current)},[]),R.useEffect(()=>{const A=D=>{D.key==="Escape"&&n()};return window.addEventListener("keydown",A),()=>{window.removeEventListener("keydown",A)}},[n]);const C=async()=>{d||(p?(E.current&&(clearTimeout(E.current),E.current=null),f(!0),await i(t.id)||(f(!1),g(!1))):(g(!0),E.current=window.setTimeout(()=>{g(!1),E.current=null},4e3)))},P=(e==null?void 0:e.role)==="admin",b=(e==null?void 0:e.id)===t.seller.id,T=t.imageUrls&&t.imageUrls.length>0,x=A=>typeof A!="number"||isNaN(A)?"N/A":A.toFixed(2);return l.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:n,"aria-modal":"true",role:"dialog",children:[l.jsx("style",{children:`
        @keyframes fade-in {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        .animate-fade-in { animation: fade-in 0.2s ease-out; }
      `}),l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl lg:max-w-4xl xl:max-w-5xl max-h-[90vh] overflow-hidden flex flex-col lg:flex-row relative",onClick:A=>A.stopPropagation(),children:[l.jsx("button",{onClick:n,className:"absolute top-3 right-3 text-gray-400 hover:text-gray-800 z-10 bg-white bg-opacity-50 rounded-full p-1 transition-colors","aria-label":"Tancar",children:l.jsx(Zr,{className:"w-6 h-6"})}),l.jsxs("div",{className:"w-full lg:w-3/5 flex-shrink-0 flex flex-col",children:[l.jsx("div",{className:"w-full bg-gray-100 h-80 lg:h-full flex items-center justify-center lg:flex-grow",children:T&&l.jsx("img",{src:t.imageUrls[c],alt:`${t.title} - imatge ${c+1}`,className:`w-full h-full object-cover lg:rounded-l-2xl rounded-t-2xl lg:rounded-t-none cursor-pointer ${t.tag==="vendido"?"grayscale":""}`,onClick:()=>o(t.imageUrls,c)})}),T&&t.imageUrls.length>1&&l.jsx("div",{className:"flex-shrink-0 p-2 bg-white lg:bg-gray-50 flex gap-2 justify-center",children:t.imageUrls.map((A,D)=>l.jsx("button",{onClick:()=>u(D),className:`w-12 h-12 rounded-md overflow-hidden border-2 transition-colors bg-gray-100 ${c===D?"border-primary":"border-transparent hover:border-gray-400"}`,children:l.jsx("img",{src:A,alt:`miniatura ${D+1}`,className:`w-full h-full object-cover ${t.tag==="vendido"?"grayscale":""}`})},D))})]}),l.jsxs("div",{className:"p-4 md:p-6 flex flex-col flex-1 overflow-y-auto",children:[t.tag&&Gn[t.tag]&&l.jsxs("div",{className:`w-fit text-sm font-semibold px-3 py-1 rounded-full mb-3 ${Gn[t.tag].className}`,children:[Gn[t.tag].emoji," ",Gn[t.tag].label]}),l.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-gray-900 mb-2",children:t.title}),l.jsxs("p",{className:"text-3xl lg:text-4xl font-extrabold text-primary mb-4",children:[x(t.price)," "]}),l.jsxs("div",{className:"flex-grow pr-2 space-y-4",children:[l.jsxs("div",{className:"border-t pt-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"Venedor"}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("img",{src:t.seller.avatarUrl,alt:t.seller.name,className:"w-12 h-12 rounded-full mr-4"}),l.jsx("div",{children:l.jsx("p",{className:"font-semibold text-gray-800",children:t.seller.name})})]})]}),l.jsxs("div",{className:"border-t pt-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Descripci"}),l.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:t.description})]})]}),l.jsxs("div",{className:"mt-6 flex-shrink-0 space-y-3",children:[t.isMerchandise&&l.jsxs("a",{href:"https://forms.gle/wc7nmx2MubiMix8h8",target:"_blank",rel:"noopener noreferrer",className:"w-full flex items-center justify-center gap-2 bg-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors",children:[l.jsx(r5,{className:"w-5 h-5"}),l.jsx("span",{children:"Realitzar comanda"})]}),!b&&e&&l.jsxs("button",{onClick:()=>s(t),className:`w-full flex items-center justify-center gap-2 font-bold py-3 px-4 rounded-lg transition-colors ${t.isMerchandise?"bg-gray-600 text-white hover:bg-gray-700":"bg-primary text-white hover:bg-primary-700"} disabled:bg-gray-400 disabled:cursor-not-allowed`,disabled:t.tag==="vendido",children:[l.jsx(OE,{className:"w-5 h-5"}),l.jsx("span",{children:t.tag==="vendido"?"Article venut":t.isMerchandise?"Contacta amb el club":"Contacta amb el venedor"})]}),(P||b)&&l.jsxs("div",{className:"flex gap-3",children:[l.jsxs("button",{onClick:()=>r(t),disabled:d||p,className:"w-full flex items-center justify-center gap-2 bg-yellow-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-yellow-600 transition-colors disabled:opacity-50",children:[l.jsx(Z4,{className:"w-5 h-5"})," Edita"]}),l.jsx("button",{onClick:C,disabled:d,className:`w-full flex items-center justify-center gap-2 text-white font-bold py-3 px-4 rounded-lg transition-all duration-200 ${p?"bg-red-700 hover:bg-red-800":"bg-red-500 hover:bg-red-600"} disabled:bg-red-400 disabled:cursor-wait`,children:d?l.jsxs(l.Fragment,{children:[l.jsx(qs,{className:"w-5 h-5"}),l.jsx("span",{children:"Eliminant..."})]}):p?"Confirmar eliminaci":l.jsxs(l.Fragment,{children:[l.jsx(FE,{className:"w-5 h-5"}),l.jsx("span",{children:"Elimina"})]})})]})]})]})]})]})},M5=()=>{const[t,e]=R.useState("home"),[n,r]=R.useState([]),[s,i]=R.useState([]),[o,c]=R.useState(null),[u,d]=R.useState(null),[f,p]=R.useState(null),[g,E]=R.useState(null),[C,P]=R.useState(null),[b,T]=R.useState(null),[x,A]=R.useState([]),[D,V]=R.useState(!1),[O,y]=R.useState([]),[v,I]=R.useState(null),[N,S]=R.useState([]),[k,_]=R.useState(0),ee=R.useRef(new Set),[ge,wt]=R.useState(!1);R.useEffect(()=>{if(!b)return;if((async()=>{var B;if(!Pl){console.log("Firebase Messaging no est disponible en aquest navegador.");return}try{if(await window.Notification.requestPermission()==="granted"){const W=await LE(Pl,{vapidKey:"BL2B5V3vjPkyyPrTo-aW-5s5t7oW3_Ni_M9XANqYdM1uO9jY3yA9k84Xo7Z-yL3p0M_sF3g4d2c1qWj9k7l4z5k"});if(W){const H=Ge(Ke,"users",b.id);(((B=(await Kc(H)).data())==null?void 0:B.fcmTokens)||[]).includes(W)||await At(H,{fcmTokens:Gc(W)})}else console.log("No s'ha pogut obtenir el token de registre.")}}catch(U){console.error("Ha ocorregut un error en configurar les notificacions:",U)}})(),Pl){const B=ME(Pl,U=>{var F,W;console.log("Missatge rebut en primer pla: ",U),c({message:`${(F=U.notification)==null?void 0:F.title}: ${(W=U.notification)==null?void 0:W.body}`,type:"success"})});return()=>B()}},[b]),R.useEffect(()=>{let L=null;const B=v1(ws,U=>{if(L&&(L(),L=null),U){const F=Ge(Ke,"users",U.uid);L=bn(F,W=>{W.exists()?T({id:U.uid,...W.data()}):(Ni(ws),T(null))},W=>{console.error("Error en escoltar el document d'usuari:",W),Ni(ws),T(null)})}else T(null)});return()=>{B(),L&&L()}},[]),R.useEffect(()=>{if((b==null?void 0:b.role)==="admin"){const L=Tn(Be(Ke,"users")),B=bn(L,U=>{const F=U.docs.map(W=>({id:W.id,...W.data()}));A(F.filter(W=>W.id!==b.id))});return()=>B()}else A([])},[b]),R.useEffect(()=>{const L=Tn(Be(Ke,"products")),B=bn(L,U=>{const F=U.docs.map(q=>{var ue;const J=q.data(),ne=(ue=J.createdAt)!=null&&ue.toDate?J.createdAt.toDate():new Date;return{id:q.id,...J,createdAt:ne}}),W=F.filter(q=>q.isMerchandise),H=F.filter(q=>!q.isMerchandise);W.sort((q,J)=>J.createdAt.getTime()-q.createdAt.getTime()),H.sort((q,J)=>{const ne=q.tag==="vendido",ue=J.tag==="vendido";return ne&&!ue?1:!ne&&ue?-1:J.createdAt.getTime()-q.createdAt.getTime()}),i(W),r(H),E(null)},U=>{console.error("Error en el listener de Firestore (products):",U),E(U),c({message:"Error de connexi. Mostrant articles d'exemple.",type:"error"});const F=fv.filter(H=>H.isMerchandise).map(H=>({...H,createdAt:new Date(H.createdAt)})),W=fv.filter(H=>!H.isMerchandise).map(H=>({...H,createdAt:new Date(H.createdAt)}));F.sort((H,q)=>q.createdAt.getTime()-H.createdAt.getTime()),W.sort((H,q)=>q.createdAt.getTime()-H.createdAt.getTime()),i(F),r(W)});return()=>B()},[]),R.useEffect(()=>{if(!b){y([]);return}const L=Tn(Be(Ke,"chats"),Pi("participantIds","array-contains",b.id)),B=bn(L,U=>{let F=U.docs.map(H=>({id:H.id,...H.data()}));F=F.filter(H=>{var q;return!((q=H.hiddenFor)!=null&&q.includes(b.id))&&!ee.current.has(H.id)}),F.sort((H,q)=>{var ue,Lt;const J=((ue=H.updatedAt)==null?void 0:ue.toMillis())||0;return(((Lt=q.updatedAt)==null?void 0:Lt.toMillis())||0)-J});const W=F.reduce((H,q)=>H+(q.unreadCount[b.id]||0),0);_(W),y(F),E(null)},U=>{console.error("Error fetching chats:",U),E(U)});return()=>B()},[b]),R.useEffect(()=>{if(!v){S([]);return}const L=Tn(Be(Ke,"chats",v.id,"messages")),B=bn(L,U=>{const F=U.docs.map(W=>({id:W.id,...W.data()}));F.sort((W,H)=>{var ne,ue;const q=((ne=W.timestamp)==null?void 0:ne.toMillis())||0,J=((ue=H.timestamp)==null?void 0:ue.toMillis())||0;return q-J}),S(F)});return()=>B()},[v]),R.useEffect(()=>{if(o){const L=setTimeout(()=>c(null),8e3);return()=>clearTimeout(L)}},[o]),R.useEffect(()=>{const L="LABOTIGA";k>0?document.title=`(${k}) ${L}`:document.title=L},[k]),R.useEffect(()=>(u||D||!b||ge||C?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[u,D,b,ge,C]);const Vn=async(L,B)=>{await y1(ws,L,B),c({message:"Benvingut/da de nou!",type:"success"})},Q=(L,B)=>{const W=`<svg xmlns="http://www.w3.org/2000/svg" width="150" height="150" viewBox="0 0 150 150">
                    <rect width="100%" height="100%" fill="${(H=>{let q=0;for(let ne=0;ne<H.length;ne++)q=H.charCodeAt(ne)+((q<<5)-q);let J="#";for(let ne=0;ne<3;ne++){const ue=q>>ne*8&255;J+=("00"+ue.toString(16)).substr(-2)}return J})(B)}" />
                    <text x="50%" y="55%" dominant-baseline="middle" text-anchor="middle" font-family="Arial, sans-serif" font-size="60" fill="#ffffff">${L}</text>
                 </svg>`;return`data:image/svg+xml;base64,${btoa(W)}`},re=async(L,B,U,F)=>{let W="",H=F;if(!H){const ue=L.split(" ").map(Lt=>Lt[0]).slice(0,2).join("").toUpperCase();H=Q(ue,L)}try{W=await tc(H)}catch(ue){throw console.error("La pujada de la imatge ha fallat:",ue),new Error("No s'ha pogut pujar la imatge. Revisa la teva configuraci de Cloudinary i que el 'preset' sigui 'unsigned'.")}if(!W)throw new Error("Cloudinary no ha retornat una URL vlida.");const J=(await g1(ws,B,U)).user,ne={name:L,email:B,avatarUrl:W,joinDate:new Date().toISOString(),role:"user",fcmTokens:[]};await aE(Ge(Ke,"users",J.uid),ne),T({id:J.uid,...ne}),c({message:`Benvingut/da, ${L}! El teu compte ha estat creat.`,type:"success"})},ae=async L=>{try{await p1(ws,L),c({message:"S'ha enviat un correu per restablir la contrasenya. Revisa la teva bstia d'entrada.",type:"success"})}catch(B){throw console.error("Error en restablir la contrasenya:",B),B}},_e=async()=>{e("home"),await Ni(ws),c({message:"Sessi tancada correctament.",type:"success"})},Ie=()=>{e("home"),p(null)},rn=()=>{p(null),e("listing")},lt=()=>{b&&e("profile")},sn=async(L,B,U)=>{if(!b||b.id!==L)throw c({message:"No autoritzat.",type:"error"}),new Error("No autoritzat.");if(B===b.name&&!U){c({message:"No s'han detectat canvis.",type:"success"});return}try{const F={name:B};U&&(F.avatarUrl=await tc(U));const W=Ge(Ke,"users",L);await At(W,F),c({message:"Perfil actualitzat correctament!",type:"success"})}catch(F){throw console.error("Error actualitzant l'usuari:",F),c({message:`Error en actualitzar: ${F.message||"Error desconegut."}`,type:"error"}),F}},_t=async(L,B)=>{var U;if(!b)throw c({message:"Has d'iniciar la sessi per desar un producte.",type:"error"}),new Error("L'usuari no ha iniciat la sessi.");try{const F=L.imageUrls.map(q=>q.startsWith("data:image")?tc(q):Promise.resolve(q)),W=await Promise.all(F),H={...L,imageUrls:W};if(B){const q=Ge(Ke,"products",B),J=(U=(await Kc(q)).data())==null?void 0:U.seller;await At(q,{...H,seller:J}),c({message:"Anunci actualitzat correctament!",type:"success"})}else{const q={...H,seller:{id:b.id,name:b.name,avatarUrl:b.avatarUrl},createdAt:new Date};await In(Be(Ke,"products"),q),c({message:"Anunci publicat amb xit!",type:"success"})}e("home"),p(null)}catch(F){throw console.error("Error al desar el producte:",F),c({message:`Error en desar: ${F.message||"Error desconegut."}`,type:"error"}),F}},Wt=L=>{p(L),d(null),e("listing")},as=async L=>{try{return await lE(Ge(Ke,"products",L)),c({message:"Anunci eliminat correctament.",type:"success"}),d(null),!0}catch(B){console.error("Error en eliminar el producte: ",B);const U=`Error en eliminar: ${B.code||B.message||"Error desconegut."}`;return c({message:U,type:"error"}),!1}},Xs=L=>{d(L)},ao=()=>{d(null)},lo=async L=>{if(!b)return;const B=L.seller.id,U=b.id,F=Be(Ke,"chats"),W=Tn(F,Pi("productId","==",L.id),Pi("participantIds","array-contains",U)),H=await oE(W);let q=null;if(H.forEach(J=>{const ne={id:J.id,...J.data()};ne.participantIds.includes(B)&&(q=ne)}),q)await dr(q);else{const J={participantIds:[U,B],participants:{[U]:{name:b.name,avatarUrl:b.avatarUrl},[B]:{name:L.seller.name,avatarUrl:L.seller.avatarUrl}},productId:L.id,productTitle:L.title,productImageUrl:L.imageUrls[0]||"",lastMessage:null,createdAt:ft(),updatedAt:ft(),unreadCount:{[U]:0,[B]:0},hiddenFor:[]},ne=await In(Be(Ke,"chats"),J);I({id:ne.id,...J})}d(null),V(!0)},dr=async L=>{if(I(L),b&&(L.unreadCount[b.id]||0)>0){const B=Ge(Ke,"chats",L.id);await At(B,{[`unreadCount.${b.id}`]:0})}},ls=async(L,B)=>{if(!b||!v)return;const U=b.id,F=v.participantIds.find(q=>q!==U);if(!F)return;const W={senderId:U,text:L,timestamp:ft(),...B&&{imageUrl:B}};await In(Be(Ke,"chats",v.id,"messages"),W);const H=Ge(Ke,"chats",v.id);await At(H,{lastMessage:{...W,timestamp:new Date},updatedAt:ft(),[`unreadCount.${F}`]:Qc(1)})},Js=()=>{I(null)},co=()=>{V(!1),I(null)},cs=async L=>{if(!b)return;ee.current.add(L),y(U=>U.filter(F=>F.id!==L)),(v==null?void 0:v.id)===L&&I(null);const B=Ge(Ke,"chats",L);try{await At(B,{hiddenFor:Gc(b.id)}),ee.current.delete(L)}catch(U){console.error("Error en eliminar el xat:",U),c({message:"No s'ha pogut eliminar el xat. La conversa es restaurar.",type:"error"}),ee.current.delete(L)}},us=async(L,B)=>{if(!b||b.role!=="admin"){c({message:"No autoritzat.",type:"error"});return}const U=L==="all"?x:x.filter(F=>F.id===L);if(U.length===0){c({message:"No s'han trobat destinataris.",type:"error"});return}try{for(const F of U){const W=`admin-message-${b.id}-${F.id}-${Date.now()}`,H={participantIds:[b.id,F.id],participants:{[b.id]:{name:b.name,avatarUrl:b.avatarUrl},[F.id]:{name:F.name,avatarUrl:F.avatarUrl}},productId:W,productTitle:"Missatge de l'administrador",productImageUrl:b.avatarUrl,lastMessage:null,createdAt:ft(),updatedAt:ft(),unreadCount:{[b.id]:0,[F.id]:0},hiddenFor:[]},q=await In(Be(Ke,"chats"),H),J={senderId:b.id,text:B,timestamp:ft()};await In(Be(Ke,"chats",q.id,"messages"),J),await At(q,{lastMessage:{...J,timestamp:new Date},updatedAt:ft(),[`unreadCount.${F.id}`]:Qc(1)})}c({message:`Missatge enviat a ${U.length} usuari(s).`,type:"success"})}catch(F){throw console.error("Error en enviar el missatge d'administrador:",F),c({message:"No s'ha pogut enviar el missatge.",type:"error"}),F}};return b?l.jsxs("div",{className:"min-h-screen bg-gray-50 font-sans text-gray-800",children:[l.jsx(u5,{user:b,onNavigateHome:Ie,onNavigateToListing:rn,onNavigateToProfile:lt,onOpenTutorial:()=>wt(!0)}),l.jsx(T5,{message:(o==null?void 0:o.message)||null,type:o==null?void 0:o.type,onClose:()=>c(null)}),t==="home"&&l.jsx(d5,{userProducts:n,merchProducts:s,onProductSelect:Xs,firebaseError:g,currentUser:b}),t==="listing"&&l.jsx(E5,{onSave:_t,productToEdit:f,currentUser:b}),t==="profile"&&l.jsx(S5,{user:b,onUpdateUser:sn,onBack:()=>e("home"),onLogout:_e,allUsers:x,onSendAdminMessage:us}),u&&l.jsx(L5,{product:u,currentUser:b,onClose:ao,onEdit:Wt,onContactSeller:lo,onDelete:as,onOpenImageViewer:(L,B)=>P({images:L,startIndex:B})}),ge&&l.jsx(R5,{onClose:()=>wt(!1)}),C&&l.jsx(j5,{images:C.images,startIndex:C.startIndex,onClose:()=>P(null)}),l.jsx(A5,{isOpen:D,onClick:()=>V(!D),unreadCount:k}),l.jsx(P5,{isOpen:D,onClose:co,chats:O,activeChat:v,messages:N,currentUser:b,onSendMessage:ls,onSelectChat:dr,onBackToList:Js,onDeleteChat:cs})]}):l.jsxs("div",{className:"min-h-screen bg-cover bg-center flex items-center justify-center p-4",style:{backgroundImage:"url('https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/Bandera%20Club%20Handbol%20Molins.png')"},children:[l.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"}),l.jsx("div",{className:"relative z-10",children:l.jsx(I5,{onLogin:Vn,onRegister:re,onPasswordReset:ae,isDismissable:!1})})]})},$E=document.getElementById("root");if(!$E)throw new Error("Could not find root element to mount to");const V5=nc.createRoot($E);V5.render(l.jsx(Iv.StrictMode,{children:l.jsx(M5,{})}));
