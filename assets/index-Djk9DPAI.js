(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function d2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var hv={exports:{}},Qc={},fv={exports:{}},de={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ra=Symbol.for("react.element"),h2=Symbol.for("react.portal"),f2=Symbol.for("react.fragment"),m2=Symbol.for("react.strict_mode"),p2=Symbol.for("react.profiler"),g2=Symbol.for("react.provider"),y2=Symbol.for("react.context"),v2=Symbol.for("react.forward_ref"),w2=Symbol.for("react.suspense"),_2=Symbol.for("react.memo"),x2=Symbol.for("react.lazy"),ug=Symbol.iterator;function E2(t){return t===null||typeof t!="object"?null:(t=ug&&t[ug]||t["@@iterator"],typeof t=="function"?t:null)}var mv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},pv=Object.assign,gv={};function Wi(t,e,n){this.props=t,this.context=e,this.refs=gv,this.updater=n||mv}Wi.prototype.isReactComponent={};Wi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Wi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function yv(){}yv.prototype=Wi.prototype;function ff(t,e,n){this.props=t,this.context=e,this.refs=gv,this.updater=n||mv}var mf=ff.prototype=new yv;mf.constructor=ff;pv(mf,Wi.prototype);mf.isPureReactComponent=!0;var dg=Array.isArray,vv=Object.prototype.hasOwnProperty,pf={current:null},wv={key:!0,ref:!0,__self:!0,__source:!0};function _v(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)vv.call(e,r)&&!wv.hasOwnProperty(r)&&(s[r]=e[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:Ra,type:t,key:i,ref:o,props:s,_owner:pf.current}}function T2(t,e){return{$$typeof:Ra,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function gf(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ra}function I2(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var hg=/\/+/g;function td(t,e){return typeof t=="object"&&t!==null&&t.key!=null?I2(""+t.key):e.toString(36)}function Cl(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ra:case h2:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+td(o,0):r,dg(s)?(n="",t!=null&&(n=t.replace(hg,"$&/")+"/"),Cl(s,e,n,"",function(d){return d})):s!=null&&(gf(s)&&(s=T2(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(hg,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",dg(t))for(var c=0;c<t.length;c++){i=t[c];var u=r+td(i,c);o+=Cl(i,e,n,u,s)}else if(u=E2(t),typeof u=="function")for(t=u.call(t),c=0;!(i=t.next()).done;)i=i.value,u=r+td(i,c++),o+=Cl(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function il(t,e,n){if(t==null)return t;var r=[],s=0;return Cl(t,r,"","",function(i){return e.call(n,i,s++)}),r}function b2(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Tt={current:null},Pl={transition:null},S2={ReactCurrentDispatcher:Tt,ReactCurrentBatchConfig:Pl,ReactCurrentOwner:pf};function xv(){throw Error("act(...) is not supported in production builds of React.")}de.Children={map:il,forEach:function(t,e,n){il(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return il(t,function(){e++}),e},toArray:function(t){return il(t,function(e){return e})||[]},only:function(t){if(!gf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};de.Component=Wi;de.Fragment=f2;de.Profiler=p2;de.PureComponent=ff;de.StrictMode=m2;de.Suspense=w2;de.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=S2;de.act=xv;de.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=pv({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=pf.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)vv.call(e,u)&&!wv.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];r.children=c}return{$$typeof:Ra,type:t.type,key:s,ref:i,props:r,_owner:o}};de.createContext=function(t){return t={$$typeof:y2,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:g2,_context:t},t.Consumer=t};de.createElement=_v;de.createFactory=function(t){var e=_v.bind(null,t);return e.type=t,e};de.createRef=function(){return{current:null}};de.forwardRef=function(t){return{$$typeof:v2,render:t}};de.isValidElement=gf;de.lazy=function(t){return{$$typeof:x2,_payload:{_status:-1,_result:t},_init:b2}};de.memo=function(t,e){return{$$typeof:_2,type:t,compare:e===void 0?null:e}};de.startTransition=function(t){var e=Pl.transition;Pl.transition={};try{t()}finally{Pl.transition=e}};de.unstable_act=xv;de.useCallback=function(t,e){return Tt.current.useCallback(t,e)};de.useContext=function(t){return Tt.current.useContext(t)};de.useDebugValue=function(){};de.useDeferredValue=function(t){return Tt.current.useDeferredValue(t)};de.useEffect=function(t,e){return Tt.current.useEffect(t,e)};de.useId=function(){return Tt.current.useId()};de.useImperativeHandle=function(t,e,n){return Tt.current.useImperativeHandle(t,e,n)};de.useInsertionEffect=function(t,e){return Tt.current.useInsertionEffect(t,e)};de.useLayoutEffect=function(t,e){return Tt.current.useLayoutEffect(t,e)};de.useMemo=function(t,e){return Tt.current.useMemo(t,e)};de.useReducer=function(t,e,n){return Tt.current.useReducer(t,e,n)};de.useRef=function(t){return Tt.current.useRef(t)};de.useState=function(t){return Tt.current.useState(t)};de.useSyncExternalStore=function(t,e,n){return Tt.current.useSyncExternalStore(t,e,n)};de.useTransition=function(){return Tt.current.useTransition()};de.version="18.3.1";fv.exports=de;var R=fv.exports;const Ev=d2(R);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A2=R,N2=Symbol.for("react.element"),k2=Symbol.for("react.fragment"),C2=Object.prototype.hasOwnProperty,P2=A2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,R2={key:!0,ref:!0,__self:!0,__source:!0};function Tv(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)C2.call(e,r)&&!R2.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:N2,type:t,key:i,ref:o,props:s,_owner:P2.current}}Qc.Fragment=k2;Qc.jsx=Tv;Qc.jsxs=Tv;hv.exports=Qc;var l=hv.exports,ec={},Iv={exports:{}},zt={},bv={exports:{}},Sv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Q,ne){var ae=Q.length;Q.push(ne);e:for(;0<ae;){var we=ae-1>>>1,Te=Q[we];if(0<s(Te,ne))Q[we]=ne,Q[ae]=Te,ae=we;else break e}}function n(Q){return Q.length===0?null:Q[0]}function r(Q){if(Q.length===0)return null;var ne=Q[0],ae=Q.pop();if(ae!==ne){Q[0]=ae;e:for(var we=0,Te=Q.length,rn=Te>>>1;we<rn;){var lt=2*(we+1)-1,sn=Q[lt],wt=lt+1,Ht=Q[wt];if(0>s(sn,ae))wt<Te&&0>s(Ht,sn)?(Q[we]=Ht,Q[wt]=ae,we=wt):(Q[we]=sn,Q[lt]=ae,we=lt);else if(wt<Te&&0>s(Ht,ae))Q[we]=Ht,Q[wt]=ae,we=wt;else break e}}return ne}function s(Q,ne){var ae=Q.sortIndex-ne.sortIndex;return ae!==0?ae:Q.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],d=[],f=1,m=null,g=3,T=!1,C=!1,P=!1,S=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(Q){for(var ne=n(d);ne!==null;){if(ne.callback===null)r(d);else if(ne.startTime<=Q)r(d),ne.sortIndex=ne.expirationTime,e(u,ne);else break;ne=n(d)}}function D(Q){if(P=!1,A(Q),!C)if(n(u)!==null)C=!0,nn(V);else{var ne=n(d);ne!==null&&Vn(D,ne.startTime-Q)}}function V(Q,ne){C=!1,P&&(P=!1,I(v),v=-1),T=!0;var ae=g;try{for(A(ne),m=n(u);m!==null&&(!(m.expirationTime>ne)||Q&&!_());){var we=m.callback;if(typeof we=="function"){m.callback=null,g=m.priorityLevel;var Te=we(m.expirationTime<=ne);ne=t.unstable_now(),typeof Te=="function"?m.callback=Te:m===n(u)&&r(u),A(ne)}else r(u);m=n(u)}if(m!==null)var rn=!0;else{var lt=n(d);lt!==null&&Vn(D,lt.startTime-ne),rn=!1}return rn}finally{m=null,g=ae,T=!1}}var B=!1,y=null,v=-1,b=5,k=-1;function _(){return!(t.unstable_now()-k<b)}function N(){if(y!==null){var Q=t.unstable_now();k=Q;var ne=!0;try{ne=y(!0,Q)}finally{ne?x():(B=!1,y=null)}}else B=!1}var x;if(typeof E=="function")x=function(){E(N)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,Ve=ie.port2;ie.port1.onmessage=N,x=function(){Ve.postMessage(null)}}else x=function(){S(N,0)};function nn(Q){y=Q,B||(B=!0,x())}function Vn(Q,ne){v=S(function(){Q(t.unstable_now())},ne)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Q){Q.callback=null},t.unstable_continueExecution=function(){C||T||(C=!0,nn(V))},t.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<Q?Math.floor(1e3/Q):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(Q){switch(g){case 1:case 2:case 3:var ne=3;break;default:ne=g}var ae=g;g=ne;try{return Q()}finally{g=ae}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Q,ne){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var ae=g;g=Q;try{return ne()}finally{g=ae}},t.unstable_scheduleCallback=function(Q,ne,ae){var we=t.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?we+ae:we):ae=we,Q){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=ae+Te,Q={id:f++,callback:ne,priorityLevel:Q,startTime:ae,expirationTime:Te,sortIndex:-1},ae>we?(Q.sortIndex=ae,e(d,Q),n(u)===null&&Q===n(d)&&(P?(I(v),v=-1):P=!0,Vn(D,ae-we))):(Q.sortIndex=Te,e(u,Q),C||T||(C=!0,nn(V))),Q},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(Q){var ne=g;return function(){var ae=g;g=ne;try{return Q.apply(this,arguments)}finally{g=ae}}}})(Sv);bv.exports=Sv;var j2=bv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D2=R,$t=j2;function K(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Av=new Set,ra={};function Hs(t,e){Ri(t,e),Ri(t+"Capture",e)}function Ri(t,e){for(ra[t]=e,t=0;t<e.length;t++)Av.add(e[t])}var Zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hd=Object.prototype.hasOwnProperty,L2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fg={},mg={};function M2(t){return Hd.call(mg,t)?!0:Hd.call(fg,t)?!1:L2.test(t)?mg[t]=!0:(fg[t]=!0,!1)}function V2(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function O2(t,e,n,r){if(e===null||typeof e>"u"||V2(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function It(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var ot={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ot[t]=new It(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ot[e]=new It(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ot[t]=new It(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ot[t]=new It(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ot[t]=new It(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ot[t]=new It(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ot[t]=new It(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ot[t]=new It(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ot[t]=new It(t,5,!1,t.toLowerCase(),null,!1,!1)});var yf=/[\-:]([a-z])/g;function vf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(yf,vf);ot[e]=new It(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(yf,vf);ot[e]=new It(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(yf,vf);ot[e]=new It(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ot[t]=new It(t,1,!1,t.toLowerCase(),null,!1,!1)});ot.xlinkHref=new It("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ot[t]=new It(t,1,!1,t.toLowerCase(),null,!0,!0)});function wf(t,e,n,r){var s=ot.hasOwnProperty(e)?ot[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(O2(e,n,s,r)&&(n=null),r||s===null?M2(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var lr=D2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ol=Symbol.for("react.element"),ai=Symbol.for("react.portal"),li=Symbol.for("react.fragment"),_f=Symbol.for("react.strict_mode"),Wd=Symbol.for("react.profiler"),Nv=Symbol.for("react.provider"),kv=Symbol.for("react.context"),xf=Symbol.for("react.forward_ref"),Kd=Symbol.for("react.suspense"),Gd=Symbol.for("react.suspense_list"),Ef=Symbol.for("react.memo"),_r=Symbol.for("react.lazy"),Cv=Symbol.for("react.offscreen"),pg=Symbol.iterator;function Io(t){return t===null||typeof t!="object"?null:(t=pg&&t[pg]||t["@@iterator"],typeof t=="function"?t:null)}var Pe=Object.assign,nd;function Ro(t){if(nd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);nd=e&&e[1]||""}return`
`+nd+t}var rd=!1;function sd(t,e){if(!t||rd)return"";rd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,c=i.length-1;1<=o&&0<=c&&s[o]!==i[c];)c--;for(;1<=o&&0<=c;o--,c--)if(s[o]!==i[c]){if(o!==1||c!==1)do if(o--,c--,0>c||s[o]!==i[c]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=c);break}}}finally{rd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ro(t):""}function F2(t){switch(t.tag){case 5:return Ro(t.type);case 16:return Ro("Lazy");case 13:return Ro("Suspense");case 19:return Ro("SuspenseList");case 0:case 2:case 15:return t=sd(t.type,!1),t;case 11:return t=sd(t.type.render,!1),t;case 1:return t=sd(t.type,!0),t;default:return""}}function Qd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case li:return"Fragment";case ai:return"Portal";case Wd:return"Profiler";case _f:return"StrictMode";case Kd:return"Suspense";case Gd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case kv:return(t.displayName||"Context")+".Consumer";case Nv:return(t._context.displayName||"Context")+".Provider";case xf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ef:return e=t.displayName||null,e!==null?e:Qd(t.type)||"Memo";case _r:e=t._payload,t=t._init;try{return Qd(t(e))}catch{}}return null}function U2(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qd(e);case 8:return e===_f?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function $r(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Pv(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function B2(t){var e=Pv(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function al(t){t._valueTracker||(t._valueTracker=B2(t))}function Rv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Pv(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function tc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Yd(t,e){var n=e.checked;return Pe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function gg(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=$r(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function jv(t,e){e=e.checked,e!=null&&wf(t,"checked",e,!1)}function Xd(t,e){jv(t,e);var n=$r(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Jd(t,e.type,n):e.hasOwnProperty("defaultValue")&&Jd(t,e.type,$r(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function yg(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Jd(t,e,n){(e!=="number"||tc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var jo=Array.isArray;function _i(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+$r(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Zd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(K(91));return Pe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function vg(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(K(92));if(jo(n)){if(1<n.length)throw Error(K(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:$r(n)}}function Dv(t,e){var n=$r(e.value),r=$r(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function wg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Lv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function eh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Lv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ll,Mv=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ll=ll||document.createElement("div"),ll.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ll.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function sa(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var $o={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$2=["Webkit","ms","Moz","O"];Object.keys($o).forEach(function(t){$2.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),$o[e]=$o[t]})});function Vv(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||$o.hasOwnProperty(t)&&$o[t]?(""+e).trim():e+"px"}function Ov(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Vv(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var z2=Pe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function th(t,e){if(e){if(z2[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(K(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(K(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(K(61))}if(e.style!=null&&typeof e.style!="object")throw Error(K(62))}}function nh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rh=null;function Tf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var sh=null,xi=null,Ei=null;function _g(t){if(t=La(t)){if(typeof sh!="function")throw Error(K(280));var e=t.stateNode;e&&(e=eu(e),sh(t.stateNode,t.type,e))}}function Fv(t){xi?Ei?Ei.push(t):Ei=[t]:xi=t}function Uv(){if(xi){var t=xi,e=Ei;if(Ei=xi=null,_g(t),e)for(t=0;t<e.length;t++)_g(e[t])}}function Bv(t,e){return t(e)}function $v(){}var id=!1;function zv(t,e,n){if(id)return t(e,n);id=!0;try{return Bv(t,e,n)}finally{id=!1,(xi!==null||Ei!==null)&&($v(),Uv())}}function ia(t,e){var n=t.stateNode;if(n===null)return null;var r=eu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(K(231,e,typeof n));return n}var ih=!1;if(Zn)try{var bo={};Object.defineProperty(bo,"passive",{get:function(){ih=!0}}),window.addEventListener("test",bo,bo),window.removeEventListener("test",bo,bo)}catch{ih=!1}function q2(t,e,n,r,s,i,o,c,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(f){this.onError(f)}}var zo=!1,nc=null,rc=!1,oh=null,H2={onError:function(t){zo=!0,nc=t}};function W2(t,e,n,r,s,i,o,c,u){zo=!1,nc=null,q2.apply(H2,arguments)}function K2(t,e,n,r,s,i,o,c,u){if(W2.apply(this,arguments),zo){if(zo){var d=nc;zo=!1,nc=null}else throw Error(K(198));rc||(rc=!0,oh=d)}}function Ws(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function qv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function xg(t){if(Ws(t)!==t)throw Error(K(188))}function G2(t){var e=t.alternate;if(!e){if(e=Ws(t),e===null)throw Error(K(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return xg(s),t;if(i===r)return xg(s),e;i=i.sibling}throw Error(K(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,c=s.child;c;){if(c===n){o=!0,n=s,r=i;break}if(c===r){o=!0,r=s,n=i;break}c=c.sibling}if(!o){for(c=i.child;c;){if(c===n){o=!0,n=i,r=s;break}if(c===r){o=!0,r=i,n=s;break}c=c.sibling}if(!o)throw Error(K(189))}}if(n.alternate!==r)throw Error(K(190))}if(n.tag!==3)throw Error(K(188));return n.stateNode.current===n?t:e}function Hv(t){return t=G2(t),t!==null?Wv(t):null}function Wv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Wv(t);if(e!==null)return e;t=t.sibling}return null}var Kv=$t.unstable_scheduleCallback,Eg=$t.unstable_cancelCallback,Q2=$t.unstable_shouldYield,Y2=$t.unstable_requestPaint,Fe=$t.unstable_now,X2=$t.unstable_getCurrentPriorityLevel,If=$t.unstable_ImmediatePriority,Gv=$t.unstable_UserBlockingPriority,sc=$t.unstable_NormalPriority,J2=$t.unstable_LowPriority,Qv=$t.unstable_IdlePriority,Yc=null,Sn=null;function Z2(t){if(Sn&&typeof Sn.onCommitFiberRoot=="function")try{Sn.onCommitFiberRoot(Yc,t,void 0,(t.current.flags&128)===128)}catch{}}var dn=Math.clz32?Math.clz32:nT,eT=Math.log,tT=Math.LN2;function nT(t){return t>>>=0,t===0?32:31-(eT(t)/tT|0)|0}var cl=64,ul=4194304;function Do(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ic(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var c=o&~s;c!==0?r=Do(c):(i&=o,i!==0&&(r=Do(i)))}else o=n&~s,o!==0?r=Do(o):i!==0&&(r=Do(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-dn(e),s=1<<n,r|=t[n],e&=~s;return r}function rT(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sT(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-dn(i),c=1<<o,u=s[o];u===-1?(!(c&n)||c&r)&&(s[o]=rT(c,e)):u<=e&&(t.expiredLanes|=c),i&=~c}}function ah(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Yv(){var t=cl;return cl<<=1,!(cl&4194240)&&(cl=64),t}function od(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ja(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-dn(e),t[e]=n}function iT(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-dn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function bf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-dn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var ve=0;function Xv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Jv,Sf,Zv,ew,tw,lh=!1,dl=[],Pr=null,Rr=null,jr=null,oa=new Map,aa=new Map,Er=[],oT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Tg(t,e){switch(t){case"focusin":case"focusout":Pr=null;break;case"dragenter":case"dragleave":Rr=null;break;case"mouseover":case"mouseout":jr=null;break;case"pointerover":case"pointerout":oa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":aa.delete(e.pointerId)}}function So(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=La(e),e!==null&&Sf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function aT(t,e,n,r,s){switch(e){case"focusin":return Pr=So(Pr,t,e,n,r,s),!0;case"dragenter":return Rr=So(Rr,t,e,n,r,s),!0;case"mouseover":return jr=So(jr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return oa.set(i,So(oa.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,aa.set(i,So(aa.get(i)||null,t,e,n,r,s)),!0}return!1}function nw(t){var e=Ts(t.target);if(e!==null){var n=Ws(e);if(n!==null){if(e=n.tag,e===13){if(e=qv(n),e!==null){t.blockedOn=e,tw(t.priority,function(){Zv(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Rl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ch(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);rh=r,n.target.dispatchEvent(r),rh=null}else return e=La(n),e!==null&&Sf(e),t.blockedOn=n,!1;e.shift()}return!0}function Ig(t,e,n){Rl(t)&&n.delete(e)}function lT(){lh=!1,Pr!==null&&Rl(Pr)&&(Pr=null),Rr!==null&&Rl(Rr)&&(Rr=null),jr!==null&&Rl(jr)&&(jr=null),oa.forEach(Ig),aa.forEach(Ig)}function Ao(t,e){t.blockedOn===e&&(t.blockedOn=null,lh||(lh=!0,$t.unstable_scheduleCallback($t.unstable_NormalPriority,lT)))}function la(t){function e(s){return Ao(s,t)}if(0<dl.length){Ao(dl[0],t);for(var n=1;n<dl.length;n++){var r=dl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Pr!==null&&Ao(Pr,t),Rr!==null&&Ao(Rr,t),jr!==null&&Ao(jr,t),oa.forEach(e),aa.forEach(e),n=0;n<Er.length;n++)r=Er[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Er.length&&(n=Er[0],n.blockedOn===null);)nw(n),n.blockedOn===null&&Er.shift()}var Ti=lr.ReactCurrentBatchConfig,oc=!0;function cT(t,e,n,r){var s=ve,i=Ti.transition;Ti.transition=null;try{ve=1,Af(t,e,n,r)}finally{ve=s,Ti.transition=i}}function uT(t,e,n,r){var s=ve,i=Ti.transition;Ti.transition=null;try{ve=4,Af(t,e,n,r)}finally{ve=s,Ti.transition=i}}function Af(t,e,n,r){if(oc){var s=ch(t,e,n,r);if(s===null)gd(t,e,r,ac,n),Tg(t,r);else if(aT(s,t,e,n,r))r.stopPropagation();else if(Tg(t,r),e&4&&-1<oT.indexOf(t)){for(;s!==null;){var i=La(s);if(i!==null&&Jv(i),i=ch(t,e,n,r),i===null&&gd(t,e,r,ac,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else gd(t,e,r,null,n)}}var ac=null;function ch(t,e,n,r){if(ac=null,t=Tf(r),t=Ts(t),t!==null)if(e=Ws(t),e===null)t=null;else if(n=e.tag,n===13){if(t=qv(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ac=t,null}function rw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(X2()){case If:return 1;case Gv:return 4;case sc:case J2:return 16;case Qv:return 536870912;default:return 16}default:return 16}}var Nr=null,Nf=null,jl=null;function sw(){if(jl)return jl;var t,e=Nf,n=e.length,r,s="value"in Nr?Nr.value:Nr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return jl=s.slice(t,1<r?1-r:void 0)}function Dl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function hl(){return!0}function bg(){return!1}function qt(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?hl:bg,this.isPropagationStopped=bg,this}return Pe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=hl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=hl)},persist:function(){},isPersistent:hl}),e}var Ki={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},kf=qt(Ki),Da=Pe({},Ki,{view:0,detail:0}),dT=qt(Da),ad,ld,No,Xc=Pe({},Da,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==No&&(No&&t.type==="mousemove"?(ad=t.screenX-No.screenX,ld=t.screenY-No.screenY):ld=ad=0,No=t),ad)},movementY:function(t){return"movementY"in t?t.movementY:ld}}),Sg=qt(Xc),hT=Pe({},Xc,{dataTransfer:0}),fT=qt(hT),mT=Pe({},Da,{relatedTarget:0}),cd=qt(mT),pT=Pe({},Ki,{animationName:0,elapsedTime:0,pseudoElement:0}),gT=qt(pT),yT=Pe({},Ki,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),vT=qt(yT),wT=Pe({},Ki,{data:0}),Ag=qt(wT),_T={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ET={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function TT(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=ET[t])?!!e[t]:!1}function Cf(){return TT}var IT=Pe({},Da,{key:function(t){if(t.key){var e=_T[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Dl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?xT[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cf,charCode:function(t){return t.type==="keypress"?Dl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Dl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),bT=qt(IT),ST=Pe({},Xc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ng=qt(ST),AT=Pe({},Da,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cf}),NT=qt(AT),kT=Pe({},Ki,{propertyName:0,elapsedTime:0,pseudoElement:0}),CT=qt(kT),PT=Pe({},Xc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),RT=qt(PT),jT=[9,13,27,32],Pf=Zn&&"CompositionEvent"in window,qo=null;Zn&&"documentMode"in document&&(qo=document.documentMode);var DT=Zn&&"TextEvent"in window&&!qo,iw=Zn&&(!Pf||qo&&8<qo&&11>=qo),kg=" ",Cg=!1;function ow(t,e){switch(t){case"keyup":return jT.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function aw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ci=!1;function LT(t,e){switch(t){case"compositionend":return aw(e);case"keypress":return e.which!==32?null:(Cg=!0,kg);case"textInput":return t=e.data,t===kg&&Cg?null:t;default:return null}}function MT(t,e){if(ci)return t==="compositionend"||!Pf&&ow(t,e)?(t=sw(),jl=Nf=Nr=null,ci=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return iw&&e.locale!=="ko"?null:e.data;default:return null}}var VT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!VT[t.type]:e==="textarea"}function lw(t,e,n,r){Fv(r),e=lc(e,"onChange"),0<e.length&&(n=new kf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ho=null,ca=null;function OT(t){ww(t,0)}function Jc(t){var e=hi(t);if(Rv(e))return t}function FT(t,e){if(t==="change")return e}var cw=!1;if(Zn){var ud;if(Zn){var dd="oninput"in document;if(!dd){var Rg=document.createElement("div");Rg.setAttribute("oninput","return;"),dd=typeof Rg.oninput=="function"}ud=dd}else ud=!1;cw=ud&&(!document.documentMode||9<document.documentMode)}function jg(){Ho&&(Ho.detachEvent("onpropertychange",uw),ca=Ho=null)}function uw(t){if(t.propertyName==="value"&&Jc(ca)){var e=[];lw(e,ca,t,Tf(t)),zv(OT,e)}}function UT(t,e,n){t==="focusin"?(jg(),Ho=e,ca=n,Ho.attachEvent("onpropertychange",uw)):t==="focusout"&&jg()}function BT(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Jc(ca)}function $T(t,e){if(t==="click")return Jc(e)}function zT(t,e){if(t==="input"||t==="change")return Jc(e)}function qT(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var fn=typeof Object.is=="function"?Object.is:qT;function ua(t,e){if(fn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Hd.call(e,s)||!fn(t[s],e[s]))return!1}return!0}function Dg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Lg(t,e){var n=Dg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Dg(n)}}function dw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?dw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function hw(){for(var t=window,e=tc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=tc(t.document)}return e}function Rf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function HT(t){var e=hw(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&dw(n.ownerDocument.documentElement,n)){if(r!==null&&Rf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Lg(n,i);var o=Lg(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var WT=Zn&&"documentMode"in document&&11>=document.documentMode,ui=null,uh=null,Wo=null,dh=!1;function Mg(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;dh||ui==null||ui!==tc(r)||(r=ui,"selectionStart"in r&&Rf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Wo&&ua(Wo,r)||(Wo=r,r=lc(uh,"onSelect"),0<r.length&&(e=new kf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ui)))}function fl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var di={animationend:fl("Animation","AnimationEnd"),animationiteration:fl("Animation","AnimationIteration"),animationstart:fl("Animation","AnimationStart"),transitionend:fl("Transition","TransitionEnd")},hd={},fw={};Zn&&(fw=document.createElement("div").style,"AnimationEvent"in window||(delete di.animationend.animation,delete di.animationiteration.animation,delete di.animationstart.animation),"TransitionEvent"in window||delete di.transitionend.transition);function Zc(t){if(hd[t])return hd[t];if(!di[t])return t;var e=di[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in fw)return hd[t]=e[n];return t}var mw=Zc("animationend"),pw=Zc("animationiteration"),gw=Zc("animationstart"),yw=Zc("transitionend"),vw=new Map,Vg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ts(t,e){vw.set(t,e),Hs(e,[t])}for(var fd=0;fd<Vg.length;fd++){var md=Vg[fd],KT=md.toLowerCase(),GT=md[0].toUpperCase()+md.slice(1);ts(KT,"on"+GT)}ts(mw,"onAnimationEnd");ts(pw,"onAnimationIteration");ts(gw,"onAnimationStart");ts("dblclick","onDoubleClick");ts("focusin","onFocus");ts("focusout","onBlur");ts(yw,"onTransitionEnd");Ri("onMouseEnter",["mouseout","mouseover"]);Ri("onMouseLeave",["mouseout","mouseover"]);Ri("onPointerEnter",["pointerout","pointerover"]);Ri("onPointerLeave",["pointerout","pointerover"]);Hs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Hs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Hs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Hs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Hs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Hs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QT=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lo));function Og(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,K2(r,e,void 0,t),t.currentTarget=null}function ww(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var c=r[o],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==i&&s.isPropagationStopped())break e;Og(s,c,d),i=u}else for(o=0;o<r.length;o++){if(c=r[o],u=c.instance,d=c.currentTarget,c=c.listener,u!==i&&s.isPropagationStopped())break e;Og(s,c,d),i=u}}}if(rc)throw t=oh,rc=!1,oh=null,t}function be(t,e){var n=e[gh];n===void 0&&(n=e[gh]=new Set);var r=t+"__bubble";n.has(r)||(_w(e,t,2,!1),n.add(r))}function pd(t,e,n){var r=0;e&&(r|=4),_w(n,t,r,e)}var ml="_reactListening"+Math.random().toString(36).slice(2);function da(t){if(!t[ml]){t[ml]=!0,Av.forEach(function(n){n!=="selectionchange"&&(QT.has(n)||pd(n,!1,t),pd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ml]||(e[ml]=!0,pd("selectionchange",!1,e))}}function _w(t,e,n,r){switch(rw(e)){case 1:var s=cT;break;case 4:s=uT;break;default:s=Af}n=s.bind(null,e,n,t),s=void 0,!ih||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function gd(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;c!==null;){if(o=Ts(c),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}c=c.parentNode}}r=r.return}zv(function(){var d=i,f=Tf(n),m=[];e:{var g=vw.get(t);if(g!==void 0){var T=kf,C=t;switch(t){case"keypress":if(Dl(n)===0)break e;case"keydown":case"keyup":T=bT;break;case"focusin":C="focus",T=cd;break;case"focusout":C="blur",T=cd;break;case"beforeblur":case"afterblur":T=cd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":T=Sg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":T=fT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":T=NT;break;case mw:case pw:case gw:T=gT;break;case yw:T=CT;break;case"scroll":T=dT;break;case"wheel":T=RT;break;case"copy":case"cut":case"paste":T=vT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":T=Ng}var P=(e&4)!==0,S=!P&&t==="scroll",I=P?g!==null?g+"Capture":null:g;P=[];for(var E=d,A;E!==null;){A=E;var D=A.stateNode;if(A.tag===5&&D!==null&&(A=D,I!==null&&(D=ia(E,I),D!=null&&P.push(ha(E,D,A)))),S)break;E=E.return}0<P.length&&(g=new T(g,C,null,n,f),m.push({event:g,listeners:P}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",T=t==="mouseout"||t==="pointerout",g&&n!==rh&&(C=n.relatedTarget||n.fromElement)&&(Ts(C)||C[er]))break e;if((T||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,T?(C=n.relatedTarget||n.toElement,T=d,C=C?Ts(C):null,C!==null&&(S=Ws(C),C!==S||C.tag!==5&&C.tag!==6)&&(C=null)):(T=null,C=d),T!==C)){if(P=Sg,D="onMouseLeave",I="onMouseEnter",E="mouse",(t==="pointerout"||t==="pointerover")&&(P=Ng,D="onPointerLeave",I="onPointerEnter",E="pointer"),S=T==null?g:hi(T),A=C==null?g:hi(C),g=new P(D,E+"leave",T,n,f),g.target=S,g.relatedTarget=A,D=null,Ts(f)===d&&(P=new P(I,E+"enter",C,n,f),P.target=A,P.relatedTarget=S,D=P),S=D,T&&C)t:{for(P=T,I=C,E=0,A=P;A;A=ni(A))E++;for(A=0,D=I;D;D=ni(D))A++;for(;0<E-A;)P=ni(P),E--;for(;0<A-E;)I=ni(I),A--;for(;E--;){if(P===I||I!==null&&P===I.alternate)break t;P=ni(P),I=ni(I)}P=null}else P=null;T!==null&&Fg(m,g,T,P,!1),C!==null&&S!==null&&Fg(m,S,C,P,!0)}}e:{if(g=d?hi(d):window,T=g.nodeName&&g.nodeName.toLowerCase(),T==="select"||T==="input"&&g.type==="file")var V=FT;else if(Pg(g))if(cw)V=zT;else{V=BT;var B=UT}else(T=g.nodeName)&&T.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(V=$T);if(V&&(V=V(t,d))){lw(m,V,n,f);break e}B&&B(t,g,d),t==="focusout"&&(B=g._wrapperState)&&B.controlled&&g.type==="number"&&Jd(g,"number",g.value)}switch(B=d?hi(d):window,t){case"focusin":(Pg(B)||B.contentEditable==="true")&&(ui=B,uh=d,Wo=null);break;case"focusout":Wo=uh=ui=null;break;case"mousedown":dh=!0;break;case"contextmenu":case"mouseup":case"dragend":dh=!1,Mg(m,n,f);break;case"selectionchange":if(WT)break;case"keydown":case"keyup":Mg(m,n,f)}var y;if(Pf)e:{switch(t){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else ci?ow(t,n)&&(v="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(v="onCompositionStart");v&&(iw&&n.locale!=="ko"&&(ci||v!=="onCompositionStart"?v==="onCompositionEnd"&&ci&&(y=sw()):(Nr=f,Nf="value"in Nr?Nr.value:Nr.textContent,ci=!0)),B=lc(d,v),0<B.length&&(v=new Ag(v,t,null,n,f),m.push({event:v,listeners:B}),y?v.data=y:(y=aw(n),y!==null&&(v.data=y)))),(y=DT?LT(t,n):MT(t,n))&&(d=lc(d,"onBeforeInput"),0<d.length&&(f=new Ag("onBeforeInput","beforeinput",null,n,f),m.push({event:f,listeners:d}),f.data=y))}ww(m,e)})}function ha(t,e,n){return{instance:t,listener:e,currentTarget:n}}function lc(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ia(t,n),i!=null&&r.unshift(ha(t,i,s)),i=ia(t,e),i!=null&&r.push(ha(t,i,s))),t=t.return}return r}function ni(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Fg(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var c=n,u=c.alternate,d=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&d!==null&&(c=d,s?(u=ia(n,i),u!=null&&o.unshift(ha(n,u,c))):s||(u=ia(n,i),u!=null&&o.push(ha(n,u,c)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var YT=/\r\n?/g,XT=/\u0000|\uFFFD/g;function Ug(t){return(typeof t=="string"?t:""+t).replace(YT,`
`).replace(XT,"")}function pl(t,e,n){if(e=Ug(e),Ug(t)!==e&&n)throw Error(K(425))}function cc(){}var hh=null,fh=null;function mh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ph=typeof setTimeout=="function"?setTimeout:void 0,JT=typeof clearTimeout=="function"?clearTimeout:void 0,Bg=typeof Promise=="function"?Promise:void 0,ZT=typeof queueMicrotask=="function"?queueMicrotask:typeof Bg<"u"?function(t){return Bg.resolve(null).then(t).catch(eI)}:ph;function eI(t){setTimeout(function(){throw t})}function yd(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),la(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);la(e)}function Dr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function $g(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Gi=Math.random().toString(36).slice(2),En="__reactFiber$"+Gi,fa="__reactProps$"+Gi,er="__reactContainer$"+Gi,gh="__reactEvents$"+Gi,tI="__reactListeners$"+Gi,nI="__reactHandles$"+Gi;function Ts(t){var e=t[En];if(e)return e;for(var n=t.parentNode;n;){if(e=n[er]||n[En]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=$g(t);t!==null;){if(n=t[En])return n;t=$g(t)}return e}t=n,n=t.parentNode}return null}function La(t){return t=t[En]||t[er],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function hi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(K(33))}function eu(t){return t[fa]||null}var yh=[],fi=-1;function ns(t){return{current:t}}function Ae(t){0>fi||(t.current=yh[fi],yh[fi]=null,fi--)}function Ee(t,e){fi++,yh[fi]=t.current,t.current=e}var zr={},yt=ns(zr),Ct=ns(!1),Rs=zr;function ji(t,e){var n=t.type.contextTypes;if(!n)return zr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Pt(t){return t=t.childContextTypes,t!=null}function uc(){Ae(Ct),Ae(yt)}function zg(t,e,n){if(yt.current!==zr)throw Error(K(168));Ee(yt,e),Ee(Ct,n)}function xw(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(K(108,U2(t)||"Unknown",s));return Pe({},n,r)}function dc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||zr,Rs=yt.current,Ee(yt,t),Ee(Ct,Ct.current),!0}function qg(t,e,n){var r=t.stateNode;if(!r)throw Error(K(169));n?(t=xw(t,e,Rs),r.__reactInternalMemoizedMergedChildContext=t,Ae(Ct),Ae(yt),Ee(yt,t)):Ae(Ct),Ee(Ct,n)}var $n=null,tu=!1,vd=!1;function Ew(t){$n===null?$n=[t]:$n.push(t)}function rI(t){tu=!0,Ew(t)}function rs(){if(!vd&&$n!==null){vd=!0;var t=0,e=ve;try{var n=$n;for(ve=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}$n=null,tu=!1}catch(s){throw $n!==null&&($n=$n.slice(t+1)),Kv(If,rs),s}finally{ve=e,vd=!1}}return null}var mi=[],pi=0,hc=null,fc=0,Wt=[],Kt=0,js=null,zn=1,qn="";function _s(t,e){mi[pi++]=fc,mi[pi++]=hc,hc=t,fc=e}function Tw(t,e,n){Wt[Kt++]=zn,Wt[Kt++]=qn,Wt[Kt++]=js,js=t;var r=zn;t=qn;var s=32-dn(r)-1;r&=~(1<<s),n+=1;var i=32-dn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,zn=1<<32-dn(e)+s|n<<s|r,qn=i+t}else zn=1<<i|n<<s|r,qn=t}function jf(t){t.return!==null&&(_s(t,1),Tw(t,1,0))}function Df(t){for(;t===hc;)hc=mi[--pi],mi[pi]=null,fc=mi[--pi],mi[pi]=null;for(;t===js;)js=Wt[--Kt],Wt[Kt]=null,qn=Wt[--Kt],Wt[Kt]=null,zn=Wt[--Kt],Wt[Kt]=null}var Bt=null,Ft=null,Ne=!1,cn=null;function Iw(t,e){var n=Yt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Hg(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Bt=t,Ft=Dr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Bt=t,Ft=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=js!==null?{id:zn,overflow:qn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Yt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Bt=t,Ft=null,!0):!1;default:return!1}}function vh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function wh(t){if(Ne){var e=Ft;if(e){var n=e;if(!Hg(t,e)){if(vh(t))throw Error(K(418));e=Dr(n.nextSibling);var r=Bt;e&&Hg(t,e)?Iw(r,n):(t.flags=t.flags&-4097|2,Ne=!1,Bt=t)}}else{if(vh(t))throw Error(K(418));t.flags=t.flags&-4097|2,Ne=!1,Bt=t}}}function Wg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Bt=t}function gl(t){if(t!==Bt)return!1;if(!Ne)return Wg(t),Ne=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!mh(t.type,t.memoizedProps)),e&&(e=Ft)){if(vh(t))throw bw(),Error(K(418));for(;e;)Iw(t,e),e=Dr(e.nextSibling)}if(Wg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(K(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ft=Dr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ft=null}}else Ft=Bt?Dr(t.stateNode.nextSibling):null;return!0}function bw(){for(var t=Ft;t;)t=Dr(t.nextSibling)}function Di(){Ft=Bt=null,Ne=!1}function Lf(t){cn===null?cn=[t]:cn.push(t)}var sI=lr.ReactCurrentBatchConfig;function ko(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(K(309));var r=n.stateNode}if(!r)throw Error(K(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var c=s.refs;o===null?delete c[i]:c[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(K(284));if(!n._owner)throw Error(K(290,t))}return t}function yl(t,e){throw t=Object.prototype.toString.call(e),Error(K(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Kg(t){var e=t._init;return e(t._payload)}function Sw(t){function e(I,E){if(t){var A=I.deletions;A===null?(I.deletions=[E],I.flags|=16):A.push(E)}}function n(I,E){if(!t)return null;for(;E!==null;)e(I,E),E=E.sibling;return null}function r(I,E){for(I=new Map;E!==null;)E.key!==null?I.set(E.key,E):I.set(E.index,E),E=E.sibling;return I}function s(I,E){return I=Or(I,E),I.index=0,I.sibling=null,I}function i(I,E,A){return I.index=A,t?(A=I.alternate,A!==null?(A=A.index,A<E?(I.flags|=2,E):A):(I.flags|=2,E)):(I.flags|=1048576,E)}function o(I){return t&&I.alternate===null&&(I.flags|=2),I}function c(I,E,A,D){return E===null||E.tag!==6?(E=bd(A,I.mode,D),E.return=I,E):(E=s(E,A),E.return=I,E)}function u(I,E,A,D){var V=A.type;return V===li?f(I,E,A.props.children,D,A.key):E!==null&&(E.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===_r&&Kg(V)===E.type)?(D=s(E,A.props),D.ref=ko(I,E,A),D.return=I,D):(D=Bl(A.type,A.key,A.props,null,I.mode,D),D.ref=ko(I,E,A),D.return=I,D)}function d(I,E,A,D){return E===null||E.tag!==4||E.stateNode.containerInfo!==A.containerInfo||E.stateNode.implementation!==A.implementation?(E=Sd(A,I.mode,D),E.return=I,E):(E=s(E,A.children||[]),E.return=I,E)}function f(I,E,A,D,V){return E===null||E.tag!==7?(E=ks(A,I.mode,D,V),E.return=I,E):(E=s(E,A),E.return=I,E)}function m(I,E,A){if(typeof E=="string"&&E!==""||typeof E=="number")return E=bd(""+E,I.mode,A),E.return=I,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case ol:return A=Bl(E.type,E.key,E.props,null,I.mode,A),A.ref=ko(I,null,E),A.return=I,A;case ai:return E=Sd(E,I.mode,A),E.return=I,E;case _r:var D=E._init;return m(I,D(E._payload),A)}if(jo(E)||Io(E))return E=ks(E,I.mode,A,null),E.return=I,E;yl(I,E)}return null}function g(I,E,A,D){var V=E!==null?E.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return V!==null?null:c(I,E,""+A,D);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case ol:return A.key===V?u(I,E,A,D):null;case ai:return A.key===V?d(I,E,A,D):null;case _r:return V=A._init,g(I,E,V(A._payload),D)}if(jo(A)||Io(A))return V!==null?null:f(I,E,A,D,null);yl(I,A)}return null}function T(I,E,A,D,V){if(typeof D=="string"&&D!==""||typeof D=="number")return I=I.get(A)||null,c(E,I,""+D,V);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case ol:return I=I.get(D.key===null?A:D.key)||null,u(E,I,D,V);case ai:return I=I.get(D.key===null?A:D.key)||null,d(E,I,D,V);case _r:var B=D._init;return T(I,E,A,B(D._payload),V)}if(jo(D)||Io(D))return I=I.get(A)||null,f(E,I,D,V,null);yl(E,D)}return null}function C(I,E,A,D){for(var V=null,B=null,y=E,v=E=0,b=null;y!==null&&v<A.length;v++){y.index>v?(b=y,y=null):b=y.sibling;var k=g(I,y,A[v],D);if(k===null){y===null&&(y=b);break}t&&y&&k.alternate===null&&e(I,y),E=i(k,E,v),B===null?V=k:B.sibling=k,B=k,y=b}if(v===A.length)return n(I,y),Ne&&_s(I,v),V;if(y===null){for(;v<A.length;v++)y=m(I,A[v],D),y!==null&&(E=i(y,E,v),B===null?V=y:B.sibling=y,B=y);return Ne&&_s(I,v),V}for(y=r(I,y);v<A.length;v++)b=T(y,I,v,A[v],D),b!==null&&(t&&b.alternate!==null&&y.delete(b.key===null?v:b.key),E=i(b,E,v),B===null?V=b:B.sibling=b,B=b);return t&&y.forEach(function(_){return e(I,_)}),Ne&&_s(I,v),V}function P(I,E,A,D){var V=Io(A);if(typeof V!="function")throw Error(K(150));if(A=V.call(A),A==null)throw Error(K(151));for(var B=V=null,y=E,v=E=0,b=null,k=A.next();y!==null&&!k.done;v++,k=A.next()){y.index>v?(b=y,y=null):b=y.sibling;var _=g(I,y,k.value,D);if(_===null){y===null&&(y=b);break}t&&y&&_.alternate===null&&e(I,y),E=i(_,E,v),B===null?V=_:B.sibling=_,B=_,y=b}if(k.done)return n(I,y),Ne&&_s(I,v),V;if(y===null){for(;!k.done;v++,k=A.next())k=m(I,k.value,D),k!==null&&(E=i(k,E,v),B===null?V=k:B.sibling=k,B=k);return Ne&&_s(I,v),V}for(y=r(I,y);!k.done;v++,k=A.next())k=T(y,I,v,k.value,D),k!==null&&(t&&k.alternate!==null&&y.delete(k.key===null?v:k.key),E=i(k,E,v),B===null?V=k:B.sibling=k,B=k);return t&&y.forEach(function(N){return e(I,N)}),Ne&&_s(I,v),V}function S(I,E,A,D){if(typeof A=="object"&&A!==null&&A.type===li&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case ol:e:{for(var V=A.key,B=E;B!==null;){if(B.key===V){if(V=A.type,V===li){if(B.tag===7){n(I,B.sibling),E=s(B,A.props.children),E.return=I,I=E;break e}}else if(B.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===_r&&Kg(V)===B.type){n(I,B.sibling),E=s(B,A.props),E.ref=ko(I,B,A),E.return=I,I=E;break e}n(I,B);break}else e(I,B);B=B.sibling}A.type===li?(E=ks(A.props.children,I.mode,D,A.key),E.return=I,I=E):(D=Bl(A.type,A.key,A.props,null,I.mode,D),D.ref=ko(I,E,A),D.return=I,I=D)}return o(I);case ai:e:{for(B=A.key;E!==null;){if(E.key===B)if(E.tag===4&&E.stateNode.containerInfo===A.containerInfo&&E.stateNode.implementation===A.implementation){n(I,E.sibling),E=s(E,A.children||[]),E.return=I,I=E;break e}else{n(I,E);break}else e(I,E);E=E.sibling}E=Sd(A,I.mode,D),E.return=I,I=E}return o(I);case _r:return B=A._init,S(I,E,B(A._payload),D)}if(jo(A))return C(I,E,A,D);if(Io(A))return P(I,E,A,D);yl(I,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,E!==null&&E.tag===6?(n(I,E.sibling),E=s(E,A),E.return=I,I=E):(n(I,E),E=bd(A,I.mode,D),E.return=I,I=E),o(I)):n(I,E)}return S}var Li=Sw(!0),Aw=Sw(!1),mc=ns(null),pc=null,gi=null,Mf=null;function Vf(){Mf=gi=pc=null}function Of(t){var e=mc.current;Ae(mc),t._currentValue=e}function _h(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ii(t,e){pc=t,Mf=gi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(kt=!0),t.firstContext=null)}function en(t){var e=t._currentValue;if(Mf!==t)if(t={context:t,memoizedValue:e,next:null},gi===null){if(pc===null)throw Error(K(308));gi=t,pc.dependencies={lanes:0,firstContext:t}}else gi=gi.next=t;return e}var Is=null;function Ff(t){Is===null?Is=[t]:Is.push(t)}function Nw(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Ff(e)):(n.next=s.next,s.next=n),e.interleaved=n,tr(t,r)}function tr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var xr=!1;function Uf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function kw(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Qn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Lr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ge&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,tr(t,n)}return s=r.interleaved,s===null?(e.next=e,Ff(r)):(e.next=s.next,s.next=e),r.interleaved=e,tr(t,n)}function Ll(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,bf(t,n)}}function Gg(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function gc(t,e,n,r){var s=t.updateQueue;xr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var f=t.alternate;f!==null&&(f=f.updateQueue,c=f.lastBaseUpdate,c!==o&&(c===null?f.firstBaseUpdate=d:c.next=d,f.lastBaseUpdate=u))}if(i!==null){var m=s.baseState;o=0,f=d=u=null,c=i;do{var g=c.lane,T=c.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:T,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var C=t,P=c;switch(g=e,T=n,P.tag){case 1:if(C=P.payload,typeof C=="function"){m=C.call(T,m,g);break e}m=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=P.payload,g=typeof C=="function"?C.call(T,m,g):C,g==null)break e;m=Pe({},m,g);break e;case 2:xr=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[c]:g.push(c))}else T={eventTime:T,lane:g,tag:c.tag,payload:c.payload,callback:c.callback,next:null},f===null?(d=f=T,u=m):f=f.next=T,o|=g;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;g=c,c=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(f===null&&(u=m),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Ls|=o,t.lanes=o,t.memoizedState=m}}function Qg(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(K(191,s));s.call(r)}}}var Ma={},An=ns(Ma),ma=ns(Ma),pa=ns(Ma);function bs(t){if(t===Ma)throw Error(K(174));return t}function Bf(t,e){switch(Ee(pa,e),Ee(ma,t),Ee(An,Ma),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:eh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=eh(e,t)}Ae(An),Ee(An,e)}function Mi(){Ae(An),Ae(ma),Ae(pa)}function Cw(t){bs(pa.current);var e=bs(An.current),n=eh(e,t.type);e!==n&&(Ee(ma,t),Ee(An,n))}function $f(t){ma.current===t&&(Ae(An),Ae(ma))}var ke=ns(0);function yc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var wd=[];function zf(){for(var t=0;t<wd.length;t++)wd[t]._workInProgressVersionPrimary=null;wd.length=0}var Ml=lr.ReactCurrentDispatcher,_d=lr.ReactCurrentBatchConfig,Ds=0,Ce=null,Qe=null,et=null,vc=!1,Ko=!1,ga=0,iI=0;function ct(){throw Error(K(321))}function qf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!fn(t[n],e[n]))return!1;return!0}function Hf(t,e,n,r,s,i){if(Ds=i,Ce=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ml.current=t===null||t.memoizedState===null?cI:uI,t=n(r,s),Ko){i=0;do{if(Ko=!1,ga=0,25<=i)throw Error(K(301));i+=1,et=Qe=null,e.updateQueue=null,Ml.current=dI,t=n(r,s)}while(Ko)}if(Ml.current=wc,e=Qe!==null&&Qe.next!==null,Ds=0,et=Qe=Ce=null,vc=!1,e)throw Error(K(300));return t}function Wf(){var t=ga!==0;return ga=0,t}function _n(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return et===null?Ce.memoizedState=et=t:et=et.next=t,et}function tn(){if(Qe===null){var t=Ce.alternate;t=t!==null?t.memoizedState:null}else t=Qe.next;var e=et===null?Ce.memoizedState:et.next;if(e!==null)et=e,Qe=t;else{if(t===null)throw Error(K(310));Qe=t,t={memoizedState:Qe.memoizedState,baseState:Qe.baseState,baseQueue:Qe.baseQueue,queue:Qe.queue,next:null},et===null?Ce.memoizedState=et=t:et=et.next=t}return et}function ya(t,e){return typeof e=="function"?e(t):e}function xd(t){var e=tn(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var r=Qe,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var c=o=null,u=null,d=i;do{var f=d.lane;if((Ds&f)===f)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var m={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=m,o=r):u=u.next=m,Ce.lanes|=f,Ls|=f}d=d.next}while(d!==null&&d!==i);u===null?o=r:u.next=c,fn(r,e.memoizedState)||(kt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Ce.lanes|=i,Ls|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Ed(t){var e=tn(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);fn(i,e.memoizedState)||(kt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Pw(){}function Rw(t,e){var n=Ce,r=tn(),s=e(),i=!fn(r.memoizedState,s);if(i&&(r.memoizedState=s,kt=!0),r=r.queue,Kf(Lw.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||et!==null&&et.memoizedState.tag&1){if(n.flags|=2048,va(9,Dw.bind(null,n,r,s,e),void 0,null),tt===null)throw Error(K(349));Ds&30||jw(n,e,s)}return s}function jw(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ce.updateQueue,e===null?(e={lastEffect:null,stores:null},Ce.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Dw(t,e,n,r){e.value=n,e.getSnapshot=r,Mw(e)&&Vw(t)}function Lw(t,e,n){return n(function(){Mw(e)&&Vw(t)})}function Mw(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!fn(t,n)}catch{return!0}}function Vw(t){var e=tr(t,1);e!==null&&hn(e,t,1,-1)}function Yg(t){var e=_n();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:t},e.queue=t,t=t.dispatch=lI.bind(null,Ce,t),[e.memoizedState,t]}function va(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ce.updateQueue,e===null?(e={lastEffect:null,stores:null},Ce.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Ow(){return tn().memoizedState}function Vl(t,e,n,r){var s=_n();Ce.flags|=t,s.memoizedState=va(1|e,n,void 0,r===void 0?null:r)}function nu(t,e,n,r){var s=tn();r=r===void 0?null:r;var i=void 0;if(Qe!==null){var o=Qe.memoizedState;if(i=o.destroy,r!==null&&qf(r,o.deps)){s.memoizedState=va(e,n,i,r);return}}Ce.flags|=t,s.memoizedState=va(1|e,n,i,r)}function Xg(t,e){return Vl(8390656,8,t,e)}function Kf(t,e){return nu(2048,8,t,e)}function Fw(t,e){return nu(4,2,t,e)}function Uw(t,e){return nu(4,4,t,e)}function Bw(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function $w(t,e,n){return n=n!=null?n.concat([t]):null,nu(4,4,Bw.bind(null,e,t),n)}function Gf(){}function zw(t,e){var n=tn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&qf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function qw(t,e){var n=tn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&qf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Hw(t,e,n){return Ds&21?(fn(n,e)||(n=Yv(),Ce.lanes|=n,Ls|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,kt=!0),t.memoizedState=n)}function oI(t,e){var n=ve;ve=n!==0&&4>n?n:4,t(!0);var r=_d.transition;_d.transition={};try{t(!1),e()}finally{ve=n,_d.transition=r}}function Ww(){return tn().memoizedState}function aI(t,e,n){var r=Vr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Kw(t))Gw(e,n);else if(n=Nw(t,e,n,r),n!==null){var s=Et();hn(n,t,r,s),Qw(n,e,r)}}function lI(t,e,n){var r=Vr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Kw(t))Gw(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,c=i(o,n);if(s.hasEagerState=!0,s.eagerState=c,fn(c,o)){var u=e.interleaved;u===null?(s.next=s,Ff(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=Nw(t,e,s,r),n!==null&&(s=Et(),hn(n,t,r,s),Qw(n,e,r))}}function Kw(t){var e=t.alternate;return t===Ce||e!==null&&e===Ce}function Gw(t,e){Ko=vc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Qw(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,bf(t,n)}}var wc={readContext:en,useCallback:ct,useContext:ct,useEffect:ct,useImperativeHandle:ct,useInsertionEffect:ct,useLayoutEffect:ct,useMemo:ct,useReducer:ct,useRef:ct,useState:ct,useDebugValue:ct,useDeferredValue:ct,useTransition:ct,useMutableSource:ct,useSyncExternalStore:ct,useId:ct,unstable_isNewReconciler:!1},cI={readContext:en,useCallback:function(t,e){return _n().memoizedState=[t,e===void 0?null:e],t},useContext:en,useEffect:Xg,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Vl(4194308,4,Bw.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Vl(4194308,4,t,e)},useInsertionEffect:function(t,e){return Vl(4,2,t,e)},useMemo:function(t,e){var n=_n();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=_n();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=aI.bind(null,Ce,t),[r.memoizedState,t]},useRef:function(t){var e=_n();return t={current:t},e.memoizedState=t},useState:Yg,useDebugValue:Gf,useDeferredValue:function(t){return _n().memoizedState=t},useTransition:function(){var t=Yg(!1),e=t[0];return t=oI.bind(null,t[1]),_n().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ce,s=_n();if(Ne){if(n===void 0)throw Error(K(407));n=n()}else{if(n=e(),tt===null)throw Error(K(349));Ds&30||jw(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Xg(Lw.bind(null,r,i,t),[t]),r.flags|=2048,va(9,Dw.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=_n(),e=tt.identifierPrefix;if(Ne){var n=qn,r=zn;n=(r&~(1<<32-dn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ga++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=iI++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},uI={readContext:en,useCallback:zw,useContext:en,useEffect:Kf,useImperativeHandle:$w,useInsertionEffect:Fw,useLayoutEffect:Uw,useMemo:qw,useReducer:xd,useRef:Ow,useState:function(){return xd(ya)},useDebugValue:Gf,useDeferredValue:function(t){var e=tn();return Hw(e,Qe.memoizedState,t)},useTransition:function(){var t=xd(ya)[0],e=tn().memoizedState;return[t,e]},useMutableSource:Pw,useSyncExternalStore:Rw,useId:Ww,unstable_isNewReconciler:!1},dI={readContext:en,useCallback:zw,useContext:en,useEffect:Kf,useImperativeHandle:$w,useInsertionEffect:Fw,useLayoutEffect:Uw,useMemo:qw,useReducer:Ed,useRef:Ow,useState:function(){return Ed(ya)},useDebugValue:Gf,useDeferredValue:function(t){var e=tn();return Qe===null?e.memoizedState=t:Hw(e,Qe.memoizedState,t)},useTransition:function(){var t=Ed(ya)[0],e=tn().memoizedState;return[t,e]},useMutableSource:Pw,useSyncExternalStore:Rw,useId:Ww,unstable_isNewReconciler:!1};function an(t,e){if(t&&t.defaultProps){e=Pe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function xh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Pe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ru={isMounted:function(t){return(t=t._reactInternals)?Ws(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Et(),s=Vr(t),i=Qn(r,s);i.payload=e,n!=null&&(i.callback=n),e=Lr(t,i,s),e!==null&&(hn(e,t,s,r),Ll(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Et(),s=Vr(t),i=Qn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Lr(t,i,s),e!==null&&(hn(e,t,s,r),Ll(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Et(),r=Vr(t),s=Qn(n,r);s.tag=2,e!=null&&(s.callback=e),e=Lr(t,s,r),e!==null&&(hn(e,t,r,n),Ll(e,t,r))}};function Jg(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!ua(n,r)||!ua(s,i):!0}function Yw(t,e,n){var r=!1,s=zr,i=e.contextType;return typeof i=="object"&&i!==null?i=en(i):(s=Pt(e)?Rs:yt.current,r=e.contextTypes,i=(r=r!=null)?ji(t,s):zr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ru,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Zg(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ru.enqueueReplaceState(e,e.state,null)}function Eh(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Uf(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=en(i):(i=Pt(e)?Rs:yt.current,s.context=ji(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(xh(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&ru.enqueueReplaceState(s,s.state,null),gc(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Vi(t,e){try{var n="",r=e;do n+=F2(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Td(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Th(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var hI=typeof WeakMap=="function"?WeakMap:Map;function Xw(t,e,n){n=Qn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){xc||(xc=!0,jh=r),Th(t,e)},n}function Jw(t,e,n){n=Qn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Th(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Th(t,e),typeof r!="function"&&(Mr===null?Mr=new Set([this]):Mr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function ey(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new hI;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=SI.bind(null,t,e,n),e.then(t,t))}function ty(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ny(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Qn(-1,1),e.tag=2,Lr(n,e,1))),n.lanes|=1),t)}var fI=lr.ReactCurrentOwner,kt=!1;function xt(t,e,n,r){e.child=t===null?Aw(e,null,n,r):Li(e,t.child,n,r)}function ry(t,e,n,r,s){n=n.render;var i=e.ref;return Ii(e,s),r=Hf(t,e,n,r,i,s),n=Wf(),t!==null&&!kt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,nr(t,e,s)):(Ne&&n&&jf(e),e.flags|=1,xt(t,e,r,s),e.child)}function sy(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!nm(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Zw(t,e,i,r,s)):(t=Bl(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:ua,n(o,r)&&t.ref===e.ref)return nr(t,e,s)}return e.flags|=1,t=Or(i,r),t.ref=e.ref,t.return=e,e.child=t}function Zw(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(ua(i,r)&&t.ref===e.ref)if(kt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(kt=!0);else return e.lanes=t.lanes,nr(t,e,s)}return Ih(t,e,n,r,s)}function e_(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ee(vi,Ot),Ot|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ee(vi,Ot),Ot|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ee(vi,Ot),Ot|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ee(vi,Ot),Ot|=r;return xt(t,e,s,n),e.child}function t_(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ih(t,e,n,r,s){var i=Pt(n)?Rs:yt.current;return i=ji(e,i),Ii(e,s),n=Hf(t,e,n,r,i,s),r=Wf(),t!==null&&!kt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,nr(t,e,s)):(Ne&&r&&jf(e),e.flags|=1,xt(t,e,n,s),e.child)}function iy(t,e,n,r,s){if(Pt(n)){var i=!0;dc(e)}else i=!1;if(Ii(e,s),e.stateNode===null)Ol(t,e),Yw(e,n,r),Eh(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,c=e.memoizedProps;o.props=c;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=en(d):(d=Pt(n)?Rs:yt.current,d=ji(e,d));var f=n.getDerivedStateFromProps,m=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==r||u!==d)&&Zg(e,o,r,d),xr=!1;var g=e.memoizedState;o.state=g,gc(e,r,o,s),u=e.memoizedState,c!==r||g!==u||Ct.current||xr?(typeof f=="function"&&(xh(e,n,f,r),u=e.memoizedState),(c=xr||Jg(e,n,c,r,g,u,d))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=d,r=c):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,kw(t,e),c=e.memoizedProps,d=e.type===e.elementType?c:an(e.type,c),o.props=d,m=e.pendingProps,g=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=en(u):(u=Pt(n)?Rs:yt.current,u=ji(e,u));var T=n.getDerivedStateFromProps;(f=typeof T=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==m||g!==u)&&Zg(e,o,r,u),xr=!1,g=e.memoizedState,o.state=g,gc(e,r,o,s);var C=e.memoizedState;c!==m||g!==C||Ct.current||xr?(typeof T=="function"&&(xh(e,n,T,r),C=e.memoizedState),(d=xr||Jg(e,n,d,r,g,C,u)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,C,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,C,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=C),o.props=r,o.state=C,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return bh(t,e,n,r,i,s)}function bh(t,e,n,r,s,i){t_(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&qg(e,n,!1),nr(t,e,i);r=e.stateNode,fI.current=e;var c=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Li(e,t.child,null,i),e.child=Li(e,null,c,i)):xt(t,e,c,i),e.memoizedState=r.state,s&&qg(e,n,!0),e.child}function n_(t){var e=t.stateNode;e.pendingContext?zg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&zg(t,e.context,!1),Bf(t,e.containerInfo)}function oy(t,e,n,r,s){return Di(),Lf(s),e.flags|=256,xt(t,e,n,r),e.child}var Sh={dehydrated:null,treeContext:null,retryLane:0};function Ah(t){return{baseLanes:t,cachePool:null,transitions:null}}function r_(t,e,n){var r=e.pendingProps,s=ke.current,i=!1,o=(e.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(s&2)!==0),c?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ee(ke,s&1),t===null)return wh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=ou(o,r,0,null),t=ks(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Ah(n),e.memoizedState=Sh,t):Qf(e,o));if(s=t.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return mI(t,e,o,r,c,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,c=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Or(s,u),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=Or(c,i):(i=ks(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Ah(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Sh,r}return i=t.child,t=i.sibling,r=Or(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Qf(t,e){return e=ou({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function vl(t,e,n,r){return r!==null&&Lf(r),Li(e,t.child,null,n),t=Qf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function mI(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Td(Error(K(422))),vl(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=ou({mode:"visible",children:r.children},s,0,null),i=ks(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Li(e,t.child,null,o),e.child.memoizedState=Ah(o),e.memoizedState=Sh,i);if(!(e.mode&1))return vl(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error(K(419)),r=Td(i,r,void 0),vl(t,e,o,r)}if(c=(o&t.childLanes)!==0,kt||c){if(r=tt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,tr(t,s),hn(r,t,s,-1))}return tm(),r=Td(Error(K(421))),vl(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=AI.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Ft=Dr(s.nextSibling),Bt=e,Ne=!0,cn=null,t!==null&&(Wt[Kt++]=zn,Wt[Kt++]=qn,Wt[Kt++]=js,zn=t.id,qn=t.overflow,js=e),e=Qf(e,r.children),e.flags|=4096,e)}function ay(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),_h(t.return,e,n)}function Id(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function s_(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(xt(t,e,r.children,n),r=ke.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ay(t,n,e);else if(t.tag===19)ay(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ee(ke,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&yc(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Id(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&yc(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Id(e,!0,n,null,i);break;case"together":Id(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ol(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function nr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ls|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(K(153));if(e.child!==null){for(t=e.child,n=Or(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Or(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function pI(t,e,n){switch(e.tag){case 3:n_(e),Di();break;case 5:Cw(e);break;case 1:Pt(e.type)&&dc(e);break;case 4:Bf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ee(mc,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ee(ke,ke.current&1),e.flags|=128,null):n&e.child.childLanes?r_(t,e,n):(Ee(ke,ke.current&1),t=nr(t,e,n),t!==null?t.sibling:null);Ee(ke,ke.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return s_(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ee(ke,ke.current),r)break;return null;case 22:case 23:return e.lanes=0,e_(t,e,n)}return nr(t,e,n)}var i_,Nh,o_,a_;i_=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Nh=function(){};o_=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,bs(An.current);var i=null;switch(n){case"input":s=Yd(t,s),r=Yd(t,r),i=[];break;case"select":s=Pe({},s,{value:void 0}),r=Pe({},r,{value:void 0}),i=[];break;case"textarea":s=Zd(t,s),r=Zd(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=cc)}th(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var c=s[d];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ra.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(c=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(o in c)!c.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&c[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ra.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&be("scroll",t),i||c===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};a_=function(t,e,n,r){n!==r&&(e.flags|=4)};function Co(t,e){if(!Ne)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ut(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function gI(t,e,n){var r=e.pendingProps;switch(Df(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ut(e),null;case 1:return Pt(e.type)&&uc(),ut(e),null;case 3:return r=e.stateNode,Mi(),Ae(Ct),Ae(yt),zf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(gl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,cn!==null&&(Mh(cn),cn=null))),Nh(t,e),ut(e),null;case 5:$f(e);var s=bs(pa.current);if(n=e.type,t!==null&&e.stateNode!=null)o_(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(K(166));return ut(e),null}if(t=bs(An.current),gl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[En]=e,r[fa]=i,t=(e.mode&1)!==0,n){case"dialog":be("cancel",r),be("close",r);break;case"iframe":case"object":case"embed":be("load",r);break;case"video":case"audio":for(s=0;s<Lo.length;s++)be(Lo[s],r);break;case"source":be("error",r);break;case"img":case"image":case"link":be("error",r),be("load",r);break;case"details":be("toggle",r);break;case"input":gg(r,i),be("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},be("invalid",r);break;case"textarea":vg(r,i),be("invalid",r)}th(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var c=i[o];o==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&pl(r.textContent,c,t),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&pl(r.textContent,c,t),s=["children",""+c]):ra.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&be("scroll",r)}switch(n){case"input":al(r),yg(r,i,!0);break;case"textarea":al(r),wg(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=cc)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Lv(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[En]=e,t[fa]=r,i_(t,e,!1,!1),e.stateNode=t;e:{switch(o=nh(n,r),n){case"dialog":be("cancel",t),be("close",t),s=r;break;case"iframe":case"object":case"embed":be("load",t),s=r;break;case"video":case"audio":for(s=0;s<Lo.length;s++)be(Lo[s],t);s=r;break;case"source":be("error",t),s=r;break;case"img":case"image":case"link":be("error",t),be("load",t),s=r;break;case"details":be("toggle",t),s=r;break;case"input":gg(t,r),s=Yd(t,r),be("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Pe({},r,{value:void 0}),be("invalid",t);break;case"textarea":vg(t,r),s=Zd(t,r),be("invalid",t);break;default:s=r}th(n,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?Ov(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Mv(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&sa(t,u):typeof u=="number"&&sa(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ra.hasOwnProperty(i)?u!=null&&i==="onScroll"&&be("scroll",t):u!=null&&wf(t,i,u,o))}switch(n){case"input":al(t),yg(t,r,!1);break;case"textarea":al(t),wg(t);break;case"option":r.value!=null&&t.setAttribute("value",""+$r(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?_i(t,!!r.multiple,i,!1):r.defaultValue!=null&&_i(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=cc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ut(e),null;case 6:if(t&&e.stateNode!=null)a_(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(K(166));if(n=bs(pa.current),bs(An.current),gl(e)){if(r=e.stateNode,n=e.memoizedProps,r[En]=e,(i=r.nodeValue!==n)&&(t=Bt,t!==null))switch(t.tag){case 3:pl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&pl(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[En]=e,e.stateNode=r}return ut(e),null;case 13:if(Ae(ke),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ne&&Ft!==null&&e.mode&1&&!(e.flags&128))bw(),Di(),e.flags|=98560,i=!1;else if(i=gl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(K(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(K(317));i[En]=e}else Di(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ut(e),i=!1}else cn!==null&&(Mh(cn),cn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ke.current&1?Ye===0&&(Ye=3):tm())),e.updateQueue!==null&&(e.flags|=4),ut(e),null);case 4:return Mi(),Nh(t,e),t===null&&da(e.stateNode.containerInfo),ut(e),null;case 10:return Of(e.type._context),ut(e),null;case 17:return Pt(e.type)&&uc(),ut(e),null;case 19:if(Ae(ke),i=e.memoizedState,i===null)return ut(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Co(i,!1);else{if(Ye!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=yc(t),o!==null){for(e.flags|=128,Co(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ee(ke,ke.current&1|2),e.child}t=t.sibling}i.tail!==null&&Fe()>Oi&&(e.flags|=128,r=!0,Co(i,!1),e.lanes=4194304)}else{if(!r)if(t=yc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Co(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ne)return ut(e),null}else 2*Fe()-i.renderingStartTime>Oi&&n!==1073741824&&(e.flags|=128,r=!0,Co(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Fe(),e.sibling=null,n=ke.current,Ee(ke,r?n&1|2:n&1),e):(ut(e),null);case 22:case 23:return em(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ot&1073741824&&(ut(e),e.subtreeFlags&6&&(e.flags|=8192)):ut(e),null;case 24:return null;case 25:return null}throw Error(K(156,e.tag))}function yI(t,e){switch(Df(e),e.tag){case 1:return Pt(e.type)&&uc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Mi(),Ae(Ct),Ae(yt),zf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return $f(e),null;case 13:if(Ae(ke),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(K(340));Di()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ae(ke),null;case 4:return Mi(),null;case 10:return Of(e.type._context),null;case 22:case 23:return em(),null;case 24:return null;default:return null}}var wl=!1,mt=!1,vI=typeof WeakSet=="function"?WeakSet:Set,Z=null;function yi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){De(t,e,r)}else n.current=null}function kh(t,e,n){try{n()}catch(r){De(t,e,r)}}var ly=!1;function wI(t,e){if(hh=oc,t=hw(),Rf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,c=-1,u=-1,d=0,f=0,m=t,g=null;t:for(;;){for(var T;m!==n||s!==0&&m.nodeType!==3||(c=o+s),m!==i||r!==0&&m.nodeType!==3||(u=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(T=m.firstChild)!==null;)g=m,m=T;for(;;){if(m===t)break t;if(g===n&&++d===s&&(c=o),g===i&&++f===r&&(u=o),(T=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=T}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(fh={focusedElem:t,selectionRange:n},oc=!1,Z=e;Z!==null;)if(e=Z,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Z=t;else for(;Z!==null;){e=Z;try{var C=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var P=C.memoizedProps,S=C.memoizedState,I=e.stateNode,E=I.getSnapshotBeforeUpdate(e.elementType===e.type?P:an(e.type,P),S);I.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var A=e.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(K(163))}}catch(D){De(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,Z=t;break}Z=e.return}return C=ly,ly=!1,C}function Go(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&kh(e,n,i)}s=s.next}while(s!==r)}}function su(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Ch(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function l_(t){var e=t.alternate;e!==null&&(t.alternate=null,l_(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[En],delete e[fa],delete e[gh],delete e[tI],delete e[nI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function c_(t){return t.tag===5||t.tag===3||t.tag===4}function cy(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||c_(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ph(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=cc));else if(r!==4&&(t=t.child,t!==null))for(Ph(t,e,n),t=t.sibling;t!==null;)Ph(t,e,n),t=t.sibling}function Rh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Rh(t,e,n),t=t.sibling;t!==null;)Rh(t,e,n),t=t.sibling}var nt=null,ln=!1;function vr(t,e,n){for(n=n.child;n!==null;)u_(t,e,n),n=n.sibling}function u_(t,e,n){if(Sn&&typeof Sn.onCommitFiberUnmount=="function")try{Sn.onCommitFiberUnmount(Yc,n)}catch{}switch(n.tag){case 5:mt||yi(n,e);case 6:var r=nt,s=ln;nt=null,vr(t,e,n),nt=r,ln=s,nt!==null&&(ln?(t=nt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):nt.removeChild(n.stateNode));break;case 18:nt!==null&&(ln?(t=nt,n=n.stateNode,t.nodeType===8?yd(t.parentNode,n):t.nodeType===1&&yd(t,n),la(t)):yd(nt,n.stateNode));break;case 4:r=nt,s=ln,nt=n.stateNode.containerInfo,ln=!0,vr(t,e,n),nt=r,ln=s;break;case 0:case 11:case 14:case 15:if(!mt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&kh(n,e,o),s=s.next}while(s!==r)}vr(t,e,n);break;case 1:if(!mt&&(yi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){De(n,e,c)}vr(t,e,n);break;case 21:vr(t,e,n);break;case 22:n.mode&1?(mt=(r=mt)||n.memoizedState!==null,vr(t,e,n),mt=r):vr(t,e,n);break;default:vr(t,e,n)}}function uy(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new vI),e.forEach(function(r){var s=NI.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function on(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,c=o;e:for(;c!==null;){switch(c.tag){case 5:nt=c.stateNode,ln=!1;break e;case 3:nt=c.stateNode.containerInfo,ln=!0;break e;case 4:nt=c.stateNode.containerInfo,ln=!0;break e}c=c.return}if(nt===null)throw Error(K(160));u_(i,o,s),nt=null,ln=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){De(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)d_(e,t),e=e.sibling}function d_(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(on(e,t),wn(t),r&4){try{Go(3,t,t.return),su(3,t)}catch(P){De(t,t.return,P)}try{Go(5,t,t.return)}catch(P){De(t,t.return,P)}}break;case 1:on(e,t),wn(t),r&512&&n!==null&&yi(n,n.return);break;case 5:if(on(e,t),wn(t),r&512&&n!==null&&yi(n,n.return),t.flags&32){var s=t.stateNode;try{sa(s,"")}catch(P){De(t,t.return,P)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&jv(s,i),nh(c,o);var d=nh(c,i);for(o=0;o<u.length;o+=2){var f=u[o],m=u[o+1];f==="style"?Ov(s,m):f==="dangerouslySetInnerHTML"?Mv(s,m):f==="children"?sa(s,m):wf(s,f,m,d)}switch(c){case"input":Xd(s,i);break;case"textarea":Dv(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var T=i.value;T!=null?_i(s,!!i.multiple,T,!1):g!==!!i.multiple&&(i.defaultValue!=null?_i(s,!!i.multiple,i.defaultValue,!0):_i(s,!!i.multiple,i.multiple?[]:"",!1))}s[fa]=i}catch(P){De(t,t.return,P)}}break;case 6:if(on(e,t),wn(t),r&4){if(t.stateNode===null)throw Error(K(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(P){De(t,t.return,P)}}break;case 3:if(on(e,t),wn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{la(e.containerInfo)}catch(P){De(t,t.return,P)}break;case 4:on(e,t),wn(t);break;case 13:on(e,t),wn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Jf=Fe())),r&4&&uy(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(mt=(d=mt)||f,on(e,t),mt=d):on(e,t),wn(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!f&&t.mode&1)for(Z=t,f=t.child;f!==null;){for(m=Z=f;Z!==null;){switch(g=Z,T=g.child,g.tag){case 0:case 11:case 14:case 15:Go(4,g,g.return);break;case 1:yi(g,g.return);var C=g.stateNode;if(typeof C.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,C.props=e.memoizedProps,C.state=e.memoizedState,C.componentWillUnmount()}catch(P){De(r,n,P)}}break;case 5:yi(g,g.return);break;case 22:if(g.memoizedState!==null){hy(m);continue}}T!==null?(T.return=g,Z=T):hy(m)}f=f.sibling}e:for(f=null,m=t;;){if(m.tag===5){if(f===null){f=m;try{s=m.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=m.stateNode,u=m.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=Vv("display",o))}catch(P){De(t,t.return,P)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(P){De(t,t.return,P)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:on(e,t),wn(t),r&4&&uy(t);break;case 21:break;default:on(e,t),wn(t)}}function wn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(c_(n)){var r=n;break e}n=n.return}throw Error(K(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(sa(s,""),r.flags&=-33);var i=cy(t);Rh(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,c=cy(t);Ph(t,c,o);break;default:throw Error(K(161))}}catch(u){De(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function _I(t,e,n){Z=t,h_(t)}function h_(t,e,n){for(var r=(t.mode&1)!==0;Z!==null;){var s=Z,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||wl;if(!o){var c=s.alternate,u=c!==null&&c.memoizedState!==null||mt;c=wl;var d=mt;if(wl=o,(mt=u)&&!d)for(Z=s;Z!==null;)o=Z,u=o.child,o.tag===22&&o.memoizedState!==null?fy(s):u!==null?(u.return=o,Z=u):fy(s);for(;i!==null;)Z=i,h_(i),i=i.sibling;Z=s,wl=c,mt=d}dy(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Z=i):dy(t)}}function dy(t){for(;Z!==null;){var e=Z;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:mt||su(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!mt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:an(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Qg(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Qg(e,o,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&la(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(K(163))}mt||e.flags&512&&Ch(e)}catch(g){De(e,e.return,g)}}if(e===t){Z=null;break}if(n=e.sibling,n!==null){n.return=e.return,Z=n;break}Z=e.return}}function hy(t){for(;Z!==null;){var e=Z;if(e===t){Z=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Z=n;break}Z=e.return}}function fy(t){for(;Z!==null;){var e=Z;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{su(4,e)}catch(u){De(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){De(e,s,u)}}var i=e.return;try{Ch(e)}catch(u){De(e,i,u)}break;case 5:var o=e.return;try{Ch(e)}catch(u){De(e,o,u)}}}catch(u){De(e,e.return,u)}if(e===t){Z=null;break}var c=e.sibling;if(c!==null){c.return=e.return,Z=c;break}Z=e.return}}var xI=Math.ceil,_c=lr.ReactCurrentDispatcher,Yf=lr.ReactCurrentOwner,Xt=lr.ReactCurrentBatchConfig,ge=0,tt=null,$e=null,it=0,Ot=0,vi=ns(0),Ye=0,wa=null,Ls=0,iu=0,Xf=0,Qo=null,At=null,Jf=0,Oi=1/0,Un=null,xc=!1,jh=null,Mr=null,_l=!1,kr=null,Ec=0,Yo=0,Dh=null,Fl=-1,Ul=0;function Et(){return ge&6?Fe():Fl!==-1?Fl:Fl=Fe()}function Vr(t){return t.mode&1?ge&2&&it!==0?it&-it:sI.transition!==null?(Ul===0&&(Ul=Yv()),Ul):(t=ve,t!==0||(t=window.event,t=t===void 0?16:rw(t.type)),t):1}function hn(t,e,n,r){if(50<Yo)throw Yo=0,Dh=null,Error(K(185));ja(t,n,r),(!(ge&2)||t!==tt)&&(t===tt&&(!(ge&2)&&(iu|=n),Ye===4&&Tr(t,it)),Rt(t,r),n===1&&ge===0&&!(e.mode&1)&&(Oi=Fe()+500,tu&&rs()))}function Rt(t,e){var n=t.callbackNode;sT(t,e);var r=ic(t,t===tt?it:0);if(r===0)n!==null&&Eg(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Eg(n),e===1)t.tag===0?rI(my.bind(null,t)):Ew(my.bind(null,t)),ZT(function(){!(ge&6)&&rs()}),n=null;else{switch(Xv(r)){case 1:n=If;break;case 4:n=Gv;break;case 16:n=sc;break;case 536870912:n=Qv;break;default:n=sc}n=__(n,f_.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function f_(t,e){if(Fl=-1,Ul=0,ge&6)throw Error(K(327));var n=t.callbackNode;if(bi()&&t.callbackNode!==n)return null;var r=ic(t,t===tt?it:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Tc(t,r);else{e=r;var s=ge;ge|=2;var i=p_();(tt!==t||it!==e)&&(Un=null,Oi=Fe()+500,Ns(t,e));do try{II();break}catch(c){m_(t,c)}while(!0);Vf(),_c.current=i,ge=s,$e!==null?e=0:(tt=null,it=0,e=Ye)}if(e!==0){if(e===2&&(s=ah(t),s!==0&&(r=s,e=Lh(t,s))),e===1)throw n=wa,Ns(t,0),Tr(t,r),Rt(t,Fe()),n;if(e===6)Tr(t,r);else{if(s=t.current.alternate,!(r&30)&&!EI(s)&&(e=Tc(t,r),e===2&&(i=ah(t),i!==0&&(r=i,e=Lh(t,i))),e===1))throw n=wa,Ns(t,0),Tr(t,r),Rt(t,Fe()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(K(345));case 2:xs(t,At,Un);break;case 3:if(Tr(t,r),(r&130023424)===r&&(e=Jf+500-Fe(),10<e)){if(ic(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Et(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=ph(xs.bind(null,t,At,Un),e);break}xs(t,At,Un);break;case 4:if(Tr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-dn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Fe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*xI(r/1960))-r,10<r){t.timeoutHandle=ph(xs.bind(null,t,At,Un),r);break}xs(t,At,Un);break;case 5:xs(t,At,Un);break;default:throw Error(K(329))}}}return Rt(t,Fe()),t.callbackNode===n?f_.bind(null,t):null}function Lh(t,e){var n=Qo;return t.current.memoizedState.isDehydrated&&(Ns(t,e).flags|=256),t=Tc(t,e),t!==2&&(e=At,At=n,e!==null&&Mh(e)),t}function Mh(t){At===null?At=t:At.push.apply(At,t)}function EI(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!fn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Tr(t,e){for(e&=~Xf,e&=~iu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-dn(e),r=1<<n;t[n]=-1,e&=~r}}function my(t){if(ge&6)throw Error(K(327));bi();var e=ic(t,0);if(!(e&1))return Rt(t,Fe()),null;var n=Tc(t,e);if(t.tag!==0&&n===2){var r=ah(t);r!==0&&(e=r,n=Lh(t,r))}if(n===1)throw n=wa,Ns(t,0),Tr(t,e),Rt(t,Fe()),n;if(n===6)throw Error(K(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,xs(t,At,Un),Rt(t,Fe()),null}function Zf(t,e){var n=ge;ge|=1;try{return t(e)}finally{ge=n,ge===0&&(Oi=Fe()+500,tu&&rs())}}function Ms(t){kr!==null&&kr.tag===0&&!(ge&6)&&bi();var e=ge;ge|=1;var n=Xt.transition,r=ve;try{if(Xt.transition=null,ve=1,t)return t()}finally{ve=r,Xt.transition=n,ge=e,!(ge&6)&&rs()}}function em(){Ot=vi.current,Ae(vi)}function Ns(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,JT(n)),$e!==null)for(n=$e.return;n!==null;){var r=n;switch(Df(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&uc();break;case 3:Mi(),Ae(Ct),Ae(yt),zf();break;case 5:$f(r);break;case 4:Mi();break;case 13:Ae(ke);break;case 19:Ae(ke);break;case 10:Of(r.type._context);break;case 22:case 23:em()}n=n.return}if(tt=t,$e=t=Or(t.current,null),it=Ot=e,Ye=0,wa=null,Xf=iu=Ls=0,At=Qo=null,Is!==null){for(e=0;e<Is.length;e++)if(n=Is[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Is=null}return t}function m_(t,e){do{var n=$e;try{if(Vf(),Ml.current=wc,vc){for(var r=Ce.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}vc=!1}if(Ds=0,et=Qe=Ce=null,Ko=!1,ga=0,Yf.current=null,n===null||n.return===null){Ye=1,wa=e,$e=null;break}e:{var i=t,o=n.return,c=n,u=e;if(e=it,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,f=c,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var T=ty(o);if(T!==null){T.flags&=-257,ny(T,o,c,i,e),T.mode&1&&ey(i,d,e),e=T,u=d;var C=e.updateQueue;if(C===null){var P=new Set;P.add(u),e.updateQueue=P}else C.add(u);break e}else{if(!(e&1)){ey(i,d,e),tm();break e}u=Error(K(426))}}else if(Ne&&c.mode&1){var S=ty(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),ny(S,o,c,i,e),Lf(Vi(u,c));break e}}i=u=Vi(u,c),Ye!==4&&(Ye=2),Qo===null?Qo=[i]:Qo.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var I=Xw(i,u,e);Gg(i,I);break e;case 1:c=u;var E=i.type,A=i.stateNode;if(!(i.flags&128)&&(typeof E.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Mr===null||!Mr.has(A)))){i.flags|=65536,e&=-e,i.lanes|=e;var D=Jw(i,c,e);Gg(i,D);break e}}i=i.return}while(i!==null)}y_(n)}catch(V){e=V,$e===n&&n!==null&&($e=n=n.return);continue}break}while(!0)}function p_(){var t=_c.current;return _c.current=wc,t===null?wc:t}function tm(){(Ye===0||Ye===3||Ye===2)&&(Ye=4),tt===null||!(Ls&268435455)&&!(iu&268435455)||Tr(tt,it)}function Tc(t,e){var n=ge;ge|=2;var r=p_();(tt!==t||it!==e)&&(Un=null,Ns(t,e));do try{TI();break}catch(s){m_(t,s)}while(!0);if(Vf(),ge=n,_c.current=r,$e!==null)throw Error(K(261));return tt=null,it=0,Ye}function TI(){for(;$e!==null;)g_($e)}function II(){for(;$e!==null&&!Q2();)g_($e)}function g_(t){var e=w_(t.alternate,t,Ot);t.memoizedProps=t.pendingProps,e===null?y_(t):$e=e,Yf.current=null}function y_(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=yI(n,e),n!==null){n.flags&=32767,$e=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ye=6,$e=null;return}}else if(n=gI(n,e,Ot),n!==null){$e=n;return}if(e=e.sibling,e!==null){$e=e;return}$e=e=t}while(e!==null);Ye===0&&(Ye=5)}function xs(t,e,n){var r=ve,s=Xt.transition;try{Xt.transition=null,ve=1,bI(t,e,n,r)}finally{Xt.transition=s,ve=r}return null}function bI(t,e,n,r){do bi();while(kr!==null);if(ge&6)throw Error(K(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(K(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(iT(t,i),t===tt&&($e=tt=null,it=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||_l||(_l=!0,__(sc,function(){return bi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Xt.transition,Xt.transition=null;var o=ve;ve=1;var c=ge;ge|=4,Yf.current=null,wI(t,n),d_(n,t),HT(fh),oc=!!hh,fh=hh=null,t.current=n,_I(n),Y2(),ge=c,ve=o,Xt.transition=i}else t.current=n;if(_l&&(_l=!1,kr=t,Ec=s),i=t.pendingLanes,i===0&&(Mr=null),Z2(n.stateNode),Rt(t,Fe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(xc)throw xc=!1,t=jh,jh=null,t;return Ec&1&&t.tag!==0&&bi(),i=t.pendingLanes,i&1?t===Dh?Yo++:(Yo=0,Dh=t):Yo=0,rs(),null}function bi(){if(kr!==null){var t=Xv(Ec),e=Xt.transition,n=ve;try{if(Xt.transition=null,ve=16>t?16:t,kr===null)var r=!1;else{if(t=kr,kr=null,Ec=0,ge&6)throw Error(K(331));var s=ge;for(ge|=4,Z=t.current;Z!==null;){var i=Z,o=i.child;if(Z.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(Z=d;Z!==null;){var f=Z;switch(f.tag){case 0:case 11:case 15:Go(8,f,i)}var m=f.child;if(m!==null)m.return=f,Z=m;else for(;Z!==null;){f=Z;var g=f.sibling,T=f.return;if(l_(f),f===d){Z=null;break}if(g!==null){g.return=T,Z=g;break}Z=T}}}var C=i.alternate;if(C!==null){var P=C.child;if(P!==null){C.child=null;do{var S=P.sibling;P.sibling=null,P=S}while(P!==null)}}Z=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Z=o;else e:for(;Z!==null;){if(i=Z,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Go(9,i,i.return)}var I=i.sibling;if(I!==null){I.return=i.return,Z=I;break e}Z=i.return}}var E=t.current;for(Z=E;Z!==null;){o=Z;var A=o.child;if(o.subtreeFlags&2064&&A!==null)A.return=o,Z=A;else e:for(o=E;Z!==null;){if(c=Z,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:su(9,c)}}catch(V){De(c,c.return,V)}if(c===o){Z=null;break e}var D=c.sibling;if(D!==null){D.return=c.return,Z=D;break e}Z=c.return}}if(ge=s,rs(),Sn&&typeof Sn.onPostCommitFiberRoot=="function")try{Sn.onPostCommitFiberRoot(Yc,t)}catch{}r=!0}return r}finally{ve=n,Xt.transition=e}}return!1}function py(t,e,n){e=Vi(n,e),e=Xw(t,e,1),t=Lr(t,e,1),e=Et(),t!==null&&(ja(t,1,e),Rt(t,e))}function De(t,e,n){if(t.tag===3)py(t,t,n);else for(;e!==null;){if(e.tag===3){py(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Mr===null||!Mr.has(r))){t=Vi(n,t),t=Jw(e,t,1),e=Lr(e,t,1),t=Et(),e!==null&&(ja(e,1,t),Rt(e,t));break}}e=e.return}}function SI(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Et(),t.pingedLanes|=t.suspendedLanes&n,tt===t&&(it&n)===n&&(Ye===4||Ye===3&&(it&130023424)===it&&500>Fe()-Jf?Ns(t,0):Xf|=n),Rt(t,e)}function v_(t,e){e===0&&(t.mode&1?(e=ul,ul<<=1,!(ul&130023424)&&(ul=4194304)):e=1);var n=Et();t=tr(t,e),t!==null&&(ja(t,e,n),Rt(t,n))}function AI(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),v_(t,n)}function NI(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(K(314))}r!==null&&r.delete(e),v_(t,n)}var w_;w_=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ct.current)kt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return kt=!1,pI(t,e,n);kt=!!(t.flags&131072)}else kt=!1,Ne&&e.flags&1048576&&Tw(e,fc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ol(t,e),t=e.pendingProps;var s=ji(e,yt.current);Ii(e,n),s=Hf(null,e,r,t,s,n);var i=Wf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Pt(r)?(i=!0,dc(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Uf(e),s.updater=ru,e.stateNode=s,s._reactInternals=e,Eh(e,r,t,n),e=bh(null,e,r,!0,i,n)):(e.tag=0,Ne&&i&&jf(e),xt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ol(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=CI(r),t=an(r,t),s){case 0:e=Ih(null,e,r,t,n);break e;case 1:e=iy(null,e,r,t,n);break e;case 11:e=ry(null,e,r,t,n);break e;case 14:e=sy(null,e,r,an(r.type,t),n);break e}throw Error(K(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:an(r,s),Ih(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:an(r,s),iy(t,e,r,s,n);case 3:e:{if(n_(e),t===null)throw Error(K(387));r=e.pendingProps,i=e.memoizedState,s=i.element,kw(t,e),gc(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Vi(Error(K(423)),e),e=oy(t,e,r,n,s);break e}else if(r!==s){s=Vi(Error(K(424)),e),e=oy(t,e,r,n,s);break e}else for(Ft=Dr(e.stateNode.containerInfo.firstChild),Bt=e,Ne=!0,cn=null,n=Aw(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Di(),r===s){e=nr(t,e,n);break e}xt(t,e,r,n)}e=e.child}return e;case 5:return Cw(e),t===null&&wh(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,mh(r,s)?o=null:i!==null&&mh(r,i)&&(e.flags|=32),t_(t,e),xt(t,e,o,n),e.child;case 6:return t===null&&wh(e),null;case 13:return r_(t,e,n);case 4:return Bf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Li(e,null,r,n):xt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:an(r,s),ry(t,e,r,s,n);case 7:return xt(t,e,e.pendingProps,n),e.child;case 8:return xt(t,e,e.pendingProps.children,n),e.child;case 12:return xt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Ee(mc,r._currentValue),r._currentValue=o,i!==null)if(fn(i.value,o)){if(i.children===s.children&&!Ct.current){e=nr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var c=i.dependencies;if(c!==null){o=i.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Qn(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?u.next=u:(u.next=f.next,f.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),_h(i.return,n,e),c.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(K(341));o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),_h(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}xt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Ii(e,n),s=en(s),r=r(s),e.flags|=1,xt(t,e,r,n),e.child;case 14:return r=e.type,s=an(r,e.pendingProps),s=an(r.type,s),sy(t,e,r,s,n);case 15:return Zw(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:an(r,s),Ol(t,e),e.tag=1,Pt(r)?(t=!0,dc(e)):t=!1,Ii(e,n),Yw(e,r,s),Eh(e,r,s,n),bh(null,e,r,!0,t,n);case 19:return s_(t,e,n);case 22:return e_(t,e,n)}throw Error(K(156,e.tag))};function __(t,e){return Kv(t,e)}function kI(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yt(t,e,n,r){return new kI(t,e,n,r)}function nm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function CI(t){if(typeof t=="function")return nm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===xf)return 11;if(t===Ef)return 14}return 2}function Or(t,e){var n=t.alternate;return n===null?(n=Yt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Bl(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")nm(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case li:return ks(n.children,s,i,e);case _f:o=8,s|=8;break;case Wd:return t=Yt(12,n,e,s|2),t.elementType=Wd,t.lanes=i,t;case Kd:return t=Yt(13,n,e,s),t.elementType=Kd,t.lanes=i,t;case Gd:return t=Yt(19,n,e,s),t.elementType=Gd,t.lanes=i,t;case Cv:return ou(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Nv:o=10;break e;case kv:o=9;break e;case xf:o=11;break e;case Ef:o=14;break e;case _r:o=16,r=null;break e}throw Error(K(130,t==null?t:typeof t,""))}return e=Yt(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ks(t,e,n,r){return t=Yt(7,t,r,e),t.lanes=n,t}function ou(t,e,n,r){return t=Yt(22,t,r,e),t.elementType=Cv,t.lanes=n,t.stateNode={isHidden:!1},t}function bd(t,e,n){return t=Yt(6,t,null,e),t.lanes=n,t}function Sd(t,e,n){return e=Yt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function PI(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=od(0),this.expirationTimes=od(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=od(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function rm(t,e,n,r,s,i,o,c,u){return t=new PI(t,e,n,c,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Yt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Uf(i),t}function RI(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ai,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function x_(t){if(!t)return zr;t=t._reactInternals;e:{if(Ws(t)!==t||t.tag!==1)throw Error(K(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Pt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(K(171))}if(t.tag===1){var n=t.type;if(Pt(n))return xw(t,n,e)}return e}function E_(t,e,n,r,s,i,o,c,u){return t=rm(n,r,!0,t,s,i,o,c,u),t.context=x_(null),n=t.current,r=Et(),s=Vr(n),i=Qn(r,s),i.callback=e??null,Lr(n,i,s),t.current.lanes=s,ja(t,s,r),Rt(t,r),t}function au(t,e,n,r){var s=e.current,i=Et(),o=Vr(s);return n=x_(n),e.context===null?e.context=n:e.pendingContext=n,e=Qn(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Lr(s,e,o),t!==null&&(hn(t,s,o,i),Ll(t,s,o)),o}function Ic(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function gy(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function sm(t,e){gy(t,e),(t=t.alternate)&&gy(t,e)}function jI(){return null}var T_=typeof reportError=="function"?reportError:function(t){console.error(t)};function im(t){this._internalRoot=t}lu.prototype.render=im.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(K(409));au(t,e,null,null)};lu.prototype.unmount=im.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ms(function(){au(null,t,null,null)}),e[er]=null}};function lu(t){this._internalRoot=t}lu.prototype.unstable_scheduleHydration=function(t){if(t){var e=ew();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Er.length&&e!==0&&e<Er[n].priority;n++);Er.splice(n,0,t),n===0&&nw(t)}};function om(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function cu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function yy(){}function DI(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Ic(o);i.call(d)}}var o=E_(e,r,t,0,null,!1,!1,"",yy);return t._reactRootContainer=o,t[er]=o.current,da(t.nodeType===8?t.parentNode:t),Ms(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var d=Ic(u);c.call(d)}}var u=rm(t,0,!1,null,null,!1,!1,"",yy);return t._reactRootContainer=u,t[er]=u.current,da(t.nodeType===8?t.parentNode:t),Ms(function(){au(e,u,n,r)}),u}function uu(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var c=s;s=function(){var u=Ic(o);c.call(u)}}au(e,o,t,s)}else o=DI(n,e,t,s,r);return Ic(o)}Jv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Do(e.pendingLanes);n!==0&&(bf(e,n|1),Rt(e,Fe()),!(ge&6)&&(Oi=Fe()+500,rs()))}break;case 13:Ms(function(){var r=tr(t,1);if(r!==null){var s=Et();hn(r,t,1,s)}}),sm(t,1)}};Sf=function(t){if(t.tag===13){var e=tr(t,134217728);if(e!==null){var n=Et();hn(e,t,134217728,n)}sm(t,134217728)}};Zv=function(t){if(t.tag===13){var e=Vr(t),n=tr(t,e);if(n!==null){var r=Et();hn(n,t,e,r)}sm(t,e)}};ew=function(){return ve};tw=function(t,e){var n=ve;try{return ve=t,e()}finally{ve=n}};sh=function(t,e,n){switch(e){case"input":if(Xd(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=eu(r);if(!s)throw Error(K(90));Rv(r),Xd(r,s)}}}break;case"textarea":Dv(t,n);break;case"select":e=n.value,e!=null&&_i(t,!!n.multiple,e,!1)}};Bv=Zf;$v=Ms;var LI={usingClientEntryPoint:!1,Events:[La,hi,eu,Fv,Uv,Zf]},Po={findFiberByHostInstance:Ts,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},MI={bundleType:Po.bundleType,version:Po.version,rendererPackageName:Po.rendererPackageName,rendererConfig:Po.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:lr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Hv(t),t===null?null:t.stateNode},findFiberByHostInstance:Po.findFiberByHostInstance||jI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xl.isDisabled&&xl.supportsFiber)try{Yc=xl.inject(MI),Sn=xl}catch{}}zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LI;zt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!om(e))throw Error(K(200));return RI(t,e,null,n)};zt.createRoot=function(t,e){if(!om(t))throw Error(K(299));var n=!1,r="",s=T_;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=rm(t,1,!1,null,null,n,!1,r,s),t[er]=e.current,da(t.nodeType===8?t.parentNode:t),new im(e)};zt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(K(188)):(t=Object.keys(t).join(","),Error(K(268,t)));return t=Hv(e),t=t===null?null:t.stateNode,t};zt.flushSync=function(t){return Ms(t)};zt.hydrate=function(t,e,n){if(!cu(e))throw Error(K(200));return uu(null,t,e,!0,n)};zt.hydrateRoot=function(t,e,n){if(!om(t))throw Error(K(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=T_;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=E_(e,null,t,1,n??null,s,!1,i,o),t[er]=e.current,da(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new lu(e)};zt.render=function(t,e,n){if(!cu(e))throw Error(K(200));return uu(null,t,e,!1,n)};zt.unmountComponentAtNode=function(t){if(!cu(t))throw Error(K(40));return t._reactRootContainer?(Ms(function(){uu(null,null,t,!1,function(){t._reactRootContainer=null,t[er]=null})}),!0):!1};zt.unstable_batchedUpdates=Zf;zt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!cu(n))throw Error(K(200));if(t==null||t._reactInternals===void 0)throw Error(K(38));return uu(t,e,n,!1,r)};zt.version="18.3.1-next-f1338f8080-20240426";function I_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(I_)}catch(t){console.error(t)}}I_(),Iv.exports=zt;var VI=Iv.exports,vy=VI;ec.createRoot=vy.createRoot,ec.hydrateRoot=vy.hydrateRoot;const am=t=>l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.776 48.776 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})]}),b_=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193l-3.722.28c-.443.034-.884.176-1.286.448l-4.486 2.872c-.18.115-.383.115-.564 0l-4.486-2.873a1.875 1.875 0 01-1.286-.447l-3.722-.281a2.25 2.25 0 01-1.98-2.192v-4.286c0-.97.616-1.813 1.5-2.097m14.25-1.118a2.25 2.25 0 00-2.25-2.25h-8.25a2.25 2.25 0 00-2.25 2.25v.928c.378-.04.757-.067 1.143-.082l3.722-.281c.443-.034.884-.176 1.286-.448l4.486-2.872c.18-.115.383.115.564 0l4.486 2.873c.402.27.843.414 1.286.448l3.722.28c.386.016.764.042 1.143.082v-.928a2.25 2.25 0 00-2.25-2.25h-8.25a2.25 2.25 0 00-2.25 2.25v.928"})}),qr=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),S_=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})}),OI=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),A_=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25z"})}),Vs=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`animate-spin ${t.className}`,children:l.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),FI=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"})}),UI=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.122 2.122l7.81-7.81"})}),BI=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),$I=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 00-3 3h15.75m-12.75-3h11.218c.51 0 .962-.343 1.087-.835l1.821-6.831a1.5 1.5 0 00-1.422-2.098H5.168L4.659 3.563A1.5 1.5 0 003.132 2.25H2.25m5.25 9h10.5m-10.5-9h10.5"})}),zI=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})}),qI=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.562L16.5 21.75l-.398-1.188a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.188-.398a2.25 2.25 0 001.423-1.423L16.5 15.75l.398 1.188a2.25 2.25 0 001.423 1.423L19.5 18.75l-1.188.398a2.25 2.25 0 00-1.423 1.423z"})}),wy=t=>l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6h.008v.008H6V6z"})]}),Vh=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),HI=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z"})}),WI=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})}),KI=t=>l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),GI=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.243 4.243L6.228 6.228"})}),N_=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"})}),QI=({user:t,onNavigateHome:e,onNavigateToListing:n,onNavigateToProfile:r,onOpenTutorial:s})=>l.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-10",children:l.jsxs("div",{className:"container mx-auto px-4 md:px-8 py-4 flex items-center justify-between",children:[l.jsxs("button",{onClick:e,className:"flex items-center gap-3 cursor-pointer",children:[l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-10 w-auto"}),l.jsxs("span",{className:"text-2xl font-bold",children:[l.jsx("span",{className:"text-gray-900",children:"LA"}),l.jsx("span",{className:"text-primary",children:"BOTIGA"})]})]}),l.jsx("div",{className:"flex items-center gap-4",children:t&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:s,className:"p-2 text-gray-500 hover:text-primary hover:bg-gray-100 rounded-full transition-colors","aria-label":"Obre el tutorial",children:l.jsx(N_,{className:"w-7 h-7"})}),l.jsxs("button",{onClick:n,className:"bg-primary text-white font-semibold p-2 sm:px-4 sm:py-2 rounded-lg hover:bg-primary-700 transition-colors flex items-center gap-2",children:[l.jsx(Vh,{className:"h-5 w-5"}),l.jsx("span",{className:"hidden sm:inline",children:"Puja un article"})]}),l.jsxs("button",{onClick:r,className:"flex items-center gap-2 cursor-pointer p-1 rounded-md hover:bg-gray-100",children:[l.jsx("img",{src:t.avatarUrl,alt:t.name,className:"w-9 h-9 rounded-full border-2 border-primary-200"}),l.jsx("span",{className:"font-semibold text-gray-700 hidden md:block",children:t.name})]})]})})]})}),Hn={novedad:{label:"Novetat",emoji:"",className:"bg-blue-500 text-white"},ultimas_unidades:{label:"ltimes Unitats",emoji:"",className:"bg-yellow-500 text-black"},reservado:{label:"Reservat",emoji:"",className:"bg-orange-500 text-white"},vendido:{label:"Tracte Fet",emoji:"",className:"bg-gray-700 text-white"}},_y=({product:t,onSelect:e})=>{const n=t.imageUrls&&t.imageUrls.length>0,r=i=>typeof i!="number"||isNaN(i)?"N/A":i.toFixed(2),s=t.tag?Hn[t.tag]:null;return l.jsxs("button",{onClick:e,className:`bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden group text-left w-full hover:shadow-lg transition-shadow duration-200 ${t.tag==="vendido"?"opacity-70":""}`,children:[l.jsxs("div",{className:"relative w-full aspect-square bg-gray-100 overflow-hidden",children:[n&&l.jsx("img",{src:t.imageUrls[0],alt:t.title,className:`w-full h-full object-cover group-hover:scale-105 transition-transform duration-300 ${t.tag==="vendido"?"grayscale":""}`}),s&&l.jsxs("div",{className:`absolute top-2 left-2 text-xs font-bold px-2 py-1 rounded-full shadow-md ${s.className}`,children:[s.emoji," ",s.label]})]}),l.jsxs("div",{className:"p-3",children:[l.jsxs("p",{className:"font-bold text-gray-800 text-lg",children:[r(t.price)," "]}),l.jsx("h3",{className:"text-gray-600 text-sm truncate",children:t.title}),l.jsxs("div",{className:"flex items-center mt-2 pt-2 border-t border-gray-100",children:[l.jsx("img",{src:t.seller.avatarUrl,alt:t.seller.name,className:"w-6 h-6 rounded-full mr-2"}),l.jsx("p",{className:"text-xs text-gray-500 truncate",children:t.seller.name})]})]})]})},YI=({userProducts:t,merchProducts:e,onProductSelect:n})=>{const[r,s]=R.useState(t),[i,o]=R.useState("");R.useEffect(()=>{const u=i.toLowerCase();if(u==="")s(t);else{const d=t.filter(f=>f.title.toLowerCase().includes(u)||f.description.toLowerCase().includes(u));s(d)}},[i,t]);const c=u=>{o(u.target.value)};return l.jsxs("main",{className:"container mx-auto p-4 md:p-8",children:[l.jsxs("div",{className:"bg-white rounded-2xl shadow-md border border-gray-200 p-6 mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Descobreix i estalvia"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Busca entre els articles de segona m a prop teu."}),l.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:l.jsxs("div",{className:"relative flex-grow",children:[l.jsx(BI,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Busca el que et calgui per practicar el millor esport del mn",value:i,onChange:c,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary bg-white text-gray-900"})]})})]}),e.length>0&&l.jsx("section",{className:"mb-12",children:l.jsxs("div",{className:"bg-primary-50 border border-primary-200 rounded-2xl p-6 shadow-sm",children:[l.jsx("div",{className:"flex justify-between items-center mb-6",children:l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Marxandatge del Club"})}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6",children:e.map(u=>l.jsx(_y,{product:u,onSelect:()=>n(u)},u.id))})]})}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Articles destacats"}),r.length>0?l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6",children:r.map(u=>l.jsx(_y,{product:u,onSelect:()=>n(u)},u.id))}):l.jsx("div",{className:"text-center py-16",children:l.jsx("p",{className:"text-gray-600",children:"No s'han trobat articles que coincideixin amb la teva cerca."})})]})]})},On=5,XI=(t,e=1280,n=1280)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var u;if(!((u=o.target)!=null&&u.result))return s(new Error("No s'ha pogut llegir el fitxer."));const c=new Image;c.src=o.target.result,c.onload=()=>{const d=document.createElement("canvas");let{width:f,height:m}=c;f>m?f>e&&(m=Math.round(m*(e/f)),f=e):m>n&&(f=Math.round(f*(n/m)),m=n),d.width=f,d.height=m;const g=d.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(c,0,0,f,m),d.toBlob(T=>{T?r(T):s(new Error("La creaci del Blob des del canvas ha fallat."))},"image/jpeg",.85)},c.onerror=d=>s(new Error(`Error en carregar la imatge: ${d}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),JI=({imagePreviews:t,onImagesAdded:e,onDeleteImage:n})=>{const[r,s]=R.useState(!1),[i,o]=R.useState(null),[c,u]=R.useState(!1),d=R.useRef(null),f=R.useRef(null),m=async C=>{const P=C.target.files;if(!P)return;const S=Array.from(P).slice(0,On-t.length);if(P.length>S.length?o(`Noms pots pujar un mxim de ${On} imatges.`):o(null),S.length!==0){s(!0);try{const I=S.map(A=>XI(A)),E=await Promise.all(I);e(E)}catch(I){o("No s'ha pogut carregar una o ms imatges."),console.error(I)}finally{s(!1)}C.target.value=""}},g=()=>{var C;u(!1),(C=d.current)==null||C.click()},T=()=>{var C;u(!1),(C=f.current)==null||C.click()};return l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:l.jsx(Vh,{className:"h-6 w-6 text-primary"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"1. Puja les teves fotos"})]}),l.jsxs("p",{className:"text-sm font-medium text-gray-500",children:[t.length," / ",On]})]}),l.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-4",children:[t.map((C,P)=>l.jsxs("div",{className:"relative aspect-square group",children:[l.jsx("img",{src:C,alt:`Product image ${P+1}`,className:"w-full h-full object-cover rounded-lg border"}),l.jsx("button",{onClick:()=>n(P),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity","aria-label":"Eliminar imatge",children:l.jsx(qr,{className:"w-4 h-4"})})]},P)),r&&l.jsx("div",{className:"aspect-square flex justify-center items-center w-full h-full border-2 border-dashed border-gray-300 rounded-lg",children:l.jsx(Vs,{className:"w-8 h-8 text-primary"})}),t.length<On&&!r&&l.jsxs("button",{onClick:()=>u(!0),className:"aspect-square flex flex-col justify-center items-center w-full h-full border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-primary hover:bg-primary-50 transition-colors text-center","aria-label":`Puja ${On-t.length} imatges ms`,children:[l.jsx(Vh,{className:"mx-auto h-8 w-8 text-gray-400"}),l.jsx("p",{className:"mt-1 text-xs text-gray-600",children:l.jsx("span",{className:"font-semibold text-primary",children:"Afegeix fotos"})})]})]}),l.jsx("input",{ref:d,type:"file",onChange:m,className:"hidden",accept:"image/*",multiple:!0,disabled:t.length>=On}),l.jsx("input",{ref:f,type:"file",onChange:m,className:"hidden",accept:"image/*",capture:"environment",disabled:t.length>=On}),i&&l.jsx("p",{className:"text-red-500 text-sm mt-4",children:i}),c&&l.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4 animate-fade-in-fast",onClick:()=>u(!1),"aria-modal":"true",role:"dialog",children:[l.jsx("style",{children:`
            @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }
            .animate-fade-in-fast { animation: fade-in-fast 0.2s ease-out; }
            @keyframes scale-in { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
            .animate-scale-in { animation: scale-in 0.2s ease-out; }
          `}),l.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-xs shadow-xl animate-scale-in",onClick:C=>C.stopPropagation(),children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Tria una opci"}),l.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:l.jsx(qr,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{onClick:T,className:"w-full flex items-center gap-4 p-4 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors disabled:opacity-50",disabled:t.length>=On,children:[l.jsx(am,{className:"w-6 h-6 text-primary"}),l.jsx("span",{className:"font-semibold text-gray-700",children:"Fes una foto"})]}),l.jsxs("button",{onClick:g,className:"w-full flex items-center gap-4 p-4 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors disabled:opacity-50",disabled:t.length>=On,children:[l.jsx(A_,{className:"w-6 h-6 text-primary"}),l.jsx("span",{className:"font-semibold text-gray-700",children:"Tria de la galeria"})]})]})]})]})]})},ZI=({title:t,setTitle:e,description:n,setDescription:r})=>l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:l.jsx(qI,{className:"h-6 w-6 text-primary"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"2. Descriu el teu article"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"product-title",className:"block text-sm font-medium text-gray-700",children:"Ttol del producte"}),l.jsx("input",{id:"product-title",type:"text",value:t,onChange:s=>e(s.target.value),placeholder:'p. ex., "Jaqueta de cuir vintage"',className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{htmlFor:"product-description",className:"block text-sm font-medium text-gray-700",children:"Descripci"}),l.jsx("textarea",{id:"product-description",rows:6,value:n,onChange:s=>r(s.target.value),placeholder:"Descriu el teu article amb detall...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]})]}),eb=({imagePreviews:t,title:e,description:n,price:r,onPublish:s,isEditing:i,isPublishing:o})=>{const c=t.length>0&&e&&r;return l.jsx("div",{className:"sticky top-28",children:l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Vista prvia de l'anunci"}),l.jsx("div",{className:"w-full aspect-square bg-gray-100 rounded-lg mb-4 flex items-center justify-center",children:t&&t.length>0?l.jsx("img",{src:t[0],alt:"Vista prvia del producte",className:"w-full h-full object-cover rounded-lg"}):l.jsx(A_,{className:"w-16 h-16 text-gray-300"})}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-900 truncate",children:e||"Ttol del producte"}),l.jsx("p",{className:"text-3xl font-extrabold text-primary",children:r?`${parseFloat(r).toFixed(2)} `:"0.00 "}),l.jsx("div",{className:"border-t pt-3",children:l.jsx("p",{className:"text-gray-600 text-sm whitespace-pre-wrap h-32 overflow-y-auto",children:n||"La teva descripci generada apareixer aqu..."})}),l.jsx("button",{onClick:s,disabled:!c||o,className:"w-full bg-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:o?l.jsxs(l.Fragment,{children:[l.jsx(Vs,{className:"w-5 h-5"}),l.jsx("span",{children:i?"Desant...":"Publicant..."})]}):i?"Desa els canvis":"Publica l'anunci"})]})]})})},tb="dfmkfeqzt",nb="BOTIGAHANDBOL",$l=async t=>{try{const e=new FormData;e.append("file",t),e.append("upload_preset",nb);const n=await fetch(`https://api.cloudinary.com/v1_1/${tb}/image/upload`,{method:"POST",body:e});if(!n.ok){const s=await n.json();throw new Error(`Error en pujar a Cloudinary: ${s.error.message}`)}return(await n.json()).secure_url}catch(e){throw console.error("Error en la crrega a Cloudinary:",e),e}},rb="ListingDraftDB",sb=1,Hr="listingDrafts",lm="currentListingDraft",cm=()=>new Promise((t,e)=>{const n=indexedDB.open(rb,sb);n.onerror=()=>e("Error en obrir la base de dades IndexedDB."),n.onsuccess=()=>t(n.result),n.onupgradeneeded=r=>{const s=r.target.result;s.objectStoreNames.contains(Hr)||s.createObjectStore(Hr)}}),ib=t=>new Promise((e,n)=>{const r=new FileReader;r.onloadend=()=>e(r.result),r.onerror=n,r.readAsDataURL(t)}),ob=async t=>{const n=(await cm()).transaction(Hr,"readwrite");return n.objectStore(Hr).put(t,lm),new Promise((s,i)=>{n.oncomplete=()=>s(),n.onerror=()=>i("Error en desar l'esborrany a IndexedDB.")})},ab=async()=>{const r=(await cm()).transaction(Hr,"readonly").objectStore(Hr).get(lm);return new Promise((s,i)=>{r.onsuccess=()=>{s(r.result||null)},r.onerror=()=>i("Error en llegir l'esborrany.")})},lb=async()=>{(await cm()).transaction(Hr,"readwrite").objectStore(Hr).delete(lm)},cb=({onSave:t,productToEdit:e,currentUser:n})=>{const[r,s]=R.useState([]),[i,o]=R.useState([]),[c,u]=R.useState(""),[d,f]=R.useState(""),[m,g]=R.useState(""),[T,C]=R.useState(!1),[P,S]=R.useState(""),[I,E]=R.useState(!0),[A,D]=R.useState(!1),V=!!e;R.useEffect(()=>{const _=r.map(N=>typeof N=="string"?N:URL.createObjectURL(N));return o(_),()=>{_.forEach(N=>{N.startsWith("blob:")&&URL.revokeObjectURL(N)})}},[r]),R.useEffect(()=>{(async()=>{var N;if(V&&e)u(e.title),f(e.description),g(((N=e.price)==null?void 0:N.toString())||""),s(e.imageUrls||[]),C(e.isMerchandise||!1),S(e.tag||"");else if(!V)try{const x=await ab();x&&(s(x.imagesData||[]),u(x.title||""),f(x.description||""),g(x.price||""),C(x.isMerchandise||!1),S(x.tag||""))}catch(x){console.error("Error en restaurar l'esborrany:",x)}E(!1)})()},[e,V]),R.useEffect(()=>{if(I||V)return;ob({imagesData:r,title:c,description:d,price:m,isMerchandise:T,tag:P}).catch(N=>console.error("Error en desar l'esborrany:",N))},[r,c,d,m,T,P,I,V]);const B=async()=>{s([]),u(""),f(""),g(""),C(!1),S(""),await lb()},y=async()=>{if(i.length>0&&c&&m){D(!0);try{const _=r.map(ie=>typeof ie=="string"?Promise.resolve(ie):ib(ie).then(Ve=>$l(Ve))),N=await Promise.all(_),x={title:c,description:d,price:parseFloat(m),imageUrls:N,isMerchandise:T,tag:P||void 0};await t(x,e==null?void 0:e.id),await B()}catch{console.error("La publicaci ha fallat. L'usuari ja ha estat notificat.")}finally{D(!1)}}},v={novedad:Hn.novedad,ultimas_unidades:Hn.ultimas_unidades},b={reservado:Hn.reservado,vendido:Hn.vendido},k=(n==null?void 0:n.role)==="admin"&&T?v:b;return I&&!V?l.jsx("div",{className:"flex justify-center items-center h-screen",children:l.jsx("p",{className:"text-gray-600",children:"Recuperant l'esborrany..."})}):l.jsx("main",{className:"container mx-auto p-4 md:p-8",children:l.jsxs("div",{className:"max-w-7xl mx-auto",children:[l.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",children:V?"Edita el teu anunci":"Crea el teu anunci"}),l.jsx("p",{className:"text-gray-600 mb-8",children:V?"Actualitza els detalls del teu producte.":"Fes servir les nostres eines per fer destacar el teu producte."}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8",children:[l.jsxs("div",{className:"lg:col-span-3 flex flex-col gap-8",children:[l.jsx(JI,{imagePreviews:i,onImagesAdded:_=>s(N=>[...N,..._]),onDeleteImage:_=>s(N=>N.filter((x,ie)=>ie!==_))}),l.jsx(ZI,{title:c,setTitle:u,description:d,setDescription:f}),l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:l.jsx(wy,{className:"h-6 w-6 text-primary"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"3. Afegeix un preu"})]}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Introdueix el preu de venda del teu article."}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"product-price",className:"block text-sm font-medium text-gray-700",children:"Preu ()"}),l.jsx("input",{id:"product-price",type:"number",value:m,onChange:_=>g(_.target.value),placeholder:"p. ex., 25.50",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",step:"0.01",min:"0",required:!0})]})]}),l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:l.jsx(wy,{className:"h-6 w-6 text-primary"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"4. Etiqueta (Opcional)"})]}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Selecciona un estat per al teu article."}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("label",{className:"flex items-center gap-3 cursor-pointer p-2 rounded-lg hover:bg-gray-50",children:[l.jsx("input",{type:"radio",name:"tag",value:"",checked:P==="",onChange:_=>S(_.target.value),className:"h-5 w-5 text-primary focus:ring-primary border-gray-300"}),l.jsx("span",{className:"text-gray-700 font-medium",children:"Cap etiqueta"})]}),Object.entries(k).map(([_,N])=>l.jsxs("label",{className:"flex items-center gap-3 cursor-pointer p-2 rounded-lg hover:bg-gray-50",children:[l.jsx("input",{type:"radio",name:"tag",value:_,checked:P===_,onChange:x=>S(x.target.value),className:"h-5 w-5 text-primary focus:ring-primary border-gray-300"}),l.jsxs("span",{className:`text-sm font-semibold px-2 py-1 rounded-full ${N.className}`,children:[N.emoji," ",N.label]})]},_))]})]}),(n==null?void 0:n.role)==="admin"&&l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg flex items-center justify-center h-10 w-10",children:l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-6 w-auto"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Opcions d'Administrador"})]}),l.jsx("div",{className:"mt-4",children:l.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:T,onChange:_=>C(_.target.checked),className:"h-5 w-5 rounded border-gray-300 text-primary focus:ring-primary"}),l.jsx("span",{className:"text-gray-700 font-medium",children:"Afegeix com a article de merchandising oficial"})]})})]})]}),l.jsx("div",{className:"lg:col-span-2",children:l.jsx(eb,{imagePreviews:i,title:c,description:d,price:m,onPublish:y,isEditing:V,isPublishing:A})})]})]})})},ub=({message:t,type:e="success",onClose:n})=>{if(!t)return null;const r="text-white text-sm font-semibold px-4 py-3 rounded-lg shadow-lg flex items-center justify-between gap-4",s={success:"bg-green-500",error:"bg-red-500"},i={success:"hover:bg-green-600",error:"hover:bg-red-600"};return l.jsxs("div",{className:"fixed bottom-6 left-6 z-50 animate-slide-in-up",children:[l.jsx("style",{children:`
        @keyframes slide-in-up {
          0% {
            opacity: 0;
            transform: translateY(20px);
          }
          100% {
            opacity: 1;
            transform: translateY(0);
          }
        }
        .animate-slide-in-up {
          animation: slide-in-up 0.3s ease-out forwards;
        }
      `}),l.jsxs("div",{className:`${r} ${s[e]}`,children:[l.jsx("span",{children:t}),l.jsx("button",{onClick:n,className:`p-1 rounded-full flex-shrink-0 ${i[e]}`,children:l.jsx(qr,{className:"w-4 h-4"})})]})]})},db=(t,e=512,n=512)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var u;if(!((u=o.target)!=null&&u.result))return s(new Error("No s'ha pogut llegir el fitxer."));const c=new Image;c.src=o.target.result,c.onload=()=>{const d=document.createElement("canvas");let{width:f,height:m}=c;f>m?f>e&&(m=Math.round(m*(e/f)),f=e):m>n&&(f=Math.round(f*(n/m)),m=n),d.width=f,d.height=m;const g=d.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(c,0,0,f,m),r(d.toDataURL("image/jpeg",.9))},c.onerror=d=>s(new Error(`Error en carregar la imatge: ${d}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),hb=({onClose:t,onLogin:e,onRegister:n,onPasswordReset:r,isDismissable:s=!0})=>{const[i,o]=R.useState("login"),[c,u]=R.useState(""),[d,f]=R.useState(""),[m,g]=R.useState(""),[T,C]=R.useState(!1),[P,S]=R.useState(null),I=R.useRef(null),[E,A]=R.useState(!1),[D,V]=R.useState(null),[B,y]=R.useState(null),v=async _=>{var x;const N=(x=_.target.files)==null?void 0:x[0];if(N)try{const ie=await db(N);S(ie)}catch(ie){console.error("Error en llegir el fitxer:",ie),V("No s'ha pogut processar la imatge.")}},b=async _=>{_.preventDefault(),A(!0),V(null),y(null);try{i==="login"?await e(d,m):await n(c,d,m,P)}catch(N){let x="Hi ha hagut un error. Si us plau, torna-ho a provar.";if(N.code)switch(N.code){case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":x="Correu electrnic o contrasenya incorrectes.";break;case"auth/email-already-in-use":x="Aquest correu electrnic ja est en s.";break;case"auth/weak-password":x="La contrasenya ha de tenir almenys 6 carcters.";break;case"auth/invalid-email":x="El format del correu electrnic no s vlid.";break}else N.message&&(N.message.includes("Cloudinary")?x="Error amb la imatge: Assegura't que el 'preset' de crrega a Cloudinary estigui configurat com a 'unsigned'.":x=N.message);V(x),console.error(N)}finally{A(!1)}},k=async _=>{_.preventDefault(),A(!0),V(null),y(null);try{await r(d),y("S'ha enviat l'enlla de recuperaci. Revisa el teu correu (i la carpeta de correu brossa).")}catch(N){let x="Hi ha hagut un error en enviar el correu.";(N.code==="auth/user-not-found"||N.code==="auth/invalid-email")&&(x="No s'ha trobat cap usuari amb aquest correu electrnic."),V(x)}finally{A(!1)}};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:s?t:void 0,"aria-modal":"true",role:"dialog",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden relative",onClick:_=>_.stopPropagation(),children:[s&&l.jsx("button",{onClick:t,className:"absolute top-3 right-3 text-gray-400 hover:text-gray-800 z-10 p-1 transition-colors","aria-label":"Tancar",children:l.jsx(qr,{className:"w-6 h-6"})}),l.jsx("div",{className:"p-6 sm:p-8",children:i==="forgotPassword"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-12 w-auto mx-auto"}),l.jsx("h2",{className:"mt-2 text-2xl font-bold text-gray-900",children:"Restableix la contrasenya"}),l.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Introdueix el teu correu i t'enviarem un enlla per recuperar-la."})]}),l.jsxs("form",{onSubmit:k,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email-reset",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),l.jsx("input",{id:"email-reset",name:"email",type:"email",autoComplete:"email",required:!0,value:d,onChange:_=>f(_.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"correu@exemple.com"})]}),D&&l.jsx("p",{className:"text-red-500 text-sm text-center",children:D}),B&&l.jsx("p",{className:"text-green-600 text-sm text-center",children:B}),l.jsx("div",{children:l.jsx("button",{type:"submit",disabled:E,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:E?l.jsx(Vs,{className:"w-5 h-5"}):"Envia l'enlla"})}),l.jsx("div",{children:l.jsx("button",{type:"button",onClick:()=>{o("login"),V(null),y(null),C(!1)},className:"w-full text-sm font-medium text-primary hover:underline",children:"Tornar a l'inici de sessi"})})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-12 w-auto mx-auto"}),l.jsx("h2",{className:"mt-2 text-2xl font-bold text-gray-900",children:i==="login"?l.jsxs(l.Fragment,{children:["Benvingut/da a LA",l.jsx("span",{className:"text-primary",children:"BOTIGA"})]}):"Crea el teu compte"}),l.jsx("p",{className:"text-gray-600 text-sm mt-1 px-4",children:i==="login"?"La botiga de segona m i marxandatge del Club Handbol Molins.":"Registra't per comprar i vendre material del club i molt ms."})]}),l.jsxs("div",{className:"flex border-b border-gray-200 mb-6",children:[l.jsx("button",{onClick:()=>{o("login"),V(null),y(null),C(!1)},className:`flex-1 py-3 text-sm font-semibold text-center transition-colors ${i==="login"?"text-primary border-b-2 border-primary":"text-gray-500 hover:text-gray-700"}`,children:"Inicia la sessi"}),l.jsx("button",{onClick:()=>{o("register"),V(null),y(null),C(!1)},className:`flex-1 py-3 text-sm font-semibold text-center transition-colors ${i==="register"?"text-primary border-b-2 border-primary":"text-gray-500 hover:text-gray-700"}`,children:"Registra't"})]}),l.jsxs("form",{onSubmit:b,className:"space-y-4",children:[i==="register"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex justify-center",children:[l.jsx("input",{type:"file",ref:I,onChange:v,className:"hidden",accept:"image/*"}),l.jsxs("button",{type:"button",onClick:()=>{var _;return(_=I.current)==null?void 0:_.click()},className:"relative w-24 h-24 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 hover:bg-gray-200 transition-colors",children:[P?l.jsx("img",{src:P,alt:"Avatar Preview",className:"w-full h-full object-cover rounded-full"}):l.jsx(am,{className:"w-10 h-10"}),l.jsx("div",{className:"absolute bottom-0 right-0 bg-primary text-white rounded-full p-1 text-xs",children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nom"}),l.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:c,onChange:_=>u(_.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"El teu nom"})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),l.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:d,onChange:_=>f(_.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"correu@exemple.com"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Contrasenya"}),i==="login"&&l.jsx("button",{type:"button",onClick:()=>{o("forgotPassword"),V(null),y(null)},className:"text-sm font-medium text-primary hover:underline",children:"Heu oblidat la contrasenya?"})]}),l.jsxs("div",{className:"relative mt-1",children:[l.jsx("input",{id:"password",name:"password",type:T?"text":"password",autoComplete:"current-password",required:!0,value:m,onChange:_=>g(_.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900 pr-10",placeholder:""}),l.jsx("button",{type:"button",onClick:()=>C(!T),className:"absolute inset-y-0 right-0 flex items-center px-3 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":T?"Oculta la contrasenya":"Mostra la contrasenya",children:T?l.jsx(GI,{className:"w-5 h-5"}):l.jsx(KI,{className:"w-5 h-5"})})]})]}),D&&l.jsx("p",{className:"text-red-500 text-sm text-center",children:D}),B&&l.jsx("p",{className:"text-green-600 text-sm text-center",children:B}),l.jsx("div",{children:l.jsx("button",{type:"submit",disabled:E,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:E?l.jsx(Vs,{className:"w-5 h-5"}):i==="login"?"Inicia la sessi":"Crea el compte"})})]})]})})]})})},fb=(t,e=512,n=512)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var u;if(!((u=o.target)!=null&&u.result))return s(new Error("No s'ha pogut llegir el fitxer."));const c=new Image;c.src=o.target.result,c.onload=()=>{const d=document.createElement("canvas");let{width:f,height:m}=c;f>m?f>e&&(m=Math.round(m*(e/f)),f=e):m>n&&(f=Math.round(f*(n/m)),m=n),d.width=f,d.height=m;const g=d.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(c,0,0,f,m),r(d.toDataURL("image/jpeg",.9))},c.onerror=d=>s(new Error(`Error en carregar la imatge: ${d}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),mb=({allUsers:t,onSendAdminMessage:e})=>{const[n,r]=R.useState("all"),[s,i]=R.useState(""),[o,c]=R.useState(!1),u=async d=>{if(d.preventDefault(),!!s.trim()){c(!0);try{await e(n,s),i(""),r("all")}catch{}finally{c(!1)}}};return l.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-2xl shadow-md border border-gray-200 mt-8",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-6 border-b",children:[l.jsx(FI,{className:"h-10 w-10 text-primary"}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Panell d'Administrador"}),l.jsx("p",{className:"text-gray-600",children:"Envia comunicats a usuaris individuals o a tothom."})]})]}),l.jsxs("form",{onSubmit:u,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"recipient",className:"block text-sm font-medium text-gray-700",children:"Destinatari"}),l.jsxs("select",{id:"recipient",value:n,onChange:d=>r(d.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",children:[l.jsx("option",{value:"all",children:"Tots els usuaris"}),t.map(d=>l.jsxs("option",{value:d.id,children:[d.name," (",d.email,")"]},d.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"admin-message",className:"block text-sm font-medium text-gray-700",children:"Missatge"}),l.jsx("textarea",{id:"admin-message",rows:5,value:s,onChange:d=>i(d.target.value),placeholder:"Escriu el teu comunicat aqu...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",required:!0})]}),l.jsx("button",{type:"submit",disabled:o||!s.trim(),className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:o?l.jsx(Vs,{className:"w-5 h-5"}):"Envia el missatge"})]})]})},pb=({user:t,onUpdateUser:e,onBack:n,onLogout:r,allUsers:s,onSendAdminMessage:i})=>{const[o,c]=R.useState(t.name),[u,d]=R.useState(null),f=R.useRef(null),[m,g]=R.useState(!1);R.useEffect(()=>{c(t.name)},[t]);const T=async P=>{var I;const S=(I=P.target.files)==null?void 0:I[0];if(S)try{const E=await fb(S);d(E)}catch(E){console.error("Error en llegir el fitxer:",E)}},C=async P=>{P.preventDefault(),g(!0);try{await e(t.id,o,u),d(null)}catch(S){console.error(S)}finally{g(!1)}};return l.jsx("main",{className:"container mx-auto p-4 md:p-8",children:l.jsxs("div",{className:"max-w-2xl mx-auto",children:[l.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-6 border-b",children:[l.jsx(HI,{className:"h-10 w-10 text-primary"}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"El Meu Perfil"}),l.jsx("p",{className:"text-gray-600",children:"Actualitza la teva informaci personal."})]})]}),l.jsxs("form",{onSubmit:C,className:"space-y-4 sm:space-y-6",children:[l.jsxs("div",{className:"flex flex-col items-center gap-4",children:[l.jsx("input",{type:"file",ref:f,onChange:T,className:"hidden",accept:"image/*"}),l.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Foto de perfil"}),l.jsxs("button",{type:"button",onClick:()=>{var P;return(P=f.current)==null?void 0:P.click()},className:"relative w-32 h-32 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 hover:bg-gray-200 transition-colors group",children:[l.jsx("img",{src:u||t.avatarUrl,alt:"Avatar",className:"w-full h-full object-cover rounded-full"}),l.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 flex items-center justify-center rounded-full transition-opacity cursor-pointer",children:l.jsx(am,{className:"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nom"}),l.jsx("input",{id:"name",type:"text",required:!0,value:o,onChange:P=>c(P.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),l.jsx("input",{id:"email",type:"email",value:t.email,disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm bg-gray-100 text-gray-500 cursor-not-allowed"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"joinDate",className:"block text-sm font-medium text-gray-700",children:"Membre des de"}),l.jsx("input",{id:"joinDate",type:"text",value:new Date(t.joinDate).toLocaleDateString("ca-ES",{year:"numeric",month:"long",day:"numeric"}),disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm bg-gray-100 text-gray-500 cursor-not-allowed"})]}),l.jsxs("div",{className:"flex gap-4 pt-4 border-t",children:[l.jsx("button",{type:"button",onClick:n,className:"w-full flex justify-center py-3 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:"Cancella"}),l.jsx("button",{type:"submit",disabled:m,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400",children:m?l.jsx(Vs,{className:"w-5 h-5"}):"Desa els canvis"})]})]}),l.jsx("div",{className:"mt-8 pt-6 border-t border-red-200",children:l.jsx("button",{onClick:r,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Tanca la sessi"})})]}),t.role==="admin"&&l.jsx(mb,{allUsers:s,onSendAdminMessage:i})]})})},gb=({onClick:t,unreadCount:e,isOpen:n})=>n?null:l.jsxs(l.Fragment,{children:[l.jsx("style",{children:`
        @keyframes pulse-strong {
          0%, 100% { transform: scale(1); opacity: 1; }
          50% { transform: scale(1.1); opacity: 0.95; }
        }
        .animate-pulse-strong { animation: pulse-strong 1.5s infinite ease-in-out; }
      `}),l.jsxs("button",{onClick:t,className:"fixed bottom-4 right-4 md:bottom-8 md:right-8 z-30 bg-primary text-white w-16 h-16 rounded-full shadow-lg flex items-center justify-center hover:bg-primary-700 transition-all duration-300 transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary","aria-label":"Obrir el xat",children:[e>0&&l.jsx("span",{className:"absolute top-0 right-0 h-6 w-6 rounded-full bg-red-500 border-2 border-white flex items-center justify-center text-xs font-bold animate-pulse-strong",children:e}),l.jsx("div",{className:"w-9 h-9",children:l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS.png",alt:"Xat",className:"w-full h-auto p-1"})})]})]}),yb=({message:t,currentUser:e})=>{var s,i;const n=t.senderId===e.id,r=((i=(s=t.timestamp)==null?void 0:s.toDate())==null?void 0:i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"";return l.jsx("div",{className:`flex items-end gap-2 ${n?"justify-end":"justify-start"}`,children:l.jsxs("div",{className:`max-w-xs md:max-w-md lg:max-w-lg rounded-2xl px-4 py-2 ${n?"bg-primary text-white rounded-br-none":"bg-gray-200 text-gray-800 rounded-bl-none"}`,children:[t.text&&l.jsx("p",{className:"text-sm break-words",children:t.text}),t.imageUrl&&l.jsx("div",{className:"mt-2",children:l.jsx("img",{src:t.imageUrl,alt:"Uploaded content",className:"rounded-lg max-h-60 w-full object-cover"})}),l.jsx("p",{className:`text-xs mt-1 ${n?"text-primary-200":"text-gray-500"} text-right`,children:r})]})})},vb=(t,e=1280,n=1280)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var u;if(!((u=o.target)!=null&&u.result))return s(new Error("No s'ha pogut llegir el fitxer."));const c=new Image;c.src=o.target.result,c.onload=()=>{const d=document.createElement("canvas");let{width:f,height:m}=c;f>m?f>e&&(m=Math.round(m*(e/f)),f=e):m>n&&(f=Math.round(f*(n/m)),m=n),d.width=f,d.height=m;const g=d.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(c,0,0,f,m),r(d.toDataURL("image/jpeg",.85))},c.onerror=d=>s(new Error(`Error en carregar la imatge: ${d}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),wb=({chat:t,onSelect:e,currentUser:n,onDelete:r,isConfirmingDelete:s,onStartConfirmDelete:i,onCancelConfirmDelete:o})=>{var g,T,C,P,S;const c=t.participantIds.find(I=>I!==n.id);if(!c)return null;const u=t.participants[c],d=t.unreadCount[n.id]||0,f=((C=(T=(g=t.lastMessage)==null?void 0:g.timestamp)==null?void 0:T.toDate())==null?void 0:C.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"",m=()=>{r(t.id),o()};return l.jsxs("div",{className:"w-full relative bg-white overflow-hidden group",children:[l.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center justify-end px-4 gap-2 bg-white",children:[l.jsx("button",{onClick:o,className:"text-sm font-semibold py-2 px-3 rounded-md bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors","aria-label":"Cancella l'eliminaci",children:"Cancella"}),l.jsx("button",{onClick:m,className:"text-sm font-semibold py-2 px-3 rounded-md bg-red-600 text-white hover:bg-red-700 transition-colors","aria-label":"Confirma l'eliminaci",children:"Elimina"})]}),l.jsxs("div",{className:`w-full flex items-center gap-2 px-2 py-1 bg-white relative transition-transform duration-300 ease-in-out ${s?"-translate-x-44":"translate-x-0"}`,children:[l.jsxs("button",{onClick:e,className:"w-full text-left p-2 flex items-center gap-3 rounded-lg hover:bg-gray-100 transition-colors flex-1",children:[l.jsxs("div",{className:"relative flex-shrink-0",children:[l.jsx("img",{src:u.avatarUrl,alt:u.name,className:"w-12 h-12 rounded-full object-cover"}),l.jsx("img",{src:t.productImageUrl,alt:t.productTitle,className:"w-6 h-6 rounded-full object-cover absolute -bottom-1 -right-1 border-2 border-white"})]}),l.jsxs("div",{className:"flex-1 overflow-hidden",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("p",{className:"font-bold text-gray-800 truncate",children:u.name}),l.jsx("p",{className:"text-xs text-gray-500 flex-shrink-0",children:f})]}),l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("p",{className:"text-sm text-gray-600 truncate pr-2",children:((P=t.lastMessage)==null?void 0:P.text)||((S=t.lastMessage)!=null&&S.imageUrl?"Imatge":"Cap missatge encara")}),d>0&&l.jsx("span",{className:"bg-primary text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center flex-shrink-0",children:d})]})]})]}),l.jsx("button",{onClick:i,className:"p-2 rounded-full text-gray-400 hover:bg-red-100 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100","aria-label":`Elimina el xat amb ${u.name}`,children:l.jsx(S_,{className:"w-5 h-5"})})]})]})},_b=({isOpen:t,onClose:e,chats:n,activeChat:r,messages:s,currentUser:i,onSendMessage:o,onSelectChat:c,onBackToList:u,onDeleteChat:d})=>{const[f,m]=R.useState(""),[g,T]=R.useState(null),C=R.useRef(null),P=R.useRef(null),S=()=>{var y;(y=P.current)==null||y.scrollIntoView({behavior:"smooth"})};R.useEffect(()=>{t&&r&&S()},[s,t,r]),R.useEffect(()=>{(!t||!r)&&T(null)},[t,r]);const I=()=>{f.trim()&&(o(f),m(""))},E=y=>{y.key==="Enter"&&(y.preventDefault(),I())},A=async y=>{var b;const v=(b=y.target.files)==null?void 0:b[0];if(v)try{const k=await vb(v);o("",k)}catch(k){console.error("No s'ha pogut llegir el fitxer",k)}y.target&&(y.target.value="")},D=()=>{var y;(y=C.current)==null||y.click()};if(!t||!i)return null;const V=r==null?void 0:r.participantIds.find(y=>y!==i.id),B=V?r==null?void 0:r.participants[V]:null;return l.jsxs("div",{className:"fixed bottom-0 right-0 sm:bottom-4 md:bottom-8 sm:right-4 md:right-8 z-20 w-full sm:w-96 h-[90vh] sm:h-[60vh] sm:max-h-[600px] bg-white rounded-t-lg sm:rounded-lg shadow-2xl flex flex-col border border-gray-200 transform transition-transform duration-300 ease-in-out animate-slide-in",children:[l.jsx("style",{children:`
        @keyframes slide-in {
          from { transform: translateY(100%); opacity: 0; }
          to { transform: translateY(0); opacity: 1; }
        }
        .animate-slide-in { 
            animation: slide-in 0.3s ease-out; 
        }
        @keyframes fade-in-fast {
          from { opacity: 0; transform: scale(0.8); }
          to { opacity: 1; transform: scale(1); }
        }
        .animate-fade-in-fast { 
          animation: fade-in-fast 0.2s ease-out; 
        }
      `}),l.jsxs("header",{className:"bg-primary text-white p-3 flex justify-between items-center rounded-t-lg flex-shrink-0",children:[r?l.jsxs("div",{className:"flex items-center gap-3 flex-1 overflow-hidden",children:[l.jsx("button",{onClick:u,className:"hover:bg-primary-700 p-1 rounded-full -ml-1",children:l.jsx(WI,{className:"w-6 h-6"})}),l.jsx("img",{src:B==null?void 0:B.avatarUrl,alt:B==null?void 0:B.name,className:"w-8 h-8 rounded-full object-cover"}),l.jsxs("div",{className:"overflow-hidden",children:[l.jsx("h3",{className:"font-bold text-lg truncate",children:B==null?void 0:B.name}),l.jsx("p",{className:"text-xs opacity-80 truncate",children:r.productTitle})]})]}):l.jsx("div",{className:"flex items-center justify-between w-full",children:l.jsx("h3",{className:"font-bold text-lg",children:"Converses"})}),l.jsx("button",{onClick:e,className:"hover:bg-primary-700 p-1 rounded-full",children:l.jsx(qr,{className:"w-6 h-6"})})]}),r?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex-1 p-4 overflow-y-auto space-y-4 bg-gray-50",children:[s.map(y=>l.jsx(yb,{message:y,currentUser:i},y.id)),l.jsx("div",{ref:P})]}),l.jsx("div",{className:"p-2 border-t border-gray-200 bg-gray-100 flex-shrink-0",children:l.jsxs("div",{className:"flex items-center bg-white border border-gray-300 rounded-lg px-2",children:[l.jsx("input",{type:"text",value:f,onChange:y=>m(y.target.value),onKeyPress:E,placeholder:"Escriu un missatge...",className:"flex-1 py-2 px-2 border-none focus:ring-0 text-sm bg-transparent text-gray-900","aria-label":"Entrada de missatge del xat"}),l.jsx("input",{ref:C,type:"file",onChange:A,className:"hidden",accept:"image/*"}),l.jsx("button",{onClick:D,className:"text-gray-500 hover:text-primary p-2","aria-label":"Adjunta una imatge",children:l.jsx(UI,{className:"w-5 h-5"})}),l.jsx("button",{onClick:I,className:"text-white bg-primary hover:bg-primary-700 rounded-md p-2 ml-1 disabled:bg-gray-400",disabled:!f.trim(),"aria-label":"Envia el missatge",children:l.jsx(zI,{className:"w-5 h-5"})})]})})]}):l.jsx("div",{className:"flex-1 overflow-y-auto",children:n.length>0?n.map(y=>l.jsx(wb,{chat:y,onSelect:()=>c(y),currentUser:i,onDelete:d,isConfirmingDelete:g===y.id,onStartConfirmDelete:()=>T(y.id),onCancelConfirmDelete:()=>T(null)},y.id)):l.jsxs("div",{className:"text-center p-8 text-gray-500 h-full flex flex-col justify-center items-center",children:[l.jsx(b_,{className:"w-16 h-16 text-gray-300 mb-4"}),l.jsx("p",{className:"font-semibold",children:"No tens cap conversa."}),l.jsx("p",{className:"text-sm mt-1",children:"Contacta amb un venedor des d'un anunci per comenar a xatejar."})]})})]})},gs=({title:t,children:e})=>l.jsxs("section",{className:"mb-6",children:[l.jsx("h2",{className:"text-xl font-bold text-primary mb-3",children:t}),l.jsx("div",{className:"space-y-2 text-gray-700",children:e})]}),xb=({onClose:t})=>l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:t,"aria-modal":"true",role:"dialog",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col relative",onClick:e=>e.stopPropagation(),children:[l.jsxs("header",{className:"p-4 border-b flex items-center justify-between sticky top-0 bg-white z-10",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(N_,{className:"w-8 h-8 text-primary"}),l.jsxs("h1",{className:"text-2xl font-bold text-gray-800",children:["Guia Rpida de ",l.jsx("span",{className:"text-gray-900",children:"LA"}),l.jsx("span",{className:"text-primary",children:"BOTIGA"})]})]}),l.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-800 p-1 rounded-full hover:bg-gray-100","aria-label":"Tancar",children:l.jsx(qr,{className:"w-6 h-6"})})]}),l.jsxs("div",{className:"p-6 overflow-y-auto",children:[l.jsxs("section",{className:"mb-6",children:[l.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-3",children:[" Benvingut/da a ",l.jsx("span",{className:"text-gray-900",children:"LA"}),l.jsx("span",{className:"text-primary",children:"BOTIGA"}),"!"]}),l.jsx("div",{className:"space-y-2 text-gray-700",children:l.jsx("p",{children:"Aquesta s la botiga virtual del Club Handbol Molins, on pots comprar i vendre material d'handbol de segona m i adquirir el marxandatge oficial del club."})})]}),l.jsx(gs,{title:"1. Explora els Articles",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsxs("li",{children:["A la pgina principal, trobars les seccions ",l.jsx("strong",{children:"'Marxandatge del Club'"})," i ",l.jsx("strong",{children:"'Articles destacats'"}),"."]}),l.jsxs("li",{children:["Fes servir la ",l.jsx("strong",{children:"barra de cerca"})," per trobar articles especfics pel seu nom o descripci."]}),l.jsx("li",{children:"Fes clic a qualsevol article per veure'n els detalls."})]})}),l.jsx(gs,{title:"2. Comprar un Article de Segona M",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Quan trobis un article que t'interessi, fes-hi clic per obrir la vista detallada."}),l.jsxs("li",{children:[l.jsx("strong",{children:"Visualitza les imatges:"})," Fes clic a la imatge principal d'un producte per obrir-la a pantalla completa. Llisca el dit o fes servir les fletxes per veure la resta de fotos."]}),l.jsx("li",{children:"Llegeix la descripci i comprova el preu."}),l.jsxs("li",{children:["Per parlar amb el venedor, fes clic al bot ",l.jsx("strong",{children:"'Contacta amb el venedor'"}),". Aix obrir un xat privat."]}),l.jsx("li",{children:"Al xat, podeu acordar els detalls del pagament i l'entrega de forma segura."})]})}),l.jsxs(gs,{title:"3. Vendre un Article",children:[l.jsxs("p",{children:["Fes clic al bot ",l.jsx("strong",{children:"'Puja un article'"})," a la capalera per comenar."]}),l.jsxs("ul",{className:"list-decimal list-inside space-y-2 pl-4",children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Puja les teves fotos:"})," Fes clic a 'Afegeix fotos'. Podrs triar entre fer una foto amb la cmera o seleccionar-ne de la teva galeria. Pots pujar fins a 5 imatges. La primera ser la principal."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Descriu el teu article:"})," Afegeix un ttol clar i una descripci detallada. Com ms informaci, millor!"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Afegeix un preu:"})," Introdueix el preu que demanes per l'article. Pots demanar un suggeriment de preu automtic."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Vista prvia i publicaci:"})," A la dreta, veurs una vista prvia del teu anunci. Quan estiguis satisfet/a, fes clic a ",l.jsx("strong",{children:"'Publica l'anunci'"}),"."]})]})]}),l.jsx(gs,{title:"4. Gestiona els Teus Xats",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsxs("li",{children:["Fes clic a la ",l.jsx("strong",{children:"bombolla de xat"})," a la cantonada inferior dreta per veure les teves converses."]}),l.jsx("li",{children:"Un nmero vermell indicar els missatges nous que no has llegit."}),l.jsx("li",{children:"Pots enviar text i imatges a travs del xat per comunicar-te amb altres usuaris."}),l.jsx("li",{children:"Per eliminar un xat, a la llista de converses, fes clic a la icona de la paperera que apareix a la dreta en passar el cursor per sobre (ordinador). Haurs de confirmar l'acci."})]})}),l.jsx(gs,{title:"5. El Teu Perfil",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsxs("li",{children:["Fes clic a la teva ",l.jsx("strong",{children:"foto de perfil"})," a la capalera per anar a la pgina del teu perfil."]}),l.jsx("li",{children:"Aqu pots canviar el teu nom i la teva foto de perfil."}),l.jsxs("li",{children:["Tamb pots ",l.jsx("strong",{children:"tancar la sessi"})," des d'aquesta pgina de manera segura."]})]})}),l.jsx(gs,{title:"6. Comprar Marxandatge Oficial",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Els articles de la secci 'Marxandatge del Club' sn productes oficials."}),l.jsxs("li",{children:["Per comprar-ne un, fes clic a l'article i desprs al bot ",l.jsx("strong",{children:"'Realitzar comanda'"}),". Sers redirigit/da a un formulari per completar la comanda."]}),l.jsxs("li",{children:["Si tens dubtes, ara tamb pots fer clic a ",l.jsx("strong",{children:"'Contacta amb el club'"})," per iniciar un xat directe abans de fer la comanda."]})]})}),l.jsxs(gs,{title:"7. Eines d'Administrador",children:[l.jsx("p",{children:"Si tens el rol d'administrador, a la teva pgina de perfil trobars un panell addicional."}),l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsxs("li",{children:["Aquest panell et permet enviar ",l.jsx("strong",{children:"missatges massius"})," a tots els usuaris o missatges directes a un usuari especfic."]}),l.jsx("li",{children:"Aquests missatges apareixeran com una nova conversa de xat per als destinataris."})]})]})]})]})}),xy=({direction:t,onClick:e})=>l.jsx("button",{onClick:n=>{n.stopPropagation(),e()},className:`absolute top-1/2 -translate-y-1/2 ${t==="left"?"left-2 md:left-4":"right-2 md:right-4"} z-10 bg-black bg-opacity-40 text-white p-2 rounded-full hover:bg-opacity-60 transition-all`,"aria-label":t==="left"?"Imatge anterior":"Imatge segent",children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-8 md:w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:t==="left"?"M15 19l-7-7 7-7":"M9 5l7 7-7 7"})})}),Eb=({images:t,startIndex:e=0,onClose:n})=>{const[r,s]=R.useState(e),[i,o]=R.useState(null),c=R.useCallback(()=>{s(m=>m===0?t.length-1:m-1)},[t.length]),u=R.useCallback(()=>{s(m=>m===t.length-1?0:m+1)},[t.length]);R.useEffect(()=>{const m=g=>{g.key==="ArrowLeft"&&c(),g.key==="ArrowRight"&&u(),g.key==="Escape"&&n()};return window.addEventListener("keydown",m),()=>{window.removeEventListener("keydown",m)}},[c,u,n]);const d=m=>{o(m.touches[0].clientX)},f=m=>{if(i===null)return;const g=m.touches[0].clientX,T=i-g;T>50?(u(),o(null)):T<-50&&(c(),o(null))};return l.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-80 z-50 flex flex-col justify-center items-center animate-fade-in-fast",onClick:n,role:"dialog","aria-modal":"true",children:[l.jsx("style",{children:`
            @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }
            .animate-fade-in-fast { animation: fade-in-fast 0.2s ease-out; }
        `}),l.jsx("button",{onClick:m=>{m.stopPropagation(),n()},className:"absolute top-4 right-4 text-white bg-black bg-opacity-40 p-2 rounded-full hover:bg-opacity-60 transition-all","aria-label":"Tancar visor",children:l.jsx(qr,{className:"w-6 h-6"})}),l.jsxs("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:[t.length>1&&l.jsx(xy,{direction:"left",onClick:c}),l.jsx("div",{className:"w-full h-full flex items-center justify-center",onTouchStart:d,onTouchMove:f,children:l.jsx("img",{src:t[r],alt:`Imatge ${r+1} de ${t.length}`,className:"max-w-full max-h-full object-contain select-none"})}),t.length>1&&l.jsx(xy,{direction:"right",onClick:u})]}),t.length>1&&l.jsxs("div",{className:"absolute bottom-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm",children:[r+1," / ",t.length]})]})},Tb=()=>{};var Ey={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k_=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Ib=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],c=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},C_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,c=o?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,f=i>>2,m=(i&3)<<4|c>>4;let g=(c&15)<<2|d>>6,T=d&63;u||(T=64,o||(g=64)),r.push(n[f],n[m],n[g],n[T])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(k_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Ib(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],c=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||c==null||d==null||m==null)throw new bb;const g=i<<2|c>>4;if(r.push(g),d!==64){const T=c<<4&240|d>>2;if(r.push(T),m!==64){const C=d<<6&192|m;r.push(C)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class bb extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Sb=function(t){const e=k_(t);return C_.encodeByteArray(e,!0)},bc=function(t){return Sb(t).replace(/\./g,"")},P_=function(t){try{return C_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ab(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nb=()=>Ab().__FIREBASE_DEFAULTS__,kb=()=>{if(typeof process>"u"||typeof Ey>"u")return;const t=Ey.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Cb=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&P_(t[1]);return e&&JSON.parse(e)},du=()=>{try{return Tb()||Nb()||kb()||Cb()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},R_=t=>{var e,n;return(n=(e=du())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},Pb=t=>{const e=R_(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},j_=()=>{var t;return(t=du())==null?void 0:t.config},D_=t=>{var e;return(e=du())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rb{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qi(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function L_(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jb(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[bc(JSON.stringify(n)),bc(JSON.stringify(o)),""].join(".")}const Xo={};function Db(){const t={prod:[],emulator:[]};for(const e of Object.keys(Xo))Xo[e]?t.emulator.push(e):t.prod.push(e);return t}function Lb(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Ty=!1;function M_(t,e){if(typeof window>"u"||typeof document>"u"||!Qi(window.location.host)||Xo[t]===e||Xo[t]||Ty)return;Xo[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=Db().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function c(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function u(g,T){g.setAttribute("width","24"),g.setAttribute("id",T),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function d(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{Ty=!0,o()},g}function f(g,T){g.setAttribute("id",T),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=Lb(r),T=n("text"),C=document.getElementById(T)||document.createElement("span"),P=n("learnmore"),S=document.getElementById(P)||document.createElement("a"),I=n("preprendIcon"),E=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const A=g.element;c(A),f(S,P);const D=d();u(E,I),A.append(E,C,S,D),document.body.appendChild(A)}i?(C.innerText="Preview backend disconnected.",E.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(E.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Mb(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(vt())}function Vb(){var e;const t=(e=du())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Ob(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Fb(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Ub(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Bb(){const t=vt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function $b(){return!Vb()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function V_(){try{return typeof indexedDB=="object"}catch{return!1}}function O_(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}function zb(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qb="FirebaseError";class Mn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=qb,Object.setPrototypeOf(this,Mn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ks.prototype.create)}}class Ks{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Hb(i,r):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new Mn(s,c,r)}}function Hb(t,e){return t.replace(Wb,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Wb=/\{\$([^}]+)}/g;function Kb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Wr(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Iy(i)&&Iy(o)){if(!Wr(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Iy(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Va(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Mo(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Vo(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function Gb(t,e){const n=new Qb(t,e);return n.subscribe.bind(n)}class Qb{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Yb(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Ad),s.error===void 0&&(s.error=Ad),s.complete===void 0&&(s.complete=Ad);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Yb(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Ad(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Me(t){return t&&t._delegate?t._delegate:t}class mn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Es="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xb{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Rb;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Zb(e))try{this.getOrInitializeService({instanceIdentifier:Es})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Es){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Es){return this.instances.has(e)}getOptions(e=Es){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Jb(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Es){return this.component?this.component.multipleInstances?e:Es:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Jb(t){return t===Es?void 0:t}function Zb(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Xb(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var he;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(he||(he={}));const tS={debug:he.DEBUG,verbose:he.VERBOSE,info:he.INFO,warn:he.WARN,error:he.ERROR,silent:he.SILENT},nS=he.INFO,rS={[he.DEBUG]:"log",[he.VERBOSE]:"log",[he.INFO]:"info",[he.WARN]:"warn",[he.ERROR]:"error"},sS=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=rS[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class um{constructor(e){this.name=e,this._logLevel=nS,this._logHandler=sS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in he))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?tS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,he.DEBUG,...e),this._logHandler(this,he.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,he.VERBOSE,...e),this._logHandler(this,he.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,he.INFO,...e),this._logHandler(this,he.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,he.WARN,...e),this._logHandler(this,he.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,he.ERROR,...e),this._logHandler(this,he.ERROR,...e)}}const iS=(t,e)=>e.some(n=>t instanceof n);let by,Sy;function oS(){return by||(by=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function aS(){return Sy||(Sy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const F_=new WeakMap,Oh=new WeakMap,U_=new WeakMap,Nd=new WeakMap,dm=new WeakMap;function lS(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Yn(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&F_.set(n,t)}).catch(()=>{}),dm.set(e,t),e}function cS(t){if(Oh.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Oh.set(t,e)}let Fh={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Oh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||U_.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Yn(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function uS(t){Fh=t(Fh)}function dS(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(kd(this),e,...n);return U_.set(r,e.sort?e.sort():[e]),Yn(r)}:aS().includes(t)?function(...e){return t.apply(kd(this),e),Yn(F_.get(this))}:function(...e){return Yn(t.apply(kd(this),e))}}function hS(t){return typeof t=="function"?dS(t):(t instanceof IDBTransaction&&cS(t),iS(t,oS())?new Proxy(t,Fh):t)}function Yn(t){if(t instanceof IDBRequest)return lS(t);if(Nd.has(t))return Nd.get(t);const e=hS(t);return e!==t&&(Nd.set(t,e),dm.set(e,t)),e}const kd=t=>dm.get(t);function hu(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),c=Yn(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Yn(o.result),u.oldVersion,u.newVersion,Yn(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}function Cd(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),Yn(n).then(()=>{})}const fS=["get","getKey","getAll","getAllKeys","count"],mS=["put","add","delete","clear"],Pd=new Map;function Ay(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Pd.get(e))return Pd.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=mS.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||fS.includes(n)))return;const i=async function(o,...c){const u=this.transaction(o,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[n](...c),s&&u.done]))[0]};return Pd.set(e,i),i}uS(t=>({...t,get:(e,n,r)=>Ay(e,n)||t.get(e,n,r),has:(e,n)=>!!Ay(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(gS(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function gS(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Uh="@firebase/app",Ny="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rr=new um("@firebase/app"),yS="@firebase/app-compat",vS="@firebase/analytics-compat",wS="@firebase/analytics",_S="@firebase/app-check-compat",xS="@firebase/app-check",ES="@firebase/auth",TS="@firebase/auth-compat",IS="@firebase/database",bS="@firebase/data-connect",SS="@firebase/database-compat",AS="@firebase/functions",NS="@firebase/functions-compat",kS="@firebase/installations",CS="@firebase/installations-compat",PS="@firebase/messaging",RS="@firebase/messaging-compat",jS="@firebase/performance",DS="@firebase/performance-compat",LS="@firebase/remote-config",MS="@firebase/remote-config-compat",VS="@firebase/storage",OS="@firebase/storage-compat",FS="@firebase/firestore",US="@firebase/ai",BS="@firebase/firestore-compat",$S="firebase",zS="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bh="[DEFAULT]",qS={[Uh]:"fire-core",[yS]:"fire-core-compat",[wS]:"fire-analytics",[vS]:"fire-analytics-compat",[xS]:"fire-app-check",[_S]:"fire-app-check-compat",[ES]:"fire-auth",[TS]:"fire-auth-compat",[IS]:"fire-rtdb",[bS]:"fire-data-connect",[SS]:"fire-rtdb-compat",[AS]:"fire-fn",[NS]:"fire-fn-compat",[kS]:"fire-iid",[CS]:"fire-iid-compat",[PS]:"fire-fcm",[RS]:"fire-fcm-compat",[jS]:"fire-perf",[DS]:"fire-perf-compat",[LS]:"fire-rc",[MS]:"fire-rc-compat",[VS]:"fire-gcs",[OS]:"fire-gcs-compat",[FS]:"fire-fst",[BS]:"fire-fst-compat",[US]:"fire-vertex","fire-js":"fire-js",[$S]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sc=new Map,HS=new Map,$h=new Map;function ky(t,e){try{t.container.addComponent(e)}catch(n){rr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Dn(t){const e=t.name;if($h.has(e))return rr.debug(`There were multiple attempts to register component ${e}.`),!1;$h.set(e,t);for(const n of Sc.values())ky(n,t);for(const n of HS.values())ky(n,t);return!0}function Yi(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Gt(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Fr=new Ks("app","Firebase",WS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new mn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Fr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xi=zS;function hm(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Bh,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Fr.create("bad-app-name",{appName:String(s)});if(n||(n=j_()),!n)throw Fr.create("no-options");const i=Sc.get(s);if(i){if(Wr(n,i.options)&&Wr(r,i.config))return i;throw Fr.create("duplicate-app",{appName:s})}const o=new eS(s);for(const u of $h.values())o.addComponent(u);const c=new KS(n,r,o);return Sc.set(s,c),c}function fm(t=Bh){const e=Sc.get(t);if(!e&&t===Bh&&j_())return hm();if(!e)throw Fr.create("no-app",{appName:t});return e}function Jt(t,e,n){let r=qS[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),rr.warn(o.join(" "));return}Dn(new mn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GS="firebase-heartbeat-database",QS=1,_a="firebase-heartbeat-store";let Rd=null;function B_(){return Rd||(Rd=hu(GS,QS,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(_a)}catch(n){console.warn(n)}}}}).catch(t=>{throw Fr.create("idb-open",{originalErrorMessage:t.message})})),Rd}async function YS(t){try{const n=(await B_()).transaction(_a),r=await n.objectStore(_a).get($_(t));return await n.done,r}catch(e){if(e instanceof Mn)rr.warn(e.message);else{const n=Fr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});rr.warn(n.message)}}}async function Cy(t,e){try{const r=(await B_()).transaction(_a,"readwrite");await r.objectStore(_a).put(e,$_(t)),await r.done}catch(n){if(n instanceof Mn)rr.warn(n.message);else{const r=Fr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});rr.warn(r.message)}}}function $_(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XS=1024,JS=30;class ZS{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new tA(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Py();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>JS){const o=nA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){rr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Py(),{heartbeatsToSend:r,unsentEntries:s}=eA(this._heartbeatsCache.heartbeats),i=bc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return rr.warn(n),""}}}function Py(){return new Date().toISOString().substring(0,10)}function eA(t,e=XS){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Ry(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Ry(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class tA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return V_()?O_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await YS(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Cy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Cy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Ry(t){return bc(JSON.stringify({version:2,heartbeats:t})).length}function nA(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rA(t){Dn(new mn("platform-logger",e=>new pS(e),"PRIVATE")),Dn(new mn("heartbeat",e=>new ZS(e),"PRIVATE")),Jt(Uh,Ny,t),Jt(Uh,Ny,"esm2020"),Jt("fire-js","")}rA("");var sA="firebase",iA="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Jt(sA,iA,"app");function z_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const oA=z_,q_=new Ks("auth","Firebase",z_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ac=new um("@firebase/auth");function aA(t,...e){Ac.logLevel<=he.WARN&&Ac.warn(`Auth (${Xi}): ${t}`,...e)}function zl(t,...e){Ac.logLevel<=he.ERROR&&Ac.error(`Auth (${Xi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(t,...e){throw mm(t,...e)}function Nn(t,...e){return mm(t,...e)}function H_(t,e,n){const r={...oA(),[e]:n};return new Ks("auth","Firebase",r).create(e,{appName:t.name})}function Xn(t){return H_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function mm(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return q_.create(t,...e)}function re(t,e,...n){if(!t)throw mm(e,...n)}function Wn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw zl(e),new Error(e)}function sr(t,e){t||Wn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zh(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function lA(){return jy()==="http:"||jy()==="https:"}function jy(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cA(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(lA()||Fb()||"connection"in navigator)?navigator.onLine:!0}function uA(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(e,n){this.shortDelay=e,this.longDelay=n,sr(n>e,"Short delay should be less than long delay!"),this.isMobile=Mb()||Ub()}get(){return cA()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pm(t,e){sr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W_{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Wn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Wn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Wn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hA=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],fA=new Oa(3e4,6e4);function cr(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function ur(t,e,n,r,s={}){return K_(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const c=Va({key:t.config.apiKey,...o}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:u,...i};return Ob()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Qi(t.emulatorConfig.host)&&(d.credentials="include"),W_.fetch()(await G_(t,t.config.apiHost,n,c),d)})}async function K_(t,e,n){t._canInitEmulator=!1;const r={...dA,...e};try{const s=new pA(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw El(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw El(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw El(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw El(t,"user-disabled",o);const f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw H_(t,f,d);pn(t,f)}}catch(s){if(s instanceof Mn)throw s;pn(t,"network-request-failed",{message:String(s)})}}async function Fa(t,e,n,r,s={}){const i=await ur(t,e,n,r,s);return"mfaPendingCredential"in i&&pn(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function G_(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?pm(t.config,s):`${t.config.apiScheme}://${s}`;return hA.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function mA(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class pA{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Nn(this.auth,"network-request-failed")),fA.get())})}}function El(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Nn(t,e,r);return s.customData._tokenResponse=n,s}function Dy(t){return t!==void 0&&t.enterprise!==void 0}class gA{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return mA(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function yA(t,e){return ur(t,"GET","/v2/recaptchaConfig",cr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vA(t,e){return ur(t,"POST","/v1/accounts:delete",e)}async function Nc(t,e){return ur(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function wA(t,e=!1){const n=Me(t),r=await n.getIdToken(e),s=gm(r);re(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Jo(jd(s.auth_time)),issuedAtTime:Jo(jd(s.iat)),expirationTime:Jo(jd(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function jd(t){return Number(t)*1e3}function gm(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return zl("JWT malformed, contained fewer than 3 sections"),null;try{const s=P_(n);return s?JSON.parse(s):(zl("Failed to decode base64 JWT payload"),null)}catch(s){return zl("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Ly(t){const e=gm(t);return re(e,"internal-error"),re(typeof e.exp<"u","internal-error"),re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xa(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Mn&&_A(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function _A({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Jo(this.lastLoginAt),this.creationTime=Jo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kc(t){var m;const e=t.auth,n=await t.getIdToken(),r=await xa(t,Nc(e,{idToken:n}));re(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(m=s.providerUserInfo)!=null&&m.length?Q_(s.providerUserInfo):[],o=TA(t.providerData,i),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=c?u:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new qh(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function EA(t){const e=Me(t);await kc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function TA(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Q_(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IA(t,e){const n=await K_(t,{},async()=>{const r=Va({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await G_(t,s,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return t.emulatorConfig&&Qi(t.emulatorConfig.host)&&(u.credentials="include"),W_.fetch()(o,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function bA(t,e){return ur(t,"POST","/v2/accounts:revokeToken",cr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){re(e.idToken,"internal-error"),re(typeof e.idToken<"u","internal-error"),re(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Ly(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){re(e.length!==0,"internal-error");const n=Ly(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await IA(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Si;return r&&(re(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(re(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(re(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Si,this.toJSON())}_performRefresh(){return Wn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wr(t,e){re(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class un{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new xA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new qh(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await xa(this,this.stsTokenManager.getToken(this.auth,e));return re(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return wA(this,e)}reload(){return EA(this)}_assign(e){this!==e&&(re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new un({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await kc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Gt(this.auth.app))return Promise.reject(Xn(this.auth));const e=await this.getIdToken();return await xa(this,vA(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,c=n.tenantId??void 0,u=n._redirectEventId??void 0,d=n.createdAt??void 0,f=n.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:T,providerData:C,stsTokenManager:P}=n;re(m&&P,e,"internal-error");const S=Si.fromJSON(this.name,P);re(typeof m=="string",e,"internal-error"),wr(r,e.name),wr(s,e.name),re(typeof g=="boolean",e,"internal-error"),re(typeof T=="boolean",e,"internal-error"),wr(i,e.name),wr(o,e.name),wr(c,e.name),wr(u,e.name),wr(d,e.name),wr(f,e.name);const I=new un({uid:m,auth:e,email:s,emailVerified:g,displayName:r,isAnonymous:T,photoURL:o,phoneNumber:i,tenantId:c,stsTokenManager:S,createdAt:d,lastLoginAt:f});return C&&Array.isArray(C)&&(I.providerData=C.map(E=>({...E}))),u&&(I._redirectEventId=u),I}static async _fromIdTokenResponse(e,n,r=!1){const s=new Si;s.updateFromServerResponse(n);const i=new un({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await kc(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];re(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Q_(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),c=new Si;c.updateFromIdToken(r);const u=new un({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new qh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const My=new Map;function Kn(t){sr(t instanceof Function,"Expected a class definition");let e=My.get(t);return e?(sr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,My.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Y_.type="NONE";const Vy=Y_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ql(t,e,n){return`firebase:${t}:${e}:${n}`}class Ai{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=ql(this.userKey,s.apiKey,i),this.fullPersistenceKey=ql("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Nc(this.auth,{idToken:e}).catch(()=>{});return n?un._fromGetAccountInfoResponse(this.auth,n,e):null}return un._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Ai(Kn(Vy),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Kn(Vy);const o=ql(r,e.config.apiKey,e.name);let c=null;for(const d of n)try{const f=await d._get(o);if(f){let m;if(typeof f=="string"){const g=await Nc(e,{idToken:f}).catch(()=>{});if(!g)break;m=await un._fromGetAccountInfoResponse(e,g,f)}else m=un._fromJSON(e,f);d!==i&&(c=m),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new Ai(i,e,r):(i=u[0],c&&await i._set(o,c.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new Ai(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oy(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(e1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(X_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(n1(e))return"Blackberry";if(r1(e))return"Webos";if(J_(e))return"Safari";if((e.includes("chrome/")||Z_(e))&&!e.includes("edge/"))return"Chrome";if(t1(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function X_(t=vt()){return/firefox\//i.test(t)}function J_(t=vt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Z_(t=vt()){return/crios\//i.test(t)}function e1(t=vt()){return/iemobile/i.test(t)}function t1(t=vt()){return/android/i.test(t)}function n1(t=vt()){return/blackberry/i.test(t)}function r1(t=vt()){return/webos/i.test(t)}function ym(t=vt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function SA(t=vt()){var e;return ym(t)&&!!((e=window.navigator)!=null&&e.standalone)}function AA(){return Bb()&&document.documentMode===10}function s1(t=vt()){return ym(t)||t1(t)||r1(t)||n1(t)||/windows phone/i.test(t)||e1(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i1(t,e=[]){let n;switch(t){case"Browser":n=Oy(vt());break;case"Worker":n=`${Oy(vt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Xi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,c)=>{try{const u=e(i);o(u)}catch(u){c(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kA(t,e={}){return ur(t,"GET","/v2/passwordPolicy",cr(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CA=6;class PA{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??CA,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Fy(this),this.idTokenSubscription=new Fy(this),this.beforeStateQueue=new NA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=q_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Kn(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Ai.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Nc(this,{idToken:e}),r=await un._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Gt(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,c=r==null?void 0:r._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&(u!=null&&u.user)&&(r=u.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await kc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=uA()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Gt(this.app))return Promise.reject(Xn(this));const n=e?Me(e):null;return n&&re(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Gt(this.app)?Promise.reject(Xn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Gt(this.app)?Promise.reject(Xn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Kn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await kA(this),n=new PA(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ks("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await bA(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Kn(e)||this._popupRedirectResolver;re(n,this,"argument-error"),this.redirectPersistenceManager=await Ai.create(this,[Kn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(re(c,this,"internal-error"),c.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=i1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Gt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&aA(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function ss(t){return Me(t)}class Fy{constructor(e){this.auth=e,this.observer=null,this.addObserver=Gb(n=>this.observer=n)}get next(){return re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function jA(t){fu=t}function o1(t){return fu.loadJS(t)}function DA(){return fu.recaptchaEnterpriseScript}function LA(){return fu.gapiScript}function MA(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class VA{constructor(){this.enterprise=new OA}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class OA{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const FA="recaptcha-enterprise",a1="NO_RECAPTCHA";class UA{constructor(e){this.type=FA,this.auth=ss(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,c)=>{yA(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new gA(u);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(u=>{c(u)})})}function s(i,o,c){const u=window.grecaptcha;Dy(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(a1)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new VA().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(c=>{if(!n&&Dy(window.grecaptcha))s(c,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=DA();u.length!==0&&(u+=c),o1(u).then(()=>{s(c,i,o)}).catch(d=>{o(d)})}}).catch(c=>{o(c)})})}}async function Uy(t,e,n,r=!1,s=!1){const i=new UA(t);let o;if(s)o=a1;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const c={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Cc(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Uy(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await Uy(t,e,n,n==="getOobCode");return r(t,c)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BA(t,e){const n=Yi(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Wr(i,e??{}))return s;pn(s,"already-initialized")}return n.initialize({options:e})}function $A(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Kn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function zA(t,e,n){const r=ss(t);re(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=l1(e),{host:o,port:c}=qA(e),u=c===null?"":`:${c}`,d={url:`${i}//${o}${u}/`},f=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){re(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),re(Wr(d,r.config.emulator)&&Wr(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,Qi(o)?(L_(`${i}//${o}${u}`),M_("Auth",!0)):HA()}function l1(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function qA(t){const e=l1(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:By(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:By(o)}}}function By(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function HA(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Wn("not implemented")}_getIdTokenResponse(e){return Wn("not implemented")}_linkToIdToken(e,n){return Wn("not implemented")}_getReauthenticationResolver(e){return Wn("not implemented")}}async function WA(t,e){return ur(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KA(t,e){return Fa(t,"POST","/v1/accounts:signInWithPassword",cr(t,e))}async function GA(t,e){return ur(t,"POST","/v1/accounts:sendOobCode",cr(t,e))}async function QA(t,e){return GA(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YA(t,e){return Fa(t,"POST","/v1/accounts:signInWithEmailLink",cr(t,e))}async function XA(t,e){return Fa(t,"POST","/v1/accounts:signInWithEmailLink",cr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea extends vm{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Ea(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Ea(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Cc(e,n,"signInWithPassword",KA);case"emailLink":return YA(e,{email:this._email,oobCode:this._password});default:pn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Cc(e,r,"signUpPassword",WA);case"emailLink":return XA(e,{idToken:n,email:this._email,oobCode:this._password});default:pn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ni(t,e){return Fa(t,"POST","/v1/accounts:signInWithIdp",cr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JA="http://localhost";class Os extends vm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Os(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):pn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new Os(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ni(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ni(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ni(e,n)}buildRequest(){const e={requestUri:JA,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Va(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZA(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function eN(t){const e=Mo(Vo(t)).link,n=e?Mo(Vo(e)).deep_link_id:null,r=Mo(Vo(t)).deep_link_id;return(r?Mo(Vo(r)).link:null)||r||n||e||t}class wm{constructor(e){const n=Mo(Vo(e)),r=n.apiKey??null,s=n.oobCode??null,i=ZA(n.mode??null);re(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=eN(e);try{return new wm(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(){this.providerId=Ji.PROVIDER_ID}static credential(e,n){return Ea._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=wm.parseLink(n);return re(r,"argument-error"),Ea._fromEmailAndCode(e,r.code,r.tenantId)}}Ji.PROVIDER_ID="password";Ji.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ji.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua extends c1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir extends Ua{constructor(){super("facebook.com")}static credential(e){return Os._fromParams({providerId:Ir.PROVIDER_ID,signInMethod:Ir.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ir.credentialFromTaggedObject(e)}static credentialFromError(e){return Ir.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ir.credential(e.oauthAccessToken)}catch{return null}}}Ir.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ir.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br extends Ua{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Os._fromParams({providerId:br.PROVIDER_ID,signInMethod:br.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return br.credentialFromTaggedObject(e)}static credentialFromError(e){return br.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return br.credential(n,r)}catch{return null}}}br.GOOGLE_SIGN_IN_METHOD="google.com";br.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr extends Ua{constructor(){super("github.com")}static credential(e){return Os._fromParams({providerId:Sr.PROVIDER_ID,signInMethod:Sr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Sr.credentialFromTaggedObject(e)}static credentialFromError(e){return Sr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Sr.credential(e.oauthAccessToken)}catch{return null}}}Sr.GITHUB_SIGN_IN_METHOD="github.com";Sr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar extends Ua{constructor(){super("twitter.com")}static credential(e,n){return Os._fromParams({providerId:Ar.PROVIDER_ID,signInMethod:Ar.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ar.credentialFromTaggedObject(e)}static credentialFromError(e){return Ar.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ar.credential(n,r)}catch{return null}}}Ar.TWITTER_SIGN_IN_METHOD="twitter.com";Ar.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tN(t,e){return Fa(t,"POST","/v1/accounts:signUp",cr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await un._fromIdTokenResponse(e,r,s),o=$y(r);return new Fs({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=$y(r);return new Fs({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function $y(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc extends Mn{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Pc.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Pc(e,n,r,s)}}function u1(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Pc._fromErrorAndOperation(t,i,e,r):i})}async function nN(t,e,n=!1){const r=await xa(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Fs._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rN(t,e,n=!1){const{auth:r}=t;if(Gt(r.app))return Promise.reject(Xn(r));const s="reauthenticate";try{const i=await xa(t,u1(r,s,e,t),n);re(i.idToken,r,"internal-error");const o=gm(i.idToken);re(o,r,"internal-error");const{sub:c}=o;return re(t.uid===c,r,"user-mismatch"),Fs._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&pn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d1(t,e,n=!1){if(Gt(t.app))return Promise.reject(Xn(t));const r="signIn",s=await u1(t,r,e),i=await Fs._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function sN(t,e){return d1(ss(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h1(t){const e=ss(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function f1(t,e,n){const r=ss(t);await Cc(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",QA)}async function m1(t,e,n){if(Gt(t.app))return Promise.reject(Xn(t));const r=ss(t),o=await Cc(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",tN).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&h1(t),u}),c=await Fs._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function p1(t,e,n){return Gt(t.app)?Promise.reject(Xn(t)):sN(Me(t),Ji.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&h1(t),r})}function iN(t,e,n,r){return Me(t).onIdTokenChanged(e,n,r)}function oN(t,e,n){return Me(t).beforeAuthStateChanged(e,n)}function g1(t,e,n,r){return Me(t).onAuthStateChanged(e,n,r)}function ki(t){return Me(t).signOut()}const Rc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Rc,"1"),this.storage.removeItem(Rc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aN=1e3,lN=10;class v1 extends y1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=s1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);AA()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,lN):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},aN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}v1.type="LOCAL";const cN=v1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1 extends y1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}w1.type="SESSION";const _1=w1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uN(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new mu(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(o).map(async d=>d(n.origin,i)),u=await uN(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}mu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _m(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((c,u)=>{const d=_m("",20);s.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const g=m;if(g.data.eventId===d)switch(g.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(g.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kn(){return window}function hN(t){kn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x1(){return typeof kn().WorkerGlobalScope<"u"&&typeof kn().importScripts=="function"}async function fN(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function mN(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function pN(){return x1()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E1="firebaseLocalStorageDb",gN=1,jc="firebaseLocalStorage",T1="fbase_key";class Ba{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function pu(t,e){return t.transaction([jc],e?"readwrite":"readonly").objectStore(jc)}function yN(){const t=indexedDB.deleteDatabase(E1);return new Ba(t).toPromise()}function Hh(){const t=indexedDB.open(E1,gN);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(jc,{keyPath:T1})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(jc)?e(r):(r.close(),await yN(),e(await Hh()))})})}async function zy(t,e,n){const r=pu(t,!0).put({[T1]:e,value:n});return new Ba(r).toPromise()}async function vN(t,e){const n=pu(t,!1).get(e),r=await new Ba(n).toPromise();return r===void 0?null:r.value}function qy(t,e){const n=pu(t,!0).delete(e);return new Ba(n).toPromise()}const wN=800,_N=3;class I1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Hh(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>_N)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return x1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=mu._getInstance(pN()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await fN(),!this.activeServiceWorker)return;this.sender=new dN(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||mN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Hh();return await zy(e,Rc,"1"),await qy(e,Rc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>zy(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>vN(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>qy(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=pu(s,!1).getAll();return new Ba(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),wN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}I1.type="LOCAL";const xN=I1;new Oa(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EN(t,e){return e?Kn(e):(re(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xm extends vm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ni(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ni(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ni(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function TN(t){return d1(t.auth,new xm(t),t.bypassAuthState)}function IN(t){const{auth:e,user:n}=t;return re(n,e,"internal-error"),rN(n,new xm(t),t.bypassAuthState)}async function bN(t){const{auth:e,user:n}=t;return re(n,e,"internal-error"),nN(n,new xm(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return TN;case"linkViaPopup":case"linkViaRedirect":return bN;case"reauthViaPopup":case"reauthViaRedirect":return IN;default:pn(this.auth,"internal-error")}}resolve(e){sr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){sr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SN=new Oa(2e3,1e4);class wi extends b1{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,wi.currentPopupAction&&wi.currentPopupAction.cancel(),wi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return re(e,this.auth,"internal-error"),e}async onExecution(){sr(this.filter.length===1,"Popup operations only handle one event");const e=_m();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Nn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Nn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,wi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Nn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,SN.get())};e()}}wi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AN="pendingRedirect",Hl=new Map;class NN extends b1{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Hl.get(this.auth._key());if(!e){try{const r=await kN(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Hl.set(this.auth._key(),e)}return this.bypassAuthState||Hl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function kN(t,e){const n=RN(e),r=PN(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function CN(t,e){Hl.set(t._key(),e)}function PN(t){return Kn(t._redirectPersistence)}function RN(t){return ql(AN,t.config.apiKey,t.name)}async function jN(t,e,n=!1){if(Gt(t.app))return Promise.reject(Xn(t));const r=ss(t),s=EN(r,e),o=await new NN(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DN=10*60*1e3;class LN{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!MN(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!S1(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Nn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=DN&&this.cachedEventUids.clear(),this.cachedEventUids.has(Hy(e))}saveEventToCache(e){this.cachedEventUids.add(Hy(e)),this.lastProcessedEventTime=Date.now()}}function Hy(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function S1({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function MN(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return S1(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VN(t,e={}){return ur(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ON=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,FN=/^https?/;async function UN(t){if(t.config.emulator)return;const{authorizedDomains:e}=await VN(t);for(const n of e)try{if(BN(n))return}catch{}pn(t,"unauthorized-domain")}function BN(t){const e=zh(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!FN.test(n))return!1;if(ON.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $N=new Oa(3e4,6e4);function Wy(){const t=kn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function zN(t){return new Promise((e,n)=>{var s,i,o;function r(){Wy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Wy(),n(Nn(t,"network-request-failed"))},timeout:$N.get()})}if((i=(s=kn().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=kn().gapi)!=null&&o.load)r();else{const c=MA("iframefcb");return kn()[c]=()=>{gapi.load?r():n(Nn(t,"network-request-failed"))},o1(`${LA()}?onload=${c}`).catch(u=>n(u))}}).catch(e=>{throw Wl=null,e})}let Wl=null;function qN(t){return Wl=Wl||zN(t),Wl}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HN=new Oa(5e3,15e3),WN="__/auth/iframe",KN="emulator/auth/iframe",GN={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},QN=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function YN(t){const e=t.config;re(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?pm(e,KN):`https://${t.config.authDomain}/${WN}`,r={apiKey:e.apiKey,appName:t.name,v:Xi},s=QN.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Va(r).slice(1)}`}async function XN(t){const e=await qN(t),n=kn().gapi;return re(n,t,"internal-error"),e.open({where:document.body,url:YN(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:GN,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Nn(t,"network-request-failed"),c=kn().setTimeout(()=>{i(o)},HN.get());function u(){kn().clearTimeout(c),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JN={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ZN=500,ek=600,tk="_blank",nk="http://localhost";class Ky{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function rk(t,e,n,r=ZN,s=ek){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u={...JN,width:r.toString(),height:s.toString(),top:i,left:o},d=vt().toLowerCase();n&&(c=Z_(d)?tk:n),X_(d)&&(e=e||nk,u.scrollbars="yes");const f=Object.entries(u).reduce((g,[T,C])=>`${g}${T}=${C},`,"");if(SA(d)&&c!=="_self")return sk(e||"",c),new Ky(null);const m=window.open(e||"",c,f);re(m,t,"popup-blocked");try{m.focus()}catch{}return new Ky(m)}function sk(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ik="__/auth/handler",ok="emulator/auth/handler",ak=encodeURIComponent("fac");async function Gy(t,e,n,r,s,i){re(t.config.authDomain,t,"auth-domain-config-required"),re(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Xi,eventId:s};if(e instanceof c1){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Kb(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))o[f]=m}if(e instanceof Ua){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const u=await t._getAppCheckToken(),d=u?`#${ak}=${encodeURIComponent(u)}`:"";return`${lk(t)}?${Va(c).slice(1)}${d}`}function lk({config:t}){return t.emulator?pm(t,ok):`https://${t.authDomain}/${ik}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dd="webStorageSupport";class ck{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=_1,this._completeRedirectFn=jN,this._overrideRedirectResult=CN}async _openPopup(e,n,r,s){var o;sr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await Gy(e,n,r,zh(),s);return rk(e,i,_m())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await Gy(e,n,r,zh(),s);return hN(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(sr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await XN(e),r=new LN(e);return n.register("authEvent",s=>(re(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Dd,{type:Dd},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Dd];i!==void 0&&n(!!i),pn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=UN(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return s1()||J_()||ym()}}const uk=ck;var Qy="@firebase/auth",Yy="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hk(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function fk(t){Dn(new mn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;re(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:i1(t)},d=new RA(r,s,i,u);return $A(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Dn(new mn("auth-internal",e=>{const n=ss(e.getProvider("auth").getImmediate());return(r=>new dk(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Jt(Qy,Yy,hk(t)),Jt(Qy,Yy,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mk=5*60,pk=D_("authIdTokenMaxAge")||mk;let Xy=null;const gk=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>pk)return;const s=n==null?void 0:n.token;Xy!==s&&(Xy=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function A1(t=fm()){const e=Yi(t,"auth");if(e.isInitialized())return e.getImmediate();const n=BA(t,{popupRedirectResolver:uk,persistence:[xN,cN,_1]}),r=D_("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=gk(i.toString());oN(n,o,()=>o(n.currentUser)),iN(n,c=>o(c))}}const s=R_("auth");return s&&zA(n,`http://${s}`),n}function yk(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}jA({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Nn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",yk().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});fk("Browser");var Jy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ur,N1;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(y,v){function b(){}b.prototype=v.prototype,y.F=v.prototype,y.prototype=new b,y.prototype.constructor=y,y.D=function(k,_,N){for(var x=Array(arguments.length-2),ie=2;ie<arguments.length;ie++)x[ie-2]=arguments[ie];return v.prototype[_].apply(k,x)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(y,v,b){b||(b=0);const k=Array(16);if(typeof v=="string")for(var _=0;_<16;++_)k[_]=v.charCodeAt(b++)|v.charCodeAt(b++)<<8|v.charCodeAt(b++)<<16|v.charCodeAt(b++)<<24;else for(_=0;_<16;++_)k[_]=v[b++]|v[b++]<<8|v[b++]<<16|v[b++]<<24;v=y.g[0],b=y.g[1],_=y.g[2];let N=y.g[3],x;x=v+(N^b&(_^N))+k[0]+3614090360&4294967295,v=b+(x<<7&4294967295|x>>>25),x=N+(_^v&(b^_))+k[1]+3905402710&4294967295,N=v+(x<<12&4294967295|x>>>20),x=_+(b^N&(v^b))+k[2]+606105819&4294967295,_=N+(x<<17&4294967295|x>>>15),x=b+(v^_&(N^v))+k[3]+3250441966&4294967295,b=_+(x<<22&4294967295|x>>>10),x=v+(N^b&(_^N))+k[4]+4118548399&4294967295,v=b+(x<<7&4294967295|x>>>25),x=N+(_^v&(b^_))+k[5]+1200080426&4294967295,N=v+(x<<12&4294967295|x>>>20),x=_+(b^N&(v^b))+k[6]+2821735955&4294967295,_=N+(x<<17&4294967295|x>>>15),x=b+(v^_&(N^v))+k[7]+4249261313&4294967295,b=_+(x<<22&4294967295|x>>>10),x=v+(N^b&(_^N))+k[8]+1770035416&4294967295,v=b+(x<<7&4294967295|x>>>25),x=N+(_^v&(b^_))+k[9]+2336552879&4294967295,N=v+(x<<12&4294967295|x>>>20),x=_+(b^N&(v^b))+k[10]+4294925233&4294967295,_=N+(x<<17&4294967295|x>>>15),x=b+(v^_&(N^v))+k[11]+2304563134&4294967295,b=_+(x<<22&4294967295|x>>>10),x=v+(N^b&(_^N))+k[12]+1804603682&4294967295,v=b+(x<<7&4294967295|x>>>25),x=N+(_^v&(b^_))+k[13]+4254626195&4294967295,N=v+(x<<12&4294967295|x>>>20),x=_+(b^N&(v^b))+k[14]+2792965006&4294967295,_=N+(x<<17&4294967295|x>>>15),x=b+(v^_&(N^v))+k[15]+1236535329&4294967295,b=_+(x<<22&4294967295|x>>>10),x=v+(_^N&(b^_))+k[1]+4129170786&4294967295,v=b+(x<<5&4294967295|x>>>27),x=N+(b^_&(v^b))+k[6]+3225465664&4294967295,N=v+(x<<9&4294967295|x>>>23),x=_+(v^b&(N^v))+k[11]+643717713&4294967295,_=N+(x<<14&4294967295|x>>>18),x=b+(N^v&(_^N))+k[0]+3921069994&4294967295,b=_+(x<<20&4294967295|x>>>12),x=v+(_^N&(b^_))+k[5]+3593408605&4294967295,v=b+(x<<5&4294967295|x>>>27),x=N+(b^_&(v^b))+k[10]+38016083&4294967295,N=v+(x<<9&4294967295|x>>>23),x=_+(v^b&(N^v))+k[15]+3634488961&4294967295,_=N+(x<<14&4294967295|x>>>18),x=b+(N^v&(_^N))+k[4]+3889429448&4294967295,b=_+(x<<20&4294967295|x>>>12),x=v+(_^N&(b^_))+k[9]+568446438&4294967295,v=b+(x<<5&4294967295|x>>>27),x=N+(b^_&(v^b))+k[14]+3275163606&4294967295,N=v+(x<<9&4294967295|x>>>23),x=_+(v^b&(N^v))+k[3]+4107603335&4294967295,_=N+(x<<14&4294967295|x>>>18),x=b+(N^v&(_^N))+k[8]+1163531501&4294967295,b=_+(x<<20&4294967295|x>>>12),x=v+(_^N&(b^_))+k[13]+2850285829&4294967295,v=b+(x<<5&4294967295|x>>>27),x=N+(b^_&(v^b))+k[2]+4243563512&4294967295,N=v+(x<<9&4294967295|x>>>23),x=_+(v^b&(N^v))+k[7]+1735328473&4294967295,_=N+(x<<14&4294967295|x>>>18),x=b+(N^v&(_^N))+k[12]+2368359562&4294967295,b=_+(x<<20&4294967295|x>>>12),x=v+(b^_^N)+k[5]+4294588738&4294967295,v=b+(x<<4&4294967295|x>>>28),x=N+(v^b^_)+k[8]+2272392833&4294967295,N=v+(x<<11&4294967295|x>>>21),x=_+(N^v^b)+k[11]+1839030562&4294967295,_=N+(x<<16&4294967295|x>>>16),x=b+(_^N^v)+k[14]+4259657740&4294967295,b=_+(x<<23&4294967295|x>>>9),x=v+(b^_^N)+k[1]+2763975236&4294967295,v=b+(x<<4&4294967295|x>>>28),x=N+(v^b^_)+k[4]+1272893353&4294967295,N=v+(x<<11&4294967295|x>>>21),x=_+(N^v^b)+k[7]+4139469664&4294967295,_=N+(x<<16&4294967295|x>>>16),x=b+(_^N^v)+k[10]+3200236656&4294967295,b=_+(x<<23&4294967295|x>>>9),x=v+(b^_^N)+k[13]+681279174&4294967295,v=b+(x<<4&4294967295|x>>>28),x=N+(v^b^_)+k[0]+3936430074&4294967295,N=v+(x<<11&4294967295|x>>>21),x=_+(N^v^b)+k[3]+3572445317&4294967295,_=N+(x<<16&4294967295|x>>>16),x=b+(_^N^v)+k[6]+76029189&4294967295,b=_+(x<<23&4294967295|x>>>9),x=v+(b^_^N)+k[9]+3654602809&4294967295,v=b+(x<<4&4294967295|x>>>28),x=N+(v^b^_)+k[12]+3873151461&4294967295,N=v+(x<<11&4294967295|x>>>21),x=_+(N^v^b)+k[15]+530742520&4294967295,_=N+(x<<16&4294967295|x>>>16),x=b+(_^N^v)+k[2]+3299628645&4294967295,b=_+(x<<23&4294967295|x>>>9),x=v+(_^(b|~N))+k[0]+4096336452&4294967295,v=b+(x<<6&4294967295|x>>>26),x=N+(b^(v|~_))+k[7]+1126891415&4294967295,N=v+(x<<10&4294967295|x>>>22),x=_+(v^(N|~b))+k[14]+2878612391&4294967295,_=N+(x<<15&4294967295|x>>>17),x=b+(N^(_|~v))+k[5]+4237533241&4294967295,b=_+(x<<21&4294967295|x>>>11),x=v+(_^(b|~N))+k[12]+1700485571&4294967295,v=b+(x<<6&4294967295|x>>>26),x=N+(b^(v|~_))+k[3]+2399980690&4294967295,N=v+(x<<10&4294967295|x>>>22),x=_+(v^(N|~b))+k[10]+4293915773&4294967295,_=N+(x<<15&4294967295|x>>>17),x=b+(N^(_|~v))+k[1]+2240044497&4294967295,b=_+(x<<21&4294967295|x>>>11),x=v+(_^(b|~N))+k[8]+1873313359&4294967295,v=b+(x<<6&4294967295|x>>>26),x=N+(b^(v|~_))+k[15]+4264355552&4294967295,N=v+(x<<10&4294967295|x>>>22),x=_+(v^(N|~b))+k[6]+2734768916&4294967295,_=N+(x<<15&4294967295|x>>>17),x=b+(N^(_|~v))+k[13]+1309151649&4294967295,b=_+(x<<21&4294967295|x>>>11),x=v+(_^(b|~N))+k[4]+4149444226&4294967295,v=b+(x<<6&4294967295|x>>>26),x=N+(b^(v|~_))+k[11]+3174756917&4294967295,N=v+(x<<10&4294967295|x>>>22),x=_+(v^(N|~b))+k[2]+718787259&4294967295,_=N+(x<<15&4294967295|x>>>17),x=b+(N^(_|~v))+k[9]+3951481745&4294967295,y.g[0]=y.g[0]+v&4294967295,y.g[1]=y.g[1]+(_+(x<<21&4294967295|x>>>11))&4294967295,y.g[2]=y.g[2]+_&4294967295,y.g[3]=y.g[3]+N&4294967295}r.prototype.v=function(y,v){v===void 0&&(v=y.length);const b=v-this.blockSize,k=this.C;let _=this.h,N=0;for(;N<v;){if(_==0)for(;N<=b;)s(this,y,N),N+=this.blockSize;if(typeof y=="string"){for(;N<v;)if(k[_++]=y.charCodeAt(N++),_==this.blockSize){s(this,k),_=0;break}}else for(;N<v;)if(k[_++]=y[N++],_==this.blockSize){s(this,k),_=0;break}}this.h=_,this.o+=v},r.prototype.A=function(){var y=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);y[0]=128;for(var v=1;v<y.length-8;++v)y[v]=0;v=this.o*8;for(var b=y.length-8;b<y.length;++b)y[b]=v&255,v/=256;for(this.v(y),y=Array(16),v=0,b=0;b<4;++b)for(let k=0;k<32;k+=8)y[v++]=this.g[b]>>>k&255;return y};function i(y,v){var b=c;return Object.prototype.hasOwnProperty.call(b,y)?b[y]:b[y]=v(y)}function o(y,v){this.h=v;const b=[];let k=!0;for(let _=y.length-1;_>=0;_--){const N=y[_]|0;k&&N==v||(b[_]=N,k=!1)}this.g=b}var c={};function u(y){return-128<=y&&y<128?i(y,function(v){return new o([v|0],v<0?-1:0)}):new o([y|0],y<0?-1:0)}function d(y){if(isNaN(y)||!isFinite(y))return m;if(y<0)return S(d(-y));const v=[];let b=1;for(let k=0;y>=b;k++)v[k]=y/b|0,b*=4294967296;return new o(v,0)}function f(y,v){if(y.length==0)throw Error("number format error: empty string");if(v=v||10,v<2||36<v)throw Error("radix out of range: "+v);if(y.charAt(0)=="-")return S(f(y.substring(1),v));if(y.indexOf("-")>=0)throw Error('number format error: interior "-" character');const b=d(Math.pow(v,8));let k=m;for(let N=0;N<y.length;N+=8){var _=Math.min(8,y.length-N);const x=parseInt(y.substring(N,N+_),v);_<8?(_=d(Math.pow(v,_)),k=k.j(_).add(d(x))):(k=k.j(b),k=k.add(d(x)))}return k}var m=u(0),g=u(1),T=u(16777216);t=o.prototype,t.m=function(){if(P(this))return-S(this).m();let y=0,v=1;for(let b=0;b<this.g.length;b++){const k=this.i(b);y+=(k>=0?k:4294967296+k)*v,v*=4294967296}return y},t.toString=function(y){if(y=y||10,y<2||36<y)throw Error("radix out of range: "+y);if(C(this))return"0";if(P(this))return"-"+S(this).toString(y);const v=d(Math.pow(y,6));var b=this;let k="";for(;;){const _=D(b,v).g;b=I(b,_.j(v));let N=((b.g.length>0?b.g[0]:b.h)>>>0).toString(y);if(b=_,C(b))return N+k;for(;N.length<6;)N="0"+N;k=N+k}},t.i=function(y){return y<0?0:y<this.g.length?this.g[y]:this.h};function C(y){if(y.h!=0)return!1;for(let v=0;v<y.g.length;v++)if(y.g[v]!=0)return!1;return!0}function P(y){return y.h==-1}t.l=function(y){return y=I(this,y),P(y)?-1:C(y)?0:1};function S(y){const v=y.g.length,b=[];for(let k=0;k<v;k++)b[k]=~y.g[k];return new o(b,~y.h).add(g)}t.abs=function(){return P(this)?S(this):this},t.add=function(y){const v=Math.max(this.g.length,y.g.length),b=[];let k=0;for(let _=0;_<=v;_++){let N=k+(this.i(_)&65535)+(y.i(_)&65535),x=(N>>>16)+(this.i(_)>>>16)+(y.i(_)>>>16);k=x>>>16,N&=65535,x&=65535,b[_]=x<<16|N}return new o(b,b[b.length-1]&-2147483648?-1:0)};function I(y,v){return y.add(S(v))}t.j=function(y){if(C(this)||C(y))return m;if(P(this))return P(y)?S(this).j(S(y)):S(S(this).j(y));if(P(y))return S(this.j(S(y)));if(this.l(T)<0&&y.l(T)<0)return d(this.m()*y.m());const v=this.g.length+y.g.length,b=[];for(var k=0;k<2*v;k++)b[k]=0;for(k=0;k<this.g.length;k++)for(let _=0;_<y.g.length;_++){const N=this.i(k)>>>16,x=this.i(k)&65535,ie=y.i(_)>>>16,Ve=y.i(_)&65535;b[2*k+2*_]+=x*Ve,E(b,2*k+2*_),b[2*k+2*_+1]+=N*Ve,E(b,2*k+2*_+1),b[2*k+2*_+1]+=x*ie,E(b,2*k+2*_+1),b[2*k+2*_+2]+=N*ie,E(b,2*k+2*_+2)}for(y=0;y<v;y++)b[y]=b[2*y+1]<<16|b[2*y];for(y=v;y<2*v;y++)b[y]=0;return new o(b,0)};function E(y,v){for(;(y[v]&65535)!=y[v];)y[v+1]+=y[v]>>>16,y[v]&=65535,v++}function A(y,v){this.g=y,this.h=v}function D(y,v){if(C(v))throw Error("division by zero");if(C(y))return new A(m,m);if(P(y))return v=D(S(y),v),new A(S(v.g),S(v.h));if(P(v))return v=D(y,S(v)),new A(S(v.g),v.h);if(y.g.length>30){if(P(y)||P(v))throw Error("slowDivide_ only works with positive integers.");for(var b=g,k=v;k.l(y)<=0;)b=V(b),k=V(k);var _=B(b,1),N=B(k,1);for(k=B(k,2),b=B(b,2);!C(k);){var x=N.add(k);x.l(y)<=0&&(_=_.add(b),N=x),k=B(k,1),b=B(b,1)}return v=I(y,_.j(v)),new A(_,v)}for(_=m;y.l(v)>=0;){for(b=Math.max(1,Math.floor(y.m()/v.m())),k=Math.ceil(Math.log(b)/Math.LN2),k=k<=48?1:Math.pow(2,k-48),N=d(b),x=N.j(v);P(x)||x.l(y)>0;)b-=k,N=d(b),x=N.j(v);C(N)&&(N=g),_=_.add(N),y=I(y,x)}return new A(_,y)}t.B=function(y){return D(this,y).h},t.and=function(y){const v=Math.max(this.g.length,y.g.length),b=[];for(let k=0;k<v;k++)b[k]=this.i(k)&y.i(k);return new o(b,this.h&y.h)},t.or=function(y){const v=Math.max(this.g.length,y.g.length),b=[];for(let k=0;k<v;k++)b[k]=this.i(k)|y.i(k);return new o(b,this.h|y.h)},t.xor=function(y){const v=Math.max(this.g.length,y.g.length),b=[];for(let k=0;k<v;k++)b[k]=this.i(k)^y.i(k);return new o(b,this.h^y.h)};function V(y){const v=y.g.length+1,b=[];for(let k=0;k<v;k++)b[k]=y.i(k)<<1|y.i(k-1)>>>31;return new o(b,y.h)}function B(y,v){const b=v>>5;v%=32;const k=y.g.length-b,_=[];for(let N=0;N<k;N++)_[N]=v>0?y.i(N+b)>>>v|y.i(N+b+1)<<32-v:y.i(N+b);return new o(_,y.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,N1=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=f,Ur=o}).apply(typeof Jy<"u"?Jy:typeof self<"u"?self:typeof window<"u"?window:{});var Tl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var k1,Oo,C1,Kl,Wh,P1,R1,j1;(function(){var t,e=Object.defineProperty;function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Tl=="object"&&Tl];for(var h=0;h<a.length;++h){var p=a[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=n(this);function s(a,h){if(h)e:{var p=r;a=a.split(".");for(var w=0;w<a.length-1;w++){var j=a[w];if(!(j in p))break e;p=p[j]}a=a[a.length-1],w=p[a],h=h(w),h!=w&&h!=null&&e(p,a,{configurable:!0,writable:!0,value:h})}}s("Symbol.dispose",function(a){return a||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(a){return a||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(a){return a||function(h){var p=[],w;for(w in h)Object.prototype.hasOwnProperty.call(h,w)&&p.push([w,h[w]]);return p}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function c(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function u(a,h,p){return a.call.apply(a.bind,arguments)}function d(a,h,p){return d=u,d.apply(null,arguments)}function f(a,h){var p=Array.prototype.slice.call(arguments,1);return function(){var w=p.slice();return w.push.apply(w,arguments),a.apply(this,w)}}function m(a,h){function p(){}p.prototype=h.prototype,a.Z=h.prototype,a.prototype=new p,a.prototype.constructor=a,a.Ob=function(w,j,M){for(var G=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)G[ce-2]=arguments[ce];return h.prototype[j].apply(w,G)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?a=>a&&AsyncContext.Snapshot.wrap(a):a=>a;function T(a){const h=a.length;if(h>0){const p=Array(h);for(let w=0;w<h;w++)p[w]=a[w];return p}return[]}function C(a,h){for(let w=1;w<arguments.length;w++){const j=arguments[w];var p=typeof j;if(p=p!="object"?p:j?Array.isArray(j)?"array":p:"null",p=="array"||p=="object"&&typeof j.length=="number"){p=a.length||0;const M=j.length||0;a.length=p+M;for(let G=0;G<M;G++)a[p+G]=j[G]}else a.push(j)}}class P{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return this.h>0?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function S(a){o.setTimeout(()=>{throw a},0)}function I(){var a=y;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class E{constructor(){this.h=this.g=null}add(h,p){const w=A.get();w.set(h,p),this.h?this.h.next=w:this.g=w,this.h=w}}var A=new P(()=>new D,a=>a.reset());class D{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let V,B=!1,y=new E,v=()=>{const a=Promise.resolve(void 0);V=()=>{a.then(b)}};function b(){for(var a;a=I();){try{a.h.call(a.g)}catch(p){S(p)}var h=A;h.j(a),h.h<100&&(h.h++,a.next=h.g,h.g=a)}B=!1}function k(){this.u=this.u,this.C=this.C}k.prototype.u=!1,k.prototype.dispose=function(){this.u||(this.u=!0,this.N())},k.prototype[Symbol.dispose]=function(){this.dispose()},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function _(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}_.prototype.h=function(){this.defaultPrevented=!0};var N=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const p=()=>{};o.addEventListener("test",p,h),o.removeEventListener("test",p,h)}catch{}return a}();function x(a){return/^[\s\xa0]*$/.test(a)}function ie(a,h){_.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a&&this.init(a,h)}m(ie,_),ie.prototype.init=function(a,h){const p=this.type=a.type,w=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget,h||(p=="mouseover"?h=a.fromElement:p=="mouseout"&&(h=a.toElement)),this.relatedTarget=h,w?(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=a.pointerType,this.state=a.state,this.i=a,a.defaultPrevented&&ie.Z.h.call(this)},ie.prototype.h=function(){ie.Z.h.call(this);const a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Ve="closure_listenable_"+(Math.random()*1e6|0),nn=0;function Vn(a,h,p,w,j){this.listener=a,this.proxy=null,this.src=h,this.type=p,this.capture=!!w,this.ha=j,this.key=++nn,this.da=this.fa=!1}function Q(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function ne(a,h,p){for(const w in a)h.call(p,a[w],w,a)}function ae(a,h){for(const p in a)h.call(void 0,a[p],p,a)}function we(a){const h={};for(const p in a)h[p]=a[p];return h}const Te="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rn(a,h){let p,w;for(let j=1;j<arguments.length;j++){w=arguments[j];for(p in w)a[p]=w[p];for(let M=0;M<Te.length;M++)p=Te[M],Object.prototype.hasOwnProperty.call(w,p)&&(a[p]=w[p])}}function lt(a){this.src=a,this.g={},this.h=0}lt.prototype.add=function(a,h,p,w,j){const M=a.toString();a=this.g[M],a||(a=this.g[M]=[],this.h++);const G=wt(a,h,w,j);return G>-1?(h=a[G],p||(h.fa=!1)):(h=new Vn(h,this.src,M,!!w,j),h.fa=p,a.push(h)),h};function sn(a,h){const p=h.type;if(p in a.g){var w=a.g[p],j=Array.prototype.indexOf.call(w,h,void 0),M;(M=j>=0)&&Array.prototype.splice.call(w,j,1),M&&(Q(h),a.g[p].length==0&&(delete a.g[p],a.h--))}}function wt(a,h,p,w){for(let j=0;j<a.length;++j){const M=a[j];if(!M.da&&M.listener==h&&M.capture==!!p&&M.ha==w)return j}return-1}var Ht="closure_lm_"+(Math.random()*1e6|0),as={};function Xs(a,h,p,w,j){if(Array.isArray(h)){for(let M=0;M<h.length;M++)Xs(a,h[M],p,w,j);return null}return p=L(p),a&&a[Ve]?a.J(h,p,c(w)?!!w.capture:!1,j):io(a,h,p,!1,w,j)}function io(a,h,p,w,j,M){if(!h)throw Error("Invalid event type");const G=c(j)?!!j.capture:!!j;let ce=cs(a);if(ce||(a[Ht]=ce=new lt(a)),p=ce.add(h,p,w,G,M),p.proxy)return p;if(w=oo(),p.proxy=w,w.src=a,w.listener=p,a.addEventListener)N||(j=G),j===void 0&&(j=!1),a.addEventListener(h.toString(),w,j);else if(a.attachEvent)a.attachEvent(Js(h.toString()),w);else if(a.addListener&&a.removeListener)a.addListener(w);else throw Error("addEventListener and attachEvent are unavailable.");return p}function oo(){function a(p){return h.call(a.src,a.listener,p)}const h=ao;return a}function dr(a,h,p,w,j){if(Array.isArray(h))for(var M=0;M<h.length;M++)dr(a,h[M],p,w,j);else w=c(w)?!!w.capture:!!w,p=L(p),a&&a[Ve]?(a=a.i,M=String(h).toString(),M in a.g&&(h=a.g[M],p=wt(h,p,w,j),p>-1&&(Q(h[p]),Array.prototype.splice.call(h,p,1),h.length==0&&(delete a.g[M],a.h--)))):a&&(a=cs(a))&&(h=a.g[h.toString()],a=-1,h&&(a=wt(h,p,w,j)),(p=a>-1?h[a]:null)&&ls(p))}function ls(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[Ve])sn(h.i,a);else{var p=a.type,w=a.proxy;h.removeEventListener?h.removeEventListener(p,w,a.capture):h.detachEvent?h.detachEvent(Js(p),w):h.addListener&&h.removeListener&&h.removeListener(w),(p=cs(h))?(sn(p,a),p.h==0&&(p.src=null,h[Ht]=null)):Q(a)}}}function Js(a){return a in as?as[a]:as[a]="on"+a}function ao(a,h){if(a.da)a=!0;else{h=new ie(h,this);const p=a.listener,w=a.ha||a.src;a.fa&&ls(a),a=p.call(w,h)}return a}function cs(a){return a=a[Ht],a instanceof lt?a:null}var us="__closure_events_fn_"+(Math.random()*1e9>>>0);function L(a){return typeof a=="function"?a:(a[us]||(a[us]=function(h){return a.handleEvent(h)}),a[us])}function U(){k.call(this),this.i=new lt(this),this.M=this,this.G=null}m(U,k),U.prototype[Ve]=!0,U.prototype.removeEventListener=function(a,h,p,w){dr(this,a,h,p,w)};function F(a,h){var p,w=a.G;if(w)for(p=[];w;w=w.G)p.push(w);if(a=a.M,w=h.type||h,typeof h=="string")h=new _(h,a);else if(h instanceof _)h.target=h.target||a;else{var j=h;h=new _(w,a),rn(h,j)}j=!0;let M,G;if(p)for(G=p.length-1;G>=0;G--)M=h.g=p[G],j=O(M,w,!0,h)&&j;if(M=h.g=a,j=O(M,w,!0,h)&&j,j=O(M,w,!1,h)&&j,p)for(G=0;G<p.length;G++)M=h.g=p[G],j=O(M,w,!1,h)&&j}U.prototype.N=function(){if(U.Z.N.call(this),this.i){var a=this.i;for(const h in a.g){const p=a.g[h];for(let w=0;w<p.length;w++)Q(p[w]);delete a.g[h],a.h--}}this.G=null},U.prototype.J=function(a,h,p,w){return this.i.add(String(a),h,!1,p,w)},U.prototype.K=function(a,h,p,w){return this.i.add(String(a),h,!0,p,w)};function O(a,h,p,w){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();let j=!0;for(let M=0;M<h.length;++M){const G=h[M];if(G&&!G.da&&G.capture==p){const ce=G.listener,He=G.ha||G.src;G.fa&&sn(a.i,G),j=ce.call(He,w)!==!1&&j}}return j&&!w.defaultPrevented}function W(a,h){if(typeof a!="function")if(a&&typeof a.handleEvent=="function")a=d(a.handleEvent,a);else throw Error("Invalid listener argument");return Number(h)>2147483647?-1:o.setTimeout(a,h||0)}function H(a){a.g=W(()=>{a.g=null,a.i&&(a.i=!1,H(a))},a.l);const h=a.h;a.h=null,a.m.apply(null,h)}class q extends k{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:H(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function J(a){k.call(this),this.h=a,this.g={}}m(J,k);var te=[];function ue(a){ne(a.g,function(h,p){this.g.hasOwnProperty(p)&&ls(h)},a),a.g={}}J.prototype.N=function(){J.Z.N.call(this),ue(this)},J.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Dt=o.JSON.stringify,BE=o.JSON.parse,$E=class{stringify(a){return o.JSON.stringify(a,void 0)}parse(a){return o.JSON.parse(a,void 0)}};function wp(){}function _p(){}var lo={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Fu(){_.call(this,"d")}m(Fu,_);function Uu(){_.call(this,"c")}m(Uu,_);var ds={},xp=null;function Ga(){return xp=xp||new U}ds.Ia="serverreachability";function Ep(a){_.call(this,ds.Ia,a)}m(Ep,_);function co(a){const h=Ga();F(h,new Ep(h))}ds.STAT_EVENT="statevent";function Tp(a,h){_.call(this,ds.STAT_EVENT,a),this.stat=h}m(Tp,_);function _t(a){const h=Ga();F(h,new Tp(h,a))}ds.Ja="timingevent";function Ip(a,h){_.call(this,ds.Ja,a),this.size=h}m(Ip,_);function uo(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){a()},h)}function ho(){this.g=!0}ho.prototype.ua=function(){this.g=!1};function zE(a,h,p,w,j,M){a.info(function(){if(a.g)if(M){var G="",ce=M.split("&");for(let _e=0;_e<ce.length;_e++){var He=ce[_e].split("=");if(He.length>1){const Je=He[0];He=He[1];const vn=Je.split("_");G=vn.length>=2&&vn[1]=="type"?G+(Je+"="+He+"&"):G+(Je+"=redacted&")}}}else G=null;else G=M;return"XMLHTTP REQ ("+w+") [attempt "+j+"]: "+h+`
`+p+`
`+G})}function qE(a,h,p,w,j,M,G){a.info(function(){return"XMLHTTP RESP ("+w+") [ attempt "+j+"]: "+h+`
`+p+`
`+M+" "+G})}function Zs(a,h,p,w){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+WE(a,p)+(w?" "+w:"")})}function HE(a,h){a.info(function(){return"TIMEOUT: "+h})}ho.prototype.info=function(){};function WE(a,h){if(!a.g)return h;if(!h)return null;try{const M=JSON.parse(h);if(M){for(a=0;a<M.length;a++)if(Array.isArray(M[a])){var p=M[a];if(!(p.length<2)){var w=p[1];if(Array.isArray(w)&&!(w.length<1)){var j=w[0];if(j!="noop"&&j!="stop"&&j!="close")for(let G=1;G<w.length;G++)w[G]=""}}}}return Dt(M)}catch{return h}}var Qa={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},bp={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Sp;function Bu(){}m(Bu,wp),Bu.prototype.g=function(){return new XMLHttpRequest},Sp=new Bu;function fo(a){return encodeURIComponent(String(a))}function KE(a){var h=1;a=a.split(":");const p=[];for(;h>0&&a.length;)p.push(a.shift()),h--;return a.length&&p.push(a.join(":")),p}function hr(a,h,p,w){this.j=a,this.i=h,this.l=p,this.S=w||1,this.V=new J(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ap}function Ap(){this.i=null,this.g="",this.h=!1}var Np={},$u={};function zu(a,h,p){a.M=1,a.A=Xa(yn(h)),a.u=p,a.R=!0,kp(a,null)}function kp(a,h){a.F=Date.now(),Ya(a),a.B=yn(a.A);var p=a.B,w=a.S;Array.isArray(w)||(w=[String(w)]),$p(p.i,"t",w),a.C=0,p=a.j.L,a.h=new Ap,a.g=og(a.j,p?h:null,!a.u),a.P>0&&(a.O=new q(d(a.Y,a,a.g),a.P)),h=a.V,p=a.g,w=a.ba;var j="readystatechange";Array.isArray(j)||(j&&(te[0]=j.toString()),j=te);for(let M=0;M<j.length;M++){const G=Xs(p,j[M],w||h.handleEvent,!1,h.h||h);if(!G)break;h.g[G.key]=G}h=a.J?we(a.J):{},a.u?(a.v||(a.v="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.B,a.v,a.u,h)):(a.v="GET",a.g.ea(a.B,a.v,null,h)),co(),zE(a.i,a.v,a.B,a.l,a.S,a.u)}hr.prototype.ba=function(a){a=a.target;const h=this.O;h&&pr(a)==3?h.j():this.Y(a)},hr.prototype.Y=function(a){try{if(a==this.g)e:{const ce=pr(this.g),He=this.g.ya(),_e=this.g.ca();if(!(ce<3)&&(ce!=3||this.g&&(this.h.h||this.g.la()||Qp(this.g)))){this.K||ce!=4||He==7||(He==8||_e<=0?co(3):co(2)),qu(this);var h=this.g.ca();this.X=h;var p=GE(this);if(this.o=h==200,qE(this.i,this.v,this.B,this.l,this.S,ce,h),this.o){if(this.U&&!this.L){t:{if(this.g){var w,j=this.g;if((w=j.g?j.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(w)){var M=w;break t}}M=null}if(a=M)Zs(this.i,this.l,a,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Hu(this,a);else{this.o=!1,this.m=3,_t(12),hs(this),mo(this);break e}}if(this.R){a=!0;let Je;for(;!this.K&&this.C<p.length;)if(Je=QE(this,p),Je==$u){ce==4&&(this.m=4,_t(14),a=!1),Zs(this.i,this.l,null,"[Incomplete Response]");break}else if(Je==Np){this.m=4,_t(15),Zs(this.i,this.l,p,"[Invalid Chunk]"),a=!1;break}else Zs(this.i,this.l,Je,null),Hu(this,Je);if(Cp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ce!=4||p.length!=0||this.h.h||(this.m=1,_t(16),a=!1),this.o=this.o&&a,!a)Zs(this.i,this.l,p,"[Invalid Chunked Response]"),hs(this),mo(this);else if(p.length>0&&!this.W){this.W=!0;var G=this.j;G.g==this&&G.aa&&!G.P&&(G.j.info("Great, no buffering proxy detected. Bytes received: "+p.length),Zu(G),G.P=!0,_t(11))}}else Zs(this.i,this.l,p,null),Hu(this,p);ce==4&&hs(this),this.o&&!this.K&&(ce==4?ng(this.j,this):(this.o=!1,Ya(this)))}else c2(this.g),h==400&&p.indexOf("Unknown SID")>0?(this.m=3,_t(12)):(this.m=0,_t(13)),hs(this),mo(this)}}}catch{}finally{}};function GE(a){if(!Cp(a))return a.g.la();const h=Qp(a.g);if(h==="")return"";let p="";const w=h.length,j=pr(a.g)==4;if(!a.h.i){if(typeof TextDecoder>"u")return hs(a),mo(a),"";a.h.i=new o.TextDecoder}for(let M=0;M<w;M++)a.h.h=!0,p+=a.h.i.decode(h[M],{stream:!(j&&M==w-1)});return h.length=0,a.h.g+=p,a.C=0,a.h.g}function Cp(a){return a.g?a.v=="GET"&&a.M!=2&&a.j.Aa:!1}function QE(a,h){var p=a.C,w=h.indexOf(`
`,p);return w==-1?$u:(p=Number(h.substring(p,w)),isNaN(p)?Np:(w+=1,w+p>h.length?$u:(h=h.slice(w,w+p),a.C=w+p,h)))}hr.prototype.cancel=function(){this.K=!0,hs(this)};function Ya(a){a.T=Date.now()+a.H,Pp(a,a.H)}function Pp(a,h){if(a.D!=null)throw Error("WatchDog timer not null");a.D=uo(d(a.aa,a),h)}function qu(a){a.D&&(o.clearTimeout(a.D),a.D=null)}hr.prototype.aa=function(){this.D=null;const a=Date.now();a-this.T>=0?(HE(this.i,this.B),this.M!=2&&(co(),_t(17)),hs(this),this.m=2,mo(this)):Pp(this,this.T-a)};function mo(a){a.j.I==0||a.K||ng(a.j,a)}function hs(a){qu(a);var h=a.O;h&&typeof h.dispose=="function"&&h.dispose(),a.O=null,ue(a.V),a.g&&(h=a.g,a.g=null,h.abort(),h.dispose())}function Hu(a,h){try{var p=a.j;if(p.I!=0&&(p.g==a||Wu(p.h,a))){if(!a.L&&Wu(p.h,a)&&p.I==3){try{var w=p.Ba.g.parse(h)}catch{w=null}if(Array.isArray(w)&&w.length==3){var j=w;if(j[0]==0){e:if(!p.v){if(p.g)if(p.g.F+3e3<a.F)nl(p),el(p);else break e;Ju(p),_t(18)}}else p.xa=j[1],0<p.xa-p.K&&j[2]<37500&&p.F&&p.A==0&&!p.C&&(p.C=uo(d(p.Va,p),6e3));Dp(p.h)<=1&&p.ta&&(p.ta=void 0)}else ms(p,11)}else if((a.L||p.g==a)&&nl(p),!x(h))for(j=p.Ba.g.parse(h),h=0;h<j.length;h++){let _e=j[h];const Je=_e[0];if(!(Je<=p.K))if(p.K=Je,_e=_e[1],p.I==2)if(_e[0]=="c"){p.M=_e[1],p.ba=_e[2];const vn=_e[3];vn!=null&&(p.ka=vn,p.j.info("VER="+p.ka));const ps=_e[4];ps!=null&&(p.za=ps,p.j.info("SVER="+p.za));const gr=_e[5];gr!=null&&typeof gr=="number"&&gr>0&&(w=1.5*gr,p.O=w,p.j.info("backChannelRequestTimeoutMs_="+w)),w=p;const yr=a.g;if(yr){const sl=yr.g?yr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(sl){var M=w.h;M.g||sl.indexOf("spdy")==-1&&sl.indexOf("quic")==-1&&sl.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(Ku(M,M.h),M.h=null))}if(w.G){const ed=yr.g?yr.g.getResponseHeader("X-HTTP-Session-Id"):null;ed&&(w.wa=ed,Ie(w.J,w.G,ed))}}p.I=3,p.l&&p.l.ra(),p.aa&&(p.T=Date.now()-a.F,p.j.info("Handshake RTT: "+p.T+"ms")),w=p;var G=a;if(w.na=ig(w,w.L?w.ba:null,w.W),G.L){Lp(w.h,G);var ce=G,He=w.O;He&&(ce.H=He),ce.D&&(qu(ce),Ya(ce)),w.g=G}else eg(w);p.i.length>0&&tl(p)}else _e[0]!="stop"&&_e[0]!="close"||ms(p,7);else p.I==3&&(_e[0]=="stop"||_e[0]=="close"?_e[0]=="stop"?ms(p,7):Xu(p):_e[0]!="noop"&&p.l&&p.l.qa(_e),p.A=0)}}co(4)}catch{}}var YE=class{constructor(a,h){this.g=a,this.map=h}};function Rp(a){this.l=a||10,o.PerformanceNavigationTiming?(a=o.performance.getEntriesByType("navigation"),a=a.length>0&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function jp(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Dp(a){return a.h?1:a.g?a.g.size:0}function Wu(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function Ku(a,h){a.g?a.g.add(h):a.h=h}function Lp(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}Rp.prototype.cancel=function(){if(this.i=Mp(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function Mp(a){if(a.h!=null)return a.i.concat(a.h.G);if(a.g!=null&&a.g.size!==0){let h=a.i;for(const p of a.g.values())h=h.concat(p.G);return h}return T(a.i)}var Vp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function XE(a,h){if(a){a=a.split("&");for(let p=0;p<a.length;p++){const w=a[p].indexOf("=");let j,M=null;w>=0?(j=a[p].substring(0,w),M=a[p].substring(w+1)):j=a[p],h(j,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function fr(a){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let h;a instanceof fr?(this.l=a.l,po(this,a.j),this.o=a.o,this.g=a.g,go(this,a.u),this.h=a.h,Gu(this,zp(a.i)),this.m=a.m):a&&(h=String(a).match(Vp))?(this.l=!1,po(this,h[1]||"",!0),this.o=yo(h[2]||""),this.g=yo(h[3]||"",!0),go(this,h[4]),this.h=yo(h[5]||"",!0),Gu(this,h[6]||"",!0),this.m=yo(h[7]||"")):(this.l=!1,this.i=new wo(null,this.l))}fr.prototype.toString=function(){const a=[];var h=this.j;h&&a.push(vo(h,Op,!0),":");var p=this.g;return(p||h=="file")&&(a.push("//"),(h=this.o)&&a.push(vo(h,Op,!0),"@"),a.push(fo(p).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.u,p!=null&&a.push(":",String(p))),(p=this.h)&&(this.g&&p.charAt(0)!="/"&&a.push("/"),a.push(vo(p,p.charAt(0)=="/"?e2:ZE,!0))),(p=this.i.toString())&&a.push("?",p),(p=this.m)&&a.push("#",vo(p,n2)),a.join("")},fr.prototype.resolve=function(a){const h=yn(this);let p=!!a.j;p?po(h,a.j):p=!!a.o,p?h.o=a.o:p=!!a.g,p?h.g=a.g:p=a.u!=null;var w=a.h;if(p)go(h,a.u);else if(p=!!a.h){if(w.charAt(0)!="/")if(this.g&&!this.h)w="/"+w;else{var j=h.h.lastIndexOf("/");j!=-1&&(w=h.h.slice(0,j+1)+w)}if(j=w,j==".."||j==".")w="";else if(j.indexOf("./")!=-1||j.indexOf("/.")!=-1){w=j.lastIndexOf("/",0)==0,j=j.split("/");const M=[];for(let G=0;G<j.length;){const ce=j[G++];ce=="."?w&&G==j.length&&M.push(""):ce==".."?((M.length>1||M.length==1&&M[0]!="")&&M.pop(),w&&G==j.length&&M.push("")):(M.push(ce),w=!0)}w=M.join("/")}else w=j}return p?h.h=w:p=a.i.toString()!=="",p?Gu(h,zp(a.i)):p=!!a.m,p&&(h.m=a.m),h};function yn(a){return new fr(a)}function po(a,h,p){a.j=p?yo(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function go(a,h){if(h){if(h=Number(h),isNaN(h)||h<0)throw Error("Bad port number "+h);a.u=h}else a.u=null}function Gu(a,h,p){h instanceof wo?(a.i=h,r2(a.i,a.l)):(p||(h=vo(h,t2)),a.i=new wo(h,a.l))}function Ie(a,h,p){a.i.set(h,p)}function Xa(a){return Ie(a,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),a}function yo(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function vo(a,h,p){return typeof a=="string"?(a=encodeURI(a).replace(h,JE),p&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function JE(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Op=/[#\/\?@]/g,ZE=/[#\?:]/g,e2=/[#\?]/g,t2=/[#\?@]/g,n2=/#/g;function wo(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function fs(a){a.g||(a.g=new Map,a.h=0,a.i&&XE(a.i,function(h,p){a.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}t=wo.prototype,t.add=function(a,h){fs(this),this.i=null,a=ei(this,a);let p=this.g.get(a);return p||this.g.set(a,p=[]),p.push(h),this.h+=1,this};function Fp(a,h){fs(a),h=ei(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function Up(a,h){return fs(a),h=ei(a,h),a.g.has(h)}t.forEach=function(a,h){fs(this),this.g.forEach(function(p,w){p.forEach(function(j){a.call(h,j,w,this)},this)},this)};function Bp(a,h){fs(a);let p=[];if(typeof h=="string")Up(a,h)&&(p=p.concat(a.g.get(ei(a,h))));else for(a=Array.from(a.g.values()),h=0;h<a.length;h++)p=p.concat(a[h]);return p}t.set=function(a,h){return fs(this),this.i=null,a=ei(this,a),Up(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},t.get=function(a,h){return a?(a=Bp(this,a),a.length>0?String(a[0]):h):h};function $p(a,h,p){Fp(a,h),p.length>0&&(a.i=null,a.g.set(ei(a,h),T(p)),a.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],h=Array.from(this.g.keys());for(let w=0;w<h.length;w++){var p=h[w];const j=fo(p);p=Bp(this,p);for(let M=0;M<p.length;M++){let G=j;p[M]!==""&&(G+="="+fo(p[M])),a.push(G)}}return this.i=a.join("&")};function zp(a){const h=new wo;return h.i=a.i,a.g&&(h.g=new Map(a.g),h.h=a.h),h}function ei(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function r2(a,h){h&&!a.j&&(fs(a),a.i=null,a.g.forEach(function(p,w){const j=w.toLowerCase();w!=j&&(Fp(this,w),$p(this,j,p))},a)),a.j=h}function s2(a,h){const p=new ho;if(o.Image){const w=new Image;w.onload=f(mr,p,"TestLoadImage: loaded",!0,h,w),w.onerror=f(mr,p,"TestLoadImage: error",!1,h,w),w.onabort=f(mr,p,"TestLoadImage: abort",!1,h,w),w.ontimeout=f(mr,p,"TestLoadImage: timeout",!1,h,w),o.setTimeout(function(){w.ontimeout&&w.ontimeout()},1e4),w.src=a}else h(!1)}function i2(a,h){const p=new ho,w=new AbortController,j=setTimeout(()=>{w.abort(),mr(p,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:w.signal}).then(M=>{clearTimeout(j),M.ok?mr(p,"TestPingServer: ok",!0,h):mr(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(j),mr(p,"TestPingServer: error",!1,h)})}function mr(a,h,p,w,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),w(p)}catch{}}function o2(){this.g=new $E}function Qu(a){this.i=a.Sb||null,this.h=a.ab||!1}m(Qu,wp),Qu.prototype.g=function(){return new Ja(this.i,this.h)};function Ja(a,h){U.call(this),this.H=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(Ja,U),t=Ja.prototype,t.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=a,this.D=h,this.readyState=1,xo(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const h={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};a&&(h.body=a),(this.H||o).fetch(new Request(this.D,h)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,_o(this)),this.readyState=0},t.Pa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,xo(this)),this.g&&(this.readyState=3,xo(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;qp(this)}else a.text().then(this.Oa.bind(this),this.ga.bind(this))};function qp(a){a.j.read().then(a.Ma.bind(a)).catch(a.ga.bind(a))}t.Ma=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.B.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?_o(this):xo(this),this.readyState==3&&qp(this)}},t.Oa=function(a){this.g&&(this.response=this.responseText=a,_o(this))},t.Na=function(a){this.g&&(this.response=a,_o(this))},t.ga=function(){this.g&&_o(this)};function _o(a){a.readyState=4,a.l=null,a.j=null,a.B=null,xo(a)}t.setRequestHeader=function(a,h){this.A.append(a,h)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,a.push(p[0]+": "+p[1]),p=h.next();return a.join(`\r
`)};function xo(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Ja.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Hp(a){let h="";return ne(a,function(p,w){h+=w,h+=":",h+=p,h+=`\r
`}),h}function Yu(a,h,p){e:{for(w in p){var w=!1;break e}w=!0}w||(p=Hp(p),typeof a=="string"?p!=null&&fo(p):Ie(a,h,p))}function je(a){U.call(this),this.headers=new Map,this.L=a||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(je,U);var a2=/^https?$/i,l2=["POST","PUT"];t=je.prototype,t.Fa=function(a){this.H=a},t.ea=function(a,h,p,w){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Sp.g(),this.g.onreadystatechange=g(d(this.Ca,this));try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(M){Wp(this,M);return}if(a=p||"",p=new Map(this.headers),w)if(Object.getPrototypeOf(w)===Object.prototype)for(var j in w)p.set(j,w[j]);else if(typeof w.keys=="function"&&typeof w.get=="function")for(const M of w.keys())p.set(M,w.get(M));else throw Error("Unknown input type for opt_headers: "+String(w));w=Array.from(p.keys()).find(M=>M.toLowerCase()=="content-type"),j=o.FormData&&a instanceof o.FormData,!(Array.prototype.indexOf.call(l2,h,void 0)>=0)||w||j||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,G]of p)this.g.setRequestHeader(M,G);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(a),this.v=!1}catch(M){Wp(this,M)}};function Wp(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.o=5,Kp(a),Za(a)}function Kp(a){a.A||(a.A=!0,F(a,"complete"),F(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=a||7,F(this,"complete"),F(this,"abort"),Za(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Za(this,!0)),je.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Gp(this):this.Xa())},t.Xa=function(){Gp(this)};function Gp(a){if(a.h&&typeof i<"u"){if(a.v&&pr(a)==4)setTimeout(a.Ca.bind(a),0);else if(F(a,"readystatechange"),pr(a)==4){a.h=!1;try{const M=a.ca();e:switch(M){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var w;if(w=M===0){let G=String(a.D).match(Vp)[1]||null;!G&&o.self&&o.self.location&&(G=o.self.location.protocol.slice(0,-1)),w=!a2.test(G?G.toLowerCase():"")}p=w}if(p)F(a,"complete"),F(a,"success");else{a.o=6;try{var j=pr(a)>2?a.g.statusText:""}catch{j=""}a.l=j+" ["+a.ca()+"]",Kp(a)}}finally{Za(a)}}}}function Za(a,h){if(a.g){a.m&&(clearTimeout(a.m),a.m=null);const p=a.g;a.g=null,h||F(a,"ready");try{p.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function pr(a){return a.g?a.g.readyState:0}t.ca=function(){try{return pr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),BE(h)}};function Qp(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.F){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function c2(a){const h={};a=(a.g&&pr(a)>=2&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let w=0;w<a.length;w++){if(x(a[w]))continue;var p=KE(a[w]);const j=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const M=h[j]||[];h[j]=M,M.push(p)}ae(h,function(w){return w.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Eo(a,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[a]||h}function Yp(a){this.za=0,this.i=[],this.j=new ho,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Eo("failFast",!1,a),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Eo("baseRetryDelayMs",5e3,a),this.Za=Eo("retryDelaySeedMs",1e4,a),this.Ta=Eo("forwardChannelMaxRetries",2,a),this.va=Eo("forwardChannelRequestTimeoutMs",2e4,a),this.ma=a&&a.xmlHttpFactory||void 0,this.Ua=a&&a.Rb||void 0,this.Aa=a&&a.useFetchStreams||!1,this.O=void 0,this.L=a&&a.supportsCrossDomainXhr||!1,this.M="",this.h=new Rp(a&&a.concurrentRequestLimit),this.Ba=new o2,this.S=a&&a.fastHandshake||!1,this.R=a&&a.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=a&&a.Pb||!1,a&&a.ua&&this.j.ua(),a&&a.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&a&&a.detectBufferingProxy||!1,this.ia=void 0,a&&a.longPollingTimeout&&a.longPollingTimeout>0&&(this.ia=a.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Yp.prototype,t.ka=8,t.I=1,t.connect=function(a,h,p,w){_t(0),this.W=a,this.H=h||{},p&&w!==void 0&&(this.H.OSID=p,this.H.OAID=w),this.F=this.X,this.J=ig(this,null,this.W),tl(this)};function Xu(a){if(Xp(a),a.I==3){var h=a.V++,p=yn(a.J);if(Ie(p,"SID",a.M),Ie(p,"RID",h),Ie(p,"TYPE","terminate"),To(a,p),h=new hr(a,a.j,h),h.M=2,h.A=Xa(yn(p)),p=!1,o.navigator&&o.navigator.sendBeacon)try{p=o.navigator.sendBeacon(h.A.toString(),"")}catch{}!p&&o.Image&&(new Image().src=h.A,p=!0),p||(h.g=og(h.j,null),h.g.ea(h.A)),h.F=Date.now(),Ya(h)}sg(a)}function el(a){a.g&&(Zu(a),a.g.cancel(),a.g=null)}function Xp(a){el(a),a.v&&(o.clearTimeout(a.v),a.v=null),nl(a),a.h.cancel(),a.m&&(typeof a.m=="number"&&o.clearTimeout(a.m),a.m=null)}function tl(a){if(!jp(a.h)&&!a.m){a.m=!0;var h=a.Ea;V||v(),B||(V(),B=!0),y.add(h,a),a.D=0}}function u2(a,h){return Dp(a.h)>=a.h.j-(a.m?1:0)?!1:a.m?(a.i=h.G.concat(a.i),!0):a.I==1||a.I==2||a.D>=(a.Sa?0:a.Ta)?!1:(a.m=uo(d(a.Ea,a,h),rg(a,a.D)),a.D++,!0)}t.Ea=function(a){if(this.m)if(this.m=null,this.I==1){if(!a){this.V=Math.floor(Math.random()*1e5),a=this.V++;const j=new hr(this,this.j,a);let M=this.o;if(this.U&&(M?(M=we(M),rn(M,this.U)):M=this.U),this.u!==null||this.R||(j.J=M,M=null),this.S)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var w=this.i[p];if("__data__"in w.map&&(w=w.map.__data__,typeof w=="string")){w=w.length;break t}w=void 0}if(w===void 0)break;if(h+=w,h>4096){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=Zp(this,j,h),p=yn(this.J),Ie(p,"RID",a),Ie(p,"CVER",22),this.G&&Ie(p,"X-HTTP-Session-Id",this.G),To(this,p),M&&(this.R?h="headers="+fo(Hp(M))+"&"+h:this.u&&Yu(p,this.u,M)),Ku(this.h,j),this.Ra&&Ie(p,"TYPE","init"),this.S?(Ie(p,"$req",h),Ie(p,"SID","null"),j.U=!0,zu(j,p,null)):zu(j,p,h),this.I=2}}else this.I==3&&(a?Jp(this,a):this.i.length==0||jp(this.h)||Jp(this))};function Jp(a,h){var p;h?p=h.l:p=a.V++;const w=yn(a.J);Ie(w,"SID",a.M),Ie(w,"RID",p),Ie(w,"AID",a.K),To(a,w),a.u&&a.o&&Yu(w,a.u,a.o),p=new hr(a,a.j,p,a.D+1),a.u===null&&(p.J=a.o),h&&(a.i=h.G.concat(a.i)),h=Zp(a,p,1e3),p.H=Math.round(a.va*.5)+Math.round(a.va*.5*Math.random()),Ku(a.h,p),zu(p,w,h)}function To(a,h){a.H&&ne(a.H,function(p,w){Ie(h,w,p)}),a.l&&ne({},function(p,w){Ie(h,w,p)})}function Zp(a,h,p){p=Math.min(a.i.length,p);const w=a.l?d(a.l.Ka,a.l,a):null;e:{var j=a.i;let ce=-1;for(;;){const He=["count="+p];ce==-1?p>0?(ce=j[0].g,He.push("ofs="+ce)):ce=0:He.push("ofs="+ce);let _e=!0;for(let Je=0;Je<p;Je++){var M=j[Je].g;const vn=j[Je].map;if(M-=ce,M<0)ce=Math.max(0,j[Je].g-100),_e=!1;else try{M="req"+M+"_"||"";try{var G=vn instanceof Map?vn:Object.entries(vn);for(const[ps,gr]of G){let yr=gr;c(gr)&&(yr=Dt(gr)),He.push(M+ps+"="+encodeURIComponent(yr))}}catch(ps){throw He.push(M+"type="+encodeURIComponent("_badmap")),ps}}catch{w&&w(vn)}}if(_e){G=He.join("&");break e}}G=void 0}return a=a.i.splice(0,p),h.G=a,G}function eg(a){if(!a.g&&!a.v){a.Y=1;var h=a.Da;V||v(),B||(V(),B=!0),y.add(h,a),a.A=0}}function Ju(a){return a.g||a.v||a.A>=3?!1:(a.Y++,a.v=uo(d(a.Da,a),rg(a,a.A)),a.A++,!0)}t.Da=function(){if(this.v=null,tg(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var a=4*this.T;this.j.info("BP detection timer enabled: "+a),this.B=uo(d(this.Wa,this),a)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,_t(10),el(this),tg(this))};function Zu(a){a.B!=null&&(o.clearTimeout(a.B),a.B=null)}function tg(a){a.g=new hr(a,a.j,"rpc",a.Y),a.u===null&&(a.g.J=a.o),a.g.P=0;var h=yn(a.na);Ie(h,"RID","rpc"),Ie(h,"SID",a.M),Ie(h,"AID",a.K),Ie(h,"CI",a.F?"0":"1"),!a.F&&a.ia&&Ie(h,"TO",a.ia),Ie(h,"TYPE","xmlhttp"),To(a,h),a.u&&a.o&&Yu(h,a.u,a.o),a.O&&(a.g.H=a.O);var p=a.g;a=a.ba,p.M=1,p.A=Xa(yn(h)),p.u=null,p.R=!0,kp(p,a)}t.Va=function(){this.C!=null&&(this.C=null,el(this),Ju(this),_t(19))};function nl(a){a.C!=null&&(o.clearTimeout(a.C),a.C=null)}function ng(a,h){var p=null;if(a.g==h){nl(a),Zu(a),a.g=null;var w=2}else if(Wu(a.h,h))p=h.G,Lp(a.h,h),w=1;else return;if(a.I!=0){if(h.o)if(w==1){p=h.u?h.u.length:0,h=Date.now()-h.F;var j=a.D;w=Ga(),F(w,new Ip(w,p)),tl(a)}else eg(a);else if(j=h.m,j==3||j==0&&h.X>0||!(w==1&&u2(a,h)||w==2&&Ju(a)))switch(p&&p.length>0&&(h=a.h,h.i=h.i.concat(p)),j){case 1:ms(a,5);break;case 4:ms(a,10);break;case 3:ms(a,6);break;default:ms(a,2)}}}function rg(a,h){let p=a.Qa+Math.floor(Math.random()*a.Za);return a.isActive()||(p*=2),p*h}function ms(a,h){if(a.j.info("Error code "+h),h==2){var p=d(a.bb,a),w=a.Ua;const j=!w;w=new fr(w||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||po(w,"https"),Xa(w),j?s2(w.toString(),p):i2(w.toString(),p)}else _t(2);a.I=0,a.l&&a.l.pa(h),sg(a),Xp(a)}t.bb=function(a){a?(this.j.info("Successfully pinged google.com"),_t(2)):(this.j.info("Failed to ping google.com"),_t(1))};function sg(a){if(a.I=0,a.ja=[],a.l){const h=Mp(a.h);(h.length!=0||a.i.length!=0)&&(C(a.ja,h),C(a.ja,a.i),a.h.i.length=0,T(a.i),a.i.length=0),a.l.oa()}}function ig(a,h,p){var w=p instanceof fr?yn(p):new fr(p);if(w.g!="")h&&(w.g=h+"."+w.g),go(w,w.u);else{var j=o.location;w=j.protocol,h=h?h+"."+j.hostname:j.hostname,j=+j.port;const M=new fr(null);w&&po(M,w),h&&(M.g=h),j&&go(M,j),p&&(M.h=p),w=M}return p=a.G,h=a.wa,p&&h&&Ie(w,p,h),Ie(w,"VER",a.ka),To(a,w),w}function og(a,h,p){if(h&&!a.L)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Aa&&!a.ma?new je(new Qu({ab:p})):new je(a.ma),h.Fa(a.L),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ag(){}t=ag.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function rl(){}rl.prototype.g=function(a,h){return new Lt(a,h)};function Lt(a,h){U.call(this),this.g=new Yp(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.sa&&(a?a["X-WebChannel-Client-Profile"]=h.sa:a={"X-WebChannel-Client-Profile":h.sa}),this.g.U=a,(a=h&&h.Qb)&&!x(a)&&(this.g.u=a),this.A=h&&h.supportsCrossDomainXhr||!1,this.v=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!x(h)&&(this.g.G=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new ti(this)}m(Lt,U),Lt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Lt.prototype.close=function(){Xu(this.g)},Lt.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var p={};p.__data__=a,a=p}else this.v&&(p={},p.__data__=Dt(a),a=p);h.i.push(new YE(h.Ya++,a)),h.I==3&&tl(h)},Lt.prototype.N=function(){this.g.l=null,delete this.j,Xu(this.g),delete this.g,Lt.Z.N.call(this)};function lg(a){Fu.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(const p in h){a=p;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}m(lg,Fu);function cg(){Uu.call(this),this.status=1}m(cg,Uu);function ti(a){this.g=a}m(ti,ag),ti.prototype.ra=function(){F(this.g,"a")},ti.prototype.qa=function(a){F(this.g,new lg(a))},ti.prototype.pa=function(a){F(this.g,new cg)},ti.prototype.oa=function(){F(this.g,"b")},rl.prototype.createWebChannel=rl.prototype.g,Lt.prototype.send=Lt.prototype.o,Lt.prototype.open=Lt.prototype.m,Lt.prototype.close=Lt.prototype.close,j1=function(){return new rl},R1=function(){return Ga()},P1=ds,Wh={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Qa.NO_ERROR=0,Qa.TIMEOUT=8,Qa.HTTP_ERROR=6,Kl=Qa,bp.COMPLETE="complete",C1=bp,_p.EventType=lo,lo.OPEN="a",lo.CLOSE="b",lo.ERROR="c",lo.MESSAGE="d",U.prototype.listen=U.prototype.J,Oo=_p,je.prototype.listenOnce=je.prototype.K,je.prototype.getLastError=je.prototype.Ha,je.prototype.getLastErrorCode=je.prototype.ya,je.prototype.getStatus=je.prototype.ca,je.prototype.getResponseJson=je.prototype.La,je.prototype.getResponseText=je.prototype.la,je.prototype.send=je.prototype.ea,je.prototype.setWithCredentials=je.prototype.Fa,k1=je}).apply(typeof Tl<"u"?Tl:typeof self<"u"?self:typeof window<"u"?window:{});const Zy="@firebase/firestore",e0="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ht.UNAUTHENTICATED=new ht(null),ht.GOOGLE_CREDENTIALS=new ht("google-credentials-uid"),ht.FIRST_PARTY=new ht("first-party-uid"),ht.MOCK_USER=new ht("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zi="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Us=new um("@firebase/firestore");function ri(){return Us.logLevel}function X(t,...e){if(Us.logLevel<=he.DEBUG){const n=e.map(Em);Us.debug(`Firestore (${Zi}): ${t}`,...n)}}function ir(t,...e){if(Us.logLevel<=he.ERROR){const n=e.map(Em);Us.error(`Firestore (${Zi}): ${t}`,...n)}}function Fi(t,...e){if(Us.logLevel<=he.WARN){const n=e.map(Em);Us.warn(`Firestore (${Zi}): ${t}`,...n)}}function Em(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function se(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,D1(t,r,n)}function D1(t,e,n){let r=`FIRESTORE (${Zi}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw ir(r),new Error(r)}function ye(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||D1(e,s,r)}function le(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Y extends Mn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class vk{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(ht.UNAUTHENTICATED))}shutdown(){}}class wk{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class _k{constructor(e){this.t=e,this.currentUser=ht.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ye(this.o===void 0,42304);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Jn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Jn,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},c=u=>{X("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(X("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Jn)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(X("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ye(typeof r.accessToken=="string",31837,{l:r}),new L1(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ye(e===null||typeof e=="string",2055,{h:e}),new ht(e)}}class xk{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=ht.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Ek{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new xk(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(ht.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class t0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Tk{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Gt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ye(this.o===void 0,3512);const r=i=>{i.error!=null&&X("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,X("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{X("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):X("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new t0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ye(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new t0(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ik(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=Ik(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function fe(t,e){return t<e?-1:t>e?1:0}function Kh(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Ld(s)===Ld(i)?fe(s,i):Ld(s)?1:-1}return fe(t.length,e.length)}const bk=55296,Sk=57343;function Ld(t){const e=t.charCodeAt(0);return e>=bk&&e<=Sk}function Ui(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n0="__name__";class xn{constructor(e,n,r){n===void 0?n=0:n>e.length&&se(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&se(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return xn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof xn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=xn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return fe(e.length,n.length)}static compareSegments(e,n){const r=xn.isNumericId(e),s=xn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?xn.extractNumericId(e).compare(xn.extractNumericId(n)):Kh(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ur.fromString(e.substring(4,e.length-2))}}class xe extends xn{construct(e,n,r){return new xe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Y($.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new xe(n)}static emptyPath(){return new xe([])}}const Ak=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class st extends xn{construct(e,n,r){return new st(e,n,r)}static isValidIdentifier(e){return Ak.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),st.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===n0}static keyField(){return new st([n0])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new Y($.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new Y($.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Y($.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(r+=c,s++):(i(),s++)}if(i(),o)throw new Y($.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new st(n)}static emptyPath(){return new st([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(e){this.path=e}static fromPath(e){return new ee(xe.fromString(e))}static fromName(e){return new ee(xe.fromString(e).popFirst(5))}static empty(){return new ee(xe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&xe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return xe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ee(new xe(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M1(t,e,n){if(!n)throw new Y($.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Nk(t,e,n,r){if(e===!0&&r===!0)throw new Y($.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function r0(t){if(!ee.isDocumentKey(t))throw new Y($.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function s0(t){if(ee.isDocumentKey(t))throw new Y($.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function V1(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function gu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":se(12329,{type:typeof t})}function jt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Y($.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=gu(t);throw new Y($.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qe(t,e){const n={typeString:t};return e&&(n.value=e),n}function $a(t,e){if(!V1(t))throw new Y($.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new Y($.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i0=-62135596800,o0=1e6;class Se{static now(){return Se.fromMillis(Date.now())}static fromDate(e){return Se.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*o0);return new Se(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Y($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Y($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<i0)throw new Y($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Y($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/o0}_compareTo(e){return this.seconds===e.seconds?fe(this.nanoseconds,e.nanoseconds):fe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Se._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if($a(e,Se._jsonSchema))return new Se(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-i0;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Se._jsonSchemaVersion="firestore/timestamp/1.0",Se._jsonSchema={type:qe("string",Se._jsonSchemaVersion),seconds:qe("number"),nanoseconds:qe("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{static fromTimestamp(e){return new oe(e)}static min(){return new oe(new Se(0,0))}static max(){return new oe(new Se(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ta=-1;function kk(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=oe.fromTimestamp(r===1e9?new Se(n+1,0):new Se(n,r));return new Kr(s,ee.empty(),e)}function Ck(t){return new Kr(t.readTime,t.key,Ta)}class Kr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Kr(oe.min(),ee.empty(),Ta)}static max(){return new Kr(oe.max(),ee.empty(),Ta)}}function Pk(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ee.comparator(t.documentKey,e.documentKey),n!==0?n:fe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class jk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eo(t){if(t.code!==$.FAILED_PRECONDITION||t.message!==Rk)throw t;X("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&se(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new z((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof z?n:z.resolve(n)}catch(n){return z.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):z.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):z.reject(n)}static resolve(e){return new z((n,r)=>{n(e)})}static reject(e){return new z((n,r)=>{r(e)})}static waitFor(e){return new z((n,r)=>{let s=0,i=0,o=!1;e.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=z.resolve(!1);for(const r of e)n=n.next(s=>s?z.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new z((r,s)=>{const i=e.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const d=u;n(e[d]).next(f=>{o[d]=f,++c,c===i&&r(o)},f=>s(f))}})}static doWhile(e,n){return new z((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function Dk(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function to(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}yu.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Im=-1;function vu(t){return t==null}function Dc(t){return t===0&&1/t==-1/0}function Lk(t){return typeof t=="number"&&Number.isInteger(t)&&!Dc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O1="";function Mk(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=a0(e)),e=Vk(t.get(n),e);return a0(e)}function Vk(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case O1:n+="";break;default:n+=i}}return n}function a0(t){return t+O1+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l0(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function is(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function F1(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e,n){this.comparator=e,this.root=n||rt.EMPTY}insert(e,n){return new Re(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,rt.BLACK,null,null))}remove(e){return new Re(this.comparator,this.root.remove(e,this.comparator).copy(null,null,rt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Il(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Il(this.root,e,this.comparator,!1)}getReverseIterator(){return new Il(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Il(this.root,e,this.comparator,!0)}}class Il{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class rt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??rt.RED,this.left=s??rt.EMPTY,this.right=i??rt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new rt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return rt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return rt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,rt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,rt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw se(43730,{key:this.key,value:this.value});if(this.right.isRed())throw se(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw se(27949);return e+(this.isRed()?0:1)}}rt.EMPTY=null,rt.RED=!0,rt.BLACK=!1;rt.EMPTY=new class{constructor(){this.size=0}get key(){throw se(57766)}get value(){throw se(16141)}get color(){throw se(16727)}get left(){throw se(29726)}get right(){throw se(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new rt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e){this.comparator=e,this.data=new Re(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new c0(this.data.getIterator())}getIteratorFrom(e){return new c0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Xe)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Xe(this.comparator);return n.data=e,n}}class c0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.fields=e,e.sort(st.comparator)}static empty(){return new Ut([])}unionWith(e){let n=new Xe(st.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Ut(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ui(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new U1("Invalid base64 string: "+i):i}}(e);return new at(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new at(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return fe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}at.EMPTY_BYTE_STRING=new at("");const Ok=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gr(t){if(ye(!!t,39018),typeof t=="string"){let e=0;const n=Ok.exec(t);if(ye(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Oe(t.seconds),nanos:Oe(t.nanos)}}function Oe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Qr(t){return typeof t=="string"?at.fromBase64String(t):at.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B1="server_timestamp",$1="__type__",z1="__previous_value__",q1="__local_write_time__";function bm(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[$1])==null?void 0:r.stringValue)===B1}function wu(t){const e=t.mapValue.fields[z1];return bm(e)?wu(e):e}function Ia(t){const e=Gr(t.mapValue.fields[q1].timestampValue);return new Se(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fk{constructor(e,n,r,s,i,o,c,u,d,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=f}}const Lc="(default)";class ba{constructor(e,n){this.projectId=e,this.database=n||Lc}static empty(){return new ba("","")}get isDefaultDatabase(){return this.database===Lc}isEqual(e){return e instanceof ba&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H1="__type__",Uk="__max__",bl={mapValue:{}},W1="__vector__",Mc="value";function Yr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?bm(t)?4:$k(t)?9007199254740991:Bk(t)?10:11:se(28295,{value:t})}function Ln(t,e){if(t===e)return!0;const n=Yr(t);if(n!==Yr(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ia(t).isEqual(Ia(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Gr(s.timestampValue),c=Gr(i.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Qr(s.bytesValue).isEqual(Qr(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Oe(s.geoPointValue.latitude)===Oe(i.geoPointValue.latitude)&&Oe(s.geoPointValue.longitude)===Oe(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Oe(s.integerValue)===Oe(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Oe(s.doubleValue),c=Oe(i.doubleValue);return o===c?Dc(o)===Dc(c):isNaN(o)&&isNaN(c)}return!1}(t,e);case 9:return Ui(t.arrayValue.values||[],e.arrayValue.values||[],Ln);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},c=i.mapValue.fields||{};if(l0(o)!==l0(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!Ln(o[u],c[u])))return!1;return!0}(t,e);default:return se(52216,{left:t})}}function Sa(t,e){return(t.values||[]).find(n=>Ln(n,e))!==void 0}function Bi(t,e){if(t===e)return 0;const n=Yr(t),r=Yr(e);if(n!==r)return fe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return fe(t.booleanValue,e.booleanValue);case 2:return function(i,o){const c=Oe(i.integerValue||i.doubleValue),u=Oe(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return u0(t.timestampValue,e.timestampValue);case 4:return u0(Ia(t),Ia(e));case 5:return Kh(t.stringValue,e.stringValue);case 6:return function(i,o){const c=Qr(i),u=Qr(o);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const c=i.split("/"),u=o.split("/");for(let d=0;d<c.length&&d<u.length;d++){const f=fe(c[d],u[d]);if(f!==0)return f}return fe(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const c=fe(Oe(i.latitude),Oe(o.latitude));return c!==0?c:fe(Oe(i.longitude),Oe(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return d0(t.arrayValue,e.arrayValue);case 10:return function(i,o){var g,T,C,P;const c=i.fields||{},u=o.fields||{},d=(g=c[Mc])==null?void 0:g.arrayValue,f=(T=u[Mc])==null?void 0:T.arrayValue,m=fe(((C=d==null?void 0:d.values)==null?void 0:C.length)||0,((P=f==null?void 0:f.values)==null?void 0:P.length)||0);return m!==0?m:d0(d,f)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===bl.mapValue&&o===bl.mapValue)return 0;if(i===bl.mapValue)return 1;if(o===bl.mapValue)return-1;const c=i.fields||{},u=Object.keys(c),d=o.fields||{},f=Object.keys(d);u.sort(),f.sort();for(let m=0;m<u.length&&m<f.length;++m){const g=Kh(u[m],f[m]);if(g!==0)return g;const T=Bi(c[u[m]],d[f[m]]);if(T!==0)return T}return fe(u.length,f.length)}(t.mapValue,e.mapValue);default:throw se(23264,{he:n})}}function u0(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return fe(t,e);const n=Gr(t),r=Gr(e),s=fe(n.seconds,r.seconds);return s!==0?s:fe(n.nanos,r.nanos)}function d0(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Bi(n[s],r[s]);if(i)return i}return fe(n.length,r.length)}function $i(t){return Gh(t)}function Gh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Gr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Qr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ee.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Gh(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Gh(n.fields[o])}`;return s+"}"}(t.mapValue):se(61005,{value:t})}function Gl(t){switch(Yr(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=wu(t);return e?16+Gl(e):16;case 5:return 2*t.stringValue.length;case 6:return Qr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Gl(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return is(r.fields,(i,o)=>{s+=i.length+Gl(o)}),s}(t.mapValue);default:throw se(13486,{value:t})}}function h0(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Qh(t){return!!t&&"integerValue"in t}function Sm(t){return!!t&&"arrayValue"in t}function f0(t){return!!t&&"nullValue"in t}function m0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ql(t){return!!t&&"mapValue"in t}function Bk(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[H1])==null?void 0:r.stringValue)===W1}function Zo(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return is(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Zo(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Zo(t.arrayValue.values[n]);return e}return{...t}}function $k(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Uk}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e){this.value=e}static empty(){return new Nt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Ql(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Zo(n)}setAll(e){let n=st.emptyPath(),r={},s=[];e.forEach((o,c)=>{if(!n.isImmediateParentOf(c)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=c.popLast()}o?r[c.lastSegment()]=Zo(o):s.push(c.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Ql(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ln(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Ql(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){is(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Nt(Zo(this.value))}}function K1(t){const e=[];return is(t.fields,(n,r)=>{const s=new st([n]);if(Ql(r)){const i=K1(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Ut(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e,n,r,s,i,o,c){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=c}static newInvalidDocument(e){return new pt(e,0,oe.min(),oe.min(),oe.min(),Nt.empty(),0)}static newFoundDocument(e,n,r,s){return new pt(e,1,n,oe.min(),r,s,0)}static newNoDocument(e,n){return new pt(e,2,n,oe.min(),oe.min(),Nt.empty(),0)}static newUnknownDocument(e,n){return new pt(e,3,n,oe.min(),oe.min(),Nt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(oe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Nt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Nt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=oe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof pt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new pt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc{constructor(e,n){this.position=e,this.inclusive=n}}function p0(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=ee.comparator(ee.fromName(o.referenceValue),n.key):r=Bi(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function g0(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ln(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oc{constructor(e,n="asc"){this.field=e,this.dir=n}}function zk(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{}class ze extends G1{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Hk(e,n,r):n==="array-contains"?new Gk(e,r):n==="in"?new Qk(e,r):n==="not-in"?new Yk(e,r):n==="array-contains-any"?new Xk(e,r):new ze(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new Wk(e,r):new Kk(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Bi(n,this.value)):n!==null&&Yr(this.value)===Yr(n)&&this.matchesComparison(Bi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return se(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gn extends G1{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new gn(e,n)}matches(e){return Q1(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Q1(t){return t.op==="and"}function Y1(t){return qk(t)&&Q1(t)}function qk(t){for(const e of t.filters)if(e instanceof gn)return!1;return!0}function Yh(t){if(t instanceof ze)return t.field.canonicalString()+t.op.toString()+$i(t.value);if(Y1(t))return t.filters.map(e=>Yh(e)).join(",");{const e=t.filters.map(n=>Yh(n)).join(",");return`${t.op}(${e})`}}function X1(t,e){return t instanceof ze?function(r,s){return s instanceof ze&&r.op===s.op&&r.field.isEqual(s.field)&&Ln(r.value,s.value)}(t,e):t instanceof gn?function(r,s){return s instanceof gn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,c)=>i&&X1(o,s.filters[c]),!0):!1}(t,e):void se(19439)}function J1(t){return t instanceof ze?function(n){return`${n.field.canonicalString()} ${n.op} ${$i(n.value)}`}(t):t instanceof gn?function(n){return n.op.toString()+" {"+n.getFilters().map(J1).join(" ,")+"}"}(t):"Filter"}class Hk extends ze{constructor(e,n,r){super(e,n,r),this.key=ee.fromName(r.referenceValue)}matches(e){const n=ee.comparator(e.key,this.key);return this.matchesComparison(n)}}class Wk extends ze{constructor(e,n){super(e,"in",n),this.keys=Z1("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Kk extends ze{constructor(e,n){super(e,"not-in",n),this.keys=Z1("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Z1(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>ee.fromName(r.referenceValue))}class Gk extends ze{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Sm(n)&&Sa(n.arrayValue,this.value)}}class Qk extends ze{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Sa(this.value.arrayValue,n)}}class Yk extends ze{constructor(e,n){super(e,"not-in",n)}matches(e){if(Sa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Sa(this.value.arrayValue,n)}}class Xk extends ze{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Sm(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Sa(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jk{constructor(e,n=null,r=[],s=[],i=null,o=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.Te=null}}function y0(t,e=null,n=[],r=[],s=null,i=null,o=null){return new Jk(t,e,n,r,s,i,o)}function Am(t){const e=le(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Yh(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),vu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>$i(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>$i(r)).join(",")),e.Te=n}return e.Te}function Nm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!zk(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!X1(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!g0(t.startAt,e.startAt)&&g0(t.endAt,e.endAt)}function Xh(t){return ee.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e,n=null,r=[],s=[],i=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Zk(t,e,n,r,s,i,o,c){return new za(t,e,n,r,s,i,o,c)}function _u(t){return new za(t)}function v0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function ex(t){return t.collectionGroup!==null}function ea(t){const e=le(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Xe(st.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Oc(i,r))}),n.has(st.keyField().canonicalString())||e.Ie.push(new Oc(st.keyField(),r))}return e.Ie}function Cn(t){const e=le(t);return e.Ee||(e.Ee=eC(e,ea(t))),e.Ee}function eC(t,e){if(t.limitType==="F")return y0(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Oc(s.field,i)});const n=t.endAt?new Vc(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Vc(t.startAt.position,t.startAt.inclusive):null;return y0(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Jh(t,e){const n=t.filters.concat([e]);return new za(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Zh(t,e,n){return new za(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function xu(t,e){return Nm(Cn(t),Cn(e))&&t.limitType===e.limitType}function tx(t){return`${Am(Cn(t))}|lt:${t.limitType}`}function si(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>J1(s)).join(", ")}]`),vu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>$i(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>$i(s)).join(",")),`Target(${r})`}(Cn(t))}; limitType=${t.limitType})`}function Eu(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ee.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of ea(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,c,u){const d=p0(o,c,u);return o.inclusive?d<=0:d<0}(r.startAt,ea(r),s)||r.endAt&&!function(o,c,u){const d=p0(o,c,u);return o.inclusive?d>=0:d>0}(r.endAt,ea(r),s))}(t,e)}function tC(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function nx(t){return(e,n)=>{let r=!1;for(const s of ea(t)){const i=nC(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function nC(t,e,n){const r=t.field.isKeyField()?ee.comparator(e.key,n.key):function(i,o,c){const u=o.data.field(i),d=c.data.field(i);return u!==null&&d!==null?Bi(u,d):se(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return se(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){is(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return F1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC=new Re(ee.comparator);function or(){return rC}const rx=new Re(ee.comparator);function Fo(...t){let e=rx;for(const n of t)e=e.insert(n.key,n);return e}function sx(t){let e=rx;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ss(){return ta()}function ix(){return ta()}function ta(){return new Gs(t=>t.toString(),(t,e)=>t.isEqual(e))}const sC=new Re(ee.comparator),iC=new Xe(ee.comparator);function me(...t){let e=iC;for(const n of t)e=e.add(n);return e}const oC=new Xe(fe);function aC(){return oC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function km(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Dc(e)?"-0":e}}function ox(t){return{integerValue:""+t}}function ax(t,e){return Lk(e)?ox(e):km(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(){this._=void 0}}function lC(t,e,n){return t instanceof Aa?function(s,i){const o={fields:{[$1]:{stringValue:B1},[q1]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&bm(i)&&(i=wu(i)),i&&(o.fields[z1]=i),{mapValue:o}}(n,e):t instanceof zi?cx(t,e):t instanceof Na?ux(t,e):function(s,i){const o=lx(s,i),c=w0(o)+w0(s.Ae);return Qh(o)&&Qh(s.Ae)?ox(c):km(s.serializer,c)}(t,e)}function cC(t,e,n){return t instanceof zi?cx(t,e):t instanceof Na?ux(t,e):n}function lx(t,e){return t instanceof ka?function(r){return Qh(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Aa extends Tu{}class zi extends Tu{constructor(e){super(),this.elements=e}}function cx(t,e){const n=dx(e);for(const r of t.elements)n.some(s=>Ln(s,r))||n.push(r);return{arrayValue:{values:n}}}class Na extends Tu{constructor(e){super(),this.elements=e}}function ux(t,e){let n=dx(e);for(const r of t.elements)n=n.filter(s=>!Ln(s,r));return{arrayValue:{values:n}}}class ka extends Tu{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function w0(t){return Oe(t.integerValue||t.doubleValue)}function dx(t){return Sm(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(e,n){this.field=e,this.transform=n}}function uC(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof zi&&s instanceof zi||r instanceof Na&&s instanceof Na?Ui(r.elements,s.elements,Ln):r instanceof ka&&s instanceof ka?Ln(r.Ae,s.Ae):r instanceof Aa&&s instanceof Aa}(t.transform,e.transform)}class dC{constructor(e,n){this.version=e,this.transformResults=n}}class Zt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Zt}static exists(e){return new Zt(void 0,e)}static updateTime(e){return new Zt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Yl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Iu{}function hx(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Pm(t.key,Zt.none()):new qa(t.key,t.data,Zt.none());{const n=t.data,r=Nt.empty();let s=new Xe(st.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new os(t.key,r,new Ut(s.toArray()),Zt.none())}}function hC(t,e,n){t instanceof qa?function(s,i,o){const c=s.value.clone(),u=x0(s.fieldTransforms,i,o.transformResults);c.setAll(u),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):t instanceof os?function(s,i,o){if(!Yl(s.precondition,i))return void i.convertToUnknownDocument(o.version);const c=x0(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(fx(s)),u.setAll(c),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function na(t,e,n,r){return t instanceof qa?function(i,o,c,u){if(!Yl(i.precondition,o))return c;const d=i.value.clone(),f=E0(i.fieldTransforms,u,o);return d.setAll(f),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof os?function(i,o,c,u){if(!Yl(i.precondition,o))return c;const d=E0(i.fieldTransforms,u,o),f=o.data;return f.setAll(fx(i)),f.setAll(d),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,o,c){return Yl(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(t,e,n)}function fC(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=lx(r.transform,s||null);i!=null&&(n===null&&(n=Nt.empty()),n.set(r.field,i))}return n||null}function _0(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ui(r,s,(i,o)=>uC(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class qa extends Iu{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class os extends Iu{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function fx(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function x0(t,e,n){const r=new Map;ye(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,c=e.data.field(i.field);r.set(i.field,cC(o,c,n[s]))}return r}function E0(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,lC(i,o,e))}return r}class Pm extends Iu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mC extends Iu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&hC(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=na(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=na(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=ix();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=n.has(s.key)?null:c;const u=hx(o,c);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(oe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),me())}isEqual(e){return this.batchId===e.batchId&&Ui(this.mutations,e.mutations,(n,r)=>_0(n,r))&&Ui(this.baseMutations,e.baseMutations,(n,r)=>_0(n,r))}}class Rm{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){ye(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return sC}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Rm(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ue,pe;function vC(t){switch(t){case $.OK:return se(64938);case $.CANCELLED:case $.UNKNOWN:case $.DEADLINE_EXCEEDED:case $.RESOURCE_EXHAUSTED:case $.INTERNAL:case $.UNAVAILABLE:case $.UNAUTHENTICATED:return!1;case $.INVALID_ARGUMENT:case $.NOT_FOUND:case $.ALREADY_EXISTS:case $.PERMISSION_DENIED:case $.FAILED_PRECONDITION:case $.ABORTED:case $.OUT_OF_RANGE:case $.UNIMPLEMENTED:case $.DATA_LOSS:return!0;default:return se(15467,{code:t})}}function mx(t){if(t===void 0)return ir("GRPC error has no .code"),$.UNKNOWN;switch(t){case Ue.OK:return $.OK;case Ue.CANCELLED:return $.CANCELLED;case Ue.UNKNOWN:return $.UNKNOWN;case Ue.DEADLINE_EXCEEDED:return $.DEADLINE_EXCEEDED;case Ue.RESOURCE_EXHAUSTED:return $.RESOURCE_EXHAUSTED;case Ue.INTERNAL:return $.INTERNAL;case Ue.UNAVAILABLE:return $.UNAVAILABLE;case Ue.UNAUTHENTICATED:return $.UNAUTHENTICATED;case Ue.INVALID_ARGUMENT:return $.INVALID_ARGUMENT;case Ue.NOT_FOUND:return $.NOT_FOUND;case Ue.ALREADY_EXISTS:return $.ALREADY_EXISTS;case Ue.PERMISSION_DENIED:return $.PERMISSION_DENIED;case Ue.FAILED_PRECONDITION:return $.FAILED_PRECONDITION;case Ue.ABORTED:return $.ABORTED;case Ue.OUT_OF_RANGE:return $.OUT_OF_RANGE;case Ue.UNIMPLEMENTED:return $.UNIMPLEMENTED;case Ue.DATA_LOSS:return $.DATA_LOSS;default:return se(39323,{code:t})}}(pe=Ue||(Ue={}))[pe.OK=0]="OK",pe[pe.CANCELLED=1]="CANCELLED",pe[pe.UNKNOWN=2]="UNKNOWN",pe[pe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pe[pe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pe[pe.NOT_FOUND=5]="NOT_FOUND",pe[pe.ALREADY_EXISTS=6]="ALREADY_EXISTS",pe[pe.PERMISSION_DENIED=7]="PERMISSION_DENIED",pe[pe.UNAUTHENTICATED=16]="UNAUTHENTICATED",pe[pe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pe[pe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pe[pe.ABORTED=10]="ABORTED",pe[pe.OUT_OF_RANGE=11]="OUT_OF_RANGE",pe[pe.UNIMPLEMENTED=12]="UNIMPLEMENTED",pe[pe.INTERNAL=13]="INTERNAL",pe[pe.UNAVAILABLE=14]="UNAVAILABLE",pe[pe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wC(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _C=new Ur([4294967295,4294967295],0);function T0(t){const e=wC().encode(t),n=new N1;return n.update(e),new Uint8Array(n.digest())}function I0(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ur([n,r],0),new Ur([s,i],0)]}class jm{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Uo(`Invalid padding: ${n}`);if(r<0)throw new Uo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Uo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Uo(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Ur.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(Ur.fromNumber(r)));return s.compare(_C)===1&&(s=new Ur([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=T0(e),[r,s]=I0(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new jm(i,s,n);return r.forEach(c=>o.insert(c)),o}insert(e){if(this.ge===0)return;const n=T0(e),[r,s]=I0(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Uo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Ha.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new bu(oe.min(),s,new Re(fe),or(),me())}}class Ha{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ha(r,n,me(),me(),me())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class px{constructor(e,n){this.targetId=e,this.Ce=n}}class gx{constructor(e,n,r=at.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class b0{constructor(){this.ve=0,this.Fe=S0(),this.Me=at.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=me(),n=me(),r=me();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:se(38017,{changeType:i})}}),new Ha(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=S0()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ye(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class xC{constructor(e){this.Ge=e,this.ze=new Map,this.je=or(),this.Je=Sl(),this.He=Sl(),this.Ye=new Re(fe)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:se(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(Xh(i))if(r===0){const o=new ee(i.path);this.et(n,o,pt.newNoDocument(o,oe.min()))}else ye(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,c;try{o=Qr(r).toUint8Array()}catch(u){if(u instanceof U1)return Fi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new jm(o,s,i)}catch(u){return Fi(u instanceof Uo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const c=this.ot(o);if(c){if(i.current&&Xh(c.target)){const u=new ee(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,pt.newNoDocument(u,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=me();this.He.forEach((i,o)=>{let c=!0;o.forEachWhile(u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new bu(e,n,this.Ye,this.je,r);return this.je=or(),this.Je=Sl(),this.He=Sl(),this.Ye=new Re(fe),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new b0,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Xe(fe),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Xe(fe),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||X("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new b0),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Sl(){return new Re(ee.comparator)}function S0(){return new Re(ee.comparator)}const EC={asc:"ASCENDING",desc:"DESCENDING"},TC={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},IC={and:"AND",or:"OR"};class bC{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ef(t,e){return t.useProto3Json||vu(e)?e:{value:e}}function Fc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function yx(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function SC(t,e){return Fc(t,e.toTimestamp())}function Pn(t){return ye(!!t,49232),oe.fromTimestamp(function(n){const r=Gr(n);return new Se(r.seconds,r.nanos)}(t))}function Dm(t,e){return tf(t,e).canonicalString()}function tf(t,e){const n=function(s){return new xe(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function vx(t){const e=xe.fromString(t);return ye(Tx(e),10190,{key:e.toString()}),e}function nf(t,e){return Dm(t.databaseId,e.path)}function Md(t,e){const n=vx(e);if(n.get(1)!==t.databaseId.projectId)throw new Y($.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Y($.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ee(_x(n))}function wx(t,e){return Dm(t.databaseId,e)}function AC(t){const e=vx(t);return e.length===4?xe.emptyPath():_x(e)}function rf(t){return new xe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function _x(t){return ye(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function A0(t,e,n){return{name:nf(t,e),fields:n.value.mapValue.fields}}function NC(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:se(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,f){return d.useProto3Json?(ye(f===void 0||typeof f=="string",58123),at.fromBase64String(f||"")):(ye(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),at.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(d){const f=d.code===void 0?$.UNKNOWN:mx(d.code);return new Y(f,d.message||"")}(o);n=new gx(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Md(t,r.document.name),i=Pn(r.document.updateTime),o=r.document.createTime?Pn(r.document.createTime):oe.min(),c=new Nt({mapValue:{fields:r.document.fields}}),u=pt.newFoundDocument(s,i,o,c),d=r.targetIds||[],f=r.removedTargetIds||[];n=new Xl(d,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Md(t,r.document),i=r.readTime?Pn(r.readTime):oe.min(),o=pt.newNoDocument(s,i),c=r.removedTargetIds||[];n=new Xl([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Md(t,r.document),i=r.removedTargetIds||[];n=new Xl([],i,s,null)}else{if(!("filter"in e))return se(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new yC(s,i),c=r.targetId;n=new px(c,o)}}return n}function kC(t,e){let n;if(e instanceof qa)n={update:A0(t,e.key,e.value)};else if(e instanceof Pm)n={delete:nf(t,e.key)};else if(e instanceof os)n={update:A0(t,e.key,e.data),updateMask:OC(e.fieldMask)};else{if(!(e instanceof mC))return se(16599,{Vt:e.type});n={verify:nf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const c=o.transform;if(c instanceof Aa)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof zi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Na)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof ka)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw se(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:SC(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:se(27497)}(t,e.precondition)),n}function CC(t,e){return t&&t.length>0?(ye(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?Pn(s.updateTime):Pn(i);return o.isEqual(oe.min())&&(o=Pn(i)),new dC(o,s.transformResults||[])}(n,e))):[]}function PC(t,e){return{documents:[wx(t,e.path)]}}function RC(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=wx(t,s);const i=function(d){if(d.length!==0)return Ex(gn.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(f=>function(g){return{field:ii(g.field),direction:LC(g.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const c=ef(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function jC(t){let e=AC(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){ye(r===1,65062);const f=n.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];n.where&&(i=function(m){const g=xx(m);return g instanceof gn&&Y1(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(g=>function(C){return new Oc(oi(C.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(g))}(n.orderBy));let c=null;n.limit&&(c=function(m){let g;return g=typeof m=="object"?m.value:m,vu(g)?null:g}(n.limit));let u=null;n.startAt&&(u=function(m){const g=!!m.before,T=m.values||[];return new Vc(T,g)}(n.startAt));let d=null;return n.endAt&&(d=function(m){const g=!m.before,T=m.values||[];return new Vc(T,g)}(n.endAt)),Zk(e,s,o,i,c,"F",u,d)}function DC(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return se(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function xx(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=oi(n.unaryFilter.field);return ze.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=oi(n.unaryFilter.field);return ze.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=oi(n.unaryFilter.field);return ze.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=oi(n.unaryFilter.field);return ze.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return se(61313);default:return se(60726)}}(t):t.fieldFilter!==void 0?function(n){return ze.create(oi(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return se(58110);default:return se(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return gn.create(n.compositeFilter.filters.map(r=>xx(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return se(1026)}}(n.compositeFilter.op))}(t):se(30097,{filter:t})}function LC(t){return EC[t]}function MC(t){return TC[t]}function VC(t){return IC[t]}function ii(t){return{fieldPath:t.canonicalString()}}function oi(t){return st.fromServerFormat(t.fieldPath)}function Ex(t){return t instanceof ze?function(n){if(n.op==="=="){if(m0(n.value))return{unaryFilter:{field:ii(n.field),op:"IS_NAN"}};if(f0(n.value))return{unaryFilter:{field:ii(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(m0(n.value))return{unaryFilter:{field:ii(n.field),op:"IS_NOT_NAN"}};if(f0(n.value))return{unaryFilter:{field:ii(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ii(n.field),op:MC(n.op),value:n.value}}}(t):t instanceof gn?function(n){const r=n.getFilters().map(s=>Ex(s));return r.length===1?r[0]:{compositeFilter:{op:VC(n.op),filters:r}}}(t):se(54877,{filter:t})}function OC(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Tx(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e,n,r,s,i=oe.min(),o=oe.min(),c=at.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Cr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Cr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Cr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Cr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{constructor(e){this.yt=e}}function UC(t){const e=jC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Zh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC{constructor(){this.Cn=new $C}addToCollectionParentIndex(e,n){return this.Cn.add(n),z.resolve()}getCollectionParents(e,n){return z.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return z.resolve()}deleteFieldIndex(e,n){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,n){return z.resolve()}getDocumentsMatchingTarget(e,n){return z.resolve(null)}getIndexType(e,n){return z.resolve(0)}getFieldIndexes(e,n){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,n){return z.resolve(Kr.min())}getMinOffsetFromCollectionGroup(e,n){return z.resolve(Kr.min())}updateCollectionGroup(e,n,r){return z.resolve()}updateIndexEntries(e,n){return z.resolve()}}class $C{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Xe(xe.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Xe(xe.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Ix=41943040;class bt{static withCacheSize(e){return new bt(e,bt.DEFAULT_COLLECTION_PERCENTILE,bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bt.DEFAULT_COLLECTION_PERCENTILE=10,bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,bt.DEFAULT=new bt(Ix,bt.DEFAULT_COLLECTION_PERCENTILE,bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),bt.DISABLED=new bt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new qi(0)}static cr(){return new qi(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k0="LruGarbageCollector",zC=1048576;function C0([t,e],[n,r]){const s=fe(t,n);return s===0?fe(e,r):s}class qC{constructor(e){this.Ir=e,this.buffer=new Xe(C0),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();C0(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class HC{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){X(k0,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){to(n)?X(k0,"Ignoring IndexedDB error during garbage collection: ",n):await eo(n)}await this.Vr(3e5)})}}class WC{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return z.resolve(yu.ce);const r=new qC(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(X("LruGarbageCollector","Garbage collection skipped; disabled"),z.resolve(N0)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(X("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),N0):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,c,u,d;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(X("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(r=m,c=Date.now(),this.removeTargets(e,r,n))).next(m=>(i=m,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(d=Date.now(),ri()<=he.DEBUG&&X("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${s} in `+(c-o)+`ms
	Removed ${i} targets in `+(u-c)+`ms
	Removed ${m} documents in `+(d-u)+`ms
Total Duration: ${d-f}ms`),z.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m})))}}function KC(t,e){return new WC(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{constructor(){this.changes=new Gs(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,pt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?z.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&na(r.mutation,s,Ut.empty(),Se.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,me()).next(()=>r))}getLocalViewOfDocuments(e,n,r=me()){const s=Ss();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Fo();return i.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Ss();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,me()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,c)=>{n.set(o,c)})})}computeViews(e,n,r,s){let i=or();const o=ta(),c=function(){return ta()}();return n.forEach((u,d)=>{const f=r.get(d.key);s.has(d.key)&&(f===void 0||f.mutation instanceof os)?i=i.insert(d.key,d):f!==void 0?(o.set(d.key,f.mutation.getFieldMask()),na(f.mutation,d,f.mutation.getFieldMask(),Se.now())):o.set(d.key,Ut.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,f)=>o.set(d,f)),n.forEach((d,f)=>c.set(d,new QC(f,o.get(d)??null))),c))}recalculateAndSaveOverlays(e,n){const r=ta();let s=new Re((o,c)=>o-c),i=me();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const c of o)c.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let f=r.get(u)||Ut.empty();f=c.applyToLocalView(d,f),r.set(u,f);const m=(s.get(c.batchId)||me()).add(u);s=s.insert(c.batchId,m)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,f=u.value,m=ix();f.forEach(g=>{if(!i.has(g)){const T=hx(n.get(g),r.get(g));T!==null&&m.set(g,T),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,m))}return z.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return ee.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):ex(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):z.resolve(Ss());let c=Ta,u=i;return o.next(d=>z.forEach(d,(f,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(f)?z.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{u=u.insert(f,g)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,me())).next(f=>({batchId:c,changes:sx(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ee(n)).next(r=>{let s=Fo();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Fo();return this.indexManager.getCollectionParents(e,i).next(c=>z.forEach(c,u=>{const d=function(m,g){return new za(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(f=>{f.forEach((m,g)=>{o=o.insert(m,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,d)=>{const f=d.getKey();o.get(f)===null&&(o=o.insert(f,pt.newInvalidDocument(f)))});let c=Fo();return o.forEach((u,d)=>{const f=i.get(u);f!==void 0&&na(f.mutation,d,Ut.empty(),Se.now()),Eu(n,d)&&(c=c.insert(u,d))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return z.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Pn(s.createTime)}}(n)),z.resolve()}getNamedQuery(e,n){return z.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:UC(s.bundledQuery),readTime:Pn(s.readTime)}}(n)),z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(){this.overlays=new Re(ee.comparator),this.qr=new Map}getOverlay(e,n){return z.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ss();return z.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),z.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),z.resolve()}getOverlaysForCollection(e,n,r){const s=Ss(),i=n.length+1,o=new ee(n.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return z.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Re((d,f)=>d-f);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let f=i.get(d.largestBatchId);f===null&&(f=Ss(),i=i.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const c=Ss(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,f)=>c.set(d,f)),!(c.size()>=s)););return z.resolve(c)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new gC(n,r));let i=this.qr.get(n);i===void 0&&(i=me(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(){this.sessionToken=at.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lm{constructor(){this.Qr=new Xe(Ze.$r),this.Ur=new Xe(Ze.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Ze(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Ze(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new ee(new xe([])),r=new Ze(n,e),s=new Ze(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new ee(new xe([])),r=new Ze(n,e),s=new Ze(n,e+1);let i=me();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Ze(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ze{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return ee.comparator(e.key,n.key)||fe(e.Yr,n.Yr)}static Kr(e,n){return fe(e.Yr,n.Yr)||ee.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Xe(Ze.$r)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new pC(i,n,r,s);this.mutationQueue.push(o);for(const c of s)this.Zr=this.Zr.add(new Ze(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return z.resolve(o)}lookupMutationBatch(e,n){return z.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return z.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?Im:this.tr-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ze(n,0),s=new Ze(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const c=this.Xr(o.Yr);i.push(c)}),z.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Xe(fe);return n.forEach(s=>{const i=new Ze(s,0),o=new Ze(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],c=>{r=r.add(c.Yr)})}),z.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ee.isDocumentKey(i)||(i=i.child(""));const o=new Ze(new ee(i),0);let c=new Xe(fe);return this.Zr.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(c=c.add(u.Yr)),!0)},o),z.resolve(this.ti(c))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){ye(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return z.forEach(n.mutations,s=>{const i=new Ze(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Ze(n,0),s=this.Zr.firstAfterOrEqual(r);return z.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(e){this.ri=e,this.docs=function(){return new Re(ee.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return z.resolve(r?r.document.mutableCopy():pt.newInvalidDocument(n))}getEntries(e,n){let r=or();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():pt.newInvalidDocument(s))}),z.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=or();const o=n.path,c=new ee(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:f}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||Pk(Ck(f),r)<=0||(s.has(f.key)||Eu(n,f))&&(i=i.insert(f.key,f.mutableCopy()))}return z.resolve(i)}getAllFromCollectionGroup(e,n,r,s){se(9500)}ii(e,n){return z.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new nP(this)}getSize(e){return z.resolve(this.size)}}class nP extends GC{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),z.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(e){this.persistence=e,this.si=new Gs(n=>Am(n),Nm),this.lastRemoteSnapshotVersion=oe.min(),this.highestTargetId=0,this.oi=0,this._i=new Lm,this.targetCount=0,this.ai=qi.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),z.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new qi(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,z.resolve()}updateTargetData(e,n){return this.Pr(n),z.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),z.waitFor(i).next(()=>s)}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return z.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),z.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),z.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),z.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return z.resolve(r)}containsKey(e,n){return z.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(e,n){this.ui={},this.overlays={},this.ci=new yu(0),this.li=!1,this.li=!0,this.hi=new ZC,this.referenceDelegate=e(this),this.Pi=new rP(this),this.indexManager=new BC,this.remoteDocumentCache=function(s){return new tP(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new FC(n),this.Ii=new XC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new JC,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new eP(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){X("MemoryPersistence","Starting transaction:",e);const s=new sP(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return z.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class sP extends jk{constructor(e){super(),this.currentSequenceNumber=e}}class Mm{constructor(e){this.persistence=e,this.Ri=new Lm,this.Vi=null}static mi(e){return new Mm(e)}get fi(){if(this.Vi)return this.Vi;throw se(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),z.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),z.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),z.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.fi,r=>{const s=ee.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,oe.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return z.or([()=>z.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Uc{constructor(e,n){this.persistence=e,this.pi=new Gs(r=>Mk(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=KC(this,n)}static mi(e,n){return new Uc(e,n)}Ei(){}di(e){return z.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return z.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?z.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(c=>{c||(r++,i.removeEntry(o,oe.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),z.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),z.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),z.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),z.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Gl(e.data.value)),n}br(e,n,r){return z.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return z.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vm{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=me(),s=me();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Vm(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oP{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return $b()?8:Dk(vt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new iP;return this.Ss(e,n,o).next(c=>{if(i.result=c,this.Vs)return this.bs(e,n,o,c.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(ri()<=he.DEBUG&&X("QueryEngine","SDK will not create cache indexes for query:",si(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),z.resolve()):(ri()<=he.DEBUG&&X("QueryEngine","Query:",si(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(ri()<=he.DEBUG&&X("QueryEngine","The SDK decides to create cache indexes for query:",si(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Cn(n))):z.resolve())}ys(e,n){if(v0(n))return z.resolve(null);let r=Cn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Zh(n,null,"F"),r=Cn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=me(...i);return this.ps.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.Ds(n,c);return this.Cs(n,d,o,u.readTime)?this.ys(e,Zh(n,null,"F")):this.vs(e,d,n,u)}))})))}ws(e,n,r,s){return v0(n)||s.isEqual(oe.min())?z.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?z.resolve(null):(ri()<=he.DEBUG&&X("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),si(n)),this.vs(e,o,n,kk(s,Ta)).next(c=>c))})}Ds(e,n){let r=new Xe(nx(e));return n.forEach((s,i)=>{Eu(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return ri()<=he.DEBUG&&X("QueryEngine","Using full collection scan to execute query:",si(n)),this.ps.getDocumentsMatchingQuery(e,n,Kr.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Om="LocalStore",aP=3e8;class lP{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new Re(fe),this.xs=new Gs(i=>Am(i),Nm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new YC(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function cP(t,e,n,r){return new lP(t,e,n,r)}async function Sx(t,e){const n=le(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],c=[];let u=me();for(const d of s){o.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}for(const d of i){c.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}return n.localDocuments.getDocuments(r,u).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:c}))})})}function uP(t,e){const n=le(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(c,u,d,f){const m=d.batch,g=m.keys();let T=z.resolve();return g.forEach(C=>{T=T.next(()=>f.getEntry(u,C)).next(P=>{const S=d.docVersions.get(C);ye(S!==null,48541),P.version.compareTo(S)<0&&(m.applyToRemoteDocument(P,d),P.isValidDocument()&&(P.setReadTime(d.commitVersion),f.addEntry(P)))})}),T.next(()=>c.mutationQueue.removeMutationBatch(u,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let u=me();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function Ax(t){const e=le(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function dP(t,e){const n=le(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const c=[];e.targetChanges.forEach((f,m)=>{const g=s.get(m);if(!g)return;c.push(n.Pi.removeMatchingKeys(i,f.removedDocuments,m).next(()=>n.Pi.addMatchingKeys(i,f.addedDocuments,m)));let T=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?T=T.withResumeToken(at.EMPTY_BYTE_STRING,oe.min()).withLastLimboFreeSnapshotVersion(oe.min()):f.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(f.resumeToken,r)),s=s.insert(m,T),function(P,S,I){return P.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=aP?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(g,T,f)&&c.push(n.Pi.updateTargetData(i,T))});let u=or(),d=me();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(i,f))}),c.push(hP(i,o,e.documentUpdates).next(f=>{u=f.ks,d=f.qs})),!r.isEqual(oe.min())){const f=n.Pi.getLastRemoteSnapshotVersion(i).next(m=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(f)}return z.waitFor(c).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(n.Ms=s,i))}function hP(t,e,n){let r=me(),s=me();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=or();return n.forEach((c,u)=>{const d=i.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(oe.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):X(Om,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)}),{ks:o,qs:s}})}function fP(t,e){const n=le(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Im),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function mP(t,e){const n=le(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,z.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new Cr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function sf(t,e,n){const r=le(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!to(o))throw o;X(Om,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function P0(t,e,n){const r=le(t);let s=oe.min(),i=me();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,f){const m=le(u),g=m.xs.get(f);return g!==void 0?z.resolve(m.Ms.get(g)):m.Pi.getTargetData(d,f)}(r,o,Cn(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,c.targetId).next(u=>{i=u})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:oe.min(),n?i:me())).next(c=>(pP(r,tC(e),c),{documents:c,Qs:i})))}function pP(t,e,n){let r=t.Os.get(e)||oe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class R0{constructor(){this.activeTargetIds=aC()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class gP{constructor(){this.Mo=new R0,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new R0,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j0="ConnectivityMonitor";class D0{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){X(j0,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){X(j0,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Al=null;function of(){return Al===null?Al=function(){return 268435456+Math.round(2147483648*Math.random())}():Al++,"0x"+Al.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vd="RestConnection",vP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class wP{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Lc?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=of(),c=this.zo(e,n.toUriEncodedString());X(Vd,`Sending RPC '${e}' ${o}:`,c,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,s,i);const{host:d}=new URL(c),f=Qi(d);return this.Jo(e,c,u,r,f).then(m=>(X(Vd,`Received RPC '${e}' ${o}: `,m),m),m=>{throw Fi(Vd,`RPC '${e}' ${o} failed with error: `,m,"url: ",c,"request:",r),m})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Zi}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=vP[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _P{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dt="WebChannelConnection";class xP extends wP{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=of();return new Promise((c,u)=>{const d=new k1;d.setWithCredentials(!0),d.listenOnce(C1.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Kl.NO_ERROR:const m=d.getResponseJson();X(dt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),c(m);break;case Kl.TIMEOUT:X(dt,`RPC '${e}' ${o} timed out`),u(new Y($.DEADLINE_EXCEEDED,"Request time out"));break;case Kl.HTTP_ERROR:const g=d.getStatus();if(X(dt,`RPC '${e}' ${o} failed with status:`,g,"response text:",d.getResponseText()),g>0){let T=d.getResponseJson();Array.isArray(T)&&(T=T[0]);const C=T==null?void 0:T.error;if(C&&C.status&&C.message){const P=function(I){const E=I.toLowerCase().replace(/_/g,"-");return Object.values($).indexOf(E)>=0?E:$.UNKNOWN}(C.status);u(new Y(P,C.message))}else u(new Y($.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new Y($.UNAVAILABLE,"Connection failed."));break;default:se(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{X(dt,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(s);X(dt,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",f,r,15)})}T_(e,n,r){const s=of(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=j1(),c=R1(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const f=i.join("");X(dt,`Creating RPC '${e}' stream ${s}: ${f}`,u);const m=o.createWebChannel(f,u);this.I_(m);let g=!1,T=!1;const C=new _P({Yo:S=>{T?X(dt,`Not sending because RPC '${e}' stream ${s} is closed:`,S):(g||(X(dt,`Opening RPC '${e}' stream ${s} transport.`),m.open(),g=!0),X(dt,`RPC '${e}' stream ${s} sending:`,S),m.send(S))},Zo:()=>m.close()}),P=(S,I,E)=>{S.listen(I,A=>{try{E(A)}catch(D){setTimeout(()=>{throw D},0)}})};return P(m,Oo.EventType.OPEN,()=>{T||(X(dt,`RPC '${e}' stream ${s} transport opened.`),C.o_())}),P(m,Oo.EventType.CLOSE,()=>{T||(T=!0,X(dt,`RPC '${e}' stream ${s} transport closed`),C.a_(),this.E_(m))}),P(m,Oo.EventType.ERROR,S=>{T||(T=!0,Fi(dt,`RPC '${e}' stream ${s} transport errored. Name:`,S.name,"Message:",S.message),C.a_(new Y($.UNAVAILABLE,"The operation could not be completed")))}),P(m,Oo.EventType.MESSAGE,S=>{var I;if(!T){const E=S.data[0];ye(!!E,16349);const A=E,D=(A==null?void 0:A.error)||((I=A[0])==null?void 0:I.error);if(D){X(dt,`RPC '${e}' stream ${s} received error:`,D);const V=D.status;let B=function(b){const k=Ue[b];if(k!==void 0)return mx(k)}(V),y=D.message;B===void 0&&(B=$.INTERNAL,y="Unknown error status: "+V+" with message "+D.message),T=!0,C.a_(new Y(B,y)),m.close()}else X(dt,`RPC '${e}' stream ${s} received:`,E),C.u_(E)}}),P(c,P1.STAT_EVENT,S=>{S.stat===Wh.PROXY?X(dt,`RPC '${e}' stream ${s} detected buffering proxy`):S.stat===Wh.NOPROXY&&X(dt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{C.__()},0),C}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function Od(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Su(t){return new bC(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nx{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&X("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L0="PersistentStream";class kx{constructor(e,n,r,s,i,o,c,u){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Nx(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===$.RESOURCE_EXHAUSTED?(ir(n.toString()),ir("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===$.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new Y($.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return X(L0,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(X(L0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class EP extends kx{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=NC(this.serializer,e),r=function(i){if(!("targetChange"in i))return oe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?oe.min():o.readTime?Pn(o.readTime):oe.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=rf(this.serializer),n.addTarget=function(i,o){let c;const u=o.target;if(c=Xh(u)?{documents:PC(i,u)}:{query:RC(i,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=yx(i,o.resumeToken);const d=ef(i,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(oe.min())>0){c.readTime=Fc(i,o.snapshotVersion.toTimestamp());const d=ef(i,o.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);const r=DC(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=rf(this.serializer),n.removeTarget=e,this.q_(n)}}class TP extends kx{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ye(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ye(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ye(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=CC(e.writeResults,e.commitTime),r=Pn(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=rf(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>kC(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{}class bP extends IP{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Y($.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,tf(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Y($.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Ho(e,tf(n,r),s,o,c,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Y($.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class SP{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ir(n),this.aa=!1):X("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bs="RemoteStore";class AP{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{Qs(this)&&(X(Bs,"Restarting streams for network reachability change."),await async function(u){const d=le(u);d.Ea.add(4),await Wa(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Au(d)}(this))})}),this.Ra=new SP(r,s)}}async function Au(t){if(Qs(t))for(const e of t.da)await e(!0)}async function Wa(t){for(const e of t.da)await e(!1)}function Cx(t,e){const n=le(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),$m(n)?Bm(n):no(n).O_()&&Um(n,e))}function Fm(t,e){const n=le(t),r=no(n);n.Ia.delete(e),r.O_()&&Px(n,e),n.Ia.size===0&&(r.O_()?r.L_():Qs(n)&&n.Ra.set("Unknown"))}function Um(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(oe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}no(t).Y_(e)}function Px(t,e){t.Va.Ue(e),no(t).Z_(e)}function Bm(t){t.Va=new xC({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),no(t).start(),t.Ra.ua()}function $m(t){return Qs(t)&&!no(t).x_()&&t.Ia.size>0}function Qs(t){return le(t).Ea.size===0}function Rx(t){t.Va=void 0}async function NP(t){t.Ra.set("Online")}async function kP(t){t.Ia.forEach((e,n)=>{Um(t,e)})}async function CP(t,e){Rx(t),$m(t)?(t.Ra.ha(e),Bm(t)):t.Ra.set("Unknown")}async function PP(t,e,n){if(t.Ra.set("Online"),e instanceof gx&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.Ia.delete(c),s.Va.removeTarget(c))}(t,e)}catch(r){X(Bs,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Bc(t,r)}else if(e instanceof Xl?t.Va.Ze(e):e instanceof px?t.Va.st(e):t.Va.tt(e),!n.isEqual(oe.min()))try{const r=await Ax(t.localStore);n.compareTo(r)>=0&&await function(i,o){const c=i.Va.Tt(o);return c.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const f=i.Ia.get(d);f&&i.Ia.set(d,f.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,d)=>{const f=i.Ia.get(u);if(!f)return;i.Ia.set(u,f.withResumeToken(at.EMPTY_BYTE_STRING,f.snapshotVersion)),Px(i,u);const m=new Cr(f.target,u,d,f.sequenceNumber);Um(i,m)}),i.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(r){X(Bs,"Failed to raise snapshot:",r),await Bc(t,r)}}async function Bc(t,e,n){if(!to(e))throw e;t.Ea.add(1),await Wa(t),t.Ra.set("Offline"),n||(n=()=>Ax(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{X(Bs,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Au(t)})}function jx(t,e){return e().catch(n=>Bc(t,n,e))}async function Nu(t){const e=le(t),n=Xr(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Im;for(;RP(e);)try{const s=await fP(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,jP(e,s)}catch(s){await Bc(e,s)}Dx(e)&&Lx(e)}function RP(t){return Qs(t)&&t.Ta.length<10}function jP(t,e){t.Ta.push(e);const n=Xr(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Dx(t){return Qs(t)&&!Xr(t).x_()&&t.Ta.length>0}function Lx(t){Xr(t).start()}async function DP(t){Xr(t).ra()}async function LP(t){const e=Xr(t);for(const n of t.Ta)e.ea(n.mutations)}async function MP(t,e,n){const r=t.Ta.shift(),s=Rm.from(r,e,n);await jx(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Nu(t)}async function VP(t,e){e&&Xr(t).X_&&await async function(r,s){if(function(o){return vC(o)&&o!==$.ABORTED}(s.code)){const i=r.Ta.shift();Xr(r).B_(),await jx(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Nu(r)}}(t,e),Dx(t)&&Lx(t)}async function M0(t,e){const n=le(t);n.asyncQueue.verifyOperationInProgress(),X(Bs,"RemoteStore received new credentials");const r=Qs(n);n.Ea.add(3),await Wa(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Au(n)}async function OP(t,e){const n=le(t);e?(n.Ea.delete(2),await Au(n)):e||(n.Ea.add(2),await Wa(n),n.Ra.set("Unknown"))}function no(t){return t.ma||(t.ma=function(n,r,s){const i=le(n);return i.sa(),new EP(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:NP.bind(null,t),t_:kP.bind(null,t),r_:CP.bind(null,t),H_:PP.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),$m(t)?Bm(t):t.Ra.set("Unknown")):(await t.ma.stop(),Rx(t))})),t.ma}function Xr(t){return t.fa||(t.fa=function(n,r,s){const i=le(n);return i.sa(),new TP(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:DP.bind(null,t),r_:VP.bind(null,t),ta:LP.bind(null,t),na:MP.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Nu(t)):(await t.fa.stop(),t.Ta.length>0&&(X(Bs,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Jn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,c=new zm(e,n,o,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Y($.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function qm(t,e){if(ir("AsyncQueue",`${e}: ${t}`),to(t))return new Y($.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{static emptySet(e){return new Ci(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ee.comparator(n.key,r.key):(n,r)=>ee.comparator(n.key,r.key),this.keyedMap=Fo(),this.sortedSet=new Re(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ci)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ci;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0{constructor(){this.ga=new Re(ee.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):se(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Hi{constructor(e,n,r,s,i,o,c,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(c=>{o.push({type:0,doc:c})}),new Hi(e,n,Ci.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&xu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class UP{constructor(){this.queries=O0(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=le(n),i=s.queries;s.queries=O0(),i.forEach((o,c)=>{for(const u of c.Sa)u.onError(r)})})(this,new Y($.ABORTED,"Firestore shutting down"))}}function O0(){return new Gs(t=>tx(t),xu)}async function Hm(t,e){const n=le(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new FP,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const c=qm(o,`Initialization of query '${si(e.query)}' failed`);return void e.onError(c)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&Km(n)}async function Wm(t,e){const n=le(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function BP(t,e){const n=le(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const c of o.Sa)c.Fa(s)&&(r=!0);o.wa=s}}r&&Km(n)}function $P(t,e,n){const r=le(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function Km(t){t.Ca.forEach(e=>{e.next()})}var af,F0;(F0=af||(af={})).Ma="default",F0.Cache="cache";class Gm{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Hi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Hi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==af.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mx{constructor(e){this.key=e}}class Vx{constructor(e){this.key=e}}class zP{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=me(),this.mutatedKeys=me(),this.eu=nx(e),this.tu=new Ci(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new V0,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,m)=>{const g=s.get(f),T=Eu(this.query,m)?m:null,C=!!g&&this.mutatedKeys.has(g.key),P=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let S=!1;g&&T?g.data.isEqual(T.data)?C!==P&&(r.track({type:3,doc:T}),S=!0):this.su(g,T)||(r.track({type:2,doc:T}),S=!0,(u&&this.eu(T,u)>0||d&&this.eu(T,d)<0)&&(c=!0)):!g&&T?(r.track({type:0,doc:T}),S=!0):g&&!T&&(r.track({type:1,doc:g}),S=!0,(u||d)&&(c=!0)),S&&(T?(o=o.add(T),i=P?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{tu:o,iu:r,Cs:c,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((f,m)=>function(T,C){const P=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return se(20277,{Rt:S})}};return P(T)-P(C)}(f.type,m.type)||this.eu(f.doc,m.doc)),this.ou(r),s=s??!1;const c=n&&!s?this._u():[],u=this.Xa.size===0&&this.current&&!s?1:0,d=u!==this.Za;return this.Za=u,o.length!==0||d?{snapshot:new Hi(this.query,e.tu,i,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new V0,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=me(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new Vx(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new Mx(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=me();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Hi.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Qm="SyncEngine";class qP{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class HP{constructor(e){this.key=e,this.hu=!1}}class WP{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Gs(c=>tx(c),xu),this.Iu=new Map,this.Eu=new Set,this.du=new Re(ee.comparator),this.Au=new Map,this.Ru=new Lm,this.Vu={},this.mu=new Map,this.fu=qi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function KP(t,e,n=!0){const r=zx(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await Ox(r,e,n,!0),s}async function GP(t,e){const n=zx(t);await Ox(n,e,!0,!1)}async function Ox(t,e,n,r){const s=await mP(t.localStore,Cn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let c;return r&&(c=await QP(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&Cx(t.remoteStore,s),c}async function QP(t,e,n,r,s){t.pu=(m,g,T)=>async function(P,S,I,E){let A=S.view.ru(I);A.Cs&&(A=await P0(P.localStore,S.query,!1).then(({documents:y})=>S.view.ru(y,A)));const D=E&&E.targetChanges.get(S.targetId),V=E&&E.targetMismatches.get(S.targetId)!=null,B=S.view.applyChanges(A,P.isPrimaryClient,D,V);return B0(P,S.targetId,B.au),B.snapshot}(t,m,g,T);const i=await P0(t.localStore,e,!0),o=new zP(e,i.Qs),c=o.ru(i.documents),u=Ha.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(c,t.isPrimaryClient,u);B0(t,n,d.au);const f=new qP(e,n,o);return t.Tu.set(e,f),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function YP(t,e,n){const r=le(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!xu(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await sf(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Fm(r.remoteStore,s.targetId),lf(r,s.targetId)}).catch(eo)):(lf(r,s.targetId),await sf(r.localStore,s.targetId,!0))}async function XP(t,e){const n=le(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Fm(n.remoteStore,r.targetId))}async function JP(t,e,n){const r=iR(t);try{const s=await function(o,c){const u=le(o),d=Se.now(),f=c.reduce((T,C)=>T.add(C.key),me());let m,g;return u.persistence.runTransaction("Locally write mutations","readwrite",T=>{let C=or(),P=me();return u.Ns.getEntries(T,f).next(S=>{C=S,C.forEach((I,E)=>{E.isValidDocument()||(P=P.add(I))})}).next(()=>u.localDocuments.getOverlayedDocuments(T,C)).next(S=>{m=S;const I=[];for(const E of c){const A=fC(E,m.get(E.key).overlayedDocument);A!=null&&I.push(new os(E.key,A,K1(A.value.mapValue),Zt.exists(!0)))}return u.mutationQueue.addMutationBatch(T,d,I,c)}).next(S=>{g=S;const I=S.applyToLocalDocumentSet(m,P);return u.documentOverlayCache.saveOverlays(T,S.batchId,I)})}).then(()=>({batchId:g.batchId,changes:sx(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,c,u){let d=o.Vu[o.currentUser.toKey()];d||(d=new Re(fe)),d=d.insert(c,u),o.Vu[o.currentUser.toKey()]=d}(r,s.batchId,n),await Ka(r,s.changes),await Nu(r.remoteStore)}catch(s){const i=qm(s,"Failed to persist write");n.reject(i)}}async function Fx(t,e){const n=le(t);try{const r=await dP(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(ye(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?ye(o.hu,14607):s.removedDocuments.size>0&&(ye(o.hu,42227),o.hu=!1))}),await Ka(n,r,e)}catch(r){await eo(r)}}function U0(t,e,n){const r=le(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const c=o.view.va(e);c.snapshot&&s.push(c.snapshot)}),function(o,c){const u=le(o);u.onlineState=c;let d=!1;u.queries.forEach((f,m)=>{for(const g of m.Sa)g.va(c)&&(d=!0)}),d&&Km(u)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function ZP(t,e,n){const r=le(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new Re(ee.comparator);o=o.insert(i,pt.newNoDocument(i,oe.min()));const c=me().add(i),u=new bu(oe.min(),new Map,new Re(fe),o,c);await Fx(r,u),r.du=r.du.remove(i),r.Au.delete(e),Ym(r)}else await sf(r.localStore,e,!1).then(()=>lf(r,e,n)).catch(eo)}async function eR(t,e){const n=le(t),r=e.batch.batchId;try{const s=await uP(n.localStore,e);Bx(n,r,null),Ux(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ka(n,s)}catch(s){await eo(s)}}async function tR(t,e,n){const r=le(t);try{const s=await function(o,c){const u=le(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return u.mutationQueue.lookupMutationBatch(d,c).next(m=>(ye(m!==null,37113),f=m.keys(),u.mutationQueue.removeMutationBatch(d,m))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>u.localDocuments.getDocuments(d,f))})}(r.localStore,e);Bx(r,e,n),Ux(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ka(r,s)}catch(s){await eo(s)}}function Ux(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function Bx(t,e,n){const r=le(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function lf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||$x(t,r)})}function $x(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Fm(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Ym(t))}function B0(t,e,n){for(const r of n)r instanceof Mx?(t.Ru.addReference(r.key,e),nR(t,r)):r instanceof Vx?(X(Qm,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||$x(t,r.key)):se(19791,{wu:r})}function nR(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(X(Qm,"New document in limbo: "+n),t.Eu.add(r),Ym(t))}function Ym(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ee(xe.fromString(e)),r=t.fu.next();t.Au.set(r,new HP(n)),t.du=t.du.insert(n,r),Cx(t.remoteStore,new Cr(Cn(_u(n.path)),r,"TargetPurposeLimboResolution",yu.ce))}}async function Ka(t,e,n){const r=le(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((c,u)=>{o.push(r.pu(u,e,n).then(d=>{var f;if((d||n)&&r.isPrimaryClient){const m=d?!d.fromCache:(f=n==null?void 0:n.targetChanges.get(u.targetId))==null?void 0:f.current;r.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(d){s.push(d);const m=Vm.As(u.targetId,d);i.push(m)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(u,d){const f=le(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>z.forEach(d,g=>z.forEach(g.Es,T=>f.persistence.referenceDelegate.addReference(m,g.targetId,T)).next(()=>z.forEach(g.ds,T=>f.persistence.referenceDelegate.removeReference(m,g.targetId,T)))))}catch(m){if(!to(m))throw m;X(Om,"Failed to update sequence numbers: "+m)}for(const m of d){const g=m.targetId;if(!m.fromCache){const T=f.Ms.get(g),C=T.snapshotVersion,P=T.withLastLimboFreeSnapshotVersion(C);f.Ms=f.Ms.insert(g,P)}}}(r.localStore,i))}async function rR(t,e){const n=le(t);if(!n.currentUser.isEqual(e)){X(Qm,"User change. New user:",e.toKey());const r=await Sx(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(c=>{c.forEach(u=>{u.reject(new Y($.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ka(n,r.Ls)}}function sR(t,e){const n=le(t),r=n.Au.get(e);if(r&&r.hu)return me().add(r.key);{let s=me();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const c=n.Tu.get(o);s=s.unionWith(c.view.nu)}return s}}function zx(t){const e=le(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Fx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=sR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ZP.bind(null,e),e.Pu.H_=BP.bind(null,e.eventManager),e.Pu.yu=$P.bind(null,e.eventManager),e}function iR(t){const e=le(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=eR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=tR.bind(null,e),e}class $c{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Su(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return cP(this.persistence,new oP,e.initialUser,this.serializer)}Cu(e){return new bx(Mm.mi,this.serializer)}Du(e){return new gP}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}$c.provider={build:()=>new $c};class oR extends $c{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ye(this.persistence.referenceDelegate instanceof Uc,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new HC(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?bt.withCacheSize(this.cacheSizeBytes):bt.DEFAULT;return new bx(r=>Uc.mi(r,n),this.serializer)}}class cf{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>U0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=rR.bind(null,this.syncEngine),await OP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new UP}()}createDatastore(e){const n=Su(e.databaseInfo.databaseId),r=function(i){return new xP(i)}(e.databaseInfo);return function(i,o,c,u){return new bP(i,o,c,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,c){return new AP(r,s,i,o,c)}(this.localStore,this.datastore,e.asyncQueue,n=>U0(this.syncEngine,n,0),function(){return D0.v()?new D0:new yP}())}createSyncEngine(e,n){return function(s,i,o,c,u,d,f){const m=new WP(s,i,o,c,u,d);return f&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=le(s);X(Bs,"RemoteStore shutting down."),i.Ea.add(5),await Wa(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}cf.provider={build:()=>new cf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xm{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ir("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr="FirestoreClient";class aR{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=ht.UNAUTHENTICATED,this.clientId=Tm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{X(Jr,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(X(Jr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Jn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=qm(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Fd(t,e){t.asyncQueue.verifyOperationInProgress(),X(Jr,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Sx(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function $0(t,e){t.asyncQueue.verifyOperationInProgress();const n=await lR(t);X(Jr,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>M0(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>M0(e.remoteStore,s)),t._onlineComponents=e}async function lR(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){X(Jr,"Using user provided OfflineComponentProvider");try{await Fd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===$.FAILED_PRECONDITION||s.code===$.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Fi("Error using user provided cache. Falling back to memory cache: "+n),await Fd(t,new $c)}}else X(Jr,"Using default OfflineComponentProvider"),await Fd(t,new oR(void 0));return t._offlineComponents}async function qx(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(X(Jr,"Using user provided OnlineComponentProvider"),await $0(t,t._uninitializedComponentsProvider._online)):(X(Jr,"Using default OnlineComponentProvider"),await $0(t,new cf))),t._onlineComponents}function cR(t){return qx(t).then(e=>e.syncEngine)}async function zc(t){const e=await qx(t),n=e.eventManager;return n.onListen=KP.bind(null,e.syncEngine),n.onUnlisten=YP.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=GP.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=XP.bind(null,e.syncEngine),n}function uR(t,e,n={}){const r=new Jn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,c,u,d){const f=new Xm({next:g=>{f.Nu(),o.enqueueAndForget(()=>Wm(i,m));const T=g.docs.has(c);!T&&g.fromCache?d.reject(new Y($.UNAVAILABLE,"Failed to get document because the client is offline.")):T&&g.fromCache&&u&&u.source==="server"?d.reject(new Y($.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(g)},error:g=>d.reject(g)}),m=new Gm(_u(c.path),f,{includeMetadataChanges:!0,qa:!0});return Hm(i,m)}(await zc(t),t.asyncQueue,e,n,r)),r.promise}function dR(t,e,n={}){const r=new Jn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,c,u,d){const f=new Xm({next:g=>{f.Nu(),o.enqueueAndForget(()=>Wm(i,m)),g.fromCache&&u.source==="server"?d.reject(new Y($.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(g)},error:g=>d.reject(g)}),m=new Gm(c,f,{includeMetadataChanges:!0,qa:!0});return Hm(i,m)}(await zc(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hx(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z0=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wx="firestore.googleapis.com",q0=!0;class H0{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Y($.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Wx,this.ssl=q0}else this.host=e.host,this.ssl=e.ssl??q0;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Ix;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<zC)throw new Y($.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Nk("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Hx(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Y($.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Y($.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Y($.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ku{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new H0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Y($.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Y($.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new H0(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new vk;switch(r.type){case"firstParty":return new Ek(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Y($.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=z0.get(n);r&&(X("ComponentProvider","Removing Datastore"),z0.delete(n),r.terminate())}(this),Promise.resolve()}}function hR(t,e,n,r={}){var d;t=jt(t,ku);const s=Qi(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${n}`;s&&(L_(`https://${c}`),M_("Firestore",!0)),i.host!==Wx&&i.host!==c&&Fi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:c,ssl:s,emulatorOptions:r};if(!Wr(u,o)&&(t._setSettings(u),r.mockUserToken)){let f,m;if(typeof r.mockUserToken=="string")f=r.mockUserToken,m=ht.MOCK_USER;else{f=jb(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new Y($.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new ht(g)}t._authCredentials=new wk(new L1(f,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ys(this.firestore,e,this._query)}}class Le{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Br(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Le(this.firestore,e,this._key)}toJSON(){return{type:Le._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if($a(n,Le._jsonSchema))return new Le(e,r||null,new ee(xe.fromString(n.referencePath)))}}Le._jsonSchemaVersion="firestore/documentReference/1.0",Le._jsonSchema={type:qe("string",Le._jsonSchemaVersion),referencePath:qe("string")};class Br extends Ys{constructor(e,n,r){super(e,n,_u(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Le(this.firestore,null,new ee(e))}withConverter(e){return new Br(this.firestore,e,this._path)}}function Be(t,e,...n){if(t=Me(t),M1("collection","path",e),t instanceof ku){const r=xe.fromString(e,...n);return s0(r),new Br(t,null,r)}{if(!(t instanceof Le||t instanceof Br))throw new Y($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(xe.fromString(e,...n));return s0(r),new Br(t.firestore,null,r)}}function Ge(t,e,...n){if(t=Me(t),arguments.length===1&&(e=Tm.newId()),M1("doc","path",e),t instanceof ku){const r=xe.fromString(e,...n);return r0(r),new Le(t,null,new ee(r))}{if(!(t instanceof Le||t instanceof Br))throw new Y($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(xe.fromString(e,...n));return r0(r),new Le(t.firestore,t instanceof Br?t.converter:null,new ee(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0="AsyncQueue";class K0{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Nx(this,"async_queue_retry"),this._c=()=>{const r=Od();r&&X(W0,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Od();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Od();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Jn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!to(e))throw e;X(W0,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,ir("INTERNAL UNHANDLED ERROR: ",G0(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=zm.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&se(47125,{Pc:G0(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function G0(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q0(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class ar extends ku{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new K0,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new K0(e),this._firestoreClient=void 0,await e}}}function Kx(t,e){const n=typeof t=="object"?t:fm(),r=typeof t=="string"?t:Lc,s=Yi(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Pb("firestore");i&&hR(s,...i)}return s}function Cu(t){if(t._terminated)throw new Y($.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||fR(t),t._firestoreClient}function fR(t){var r,s,i;const e=t._freezeSettings(),n=function(c,u,d,f){return new Fk(c,u,d,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,Hx(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new aR(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Qt(at.fromBase64String(e))}catch(n){throw new Y($.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Qt(at.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Qt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if($a(e,Qt._jsonSchema))return Qt.fromBase64String(e.bytes)}}Qt._jsonSchemaVersion="firestore/bytes/1.0",Qt._jsonSchema={type:qe("string",Qt._jsonSchemaVersion),bytes:qe("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Y($.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new st(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Y($.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Y($.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return fe(this._lat,e._lat)||fe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Rn._jsonSchemaVersion}}static fromJSON(e){if($a(e,Rn._jsonSchema))return new Rn(e.latitude,e.longitude)}}Rn._jsonSchemaVersion="firestore/geoPoint/1.0",Rn._jsonSchema={type:qe("string",Rn._jsonSchemaVersion),latitude:qe("number"),longitude:qe("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:jn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if($a(e,jn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new jn(e.vectorValues);throw new Y($.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}jn._jsonSchemaVersion="firestore/vectorValue/1.0",jn._jsonSchema={type:qe("string",jn._jsonSchemaVersion),vectorValues:qe("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mR=/^__.*__$/;class pR{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new os(e,this.data,this.fieldMask,n,this.fieldTransforms):new qa(e,this.data,n,this.fieldTransforms)}}class Gx{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new os(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Qx(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw se(40011,{Ac:t})}}class Ru{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Ru({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return qc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Qx(this.Ac)&&mR.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class gR{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Su(e)}Cc(e,n,r,s=!1){return new Ru({Ac:e,methodName:n,Dc:r,path:st.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ju(t){const e=t._freezeSettings(),n=Su(t._databaseId);return new gR(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Yx(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);tp("Data must be an object, but it was:",o,r);const c=Xx(r,o);let u,d;if(i.merge)u=new Ut(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const m of i.mergeFields){const g=uf(e,m,n);if(!o.contains(g))throw new Y($.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);Zx(f,g)||f.push(g)}u=new Ut(f),d=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,d=o.fieldTransforms;return new pR(new Nt(c),u,d)}class Du extends ro{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Du}}function yR(t,e,n){return new Ru({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Jm extends ro{_toFieldTransform(e){return new Cm(e.path,new Aa)}isEqual(e){return e instanceof Jm}}class Zm extends ro{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=yR(this,e,!0),r=this.vc.map(i=>so(i,n)),s=new zi(r);return new Cm(e.path,s)}isEqual(e){return e instanceof Zm&&Wr(this.vc,e.vc)}}class ep extends ro{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new ka(e.serializer,ax(e.serializer,this.Fc));return new Cm(e.path,n)}isEqual(e){return e instanceof ep&&this.Fc===e.Fc}}function vR(t,e,n,r){const s=t.Cc(1,e,n);tp("Data must be an object, but it was:",s,r);const i=[],o=Nt.empty();is(r,(u,d)=>{const f=np(e,u,n);d=Me(d);const m=s.yc(f);if(d instanceof Du)i.push(f);else{const g=so(d,m);g!=null&&(i.push(f),o.set(f,g))}});const c=new Ut(i);return new Gx(o,c,s.fieldTransforms)}function wR(t,e,n,r,s,i){const o=t.Cc(1,e,n),c=[uf(e,r,n)],u=[s];if(i.length%2!=0)throw new Y($.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)c.push(uf(e,i[g])),u.push(i[g+1]);const d=[],f=Nt.empty();for(let g=c.length-1;g>=0;--g)if(!Zx(d,c[g])){const T=c[g];let C=u[g];C=Me(C);const P=o.yc(T);if(C instanceof Du)d.push(T);else{const S=so(C,P);S!=null&&(d.push(T),f.set(T,S))}}const m=new Ut(d);return new Gx(f,m,o.fieldTransforms)}function _R(t,e,n,r=!1){return so(n,t.Cc(r?4:3,e))}function so(t,e){if(Jx(t=Me(t)))return tp("Unsupported field value:",e,t),Xx(t,e);if(t instanceof ro)return function(r,s){if(!Qx(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const c of r){let u=so(c,s.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Me(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return ax(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Se.fromDate(r);return{timestampValue:Fc(s.serializer,i)}}if(r instanceof Se){const i=new Se(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Fc(s.serializer,i)}}if(r instanceof Rn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Qt)return{bytesValue:yx(s.serializer,r._byteString)};if(r instanceof Le){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Dm(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof jn)return function(o,c){return{mapValue:{fields:{[H1]:{stringValue:W1},[Mc]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return km(c.serializer,d)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${gu(r)}`)}(t,e)}function Xx(t,e){const n={};return F1(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):is(t,(r,s)=>{const i=so(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Jx(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Se||t instanceof Rn||t instanceof Qt||t instanceof Le||t instanceof ro||t instanceof jn)}function tp(t,e,n){if(!Jx(n)||!V1(n)){const r=gu(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function uf(t,e,n){if((e=Me(e))instanceof Pu)return e._internalPath;if(typeof e=="string")return np(t,e);throw qc("Field path arguments must be of type string or ",t,!1,void 0,n)}const xR=new RegExp("[~\\*/\\[\\]]");function np(t,e,n){if(e.search(xR)>=0)throw qc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Pu(...e.split("."))._internalPath}catch{throw qc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function qc(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new Y($.INVALID_ARGUMENT,c+t+u)}function Zx(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Le(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new ER(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(rp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class ER extends eE{data(){return super.data()}}function rp(t,e){return typeof e=="string"?np(t,e):e instanceof Pu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tE(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Y($.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class sp{}class TR extends sp{}function Tn(t,e,...n){let r=[];e instanceof sp&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof ip).length,c=i.filter(u=>u instanceof Lu).length;if(o>1||o>0&&c>0)throw new Y($.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Lu extends TR{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Lu(e,n,r)}_apply(e){const n=this._parse(e);return nE(e._query,n),new Ys(e.firestore,e.converter,Jh(e._query,n))}_parse(e){const n=ju(e.firestore);return function(i,o,c,u,d,f,m){let g;if(d.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new Y($.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){X0(m,f);const C=[];for(const P of m)C.push(Y0(u,i,P));g={arrayValue:{values:C}}}else g=Y0(u,i,m)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||X0(m,f),g=_R(c,o,m,f==="in"||f==="not-in");return ze.create(d,f,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Pi(t,e,n){const r=e,s=rp("where",t);return Lu._create(s,r,n)}class ip extends sp{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new ip(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:gn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const c=i.getFlattenedFilters();for(const u of c)nE(o,u),o=Jh(o,u)}(e._query,n),new Ys(e.firestore,e.converter,Jh(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Y0(t,e,n){if(typeof(n=Me(n))=="string"){if(n==="")throw new Y($.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ex(e)&&n.indexOf("/")!==-1)throw new Y($.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(xe.fromString(n));if(!ee.isDocumentKey(r))throw new Y($.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return h0(t,new ee(r))}if(n instanceof Le)return h0(t,n._key);throw new Y($.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${gu(n)}.`)}function X0(t,e){if(!Array.isArray(t)||t.length===0)throw new Y($.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function nE(t,e){const n=function(s,i){for(const o of s)for(const c of o.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Y($.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Y($.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class IR{convertValue(e,n="none"){switch(Yr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Oe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Qr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw se(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return is(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[Mc].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>Oe(o.doubleValue));return new jn(n)}convertGeoPoint(e){return new Rn(Oe(e.latitude),Oe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=wu(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ia(e));default:return null}}convertTimestamp(e){const n=Gr(e);return new Se(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=xe.fromString(e);ye(Tx(r),9688,{name:e});const s=new ba(r.get(1),r.get(3)),i=new ee(r.popFirst(5));return s.isEqual(n)||ir(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(t,e,n){let r;return r=t?t.toFirestore(e):e,r}class Bo{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Cs extends eE{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Jl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(rp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Y($.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Cs._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Cs._jsonSchemaVersion="firestore/documentSnapshot/1.0",Cs._jsonSchema={type:qe("string",Cs._jsonSchemaVersion),bundleSource:qe("string","DocumentSnapshot"),bundleName:qe("string"),bundle:qe("string")};class Jl extends Cs{data(e={}){return super.data(e)}}class Ps{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Bo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Jl(this._firestore,this._userDataWriter,r.key,r,new Bo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Y($.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(c=>{const u=new Jl(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Bo(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const u=new Jl(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Bo(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,f=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),f=o.indexOf(c.doc.key)),{type:bR(c.type),doc:u,oldIndex:d,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Y($.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ps._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Tm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function bR(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return se(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hc(t){t=jt(t,Le);const e=jt(t.firestore,ar);return uR(Cu(e),t._key).then(n=>aE(e,t,n))}Ps._jsonSchemaVersion="firestore/querySnapshot/1.0",Ps._jsonSchema={type:qe("string",Ps._jsonSchemaVersion),bundleSource:qe("string","QuerySnapshot"),bundleName:qe("string"),bundle:qe("string")};class op extends IR{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qt(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Le(this.firestore,null,n)}}function sE(t){t=jt(t,Ys);const e=jt(t.firestore,ar),n=Cu(e),r=new op(e);return tE(t._query),dR(n,t._query).then(s=>new Ps(e,r,t,s))}function iE(t,e,n){t=jt(t,Le);const r=jt(t.firestore,ar),s=rE(t.converter,e);return Mu(r,[Yx(ju(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Zt.none())])}function St(t,e,n,...r){t=jt(t,Le);const s=jt(t.firestore,ar),i=ju(s);let o;return o=typeof(e=Me(e))=="string"||e instanceof Pu?wR(i,"updateDoc",t._key,e,n,r):vR(i,"updateDoc",t._key,e),Mu(s,[o.toMutation(t._key,Zt.exists(!0))])}function oE(t){return Mu(jt(t.firestore,ar),[new Pm(t._key,Zt.none())])}function In(t,e){const n=jt(t.firestore,ar),r=Ge(t),s=rE(t.converter,e);return Mu(n,[Yx(ju(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Zt.exists(!1))]).then(()=>r)}function bn(t,...e){var u,d,f;t=Me(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Q0(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(Q0(e[r])){const m=e[r];e[r]=(u=m.next)==null?void 0:u.bind(m),e[r+1]=(d=m.error)==null?void 0:d.bind(m),e[r+2]=(f=m.complete)==null?void 0:f.bind(m)}let i,o,c;if(t instanceof Le)o=jt(t.firestore,ar),c=_u(t._key.path),i={next:m=>{e[r]&&e[r](aE(o,t,m))},error:e[r+1],complete:e[r+2]};else{const m=jt(t,Ys);o=jt(m.firestore,ar),c=m._query;const g=new op(o);i={next:T=>{e[r]&&e[r](new Ps(o,g,m,T))},error:e[r+1],complete:e[r+2]},tE(t._query)}return function(g,T,C,P){const S=new Xm(P),I=new Gm(T,S,C);return g.asyncQueue.enqueueAndForget(async()=>Hm(await zc(g),I)),()=>{S.Nu(),g.asyncQueue.enqueueAndForget(async()=>Wm(await zc(g),I))}}(Cu(o),c,s,i)}function Mu(t,e){return function(r,s){const i=new Jn;return r.asyncQueue.enqueueAndForget(async()=>JP(await cR(r),s,i)),i.promise}(Cu(t),e)}function aE(t,e,n){const r=n.docs.get(e._key),s=new op(t);return new Cs(t,s,e._key,r,new Bo(n.hasPendingWrites,n.fromCache),e.converter)}function ft(){return new Jm("serverTimestamp")}function Wc(...t){return new Zm("arrayUnion",t)}function Kc(t){return new ep("increment",t)}(function(e,n=!0){(function(s){Zi=s})(Xi),Dn(new mn("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),c=new ar(new _k(r.getProvider("auth-internal")),new Tk(o,r.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Y($.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ba(d.options.projectId,f)}(o,s),o);return i={useFetchStreams:n,...i},c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),Jt(Zy,e0,e),Jt(Zy,e0,"esm2020")})();const lE="@firebase/installations",ap="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cE=1e4,uE=`w:${ap}`,dE="FIS_v2",SR="https://firebaseinstallations.googleapis.com/v1",AR=60*60*1e3,NR="installations",kR="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CR={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},$s=new Ks(NR,kR,CR);function hE(t){return t instanceof Mn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fE({projectId:t}){return`${SR}/projects/${t}/installations`}function mE(t){return{token:t.token,requestStatus:2,expiresIn:RR(t.expiresIn),creationTime:Date.now()}}async function pE(t,e){const r=(await e.json()).error;return $s.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function gE({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function PR(t,{refreshToken:e}){const n=gE(t);return n.append("Authorization",jR(e)),n}async function yE(t){const e=await t();return e.status>=500&&e.status<600?t():e}function RR(t){return Number(t.replace("s","000"))}function jR(t){return`${dE} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DR({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=fE(t),s=gE(t),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={fid:n,authVersion:dE,appId:t.appId,sdkVersion:uE},c={method:"POST",headers:s,body:JSON.stringify(o)},u=await yE(()=>fetch(r,c));if(u.ok){const d=await u.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:mE(d.authToken)}}else throw await pE("Create Installation",u)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vE(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LR(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MR=/^[cdef][\w-]{21}$/,df="";function VR(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=OR(t);return MR.test(n)?n:df}catch{return df}}function OR(t){return LR(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vu(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wE=new Map;function _E(t,e){const n=Vu(t);xE(n,e),FR(n,e)}function xE(t,e){const n=wE.get(t);if(n)for(const r of n)r(e)}function FR(t,e){const n=UR();n&&n.postMessage({key:t,fid:e}),BR()}let As=null;function UR(){return!As&&"BroadcastChannel"in self&&(As=new BroadcastChannel("[Firebase] FID Change"),As.onmessage=t=>{xE(t.data.key,t.data.fid)}),As}function BR(){wE.size===0&&As&&(As.close(),As=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $R="firebase-installations-database",zR=1,zs="firebase-installations-store";let Ud=null;function lp(){return Ud||(Ud=hu($R,zR,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(zs)}}})),Ud}async function Gc(t,e){const n=Vu(t),s=(await lp()).transaction(zs,"readwrite"),i=s.objectStore(zs),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&_E(t,e.fid),e}async function EE(t){const e=Vu(t),r=(await lp()).transaction(zs,"readwrite");await r.objectStore(zs).delete(e),await r.done}async function Ou(t,e){const n=Vu(t),s=(await lp()).transaction(zs,"readwrite"),i=s.objectStore(zs),o=await i.get(n),c=e(o);return c===void 0?await i.delete(n):await i.put(c,n),await s.done,c&&(!o||o.fid!==c.fid)&&_E(t,c.fid),c}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cp(t){let e;const n=await Ou(t.appConfig,r=>{const s=qR(r),i=HR(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===df?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function qR(t){const e=t||{fid:VR(),registrationStatus:0};return TE(e)}function HR(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject($s.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=WR(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:KR(t)}:{installationEntry:e}}async function WR(t,e){try{const n=await DR(t,e);return Gc(t.appConfig,n)}catch(n){throw hE(n)&&n.customData.serverCode===409?await EE(t.appConfig):await Gc(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function KR(t){let e=await J0(t.appConfig);for(;e.registrationStatus===1;)await vE(100),e=await J0(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await cp(t);return r||n}return e}function J0(t){return Ou(t,e=>{if(!e)throw $s.create("installation-not-found");return TE(e)})}function TE(t){return GR(t)?{fid:t.fid,registrationStatus:0}:t}function GR(t){return t.registrationStatus===1&&t.registrationTime+cE<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QR({appConfig:t,heartbeatServiceProvider:e},n){const r=YR(t,n),s=PR(t,n),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={installation:{sdkVersion:uE,appId:t.appId}},c={method:"POST",headers:s,body:JSON.stringify(o)},u=await yE(()=>fetch(r,c));if(u.ok){const d=await u.json();return mE(d)}else throw await pE("Generate Auth Token",u)}function YR(t,{fid:e}){return`${fE(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function up(t,e=!1){let n;const r=await Ou(t.appConfig,i=>{if(!IE(i))throw $s.create("not-registered");const o=i.authToken;if(!e&&ZR(o))return i;if(o.requestStatus===1)return n=XR(t,e),i;{if(!navigator.onLine)throw $s.create("app-offline");const c=t4(i);return n=JR(t,c),c}});return n?await n:r.authToken}async function XR(t,e){let n=await Z0(t.appConfig);for(;n.authToken.requestStatus===1;)await vE(100),n=await Z0(t.appConfig);const r=n.authToken;return r.requestStatus===0?up(t,e):r}function Z0(t){return Ou(t,e=>{if(!IE(e))throw $s.create("not-registered");const n=e.authToken;return n4(n)?{...e,authToken:{requestStatus:0}}:e})}async function JR(t,e){try{const n=await QR(t,e),r={...e,authToken:n};return await Gc(t.appConfig,r),n}catch(n){if(hE(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await EE(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await Gc(t.appConfig,r)}throw n}}function IE(t){return t!==void 0&&t.registrationStatus===2}function ZR(t){return t.requestStatus===2&&!e4(t)}function e4(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+AR}function t4(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function n4(t){return t.requestStatus===1&&t.requestTime+cE<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r4(t){const e=t,{installationEntry:n,registrationPromise:r}=await cp(e);return r?r.catch(console.error):up(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s4(t,e=!1){const n=t;return await i4(n),(await up(n,e)).token}async function i4(t){const{registrationPromise:e}=await cp(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o4(t){if(!t||!t.options)throw Bd("App Configuration");if(!t.name)throw Bd("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Bd(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Bd(t){return $s.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bE="installations",a4="installations-internal",l4=t=>{const e=t.getProvider("app").getImmediate(),n=o4(e),r=Yi(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},c4=t=>{const e=t.getProvider("app").getImmediate(),n=Yi(e,bE).getImmediate();return{getId:()=>r4(n),getToken:s=>s4(n,s)}};function u4(){Dn(new mn(bE,l4,"PUBLIC")),Dn(new mn(a4,c4,"PRIVATE"))}u4();Jt(lE,ap);Jt(lE,ap,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d4="/firebase-messaging-sw.js",h4="/firebase-cloud-messaging-push-scope",SE="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",f4="https://fcmregistrations.googleapis.com/v1",AE="google.c.a.c_id",m4="google.c.a.c_l",p4="google.c.a.ts",g4="google.c.a.e",ev=1e4;var tv;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(tv||(tv={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var Ca;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(Ca||(Ca={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bn(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function y4(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $d="fcm_token_details_db",v4=5,nv="fcm_token_object_Store";async function w4(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes($d))return null;let e=null;return(await hu($d,v4,{upgrade:async(r,s,i,o)=>{if(s<2||!r.objectStoreNames.contains(nv))return;const c=o.objectStore(nv),u=await c.index("fcmSenderId").get(t);if(await c.clear(),!!u){if(s===2){const d=u;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:d.createTime??Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:Bn(d.vapidKey)}}}else if(s===3){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Bn(d.auth),p256dh:Bn(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Bn(d.vapidKey)}}}else if(s===4){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Bn(d.auth),p256dh:Bn(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Bn(d.vapidKey)}}}}}})).close(),await Cd($d),await Cd("fcm_vapid_details_db"),await Cd("undefined"),_4(e)?e:null}function _4(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x4="firebase-messaging-database",E4=1,Pa="firebase-messaging-store";let zd=null;function NE(){return zd||(zd=hu(x4,E4,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Pa)}}})),zd}async function T4(t){const e=kE(t),r=await(await NE()).transaction(Pa).objectStore(Pa).get(e);if(r)return r;{const s=await w4(t.appConfig.senderId);if(s)return await dp(t,s),s}}async function dp(t,e){const n=kE(t),s=(await NE()).transaction(Pa,"readwrite");return await s.objectStore(Pa).put(e,n),await s.done,e}function kE({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I4={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},gt=new Ks("messaging","Messaging",I4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b4(t,e){const n=await fp(t),r=CE(e),s={method:"POST",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(hp(t.appConfig),s)).json()}catch(o){throw gt.create("token-subscribe-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw gt.create("token-subscribe-failed",{errorInfo:o})}if(!i.token)throw gt.create("token-subscribe-no-token");return i.token}async function S4(t,e){const n=await fp(t),r=CE(e.subscriptionOptions),s={method:"PATCH",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(`${hp(t.appConfig)}/${e.token}`,s)).json()}catch(o){throw gt.create("token-update-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw gt.create("token-update-failed",{errorInfo:o})}if(!i.token)throw gt.create("token-update-no-token");return i.token}async function A4(t,e){const r={method:"DELETE",headers:await fp(t)};try{const i=await(await fetch(`${hp(t.appConfig)}/${e}`,r)).json();if(i.error){const o=i.error.message;throw gt.create("token-unsubscribe-failed",{errorInfo:o})}}catch(s){throw gt.create("token-unsubscribe-failed",{errorInfo:s==null?void 0:s.toString()})}}function hp({projectId:t}){return`${f4}/projects/${t}/registrations`}async function fp({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function CE({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const s={web:{endpoint:n,auth:e,p256dh:t}};return r!==SE&&(s.web.applicationPubKey=r),s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N4=7*24*60*60*1e3;async function k4(t){const e=await P4(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Bn(e.getKey("auth")),p256dh:Bn(e.getKey("p256dh"))},r=await T4(t.firebaseDependencies);if(r){if(R4(r.subscriptionOptions,n))return Date.now()>=r.createTime+N4?C4(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await A4(t.firebaseDependencies,r.token)}catch(s){console.warn(s)}return rv(t.firebaseDependencies,n)}else return rv(t.firebaseDependencies,n)}async function C4(t,e){try{const n=await S4(t.firebaseDependencies,e),r={...e,token:n,createTime:Date.now()};return await dp(t.firebaseDependencies,r),n}catch(n){throw n}}async function rv(t,e){const r={token:await b4(t,e),createTime:Date.now(),subscriptionOptions:e};return await dp(t,r),r.token}async function P4(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:y4(e)})}function R4(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,s=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&r&&s&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sv(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return j4(e,t),D4(e,t),L4(e,t),e}function j4(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const s=e.notification.image;s&&(t.notification.image=s);const i=e.notification.icon;i&&(t.notification.icon=i)}function D4(t,e){e.data&&(t.data=e.data)}function L4(t,e){var s,i,o,c;if(!e.fcmOptions&&!((s=e.notification)!=null&&s.click_action))return;t.fcmOptions={};const n=((i=e.fcmOptions)==null?void 0:i.link)??((o=e.notification)==null?void 0:o.click_action);n&&(t.fcmOptions.link=n);const r=(c=e.fcmOptions)==null?void 0:c.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M4(t){return typeof t=="object"&&!!t&&AE in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V4(t){if(!t||!t.options)throw qd("App Configuration Object");if(!t.name)throw qd("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw qd(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function qd(t){return gt.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O4{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=V4(e);this.firebaseDependencies={app:e,appConfig:s,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F4(t){try{t.swRegistration=await navigator.serviceWorker.register(d4,{scope:h4}),t.swRegistration.update().catch(()=>{}),await U4(t.swRegistration)}catch(e){throw gt.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}async function U4(t){return new Promise((e,n)=>{const r=setTimeout(()=>n(new Error(`Service worker not registered after ${ev} ms`)),ev),s=t.installing||t.waiting;t.active?(clearTimeout(r),e()):s?s.onstatechange=i=>{var o;((o=i.target)==null?void 0:o.state)==="activated"&&(s.onstatechange=null,clearTimeout(r),e())}:(clearTimeout(r),n(new Error("No incoming service worker found.")))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B4(t,e){if(!e&&!t.swRegistration&&await F4(t),!(!e&&t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw gt.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $4(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=SE)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PE(t,e){if(!navigator)throw gt.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw gt.create("permission-blocked");return await $4(t,e==null?void 0:e.vapidKey),await B4(t,e==null?void 0:e.serviceWorkerRegistration),k4(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z4(t,e,n){const r=q4(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[AE],message_name:n[m4],message_time:n[p4],message_device_time:Math.floor(Date.now()/1e3)})}function q4(t){switch(t){case Ca.NOTIFICATION_CLICKED:return"notification_open";case Ca.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H4(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===Ca.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(sv(n)):t.onMessageHandler.next(sv(n)));const r=n.data;M4(r)&&r[g4]==="1"&&await z4(t,n.messageType,r)}const iv="@firebase/messaging",ov="0.12.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W4=t=>{const e=new O4(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>H4(e,n)),e},K4=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:r=>PE(e,r)}};function G4(){Dn(new mn("messaging",W4,"PUBLIC")),Dn(new mn("messaging-internal",K4,"PRIVATE")),Jt(iv,ov),Jt(iv,ov,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q4(){try{await O_()}catch{return!1}return typeof window<"u"&&V_()&&zb()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y4(t,e){if(!navigator)throw gt.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RE(t=fm()){return Q4().then(e=>{if(!e)throw gt.create("unsupported-browser")},e=>{throw gt.create("indexed-db-unsupported")}),Yi(Me(t),"messaging").getImmediate()}async function jE(t,e){return t=Me(t),PE(t,e)}function DE(t,e){return t=Me(t),Y4(t,e)}G4();const X4={apiKey:"AIzaSyDgTGIPoHLYy9rfdpiQo07Y7F-1ytphaQM",authDomain:"botiga-35dc0.firebaseapp.com",projectId:"botiga-35dc0",storageBucket:"botiga-35dc0.firebasestorage.app",messagingSenderId:"671047302164",appId:"1:671047302164:web:2cc6065f3055dbd8fdbb01",measurementId:"G-C3X8Y6GG88"},mp=hm(X4),ys=A1(mp),We=Kx(mp),Nl=typeof window<"u"?RE(mp):null,Mt=[{id:"user-0",name:"Admin CHMolins",avatarUrl:"https://i.pravatar.cc/150?u=admin",email:"admin@chmolins.com",joinDate:"2023-01-01",role:"admin"},{id:"user-1",name:"Anna L.",avatarUrl:"https://i.pravatar.cc/150?u=anna",email:"anna@example.com",joinDate:"2023-05-12",role:"user"},{id:"user-2",name:"Carles B.",avatarUrl:"https://i.pravatar.cc/150?u=carles",email:"carles@example.com",joinDate:"2023-08-20",role:"user"},{id:"user-3",name:"Laura M.",avatarUrl:"https://i.pravatar.cc/150?u=laura",email:"laura@example.com",joinDate:"2023-11-01",role:"user"},{id:"user-4",name:"David S.",avatarUrl:"https://i.pravatar.cc/150?u=david",email:"david@example.com",joinDate:"2024-02-15",role:"user"}],av=[{id:"1",title:"Jaqueta de cuir vintage",description:"Jaqueta de cuir genu dels anys 80, en perfecte estat. Talla M.",price:75,imageUrls:["https://images.unsplash.com/photo-1551028719-00167b16eac5?q=80&w=800"],seller:Mt[1],createdAt:new Date("2024-07-20T10:00:00Z")},{id:"2",title:"Bicicleta de muntanya Scott",description:"Bicicleta Scott Aspect 970, rodes de 29 polzades, frens de disc. Poc s.",price:350,imageUrls:["https://images.unsplash.com/photo-1576426863848-c21f68c6aa98?q=80&w=800"],seller:Mt[2],createdAt:new Date("2024-07-19T15:30:00Z")},{id:"3",title:"Cmera rflex Canon EOS 2000D",description:"Inclou objectiu 18-55mm, bossa de transport i targeta de memria. Ideal per a principiants.",price:320,imageUrls:["https://images.unsplash.com/photo-1512790182412-b19e6d62bc39?q=80&w=800"],seller:Mt[3],createdAt:new Date("2024-07-19T12:00:00Z")},{id:"4",title:"Sof de 3 places gris",description:"Sof cmode i modern. Fundes rentables. Mides: 200x90cm.",price:180,imageUrls:["https://images.unsplash.com/photo-1555041469-a586c61ea9bc?q=80&w=800"],seller:Mt[4],createdAt:new Date("2024-07-18T18:45:00Z")},{id:"5",title:"Guitarra acstica Yamaha",description:"Model F310. So excellent. Perfecta per aprendre a tocar.",price:90,imageUrls:["https://images.unsplash.com/photo-1558021211-65140282a3f8?q=80&w=800"],seller:Mt[1],createdAt:new Date("2024-07-18T11:20:00Z")},{id:"6",title:"iPhone 12 - 128GB Blau",description:"En bon estat, sempre amb protector de pantalla. Salut de la bateria al 88%.",price:450,imageUrls:["https://images.unsplash.com/photo-1616348436168-de43ad0db179?q=80&w=800"],seller:Mt[3],createdAt:new Date("2024-07-17T20:00:00Z")},{id:"7",title:"Vambes Nike Air Max",description:"Talla 43. Edici limitada. Noms utilitzades un parell de vegades.",price:85,imageUrls:["https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=800"],seller:Mt[2],createdAt:new Date("2024-07-17T09:05:00Z")},{id:"8",title:"Patinet elctric Xiaomi",description:"Model Mi Electric Scooter 3. Fins a 30 km d'autonomia. Plegable i lleuger.",price:250,imageUrls:["https://images.unsplash.com/photo-1598214013444-96379d71c664?q=80&w=800"],seller:Mt[4],createdAt:new Date("2024-07-16T14:00:00Z")},{id:"9",title:"Collecci de llibres de Harry Potter",description:"Els 7 llibres de la saga, tapa dura. Edici Salamandra.",price:60,imageUrls:["https://images.unsplash.com/photo-1618965907452-a8a235327546?q=80&w=800"],seller:Mt[1],createdAt:new Date("2024-07-15T21:30:00Z")},{id:"10",title:"Planta Monstera Deliciosa",description:"Planta d'interior gran i saludable. Inclou test de cermica.",price:30,imageUrls:["https://images.unsplash.com/photo-1614594975525-e4d524c48996?q=80&w=800"],seller:Mt[3],createdAt:new Date("2024-07-15T10:15:00Z")},{id:"11",title:"Samarreta Oficial CHM",description:"Samarreta oficial del club, 100% cot. Totes les talles disponibles.",price:25,imageUrls:["https://images.unsplash.com/photo-1571455789393-8a76380c5435?q=80&w=800"],seller:Mt[0],createdAt:new Date("2024-07-21T10:00:00Z"),isMerchandise:!0},{id:"12",title:"Tassa CHM",description:"Tassa de cermica amb el logo del club. Resistent al microones i rentaplats.",price:12.5,imageUrls:["https://images.unsplash.com/photo-1594225026210-5a9b71b83b63?q=80&w=800"],seller:Mt[0],createdAt:new Date("2024-07-21T10:05:00Z"),isMerchandise:!0},{id:"13",title:"Bufanda CHM Fans",description:"Bufanda de llana per animar l'equip els dies de partit.",price:18,imageUrls:["https://images.unsplash.com/photo-1610295313555-252a71383713?q=80&w=800"],seller:Mt[0],createdAt:new Date("2024-07-21T10:10:00Z"),isMerchandise:!0}],J4=({product:t,currentUser:e,onClose:n,onEdit:r,onContactSeller:s,onDelete:i,onOpenImageViewer:o})=>{const[c,u]=R.useState(0),[d,f]=R.useState(!1),[m,g]=R.useState(!1),T=R.useRef(null);R.useEffect(()=>()=>{T.current&&clearTimeout(T.current)},[]),R.useEffect(()=>{const A=D=>{D.key==="Escape"&&n()};return window.addEventListener("keydown",A),()=>{window.removeEventListener("keydown",A)}},[n]);const C=async()=>{d||(m?(T.current&&(clearTimeout(T.current),T.current=null),f(!0),await i(t.id)||(f(!1),g(!1))):(g(!0),T.current=window.setTimeout(()=>{g(!1),T.current=null},4e3)))},P=(e==null?void 0:e.role)==="admin",S=(e==null?void 0:e.id)===t.seller.id,I=t.imageUrls&&t.imageUrls.length>0,E=A=>typeof A!="number"||isNaN(A)?"N/A":A.toFixed(2);return l.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:n,"aria-modal":"true",role:"dialog",children:[l.jsx("style",{children:`
        @keyframes fade-in {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        .animate-fade-in { animation: fade-in 0.2s ease-out; }
      `}),l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl lg:max-w-4xl xl:max-w-5xl max-h-[90vh] overflow-hidden flex flex-col lg:flex-row relative",onClick:A=>A.stopPropagation(),children:[l.jsx("button",{onClick:n,className:"absolute top-3 right-3 text-gray-400 hover:text-gray-800 z-10 bg-white bg-opacity-50 rounded-full p-1 transition-colors","aria-label":"Tancar",children:l.jsx(qr,{className:"w-6 h-6"})}),l.jsxs("div",{className:"w-full lg:w-3/5 flex-shrink-0 flex flex-col",children:[l.jsx("div",{className:"w-full bg-gray-100 h-80 lg:h-full flex items-center justify-center lg:flex-grow",children:I&&l.jsx("img",{src:t.imageUrls[c],alt:`${t.title} - imatge ${c+1}`,className:`w-full h-full object-cover lg:rounded-l-2xl rounded-t-2xl lg:rounded-t-none cursor-pointer ${t.tag==="vendido"?"grayscale":""}`,onClick:()=>o(t.imageUrls,c)})}),I&&t.imageUrls.length>1&&l.jsx("div",{className:"flex-shrink-0 p-2 bg-white lg:bg-gray-50 flex gap-2 justify-center",children:t.imageUrls.map((A,D)=>l.jsx("button",{onClick:()=>u(D),className:`w-12 h-12 rounded-md overflow-hidden border-2 transition-colors bg-gray-100 ${c===D?"border-primary":"border-transparent hover:border-gray-400"}`,children:l.jsx("img",{src:A,alt:`miniatura ${D+1}`,className:`w-full h-full object-cover ${t.tag==="vendido"?"grayscale":""}`})},D))})]}),l.jsxs("div",{className:"p-4 md:p-6 flex flex-col flex-1 overflow-y-auto",children:[t.tag&&Hn[t.tag]&&l.jsxs("div",{className:`w-fit text-sm font-semibold px-3 py-1 rounded-full mb-3 ${Hn[t.tag].className}`,children:[Hn[t.tag].emoji," ",Hn[t.tag].label]}),l.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-gray-900 mb-2",children:t.title}),l.jsxs("p",{className:"text-3xl lg:text-4xl font-extrabold text-primary mb-4",children:[E(t.price)," "]}),l.jsxs("div",{className:"flex-grow pr-2 space-y-4",children:[l.jsxs("div",{className:"border-t pt-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"Venedor"}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("img",{src:t.seller.avatarUrl,alt:t.seller.name,className:"w-12 h-12 rounded-full mr-4"}),l.jsx("div",{children:l.jsx("p",{className:"font-semibold text-gray-800",children:t.seller.name})})]})]}),l.jsxs("div",{className:"border-t pt-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Descripci"}),l.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:t.description})]})]}),l.jsxs("div",{className:"mt-6 flex-shrink-0 space-y-3",children:[t.isMerchandise&&l.jsxs("a",{href:"https://forms.gle/wc7nmx2MubiMix8h8",target:"_blank",rel:"noopener noreferrer",className:"w-full flex items-center justify-center gap-2 bg-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors",children:[l.jsx($I,{className:"w-5 h-5"}),l.jsx("span",{children:"Realitzar comanda"})]}),!S&&e&&l.jsxs("button",{onClick:()=>s(t),className:`w-full flex items-center justify-center gap-2 font-bold py-3 px-4 rounded-lg transition-colors ${t.isMerchandise?"bg-gray-600 text-white hover:bg-gray-700":"bg-primary text-white hover:bg-primary-700"} disabled:bg-gray-400 disabled:cursor-not-allowed`,disabled:t.tag==="vendido",children:[l.jsx(b_,{className:"w-5 h-5"}),l.jsx("span",{children:t.tag==="vendido"?"Article venut":t.isMerchandise?"Contacta amb el club":"Contacta amb el venedor"})]}),(P||S)&&l.jsxs("div",{className:"flex gap-3",children:[l.jsxs("button",{onClick:()=>r(t),disabled:d||m,className:"w-full flex items-center justify-center gap-2 bg-yellow-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-yellow-600 transition-colors disabled:opacity-50",children:[l.jsx(OI,{className:"w-5 h-5"})," Edita"]}),l.jsx("button",{onClick:C,disabled:d,className:`w-full flex items-center justify-center gap-2 text-white font-bold py-3 px-4 rounded-lg transition-all duration-200 ${m?"bg-red-700 hover:bg-red-800":"bg-red-500 hover:bg-red-600"} disabled:bg-red-400 disabled:cursor-wait`,children:d?l.jsxs(l.Fragment,{children:[l.jsx(Vs,{className:"w-5 h-5"}),l.jsx("span",{children:"Eliminant..."})]}):m?"Confirmar eliminaci":l.jsxs(l.Fragment,{children:[l.jsx(S_,{className:"w-5 h-5"}),l.jsx("span",{children:"Elimina"})]})})]})]})]})]})]})},Z4=()=>{const[t,e]=R.useState("home"),[n,r]=R.useState([]),[s,i]=R.useState([]),[o,c]=R.useState(null),[u,d]=R.useState(null),[f,m]=R.useState(null),[g,T]=R.useState(null),[C,P]=R.useState(null),[S,I]=R.useState(null),[E,A]=R.useState([]),[D,V]=R.useState(!1),[B,y]=R.useState([]),[v,b]=R.useState(null),[k,_]=R.useState([]),[N,x]=R.useState(0),ie=R.useRef(new Set),[Ve,nn]=R.useState(!1);R.useEffect(()=>{if(!S)return;if((async()=>{var U;if(!Nl){console.log("Firebase Messaging no est disponible en aquest navegador.");return}try{if(await window.Notification.requestPermission()==="granted"){const W=await jE(Nl,{vapidKey:"BL2B5V3vjPkyyPrTo-aW-5s5t7oW3_Ni_M9XANqYdM1uO9jY3yA9k84Xo7Z-yL3p0M_sF3g4d2c1qWj9k7l4z5k"});if(W){const H=Ge(We,"users",S.id);(((U=(await Hc(H)).data())==null?void 0:U.fcmTokens)||[]).includes(W)||await St(H,{fcmTokens:Wc(W)})}else console.log("No s'ha pogut obtenir el token de registre.")}}catch(F){console.error("Ha ocorregut un error en configurar les notificacions:",F)}})(),Nl){const U=DE(Nl,F=>{var O,W;console.log("Missatge rebut en primer pla: ",F),c({message:`${(O=F.notification)==null?void 0:O.title}: ${(W=F.notification)==null?void 0:W.body}`,type:"success"})});return()=>U()}},[S]),R.useEffect(()=>{let L=null;const U=g1(ys,F=>{if(L&&(L(),L=null),F){const O=Ge(We,"users",F.uid);L=bn(O,W=>{W.exists()?I({id:F.uid,...W.data()}):(ki(ys),I(null))},W=>{console.error("Error en escoltar el document d'usuari:",W),ki(ys),I(null)})}else I(null)});return()=>{U(),L&&L()}},[]),R.useEffect(()=>{if((S==null?void 0:S.role)==="admin"){const L=Tn(Be(We,"users")),U=bn(L,F=>{const O=F.docs.map(W=>({id:W.id,...W.data()}));A(O.filter(W=>W.id!==S.id))});return()=>U()}else A([])},[S]),R.useEffect(()=>{const L=Tn(Be(We,"products")),U=bn(L,F=>{const O=F.docs.map(q=>{var ue;const J=q.data(),te=(ue=J.createdAt)!=null&&ue.toDate?J.createdAt.toDate():new Date;return{id:q.id,...J,createdAt:te}}),W=O.filter(q=>q.isMerchandise),H=O.filter(q=>!q.isMerchandise);W.sort((q,J)=>J.createdAt.getTime()-q.createdAt.getTime()),H.sort((q,J)=>{const te=q.tag==="vendido",ue=J.tag==="vendido";return te&&!ue?1:!te&&ue?-1:J.createdAt.getTime()-q.createdAt.getTime()}),i(W),r(H),T(null)},F=>{console.error("Error en el listener de Firestore (products):",F),T(F),c({message:"Error de connexi. Mostrant articles d'exemple.",type:"error"});const O=av.filter(H=>H.isMerchandise).map(H=>({...H,createdAt:new Date(H.createdAt)})),W=av.filter(H=>!H.isMerchandise).map(H=>({...H,createdAt:new Date(H.createdAt)}));O.sort((H,q)=>q.createdAt.getTime()-H.createdAt.getTime()),W.sort((H,q)=>q.createdAt.getTime()-H.createdAt.getTime()),i(O),r(W)});return()=>U()},[]),R.useEffect(()=>{if(!S){y([]);return}const L=Tn(Be(We,"chats"),Pi("participantIds","array-contains",S.id)),U=bn(L,F=>{let O=F.docs.map(H=>({id:H.id,...H.data()}));O=O.filter(H=>{var q;return!((q=H.hiddenFor)!=null&&q.includes(S.id))&&!ie.current.has(H.id)}),O.sort((H,q)=>{var ue,Dt;const J=((ue=H.updatedAt)==null?void 0:ue.toMillis())||0;return(((Dt=q.updatedAt)==null?void 0:Dt.toMillis())||0)-J});const W=O.reduce((H,q)=>H+(q.unreadCount[S.id]||0),0);x(W),y(O),T(null)},F=>{console.error("Error fetching chats:",F),T(F)});return()=>U()},[S]),R.useEffect(()=>{if(!v){_([]);return}const L=Tn(Be(We,"chats",v.id,"messages")),U=bn(L,F=>{const O=F.docs.map(W=>({id:W.id,...W.data()}));O.sort((W,H)=>{var te,ue;const q=((te=W.timestamp)==null?void 0:te.toMillis())||0,J=((ue=H.timestamp)==null?void 0:ue.toMillis())||0;return q-J}),_(O)});return()=>U()},[v]),R.useEffect(()=>{if(o){const L=setTimeout(()=>c(null),8e3);return()=>clearTimeout(L)}},[o]),R.useEffect(()=>{const L="LABOTIGA";N>0?document.title=`(${N}) ${L}`:document.title=L},[N]),R.useEffect(()=>(u||D||!S||Ve||C?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[u,D,S,Ve,C]);const Vn=async(L,U)=>{await p1(ys,L,U),c({message:"Benvingut/da de nou!",type:"success"})},Q=(L,U)=>{const W=`<svg xmlns="http://www.w3.org/2000/svg" width="150" height="150" viewBox="0 0 150 150">
                    <rect width="100%" height="100%" fill="${(H=>{let q=0;for(let te=0;te<H.length;te++)q=H.charCodeAt(te)+((q<<5)-q);let J="#";for(let te=0;te<3;te++){const ue=q>>te*8&255;J+=("00"+ue.toString(16)).substr(-2)}return J})(U)}" />
                    <text x="50%" y="55%" dominant-baseline="middle" text-anchor="middle" font-family="Arial, sans-serif" font-size="60" fill="#ffffff">${L}</text>
                 </svg>`;return`data:image/svg+xml;base64,${btoa(W)}`},ne=async(L,U,F,O)=>{let W="",H=O;if(!H){const ue=L.split(" ").map(Dt=>Dt[0]).slice(0,2).join("").toUpperCase();H=Q(ue,L)}try{W=await $l(H)}catch(ue){throw console.error("La pujada de la imatge ha fallat:",ue),new Error("No s'ha pogut pujar la imatge. Revisa la teva configuraci de Cloudinary i que el 'preset' sigui 'unsigned'.")}if(!W)throw new Error("Cloudinary no ha retornat una URL vlida.");const J=(await m1(ys,U,F)).user,te={name:L,email:U,avatarUrl:W,joinDate:new Date().toISOString(),role:"user",fcmTokens:[]};await iE(Ge(We,"users",J.uid),te),I({id:J.uid,...te}),c({message:`Benvingut/da, ${L}! El teu compte ha estat creat.`,type:"success"})},ae=async L=>{try{await f1(ys,L),c({message:"S'ha enviat un correu per restablir la contrasenya. Revisa la teva bstia d'entrada.",type:"success"})}catch(U){throw console.error("Error en restablir la contrasenya:",U),U}},we=async()=>{e("home"),await ki(ys),c({message:"Sessi tancada correctament.",type:"success"})},Te=()=>{e("home"),m(null)},rn=()=>{m(null),e("listing")},lt=()=>{S&&e("profile")},sn=async(L,U,F)=>{if(!S||S.id!==L)throw c({message:"No autoritzat.",type:"error"}),new Error("No autoritzat.");if(U===S.name&&!F){c({message:"No s'han detectat canvis.",type:"success"});return}try{const O={name:U};F&&(O.avatarUrl=await $l(F));const W=Ge(We,"users",L);await St(W,O),c({message:"Perfil actualitzat correctament!",type:"success"})}catch(O){throw console.error("Error actualitzant l'usuari:",O),c({message:`Error en actualitzar: ${O.message||"Error desconegut."}`,type:"error"}),O}},wt=async(L,U)=>{var F;if(!S)throw c({message:"Has d'iniciar la sessi per desar un producte.",type:"error"}),new Error("L'usuari no ha iniciat la sessi.");try{const O=L.imageUrls.map(q=>q.startsWith("data:image")?$l(q):Promise.resolve(q)),W=await Promise.all(O),H={...L,imageUrls:W};if(U){const q=Ge(We,"products",U),J=(F=(await Hc(q)).data())==null?void 0:F.seller;await St(q,{...H,seller:J}),c({message:"Anunci actualitzat correctament!",type:"success"})}else{const q={...H,seller:{id:S.id,name:S.name,avatarUrl:S.avatarUrl},createdAt:new Date};await In(Be(We,"products"),q),c({message:"Anunci publicat amb xit!",type:"success"})}e("home"),m(null)}catch(O){throw console.error("Error al desar el producte:",O),c({message:`Error en desar: ${O.message||"Error desconegut."}`,type:"error"}),O}},Ht=L=>{m(L),d(null),e("listing")},as=async L=>{try{return await oE(Ge(We,"products",L)),c({message:"Anunci eliminat correctament.",type:"success"}),d(null),!0}catch(U){console.error("Error en eliminar el producte: ",U);const F=`Error en eliminar: ${U.code||U.message||"Error desconegut."}`;return c({message:F,type:"error"}),!1}},Xs=L=>{d(L)},io=()=>{d(null)},oo=async L=>{if(!S)return;const U=L.seller.id,F=S.id,O=Be(We,"chats"),W=Tn(O,Pi("productId","==",L.id),Pi("participantIds","array-contains",F)),H=await sE(W);let q=null;if(H.forEach(J=>{const te={id:J.id,...J.data()};te.participantIds.includes(U)&&(q=te)}),q)await dr(q);else{const J={participantIds:[F,U],participants:{[F]:{name:S.name,avatarUrl:S.avatarUrl},[U]:{name:L.seller.name,avatarUrl:L.seller.avatarUrl}},productId:L.id,productTitle:L.title,productImageUrl:L.imageUrls[0]||"",lastMessage:null,createdAt:ft(),updatedAt:ft(),unreadCount:{[F]:0,[U]:0},hiddenFor:[]},te=await In(Be(We,"chats"),J);b({id:te.id,...J})}d(null),V(!0)},dr=async L=>{if(b(L),S&&(L.unreadCount[S.id]||0)>0){const U=Ge(We,"chats",L.id);await St(U,{[`unreadCount.${S.id}`]:0})}},ls=async(L,U)=>{if(!S||!v)return;const F=S.id,O=v.participantIds.find(q=>q!==F);if(!O)return;const W={senderId:F,text:L,timestamp:ft(),...U&&{imageUrl:U}};await In(Be(We,"chats",v.id,"messages"),W);const H=Ge(We,"chats",v.id);await St(H,{lastMessage:{...W,timestamp:new Date},updatedAt:ft(),[`unreadCount.${O}`]:Kc(1)})},Js=()=>{b(null)},ao=()=>{V(!1),b(null)},cs=async L=>{if(!S)return;ie.current.add(L),y(F=>F.filter(O=>O.id!==L)),(v==null?void 0:v.id)===L&&b(null);const U=Ge(We,"chats",L);try{await St(U,{hiddenFor:Wc(S.id)}),ie.current.delete(L)}catch(F){console.error("Error en eliminar el xat:",F),c({message:"No s'ha pogut eliminar el xat. La conversa es restaurar.",type:"error"}),ie.current.delete(L)}},us=async(L,U)=>{if(!S||S.role!=="admin"){c({message:"No autoritzat.",type:"error"});return}const F=L==="all"?E:E.filter(O=>O.id===L);if(F.length===0){c({message:"No s'han trobat destinataris.",type:"error"});return}try{for(const O of F){const W=`admin-message-${S.id}-${O.id}-${Date.now()}`,H={participantIds:[S.id,O.id],participants:{[S.id]:{name:S.name,avatarUrl:S.avatarUrl},[O.id]:{name:O.name,avatarUrl:O.avatarUrl}},productId:W,productTitle:"Missatge de l'administrador",productImageUrl:S.avatarUrl,lastMessage:null,createdAt:ft(),updatedAt:ft(),unreadCount:{[S.id]:0,[O.id]:0},hiddenFor:[]},q=await In(Be(We,"chats"),H),J={senderId:S.id,text:U,timestamp:ft()};await In(Be(We,"chats",q.id,"messages"),J),await St(q,{lastMessage:{...J,timestamp:new Date},updatedAt:ft(),[`unreadCount.${O.id}`]:Kc(1)})}c({message:`Missatge enviat a ${F.length} usuari(s).`,type:"success"})}catch(O){throw console.error("Error en enviar el missatge d'administrador:",O),c({message:"No s'ha pogut enviar el missatge.",type:"error"}),O}};return S?l.jsxs("div",{className:"min-h-screen bg-gray-50 font-sans text-gray-800",children:[l.jsx(QI,{user:S,onNavigateHome:Te,onNavigateToListing:rn,onNavigateToProfile:lt,onOpenTutorial:()=>nn(!0)}),l.jsx(ub,{message:(o==null?void 0:o.message)||null,type:o==null?void 0:o.type,onClose:()=>c(null)}),t==="home"&&l.jsx(YI,{userProducts:n,merchProducts:s,onProductSelect:Xs,firebaseError:g,currentUser:S}),t==="listing"&&l.jsx(cb,{onSave:wt,productToEdit:f,currentUser:S}),t==="profile"&&l.jsx(pb,{user:S,onUpdateUser:sn,onBack:()=>e("home"),onLogout:we,allUsers:E,onSendAdminMessage:us}),u&&l.jsx(J4,{product:u,currentUser:S,onClose:io,onEdit:Ht,onContactSeller:oo,onDelete:as,onOpenImageViewer:(L,U)=>P({images:L,startIndex:U})}),Ve&&l.jsx(xb,{onClose:()=>nn(!1)}),C&&l.jsx(Eb,{images:C.images,startIndex:C.startIndex,onClose:()=>P(null)}),l.jsx(gb,{isOpen:D,onClick:()=>V(!D),unreadCount:N}),l.jsx(_b,{isOpen:D,onClose:ao,chats:B,activeChat:v,messages:k,currentUser:S,onSendMessage:ls,onSelectChat:dr,onBackToList:Js,onDeleteChat:cs})]}):l.jsxs("div",{className:"min-h-screen bg-cover bg-center flex items-center justify-center p-4",style:{backgroundImage:"url('https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/Bandera%20Club%20Handbol%20Molins.png')"},children:[l.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"}),l.jsx("div",{className:"relative z-10",children:l.jsx(hb,{onLogin:Vn,onRegister:ne,onPasswordReset:ae,isDismissable:!1})})]})},LE=document.getElementById("root");if(!LE)throw new Error("Could not find root element to mount to");const e5=ec.createRoot(LE);e5.render(l.jsx(Ev.StrictMode,{children:l.jsx(Z4,{})}));const pp=t=>l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.776 48.776 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})]}),ME=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193l-3.722.28c-.443.034-.884.176-1.286.448l-4.486 2.872c-.18.115-.383.115-.564 0l-4.486-2.873a1.875 1.875 0 01-1.286-.447l-3.722-.281a2.25 2.25 0 01-1.98-2.192v-4.286c0-.97.616-1.813 1.5-2.097m14.25-1.118a2.25 2.25 0 00-2.25-2.25h-8.25a2.25 2.25 0 00-2.25 2.25v.928c.378-.04.757-.067 1.143-.082l3.722-.281c.443-.034.884-.176 1.286-.448l4.486-2.872c.18-.115.383.115.564 0l4.486 2.873c.402.27.843.414 1.286.448l3.722.28c.386.016.764.042 1.143.082v-.928a2.25 2.25 0 00-2.25-2.25h-8.25a2.25 2.25 0 00-2.25 2.25v.928"})}),Zr=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),VE=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})}),t5=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),OE=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25z"})}),qs=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`animate-spin ${t.className}`,children:l.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),n5=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"})}),r5=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.122 2.122l7.81-7.81"})}),s5=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),i5=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 00-3 3h15.75m-12.75-3h11.218c.51 0 .962-.343 1.087-.835l1.821-6.831a1.5 1.5 0 00-1.422-2.098H5.168L4.659 3.563A1.5 1.5 0 003.132 2.25H2.25m5.25 9h10.5m-10.5-9h10.5"})}),o5=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})}),a5=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.562L16.5 21.75l-.398-1.188a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.188-.398a2.25 2.25 0 001.423-1.423L16.5 15.75l.398 1.188a2.25 2.25 0 001.423 1.423L19.5 18.75l-1.188.398a2.25 2.25 0 00-1.423 1.423z"})}),lv=t=>l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6h.008v.008H6V6z"})]}),hf=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),l5=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z"})}),c5=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})}),u5=t=>l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),d5=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.243 4.243L6.228 6.228"})}),FE=t=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"})}),h5=({user:t,onNavigateHome:e,onNavigateToListing:n,onNavigateToProfile:r,onOpenTutorial:s})=>l.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-10",children:l.jsxs("div",{className:"container mx-auto px-4 md:px-8 py-4 flex items-center justify-between",children:[l.jsxs("button",{onClick:e,className:"flex items-center gap-3 cursor-pointer",children:[l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-10 w-auto"}),l.jsxs("span",{className:"text-2xl font-bold",children:[l.jsx("span",{className:"text-gray-900",children:"LA"}),l.jsx("span",{className:"text-primary",children:"BOTIGA"})]})]}),l.jsx("div",{className:"flex items-center gap-4",children:t&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:s,className:"p-2 text-gray-500 hover:text-primary hover:bg-gray-100 rounded-full transition-colors","aria-label":"Obre el tutorial",children:l.jsx(FE,{className:"w-7 h-7"})}),l.jsxs("button",{onClick:n,className:"bg-primary text-white font-semibold p-2 sm:px-4 sm:py-2 rounded-lg hover:bg-primary-700 transition-colors flex items-center gap-2",children:[l.jsx(hf,{className:"h-5 w-5"}),l.jsx("span",{className:"hidden sm:inline",children:"Puja un article"})]}),l.jsxs("button",{onClick:r,className:"flex items-center gap-2 cursor-pointer p-1 rounded-md hover:bg-gray-100",children:[l.jsx("img",{src:t.avatarUrl,alt:t.name,className:"w-9 h-9 rounded-full border-2 border-primary-200"}),l.jsx("span",{className:"font-semibold text-gray-700 hidden md:block",children:t.name})]})]})})]})}),Gn={novedad:{label:"Novetat",emoji:"",className:"bg-blue-500 text-white"},ultimas_unidades:{label:"ltimes Unitats",emoji:"",className:"bg-yellow-500 text-black"},reservado:{label:"Reservat",emoji:"",className:"bg-orange-500 text-white"},vendido:{label:"Tracte Fet",emoji:"",className:"bg-gray-700 text-white"}},cv=({product:t,onSelect:e})=>{const n=t.imageUrls&&t.imageUrls.length>0,r=i=>typeof i!="number"||isNaN(i)?"N/A":i.toFixed(2),s=t.tag?Gn[t.tag]:null;return l.jsxs("button",{onClick:e,className:`bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden group text-left w-full hover:shadow-lg transition-shadow duration-200 ${t.tag==="vendido"?"opacity-70":""}`,children:[l.jsxs("div",{className:"relative w-full aspect-square bg-gray-100 overflow-hidden",children:[n&&l.jsx("img",{src:t.imageUrls[0],alt:t.title,className:`w-full h-full object-cover group-hover:scale-105 transition-transform duration-300 ${t.tag==="vendido"?"grayscale":""}`}),s&&l.jsxs("div",{className:`absolute top-2 left-2 text-xs font-bold px-2 py-1 rounded-full shadow-md ${s.className}`,children:[s.emoji," ",s.label]})]}),l.jsxs("div",{className:"p-3",children:[l.jsxs("p",{className:"font-bold text-gray-800 text-lg",children:[r(t.price)," "]}),l.jsx("h3",{className:"text-gray-600 text-sm truncate",children:t.title}),l.jsxs("div",{className:"flex items-center mt-2 pt-2 border-t border-gray-100",children:[l.jsx("img",{src:t.seller.avatarUrl,alt:t.seller.name,className:"w-6 h-6 rounded-full mr-2"}),l.jsx("p",{className:"text-xs text-gray-500 truncate",children:t.seller.name})]})]})]})},f5=({userProducts:t,merchProducts:e,onProductSelect:n,firebaseError:r,currentUser:s})=>{const[i,o]=R.useState(t),[c,u]=R.useState("");R.useEffect(()=>{const f=c.toLowerCase();if(f==="")o(t);else{const m=t.filter(g=>g.title.toLowerCase().includes(f)||g.description.toLowerCase().includes(f));o(m)}},[c,t]);const d=f=>{u(f.target.value)};return l.jsxs("main",{className:"container mx-auto p-4 md:p-8",children:[l.jsxs("div",{className:"bg-white rounded-2xl shadow-md border border-gray-200 p-6 mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Descobreix i estalvia"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Busca entre els articles de segona m a prop teu."}),l.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:l.jsxs("div",{className:"relative flex-grow",children:[l.jsx(s5,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Busca el que et calgui per practicar el millor esport del mn",value:c,onChange:d,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary bg-white text-gray-900"})]})})]}),e.length>0&&l.jsx("section",{className:"mb-12",children:l.jsxs("div",{className:"bg-primary-50 border border-primary-200 rounded-2xl p-6 shadow-sm",children:[l.jsx("div",{className:"flex justify-between items-center mb-6",children:l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Marxandatge del Club"})}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6",children:e.map(f=>l.jsx(cv,{product:f,onSelect:()=>n(f)},f.id))})]})}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Articles destacats"}),i.length>0?l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6",children:i.map(f=>l.jsx(cv,{product:f,onSelect:()=>n(f)},f.id))}):l.jsx("div",{className:"text-center py-16",children:l.jsx("p",{className:"text-gray-600",children:"No s'han trobat articles que coincideixin amb la teva cerca."})})]})]})},Fn=5,m5=(t,e=1280,n=1280)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var u;if(!((u=o.target)!=null&&u.result))return s(new Error("No s'ha pogut llegir el fitxer."));const c=new Image;c.src=o.target.result,c.onload=()=>{const d=document.createElement("canvas");let{width:f,height:m}=c;f>m?f>e&&(m=Math.round(m*(e/f)),f=e):m>n&&(f=Math.round(f*(n/m)),m=n),d.width=f,d.height=m;const g=d.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(c,0,0,f,m),d.toBlob(T=>{T?r(T):s(new Error("La creaci del Blob des del canvas ha fallat."))},"image/jpeg",.85)},c.onerror=d=>s(new Error(`Error en carregar la imatge: ${d}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),p5=({imagePreviews:t,onImagesAdded:e,onDeleteImage:n})=>{const[r,s]=R.useState(!1),[i,o]=R.useState(null),[c,u]=R.useState(!1),d=R.useRef(null),f=R.useRef(null),m=async C=>{const P=C.target.files;if(!P)return;const S=Array.from(P).slice(0,Fn-t.length);if(P.length>S.length?o(`Noms pots pujar un mxim de ${Fn} imatges.`):o(null),S.length!==0){s(!0);try{const I=S.map(A=>m5(A)),E=await Promise.all(I);e(E)}catch(I){o("No s'ha pogut carregar una o ms imatges."),console.error(I)}finally{s(!1)}C.target.value=""}},g=()=>{var C;u(!1),(C=d.current)==null||C.click()},T=()=>{var C;u(!1),(C=f.current)==null||C.click()};return l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:l.jsx(hf,{className:"h-6 w-6 text-primary"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"1. Puja les teves fotos"})]}),l.jsxs("p",{className:"text-sm font-medium text-gray-500",children:[t.length," / ",Fn]})]}),l.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-4",children:[t.map((C,P)=>l.jsxs("div",{className:"relative aspect-square group",children:[l.jsx("img",{src:C,alt:`Product image ${P+1}`,className:"w-full h-full object-cover rounded-lg border"}),l.jsx("button",{onClick:()=>n(P),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity","aria-label":"Eliminar imatge",children:l.jsx(Zr,{className:"w-4 h-4"})})]},P)),r&&l.jsx("div",{className:"aspect-square flex justify-center items-center w-full h-full border-2 border-dashed border-gray-300 rounded-lg",children:l.jsx(qs,{className:"w-8 h-8 text-primary"})}),t.length<Fn&&!r&&l.jsxs("button",{onClick:()=>u(!0),className:"aspect-square flex flex-col justify-center items-center w-full h-full border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-primary hover:bg-primary-50 transition-colors text-center","aria-label":`Puja ${Fn-t.length} imatges ms`,children:[l.jsx(hf,{className:"mx-auto h-8 w-8 text-gray-400"}),l.jsx("p",{className:"mt-1 text-xs text-gray-600",children:l.jsx("span",{className:"font-semibold text-primary",children:"Afegeix fotos"})})]})]}),l.jsx("input",{ref:d,type:"file",onChange:m,className:"hidden",accept:"image/*",multiple:!0,disabled:t.length>=Fn}),l.jsx("input",{ref:f,type:"file",onChange:m,className:"hidden",accept:"image/*",capture:"environment",disabled:t.length>=Fn}),i&&l.jsx("p",{className:"text-red-500 text-sm mt-4",children:i}),c&&l.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4 animate-fade-in-fast",onClick:()=>u(!1),"aria-modal":"true",role:"dialog",children:[l.jsx("style",{children:`
            @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }
            .animate-fade-in-fast { animation: fade-in-fast 0.2s ease-out; }
            @keyframes scale-in { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
            .animate-scale-in { animation: scale-in 0.2s ease-out; }
          `}),l.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-xs shadow-xl animate-scale-in",onClick:C=>C.stopPropagation(),children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Tria una opci"}),l.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:l.jsx(Zr,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{onClick:T,className:"w-full flex items-center gap-4 p-4 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors disabled:opacity-50",disabled:t.length>=Fn,children:[l.jsx(pp,{className:"w-6 h-6 text-primary"}),l.jsx("span",{className:"font-semibold text-gray-700",children:"Fes una foto"})]}),l.jsxs("button",{onClick:g,className:"w-full flex items-center gap-4 p-4 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors disabled:opacity-50",disabled:t.length>=Fn,children:[l.jsx(OE,{className:"w-6 h-6 text-primary"}),l.jsx("span",{className:"font-semibold text-gray-700",children:"Tria de la galeria"})]})]})]})]})]})},g5=({title:t,setTitle:e,description:n,setDescription:r})=>l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:l.jsx(a5,{className:"h-6 w-6 text-primary"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"2. Descriu el teu article"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"product-title",className:"block text-sm font-medium text-gray-700",children:"Ttol del producte"}),l.jsx("input",{id:"product-title",type:"text",value:t,onChange:s=>e(s.target.value),placeholder:'p. ex., "Jaqueta de cuir vintage"',className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{htmlFor:"product-description",className:"block text-sm font-medium text-gray-700",children:"Descripci"}),l.jsx("textarea",{id:"product-description",rows:6,value:n,onChange:s=>r(s.target.value),placeholder:"Descriu el teu article amb detall...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]})]}),y5=({imagePreviews:t,title:e,description:n,price:r,onPublish:s,isEditing:i,isPublishing:o})=>{const c=t.length>0&&e&&r;return l.jsx("div",{className:"sticky top-28",children:l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Vista prvia de l'anunci"}),l.jsx("div",{className:"w-full aspect-square bg-gray-100 rounded-lg mb-4 flex items-center justify-center",children:t&&t.length>0?l.jsx("img",{src:t[0],alt:"Vista prvia del producte",className:"w-full h-full object-cover rounded-lg"}):l.jsx(OE,{className:"w-16 h-16 text-gray-300"})}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-900 truncate",children:e||"Ttol del producte"}),l.jsx("p",{className:"text-3xl font-extrabold text-primary",children:r?`${parseFloat(r).toFixed(2)} `:"0.00 "}),l.jsx("div",{className:"border-t pt-3",children:l.jsx("p",{className:"text-gray-600 text-sm whitespace-pre-wrap h-32 overflow-y-auto",children:n||"La teva descripci generada apareixer aqu..."})}),l.jsx("button",{onClick:s,disabled:!c||o,className:"w-full bg-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:o?l.jsxs(l.Fragment,{children:[l.jsx(qs,{className:"w-5 h-5"}),l.jsx("span",{children:i?"Desant...":"Publicant..."})]}):i?"Desa els canvis":"Publica l'anunci"})]})]})})},v5="dfmkfeqzt",w5="BOTIGAHANDBOL",Zl=async t=>{try{const e=new FormData;e.append("file",t),e.append("upload_preset",w5);const n=await fetch(`https://api.cloudinary.com/v1_1/${v5}/image/upload`,{method:"POST",body:e});if(!n.ok){const s=await n.json();throw new Error(`Error en pujar a Cloudinary: ${s.error.message}`)}return(await n.json()).secure_url}catch(e){throw console.error("Error en la crrega a Cloudinary:",e),e}},_5="ListingDraftDB",x5=1,es="listingDrafts",gp="currentListingDraft",yp=()=>new Promise((t,e)=>{const n=indexedDB.open(_5,x5);n.onerror=()=>e("Error en obrir la base de dades IndexedDB."),n.onsuccess=()=>t(n.result),n.onupgradeneeded=r=>{const s=r.target.result;s.objectStoreNames.contains(es)||s.createObjectStore(es)}}),E5=t=>new Promise((e,n)=>{const r=new FileReader;r.onloadend=()=>e(r.result),r.onerror=n,r.readAsDataURL(t)}),T5=async t=>{const n=(await yp()).transaction(es,"readwrite");return n.objectStore(es).put(t,gp),new Promise((s,i)=>{n.oncomplete=()=>s(),n.onerror=()=>i("Error en desar l'esborrany a IndexedDB.")})},I5=async()=>{const r=(await yp()).transaction(es,"readonly").objectStore(es).get(gp);return new Promise((s,i)=>{r.onsuccess=()=>{s(r.result||null)},r.onerror=()=>i("Error en llegir l'esborrany.")})},b5=async()=>{(await yp()).transaction(es,"readwrite").objectStore(es).delete(gp)},S5=({onSave:t,productToEdit:e,currentUser:n})=>{const[r,s]=R.useState([]),[i,o]=R.useState([]),[c,u]=R.useState(""),[d,f]=R.useState(""),[m,g]=R.useState(""),[T,C]=R.useState(!1),[P,S]=R.useState(""),[I,E]=R.useState(!0),[A,D]=R.useState(!1),V=!!e;R.useEffect(()=>{const _=r.map(N=>typeof N=="string"?N:URL.createObjectURL(N));return o(_),()=>{_.forEach(N=>{N.startsWith("blob:")&&URL.revokeObjectURL(N)})}},[r]),R.useEffect(()=>{(async()=>{var N;if(V&&e)u(e.title),f(e.description),g(((N=e.price)==null?void 0:N.toString())||""),s(e.imageUrls||[]),C(e.isMerchandise||!1),S(e.tag||"");else if(!V)try{const x=await I5();x&&(s(x.imagesData||[]),u(x.title||""),f(x.description||""),g(x.price||""),C(x.isMerchandise||!1),S(x.tag||""))}catch(x){console.error("Error en restaurar l'esborrany:",x)}E(!1)})()},[e,V]),R.useEffect(()=>{if(I||V)return;T5({imagesData:r,title:c,description:d,price:m,isMerchandise:T,tag:P}).catch(N=>console.error("Error en desar l'esborrany:",N))},[r,c,d,m,T,P,I,V]);const B=async()=>{s([]),u(""),f(""),g(""),C(!1),S(""),await b5()},y=async()=>{if(i.length>0&&c&&m){D(!0);try{const _=r.map(ie=>typeof ie=="string"?Promise.resolve(ie):E5(ie).then(Ve=>Zl(Ve))),N=await Promise.all(_),x={title:c,description:d,price:parseFloat(m),imageUrls:N,isMerchandise:T,tag:P||void 0};await t(x,e==null?void 0:e.id),await B()}catch{console.error("La publicaci ha fallat. L'usuari ja ha estat notificat.")}finally{D(!1)}}},v={novedad:Gn.novedad,ultimas_unidades:Gn.ultimas_unidades},b={reservado:Gn.reservado,vendido:Gn.vendido},k=(n==null?void 0:n.role)==="admin"&&T?v:b;return I&&!V?l.jsx("div",{className:"flex justify-center items-center h-screen",children:l.jsx("p",{className:"text-gray-600",children:"Recuperant l'esborrany..."})}):l.jsx("main",{className:"container mx-auto p-4 md:p-8",children:l.jsxs("div",{className:"max-w-7xl mx-auto",children:[l.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",children:V?"Edita el teu anunci":"Crea el teu anunci"}),l.jsx("p",{className:"text-gray-600 mb-8",children:V?"Actualitza els detalls del teu producte.":"Fes servir les nostres eines per fer destacar el teu producte."}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8",children:[l.jsxs("div",{className:"lg:col-span-3 flex flex-col gap-8",children:[l.jsx(p5,{imagePreviews:i,onImagesAdded:_=>s(N=>[...N,..._]),onDeleteImage:_=>s(N=>N.filter((x,ie)=>ie!==_))}),l.jsx(g5,{title:c,setTitle:u,description:d,setDescription:f}),l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:l.jsx(lv,{className:"h-6 w-6 text-primary"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"3. Afegeix un preu"})]}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Introdueix el preu de venda del teu article."}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"product-price",className:"block text-sm font-medium text-gray-700",children:"Preu ()"}),l.jsx("input",{id:"product-price",type:"number",value:m,onChange:_=>g(_.target.value),placeholder:"p. ex., 25.50",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",step:"0.01",min:"0",required:!0})]})]}),l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:l.jsx(lv,{className:"h-6 w-6 text-primary"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"4. Etiqueta (Opcional)"})]}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Selecciona un estat per al teu article."}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("label",{className:"flex items-center gap-3 cursor-pointer p-2 rounded-lg hover:bg-gray-50",children:[l.jsx("input",{type:"radio",name:"tag",value:"",checked:P==="",onChange:_=>S(_.target.value),className:"h-5 w-5 text-primary focus:ring-primary border-gray-300"}),l.jsx("span",{className:"text-gray-700 font-medium",children:"Cap etiqueta"})]}),Object.entries(k).map(([_,N])=>l.jsxs("label",{className:"flex items-center gap-3 cursor-pointer p-2 rounded-lg hover:bg-gray-50",children:[l.jsx("input",{type:"radio",name:"tag",value:_,checked:P===_,onChange:x=>S(x.target.value),className:"h-5 w-5 text-primary focus:ring-primary border-gray-300"}),l.jsxs("span",{className:`text-sm font-semibold px-2 py-1 rounded-full ${N.className}`,children:[N.emoji," ",N.label]})]},_))]})]}),(n==null?void 0:n.role)==="admin"&&l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"bg-primary-50 p-2 rounded-lg flex items-center justify-center h-10 w-10",children:l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-6 w-auto"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Opcions d'Administrador"})]}),l.jsx("div",{className:"mt-4",children:l.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:T,onChange:_=>C(_.target.checked),className:"h-5 w-5 rounded border-gray-300 text-primary focus:ring-primary"}),l.jsx("span",{className:"text-gray-700 font-medium",children:"Afegeix com a article de merchandising oficial"})]})})]})]}),l.jsx("div",{className:"lg:col-span-2",children:l.jsx(y5,{imagePreviews:i,title:c,description:d,price:m,onPublish:y,isEditing:V,isPublishing:A})})]})]})})},A5=({message:t,type:e="success",onClose:n})=>{if(!t)return null;const r="text-white text-sm font-semibold px-4 py-3 rounded-lg shadow-lg flex items-center justify-between gap-4",s={success:"bg-green-500",error:"bg-red-500"},i={success:"hover:bg-green-600",error:"hover:bg-red-600"};return l.jsxs("div",{className:"fixed bottom-6 left-6 z-50 animate-slide-in-up",children:[l.jsx("style",{children:`
        @keyframes slide-in-up {
          0% {
            opacity: 0;
            transform: translateY(20px);
          }
          100% {
            opacity: 1;
            transform: translateY(0);
          }
        }
        .animate-slide-in-up {
          animation: slide-in-up 0.3s ease-out forwards;
        }
      `}),l.jsxs("div",{className:`${r} ${s[e]}`,children:[l.jsx("span",{children:t}),l.jsx("button",{onClick:n,className:`p-1 rounded-full flex-shrink-0 ${i[e]}`,children:l.jsx(Zr,{className:"w-4 h-4"})})]})]})},N5=(t,e=512,n=512)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var u;if(!((u=o.target)!=null&&u.result))return s(new Error("No s'ha pogut llegir el fitxer."));const c=new Image;c.src=o.target.result,c.onload=()=>{const d=document.createElement("canvas");let{width:f,height:m}=c;f>m?f>e&&(m=Math.round(m*(e/f)),f=e):m>n&&(f=Math.round(f*(n/m)),m=n),d.width=f,d.height=m;const g=d.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(c,0,0,f,m),r(d.toDataURL("image/jpeg",.9))},c.onerror=d=>s(new Error(`Error en carregar la imatge: ${d}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),k5=({onClose:t,onLogin:e,onRegister:n,onPasswordReset:r,isDismissable:s=!0})=>{const[i,o]=R.useState("login"),[c,u]=R.useState(""),[d,f]=R.useState(""),[m,g]=R.useState(""),[T,C]=R.useState(!1),[P,S]=R.useState(null),I=R.useRef(null),[E,A]=R.useState(!1),[D,V]=R.useState(null),[B,y]=R.useState(null),v=async _=>{var x;const N=(x=_.target.files)==null?void 0:x[0];if(N)try{const ie=await N5(N);S(ie)}catch(ie){console.error("Error en llegir el fitxer:",ie),V("No s'ha pogut processar la imatge.")}},b=async _=>{_.preventDefault(),A(!0),V(null),y(null);try{i==="login"?await e(d,m):await n(c,d,m,P)}catch(N){let x="Hi ha hagut un error. Si us plau, torna-ho a provar.";if(N.code)switch(N.code){case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":x="Correu electrnic o contrasenya incorrectes.";break;case"auth/email-already-in-use":x="Aquest correu electrnic ja est en s.";break;case"auth/weak-password":x="La contrasenya ha de tenir almenys 6 carcters.";break;case"auth/invalid-email":x="El format del correu electrnic no s vlid.";break}else N.message&&(N.message.includes("Cloudinary")?x="Error amb la imatge: Assegura't que el 'preset' de crrega a Cloudinary estigui configurat com a 'unsigned'.":x=N.message);V(x),console.error(N)}finally{A(!1)}},k=async _=>{_.preventDefault(),A(!0),V(null),y(null);try{await r(d),y("S'ha enviat l'enlla de recuperaci. Revisa el teu correu (i la carpeta de correu brossa).")}catch(N){let x="Hi ha hagut un error en enviar el correu.";(N.code==="auth/user-not-found"||N.code==="auth/invalid-email")&&(x="No s'ha trobat cap usuari amb aquest correu electrnic."),V(x)}finally{A(!1)}};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:s?t:void 0,"aria-modal":"true",role:"dialog",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden relative",onClick:_=>_.stopPropagation(),children:[s&&l.jsx("button",{onClick:t,className:"absolute top-3 right-3 text-gray-400 hover:text-gray-800 z-10 p-1 transition-colors","aria-label":"Tancar",children:l.jsx(Zr,{className:"w-6 h-6"})}),l.jsx("div",{className:"p-6 sm:p-8",children:i==="forgotPassword"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-12 w-auto mx-auto"}),l.jsx("h2",{className:"mt-2 text-2xl font-bold text-gray-900",children:"Restableix la contrasenya"}),l.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Introdueix el teu correu i t'enviarem un enlla per recuperar-la."})]}),l.jsxs("form",{onSubmit:k,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email-reset",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),l.jsx("input",{id:"email-reset",name:"email",type:"email",autoComplete:"email",required:!0,value:d,onChange:_=>f(_.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"correu@exemple.com"})]}),D&&l.jsx("p",{className:"text-red-500 text-sm text-center",children:D}),B&&l.jsx("p",{className:"text-green-600 text-sm text-center",children:B}),l.jsx("div",{children:l.jsx("button",{type:"submit",disabled:E,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:E?l.jsx(qs,{className:"w-5 h-5"}):"Envia l'enlla"})}),l.jsx("div",{children:l.jsx("button",{type:"button",onClick:()=>{o("login"),V(null),y(null),C(!1)},className:"w-full text-sm font-medium text-primary hover:underline",children:"Tornar a l'inici de sessi"})})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-12 w-auto mx-auto"}),l.jsx("h2",{className:"mt-2 text-2xl font-bold text-gray-900",children:i==="login"?l.jsxs(l.Fragment,{children:["Benvingut/da a LA",l.jsx("span",{className:"text-primary",children:"BOTIGA"})]}):"Crea el teu compte"}),l.jsx("p",{className:"text-gray-600 text-sm mt-1 px-4",children:i==="login"?"La botiga de segona m i marxandatge del Club Handbol Molins.":"Registra't per comprar i vendre material del club i molt ms."})]}),l.jsxs("div",{className:"flex border-b border-gray-200 mb-6",children:[l.jsx("button",{onClick:()=>{o("login"),V(null),y(null),C(!1)},className:`flex-1 py-3 text-sm font-semibold text-center transition-colors ${i==="login"?"text-primary border-b-2 border-primary":"text-gray-500 hover:text-gray-700"}`,children:"Inicia la sessi"}),l.jsx("button",{onClick:()=>{o("register"),V(null),y(null),C(!1)},className:`flex-1 py-3 text-sm font-semibold text-center transition-colors ${i==="register"?"text-primary border-b-2 border-primary":"text-gray-500 hover:text-gray-700"}`,children:"Registra't"})]}),l.jsxs("form",{onSubmit:b,className:"space-y-4",children:[i==="register"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex justify-center",children:[l.jsx("input",{type:"file",ref:I,onChange:v,className:"hidden",accept:"image/*"}),l.jsxs("button",{type:"button",onClick:()=>{var _;return(_=I.current)==null?void 0:_.click()},className:"relative w-24 h-24 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 hover:bg-gray-200 transition-colors",children:[P?l.jsx("img",{src:P,alt:"Avatar Preview",className:"w-full h-full object-cover rounded-full"}):l.jsx(pp,{className:"w-10 h-10"}),l.jsx("div",{className:"absolute bottom-0 right-0 bg-primary text-white rounded-full p-1 text-xs",children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nom"}),l.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:c,onChange:_=>u(_.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"El teu nom"})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),l.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:d,onChange:_=>f(_.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"correu@exemple.com"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Contrasenya"}),i==="login"&&l.jsx("button",{type:"button",onClick:()=>{o("forgotPassword"),V(null),y(null)},className:"text-sm font-medium text-primary hover:underline",children:"Heu oblidat la contrasenya?"})]}),l.jsxs("div",{className:"relative mt-1",children:[l.jsx("input",{id:"password",name:"password",type:T?"text":"password",autoComplete:"current-password",required:!0,value:m,onChange:_=>g(_.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900 pr-10",placeholder:""}),l.jsx("button",{type:"button",onClick:()=>C(!T),className:"absolute inset-y-0 right-0 flex items-center px-3 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":T?"Oculta la contrasenya":"Mostra la contrasenya",children:T?l.jsx(d5,{className:"w-5 h-5"}):l.jsx(u5,{className:"w-5 h-5"})})]})]}),D&&l.jsx("p",{className:"text-red-500 text-sm text-center",children:D}),B&&l.jsx("p",{className:"text-green-600 text-sm text-center",children:B}),l.jsx("div",{children:l.jsx("button",{type:"submit",disabled:E,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:E?l.jsx(qs,{className:"w-5 h-5"}):i==="login"?"Inicia la sessi":"Crea el compte"})})]})]})})]})})},C5=(t,e=512,n=512)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var u;if(!((u=o.target)!=null&&u.result))return s(new Error("No s'ha pogut llegir el fitxer."));const c=new Image;c.src=o.target.result,c.onload=()=>{const d=document.createElement("canvas");let{width:f,height:m}=c;f>m?f>e&&(m=Math.round(m*(e/f)),f=e):m>n&&(f=Math.round(f*(n/m)),m=n),d.width=f,d.height=m;const g=d.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(c,0,0,f,m),r(d.toDataURL("image/jpeg",.9))},c.onerror=d=>s(new Error(`Error en carregar la imatge: ${d}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),P5=({allUsers:t,onSendAdminMessage:e})=>{const[n,r]=R.useState("all"),[s,i]=R.useState(""),[o,c]=R.useState(!1),u=async d=>{if(d.preventDefault(),!!s.trim()){c(!0);try{await e(n,s),i(""),r("all")}catch{}finally{c(!1)}}};return l.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-2xl shadow-md border border-gray-200 mt-8",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-6 border-b",children:[l.jsx(n5,{className:"h-10 w-10 text-primary"}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Panell d'Administrador"}),l.jsx("p",{className:"text-gray-600",children:"Envia comunicats a usuaris individuals o a tothom."})]})]}),l.jsxs("form",{onSubmit:u,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"recipient",className:"block text-sm font-medium text-gray-700",children:"Destinatari"}),l.jsxs("select",{id:"recipient",value:n,onChange:d=>r(d.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",children:[l.jsx("option",{value:"all",children:"Tots els usuaris"}),t.map(d=>l.jsxs("option",{value:d.id,children:[d.name," (",d.email,")"]},d.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"admin-message",className:"block text-sm font-medium text-gray-700",children:"Missatge"}),l.jsx("textarea",{id:"admin-message",rows:5,value:s,onChange:d=>i(d.target.value),placeholder:"Escriu el teu comunicat aqu...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",required:!0})]}),l.jsx("button",{type:"submit",disabled:o||!s.trim(),className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:o?l.jsx(qs,{className:"w-5 h-5"}):"Envia el missatge"})]})]})},R5=({user:t,onUpdateUser:e,onBack:n,onLogout:r,allUsers:s,onSendAdminMessage:i})=>{const[o,c]=R.useState(t.name),[u,d]=R.useState(null),f=R.useRef(null),[m,g]=R.useState(!1);R.useEffect(()=>{c(t.name)},[t]);const T=async P=>{var I;const S=(I=P.target.files)==null?void 0:I[0];if(S)try{const E=await C5(S);d(E)}catch(E){console.error("Error en llegir el fitxer:",E)}},C=async P=>{P.preventDefault(),g(!0);try{await e(t.id,o,u),d(null)}catch(S){console.error(S)}finally{g(!1)}};return l.jsx("main",{className:"container mx-auto p-4 md:p-8",children:l.jsxs("div",{className:"max-w-2xl mx-auto",children:[l.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-2xl shadow-md border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-6 border-b",children:[l.jsx(l5,{className:"h-10 w-10 text-primary"}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"El Meu Perfil"}),l.jsx("p",{className:"text-gray-600",children:"Actualitza la teva informaci personal."})]})]}),l.jsxs("form",{onSubmit:C,className:"space-y-4 sm:space-y-6",children:[l.jsxs("div",{className:"flex flex-col items-center gap-4",children:[l.jsx("input",{type:"file",ref:f,onChange:T,className:"hidden",accept:"image/*"}),l.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Foto de perfil"}),l.jsxs("button",{type:"button",onClick:()=>{var P;return(P=f.current)==null?void 0:P.click()},className:"relative w-32 h-32 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 hover:bg-gray-200 transition-colors group",children:[l.jsx("img",{src:u||t.avatarUrl,alt:"Avatar",className:"w-full h-full object-cover rounded-full"}),l.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 flex items-center justify-center rounded-full transition-opacity cursor-pointer",children:l.jsx(pp,{className:"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nom"}),l.jsx("input",{id:"name",type:"text",required:!0,value:o,onChange:P=>c(P.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),l.jsx("input",{id:"email",type:"email",value:t.email,disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm bg-gray-100 text-gray-500 cursor-not-allowed"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"joinDate",className:"block text-sm font-medium text-gray-700",children:"Membre des de"}),l.jsx("input",{id:"joinDate",type:"text",value:new Date(t.joinDate).toLocaleDateString("ca-ES",{year:"numeric",month:"long",day:"numeric"}),disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm bg-gray-100 text-gray-500 cursor-not-allowed"})]}),l.jsxs("div",{className:"flex gap-4 pt-4 border-t",children:[l.jsx("button",{type:"button",onClick:n,className:"w-full flex justify-center py-3 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:"Cancella"}),l.jsx("button",{type:"submit",disabled:m,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400",children:m?l.jsx(qs,{className:"w-5 h-5"}):"Desa els canvis"})]})]}),l.jsx("div",{className:"mt-8 pt-6 border-t border-red-200",children:l.jsx("button",{onClick:r,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Tanca la sessi"})})]}),t.role==="admin"&&l.jsx(P5,{allUsers:s,onSendAdminMessage:i})]})})},j5=({onClick:t,unreadCount:e,isOpen:n})=>n?null:l.jsxs(l.Fragment,{children:[l.jsx("style",{children:`
        @keyframes pulse-strong {
          0%, 100% { transform: scale(1); opacity: 1; }
          50% { transform: scale(1.1); opacity: 0.95; }
        }
        .animate-pulse-strong { animation: pulse-strong 1.5s infinite ease-in-out; }
      `}),l.jsxs("button",{onClick:t,className:"fixed bottom-4 right-4 md:bottom-8 md:right-8 z-30 bg-primary text-white w-16 h-16 rounded-full shadow-lg flex items-center justify-center hover:bg-primary-700 transition-all duration-300 transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary","aria-label":"Obrir el xat",children:[e>0&&l.jsx("span",{className:"absolute top-0 right-0 h-6 w-6 rounded-full bg-red-500 border-2 border-white flex items-center justify-center text-xs font-bold animate-pulse-strong",children:e}),l.jsx("div",{className:"w-9 h-9",children:l.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS.png",alt:"Xat",className:"w-full h-auto p-1"})})]})]}),D5=({message:t,currentUser:e})=>{var s,i;const n=t.senderId===e.id,r=((i=(s=t.timestamp)==null?void 0:s.toDate())==null?void 0:i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"";return l.jsx("div",{className:`flex items-end gap-2 ${n?"justify-end":"justify-start"}`,children:l.jsxs("div",{className:`max-w-xs md:max-w-md lg:max-w-lg rounded-2xl px-4 py-2 ${n?"bg-primary text-white rounded-br-none":"bg-gray-200 text-gray-800 rounded-bl-none"}`,children:[t.text&&l.jsx("p",{className:"text-sm break-words",children:t.text}),t.imageUrl&&l.jsx("div",{className:"mt-2",children:l.jsx("img",{src:t.imageUrl,alt:"Uploaded content",className:"rounded-lg max-h-60 w-full object-cover"})}),l.jsx("p",{className:`text-xs mt-1 ${n?"text-primary-200":"text-gray-500"} text-right`,children:r})]})})},L5=(t,e=1280,n=1280)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var u;if(!((u=o.target)!=null&&u.result))return s(new Error("No s'ha pogut llegir el fitxer."));const c=new Image;c.src=o.target.result,c.onload=()=>{const d=document.createElement("canvas");let{width:f,height:m}=c;f>m?f>e&&(m=Math.round(m*(e/f)),f=e):m>n&&(f=Math.round(f*(n/m)),m=n),d.width=f,d.height=m;const g=d.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(c,0,0,f,m),r(d.toDataURL("image/jpeg",.85))},c.onerror=d=>s(new Error(`Error en carregar la imatge: ${d}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),M5=({chat:t,onSelect:e,currentUser:n,onDelete:r,isConfirmingDelete:s,onStartConfirmDelete:i,onCancelConfirmDelete:o})=>{var g,T,C,P,S;const c=t.participantIds.find(I=>I!==n.id);if(!c)return null;const u=t.participants[c],d=t.unreadCount[n.id]||0,f=((C=(T=(g=t.lastMessage)==null?void 0:g.timestamp)==null?void 0:T.toDate())==null?void 0:C.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"",m=()=>{r(t.id),o()};return l.jsxs("div",{className:"w-full relative bg-white overflow-hidden group",children:[l.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center justify-end px-4 gap-2 bg-white",children:[l.jsx("button",{onClick:o,className:"text-sm font-semibold py-2 px-3 rounded-md bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors","aria-label":"Cancella l'eliminaci",children:"Cancella"}),l.jsx("button",{onClick:m,className:"text-sm font-semibold py-2 px-3 rounded-md bg-red-600 text-white hover:bg-red-700 transition-colors","aria-label":"Confirma l'eliminaci",children:"Elimina"})]}),l.jsxs("div",{className:`w-full flex items-center gap-2 px-2 py-1 bg-white relative transition-transform duration-300 ease-in-out ${s?"-translate-x-44":"translate-x-0"}`,children:[l.jsxs("button",{onClick:e,className:"w-full text-left p-2 flex items-center gap-3 rounded-lg hover:bg-gray-100 transition-colors flex-1",children:[l.jsxs("div",{className:"relative flex-shrink-0",children:[l.jsx("img",{src:u.avatarUrl,alt:u.name,className:"w-12 h-12 rounded-full object-cover"}),l.jsx("img",{src:t.productImageUrl,alt:t.productTitle,className:"w-6 h-6 rounded-full object-cover absolute -bottom-1 -right-1 border-2 border-white"})]}),l.jsxs("div",{className:"flex-1 overflow-hidden",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("p",{className:"font-bold text-gray-800 truncate",children:u.name}),l.jsx("p",{className:"text-xs text-gray-500 flex-shrink-0",children:f})]}),l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("p",{className:"text-sm text-gray-600 truncate pr-2",children:((P=t.lastMessage)==null?void 0:P.text)||((S=t.lastMessage)!=null&&S.imageUrl?"Imatge":"Cap missatge encara")}),d>0&&l.jsx("span",{className:"bg-primary text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center flex-shrink-0",children:d})]})]})]}),l.jsx("button",{onClick:i,className:"p-2 rounded-full text-gray-400 hover:bg-red-100 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100","aria-label":`Elimina el xat amb ${u.name}`,children:l.jsx(VE,{className:"w-5 h-5"})})]})]})},V5=({isOpen:t,onClose:e,chats:n,activeChat:r,messages:s,currentUser:i,onSendMessage:o,onSelectChat:c,onBackToList:u,onDeleteChat:d})=>{const[f,m]=R.useState(""),[g,T]=R.useState(null),C=R.useRef(null),P=R.useRef(null),S=()=>{var y;(y=P.current)==null||y.scrollIntoView({behavior:"smooth"})};R.useEffect(()=>{t&&r&&S()},[s,t,r]),R.useEffect(()=>{(!t||!r)&&T(null)},[t,r]);const I=()=>{f.trim()&&(o(f),m(""))},E=y=>{y.key==="Enter"&&(y.preventDefault(),I())},A=async y=>{var b;const v=(b=y.target.files)==null?void 0:b[0];if(v)try{const k=await L5(v);o("",k)}catch(k){console.error("No s'ha pogut llegir el fitxer",k)}y.target&&(y.target.value="")},D=()=>{var y;(y=C.current)==null||y.click()};if(!t||!i)return null;const V=r==null?void 0:r.participantIds.find(y=>y!==i.id),B=V?r==null?void 0:r.participants[V]:null;return l.jsxs("div",{className:"fixed bottom-0 right-0 sm:bottom-4 md:bottom-8 sm:right-4 md:right-8 z-20 w-full sm:w-96 h-[90vh] sm:h-[60vh] sm:max-h-[600px] bg-white rounded-t-lg sm:rounded-lg shadow-2xl flex flex-col border border-gray-200 transform transition-transform duration-300 ease-in-out animate-slide-in",children:[l.jsx("style",{children:`
        @keyframes slide-in {
          from { transform: translateY(100%); opacity: 0; }
          to { transform: translateY(0); opacity: 1; }
        }
        .animate-slide-in { 
            animation: slide-in 0.3s ease-out; 
        }
        @keyframes fade-in-fast {
          from { opacity: 0; transform: scale(0.8); }
          to { opacity: 1; transform: scale(1); }
        }
        .animate-fade-in-fast { 
          animation: fade-in-fast 0.2s ease-out; 
        }
      `}),l.jsxs("header",{className:"bg-primary text-white p-3 flex justify-between items-center rounded-t-lg flex-shrink-0",children:[r?l.jsxs("div",{className:"flex items-center gap-3 flex-1 overflow-hidden",children:[l.jsx("button",{onClick:u,className:"hover:bg-primary-700 p-1 rounded-full -ml-1",children:l.jsx(c5,{className:"w-6 h-6"})}),l.jsx("img",{src:B==null?void 0:B.avatarUrl,alt:B==null?void 0:B.name,className:"w-8 h-8 rounded-full object-cover"}),l.jsxs("div",{className:"overflow-hidden",children:[l.jsx("h3",{className:"font-bold text-lg truncate",children:B==null?void 0:B.name}),l.jsx("p",{className:"text-xs opacity-80 truncate",children:r.productTitle})]})]}):l.jsx("div",{className:"flex items-center justify-between w-full",children:l.jsx("h3",{className:"font-bold text-lg",children:"Converses"})}),l.jsx("button",{onClick:e,className:"hover:bg-primary-700 p-1 rounded-full",children:l.jsx(Zr,{className:"w-6 h-6"})})]}),r?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex-1 p-4 overflow-y-auto space-y-4 bg-gray-50",children:[s.map(y=>l.jsx(D5,{message:y,currentUser:i},y.id)),l.jsx("div",{ref:P})]}),l.jsx("div",{className:"p-2 border-t border-gray-200 bg-gray-100 flex-shrink-0",children:l.jsxs("div",{className:"flex items-center bg-white border border-gray-300 rounded-lg px-2",children:[l.jsx("input",{type:"text",value:f,onChange:y=>m(y.target.value),onKeyPress:E,placeholder:"Escriu un missatge...",className:"flex-1 py-2 px-2 border-none focus:ring-0 text-sm bg-transparent text-gray-900","aria-label":"Entrada de missatge del xat"}),l.jsx("input",{ref:C,type:"file",onChange:A,className:"hidden",accept:"image/*"}),l.jsx("button",{onClick:D,className:"text-gray-500 hover:text-primary p-2","aria-label":"Adjunta una imatge",children:l.jsx(r5,{className:"w-5 h-5"})}),l.jsx("button",{onClick:I,className:"text-white bg-primary hover:bg-primary-700 rounded-md p-2 ml-1 disabled:bg-gray-400",disabled:!f.trim(),"aria-label":"Envia el missatge",children:l.jsx(o5,{className:"w-5 h-5"})})]})})]}):l.jsx("div",{className:"flex-1 overflow-y-auto",children:n.length>0?n.map(y=>l.jsx(M5,{chat:y,onSelect:()=>c(y),currentUser:i,onDelete:d,isConfirmingDelete:g===y.id,onStartConfirmDelete:()=>T(y.id),onCancelConfirmDelete:()=>T(null)},y.id)):l.jsxs("div",{className:"text-center p-8 text-gray-500 h-full flex flex-col justify-center items-center",children:[l.jsx(ME,{className:"w-16 h-16 text-gray-300 mb-4"}),l.jsx("p",{className:"font-semibold",children:"No tens cap conversa."}),l.jsx("p",{className:"text-sm mt-1",children:"Contacta amb un venedor des d'un anunci per comenar a xatejar."})]})})]})},vs=({title:t,children:e})=>l.jsxs("section",{className:"mb-6",children:[l.jsx("h2",{className:"text-xl font-bold text-primary mb-3",children:t}),l.jsx("div",{className:"space-y-2 text-gray-700",children:e})]}),O5=({onClose:t})=>l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:t,"aria-modal":"true",role:"dialog",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col relative",onClick:e=>e.stopPropagation(),children:[l.jsxs("header",{className:"p-4 border-b flex items-center justify-between sticky top-0 bg-white z-10",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(FE,{className:"w-8 h-8 text-primary"}),l.jsxs("h1",{className:"text-2xl font-bold text-gray-800",children:["Guia Rpida de ",l.jsx("span",{className:"text-gray-900",children:"LA"}),l.jsx("span",{className:"text-primary",children:"BOTIGA"})]})]}),l.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-800 p-1 rounded-full hover:bg-gray-100","aria-label":"Tancar",children:l.jsx(Zr,{className:"w-6 h-6"})})]}),l.jsxs("div",{className:"p-6 overflow-y-auto",children:[l.jsxs("section",{className:"mb-6",children:[l.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-3",children:[" Benvingut/da a ",l.jsx("span",{className:"text-gray-900",children:"LA"}),l.jsx("span",{className:"text-primary",children:"BOTIGA"}),"!"]}),l.jsx("div",{className:"space-y-2 text-gray-700",children:l.jsx("p",{children:"Aquesta s la botiga virtual del Club Handbol Molins, on pots comprar i vendre material d'handbol de segona m i adquirir el marxandatge oficial del club."})})]}),l.jsx(vs,{title:"1. Explora els Articles",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsxs("li",{children:["A la pgina principal, trobars les seccions ",l.jsx("strong",{children:"'Marxandatge del Club'"})," i ",l.jsx("strong",{children:"'Articles destacats'"}),"."]}),l.jsxs("li",{children:["Fes servir la ",l.jsx("strong",{children:"barra de cerca"})," per trobar articles especfics pel seu nom o descripci."]}),l.jsx("li",{children:"Fes clic a qualsevol article per veure'n els detalls."})]})}),l.jsx(vs,{title:"2. Comprar un Article de Segona M",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Quan trobis un article que t'interessi, fes-hi clic per obrir la vista detallada."}),l.jsxs("li",{children:[l.jsx("strong",{children:"Visualitza les imatges:"})," Fes clic a la imatge principal d'un producte per obrir-la a pantalla completa. Llisca el dit o fes servir les fletxes per veure la resta de fotos."]}),l.jsx("li",{children:"Llegeix la descripci i comprova el preu."}),l.jsxs("li",{children:["Per parlar amb el venedor, fes clic al bot ",l.jsx("strong",{children:"'Contacta amb el venedor'"}),". Aix obrir un xat privat."]}),l.jsx("li",{children:"Al xat, podeu acordar els detalls del pagament i l'entrega de forma segura."})]})}),l.jsxs(vs,{title:"3. Vendre un Article",children:[l.jsxs("p",{children:["Fes clic al bot ",l.jsx("strong",{children:"'Puja un article'"})," a la capalera per comenar."]}),l.jsxs("ul",{className:"list-decimal list-inside space-y-2 pl-4",children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Puja les teves fotos:"})," Fes clic a 'Afegeix fotos'. Podrs triar entre fer una foto amb la cmera o seleccionar-ne de la teva galeria. Pots pujar fins a 5 imatges. La primera ser la principal."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Descriu el teu article:"})," Afegeix un ttol clar i una descripci detallada. Com ms informaci, millor!"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Afegeix un preu:"})," Introdueix el preu que demanes per l'article. Pots demanar un suggeriment de preu automtic."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Vista prvia i publicaci:"})," A la dreta, veurs una vista prvia del teu anunci. Quan estiguis satisfet/a, fes clic a ",l.jsx("strong",{children:"'Publica l'anunci'"}),"."]})]})]}),l.jsx(vs,{title:"4. Gestiona els Teus Xats",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsxs("li",{children:["Fes clic a la ",l.jsx("strong",{children:"bombolla de xat"})," a la cantonada inferior dreta per veure les teves converses."]}),l.jsx("li",{children:"Un nmero vermell indicar els missatges nous que no has llegit."}),l.jsx("li",{children:"Pots enviar text i imatges a travs del xat per comunicar-te amb altres usuaris."}),l.jsx("li",{children:"Per eliminar un xat, a la llista de converses, fes clic a la icona de la paperera que apareix a la dreta en passar el cursor per sobre (ordinador). Haurs de confirmar l'acci."})]})}),l.jsx(vs,{title:"5. El Teu Perfil",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsxs("li",{children:["Fes clic a la teva ",l.jsx("strong",{children:"foto de perfil"})," a la capalera per anar a la pgina del teu perfil."]}),l.jsx("li",{children:"Aqu pots canviar el teu nom i la teva foto de perfil."}),l.jsxs("li",{children:["Tamb pots ",l.jsx("strong",{children:"tancar la sessi"})," des d'aquesta pgina de manera segura."]})]})}),l.jsx(vs,{title:"6. Comprar Marxandatge Oficial",children:l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Els articles de la secci 'Marxandatge del Club' sn productes oficials."}),l.jsxs("li",{children:["Per comprar-ne un, fes clic a l'article i desprs al bot ",l.jsx("strong",{children:"'Realitzar comanda'"}),". Sers redirigit/da a un formulari per completar la comanda."]}),l.jsxs("li",{children:["Si tens dubtes, ara tamb pots fer clic a ",l.jsx("strong",{children:"'Contacta amb el club'"})," per iniciar un xat directe abans de fer la comanda."]})]})}),l.jsxs(vs,{title:"7. Eines d'Administrador",children:[l.jsx("p",{children:"Si tens el rol d'administrador, a la teva pgina de perfil trobars un panell addicional."}),l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsxs("li",{children:["Aquest panell et permet enviar ",l.jsx("strong",{children:"missatges massius"})," a tots els usuaris o missatges directes a un usuari especfic."]}),l.jsx("li",{children:"Aquests missatges apareixeran com una nova conversa de xat per als destinataris."})]})]})]})]})}),uv=({direction:t,onClick:e})=>l.jsx("button",{onClick:n=>{n.stopPropagation(),e()},className:`absolute top-1/2 -translate-y-1/2 ${t==="left"?"left-2 md:left-4":"right-2 md:right-4"} z-10 bg-black bg-opacity-40 text-white p-2 rounded-full hover:bg-opacity-60 transition-all`,"aria-label":t==="left"?"Imatge anterior":"Imatge segent",children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-8 md:w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:t==="left"?"M15 19l-7-7 7-7":"M9 5l7 7-7 7"})})}),F5=({images:t,startIndex:e=0,onClose:n})=>{const[r,s]=R.useState(e),[i,o]=R.useState(null),c=R.useCallback(()=>{s(m=>m===0?t.length-1:m-1)},[t.length]),u=R.useCallback(()=>{s(m=>m===t.length-1?0:m+1)},[t.length]);R.useEffect(()=>{const m=g=>{g.key==="ArrowLeft"&&c(),g.key==="ArrowRight"&&u(),g.key==="Escape"&&n()};return window.addEventListener("keydown",m),()=>{window.removeEventListener("keydown",m)}},[c,u,n]);const d=m=>{o(m.touches[0].clientX)},f=m=>{if(i===null)return;const g=m.touches[0].clientX,T=i-g;T>50?(u(),o(null)):T<-50&&(c(),o(null))};return l.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-80 z-50 flex flex-col justify-center items-center animate-fade-in-fast",onClick:n,role:"dialog","aria-modal":"true",children:[l.jsx("style",{children:`
            @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }
            .animate-fade-in-fast { animation: fade-in-fast 0.2s ease-out; }
        `}),l.jsx("button",{onClick:m=>{m.stopPropagation(),n()},className:"absolute top-4 right-4 text-white bg-black bg-opacity-40 p-2 rounded-full hover:bg-opacity-60 transition-all","aria-label":"Tancar visor",children:l.jsx(Zr,{className:"w-6 h-6"})}),l.jsxs("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:[t.length>1&&l.jsx(uv,{direction:"left",onClick:c}),l.jsx("div",{className:"w-full h-full flex items-center justify-center",onTouchStart:d,onTouchMove:f,children:l.jsx("img",{src:t[r],alt:`Imatge ${r+1} de ${t.length}`,className:"max-w-full max-h-full object-contain select-none"})}),t.length>1&&l.jsx(uv,{direction:"right",onClick:u})]}),t.length>1&&l.jsxs("div",{className:"absolute bottom-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm",children:[r+1," / ",t.length]})]})},U5={apiKey:"AIzaSyDgTGIPoHLYy9rfdpiQo07Y7F-1ytphaQM",authDomain:"botiga-35dc0.firebaseapp.com",projectId:"botiga-35dc0",storageBucket:"botiga-35dc0.firebasestorage.app",messagingSenderId:"671047302164",appId:"1:671047302164:web:2cc6065f3055dbd8fdbb01",measurementId:"G-C3X8Y6GG88"},vp=hm(U5),ws=A1(vp),Ke=Kx(vp),kl=typeof window<"u"?RE(vp):null,Vt=[{id:"user-0",name:"Admin CHMolins",avatarUrl:"https://i.pravatar.cc/150?u=admin",email:"admin@chmolins.com",joinDate:"2023-01-01",role:"admin"},{id:"user-1",name:"Anna L.",avatarUrl:"https://i.pravatar.cc/150?u=anna",email:"anna@example.com",joinDate:"2023-05-12",role:"user"},{id:"user-2",name:"Carles B.",avatarUrl:"https://i.pravatar.cc/150?u=carles",email:"carles@example.com",joinDate:"2023-08-20",role:"user"},{id:"user-3",name:"Laura M.",avatarUrl:"https://i.pravatar.cc/150?u=laura",email:"laura@example.com",joinDate:"2023-11-01",role:"user"},{id:"user-4",name:"David S.",avatarUrl:"https://i.pravatar.cc/150?u=david",email:"david@example.com",joinDate:"2024-02-15",role:"user"}],dv=[{id:"1",title:"Jaqueta de cuir vintage",description:"Jaqueta de cuir genu dels anys 80, en perfecte estat. Talla M.",price:75,imageUrls:["https://images.unsplash.com/photo-1551028719-00167b16eac5?q=80&w=800"],seller:Vt[1],createdAt:new Date("2024-07-20T10:00:00Z")},{id:"2",title:"Bicicleta de muntanya Scott",description:"Bicicleta Scott Aspect 970, rodes de 29 polzades, frens de disc. Poc s.",price:350,imageUrls:["https://images.unsplash.com/photo-1576426863848-c21f68c6aa98?q=80&w=800"],seller:Vt[2],createdAt:new Date("2024-07-19T15:30:00Z")},{id:"3",title:"Cmera rflex Canon EOS 2000D",description:"Inclou objectiu 18-55mm, bossa de transport i targeta de memria. Ideal per a principiants.",price:320,imageUrls:["https://images.unsplash.com/photo-1512790182412-b19e6d62bc39?q=80&w=800"],seller:Vt[3],createdAt:new Date("2024-07-19T12:00:00Z")},{id:"4",title:"Sof de 3 places gris",description:"Sof cmode i modern. Fundes rentables. Mides: 200x90cm.",price:180,imageUrls:["https://images.unsplash.com/photo-1555041469-a586c61ea9bc?q=80&w=800"],seller:Vt[4],createdAt:new Date("2024-07-18T18:45:00Z")},{id:"5",title:"Guitarra acstica Yamaha",description:"Model F310. So excellent. Perfecta per aprendre a tocar.",price:90,imageUrls:["https://images.unsplash.com/photo-1558021211-65140282a3f8?q=80&w=800"],seller:Vt[1],createdAt:new Date("2024-07-18T11:20:00Z")},{id:"6",title:"iPhone 12 - 128GB Blau",description:"En bon estat, sempre amb protector de pantalla. Salut de la bateria al 88%.",price:450,imageUrls:["https://images.unsplash.com/photo-1616348436168-de43ad0db179?q=80&w=800"],seller:Vt[3],createdAt:new Date("2024-07-17T20:00:00Z")},{id:"7",title:"Vambes Nike Air Max",description:"Talla 43. Edici limitada. Noms utilitzades un parell de vegades.",price:85,imageUrls:["https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=800"],seller:Vt[2],createdAt:new Date("2024-07-17T09:05:00Z")},{id:"8",title:"Patinet elctric Xiaomi",description:"Model Mi Electric Scooter 3. Fins a 30 km d'autonomia. Plegable i lleuger.",price:250,imageUrls:["https://images.unsplash.com/photo-1598214013444-96379d71c664?q=80&w=800"],seller:Vt[4],createdAt:new Date("2024-07-16T14:00:00Z")},{id:"9",title:"Collecci de llibres de Harry Potter",description:"Els 7 llibres de la saga, tapa dura. Edici Salamandra.",price:60,imageUrls:["https://images.unsplash.com/photo-1618965907452-a8a235327546?q=80&w=800"],seller:Vt[1],createdAt:new Date("2024-07-15T21:30:00Z")},{id:"10",title:"Planta Monstera Deliciosa",description:"Planta d'interior gran i saludable. Inclou test de cermica.",price:30,imageUrls:["https://images.unsplash.com/photo-1614594975525-e4d524c48996?q=80&w=800"],seller:Vt[3],createdAt:new Date("2024-07-15T10:15:00Z")},{id:"11",title:"Samarreta Oficial CHM",description:"Samarreta oficial del club, 100% cot. Totes les talles disponibles.",price:25,imageUrls:["https://images.unsplash.com/photo-1571455789393-8a76380c5435?q=80&w=800"],seller:Vt[0],createdAt:new Date("2024-07-21T10:00:00Z"),isMerchandise:!0},{id:"12",title:"Tassa CHM",description:"Tassa de cermica amb el logo del club. Resistent al microones i rentaplats.",price:12.5,imageUrls:["https://images.unsplash.com/photo-1594225026210-5a9b71b83b63?q=80&w=800"],seller:Vt[0],createdAt:new Date("2024-07-21T10:05:00Z"),isMerchandise:!0},{id:"13",title:"Bufanda CHM Fans",description:"Bufanda de llana per animar l'equip els dies de partit.",price:18,imageUrls:["https://images.unsplash.com/photo-1610295313555-252a71383713?q=80&w=800"],seller:Vt[0],createdAt:new Date("2024-07-21T10:10:00Z"),isMerchandise:!0}],B5=({product:t,currentUser:e,onClose:n,onEdit:r,onContactSeller:s,onDelete:i,onOpenImageViewer:o})=>{const[c,u]=R.useState(0),[d,f]=R.useState(!1),[m,g]=R.useState(!1),T=R.useRef(null);R.useEffect(()=>()=>{T.current&&clearTimeout(T.current)},[]),R.useEffect(()=>{const A=D=>{D.key==="Escape"&&n()};return window.addEventListener("keydown",A),()=>{window.removeEventListener("keydown",A)}},[n]);const C=async()=>{d||(m?(T.current&&(clearTimeout(T.current),T.current=null),f(!0),await i(t.id)||(f(!1),g(!1))):(g(!0),T.current=window.setTimeout(()=>{g(!1),T.current=null},4e3)))},P=(e==null?void 0:e.role)==="admin",S=(e==null?void 0:e.id)===t.seller.id,I=t.imageUrls&&t.imageUrls.length>0,E=A=>typeof A!="number"||isNaN(A)?"N/A":A.toFixed(2);return l.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:n,"aria-modal":"true",role:"dialog",children:[l.jsx("style",{children:`
        @keyframes fade-in {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        .animate-fade-in { animation: fade-in 0.2s ease-out; }
      `}),l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl lg:max-w-4xl xl:max-w-5xl max-h-[90vh] overflow-hidden flex flex-col lg:flex-row relative",onClick:A=>A.stopPropagation(),children:[l.jsx("button",{onClick:n,className:"absolute top-3 right-3 text-gray-400 hover:text-gray-800 z-10 bg-white bg-opacity-50 rounded-full p-1 transition-colors","aria-label":"Tancar",children:l.jsx(Zr,{className:"w-6 h-6"})}),l.jsxs("div",{className:"w-full lg:w-3/5 flex-shrink-0 flex flex-col",children:[l.jsx("div",{className:"w-full bg-gray-100 h-80 lg:h-full flex items-center justify-center lg:flex-grow",children:I&&l.jsx("img",{src:t.imageUrls[c],alt:`${t.title} - imatge ${c+1}`,className:`w-full h-full object-cover lg:rounded-l-2xl rounded-t-2xl lg:rounded-t-none cursor-pointer ${t.tag==="vendido"?"grayscale":""}`,onClick:()=>o(t.imageUrls,c)})}),I&&t.imageUrls.length>1&&l.jsx("div",{className:"flex-shrink-0 p-2 bg-white lg:bg-gray-50 flex gap-2 justify-center",children:t.imageUrls.map((A,D)=>l.jsx("button",{onClick:()=>u(D),className:`w-12 h-12 rounded-md overflow-hidden border-2 transition-colors bg-gray-100 ${c===D?"border-primary":"border-transparent hover:border-gray-400"}`,children:l.jsx("img",{src:A,alt:`miniatura ${D+1}`,className:`w-full h-full object-cover ${t.tag==="vendido"?"grayscale":""}`})},D))})]}),l.jsxs("div",{className:"p-4 md:p-6 flex flex-col flex-1 overflow-y-auto",children:[t.tag&&Gn[t.tag]&&l.jsxs("div",{className:`w-fit text-sm font-semibold px-3 py-1 rounded-full mb-3 ${Gn[t.tag].className}`,children:[Gn[t.tag].emoji," ",Gn[t.tag].label]}),l.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-gray-900 mb-2",children:t.title}),l.jsxs("p",{className:"text-3xl lg:text-4xl font-extrabold text-primary mb-4",children:[E(t.price)," "]}),l.jsxs("div",{className:"flex-grow pr-2 space-y-4",children:[l.jsxs("div",{className:"border-t pt-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"Venedor"}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("img",{src:t.seller.avatarUrl,alt:t.seller.name,className:"w-12 h-12 rounded-full mr-4"}),l.jsx("div",{children:l.jsx("p",{className:"font-semibold text-gray-800",children:t.seller.name})})]})]}),l.jsxs("div",{className:"border-t pt-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Descripci"}),l.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:t.description})]})]}),l.jsxs("div",{className:"mt-6 flex-shrink-0 space-y-3",children:[t.isMerchandise&&l.jsxs("a",{href:"https://forms.gle/wc7nmx2MubiMix8h8",target:"_blank",rel:"noopener noreferrer",className:"w-full flex items-center justify-center gap-2 bg-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors",children:[l.jsx(i5,{className:"w-5 h-5"}),l.jsx("span",{children:"Realitzar comanda"})]}),!S&&e&&l.jsxs("button",{onClick:()=>s(t),className:`w-full flex items-center justify-center gap-2 font-bold py-3 px-4 rounded-lg transition-colors ${t.isMerchandise?"bg-gray-600 text-white hover:bg-gray-700":"bg-primary text-white hover:bg-primary-700"} disabled:bg-gray-400 disabled:cursor-not-allowed`,disabled:t.tag==="vendido",children:[l.jsx(ME,{className:"w-5 h-5"}),l.jsx("span",{children:t.tag==="vendido"?"Article venut":t.isMerchandise?"Contacta amb el club":"Contacta amb el venedor"})]}),(P||S)&&l.jsxs("div",{className:"flex gap-3",children:[l.jsxs("button",{onClick:()=>r(t),disabled:d||m,className:"w-full flex items-center justify-center gap-2 bg-yellow-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-yellow-600 transition-colors disabled:opacity-50",children:[l.jsx(t5,{className:"w-5 h-5"})," Edita"]}),l.jsx("button",{onClick:C,disabled:d,className:`w-full flex items-center justify-center gap-2 text-white font-bold py-3 px-4 rounded-lg transition-all duration-200 ${m?"bg-red-700 hover:bg-red-800":"bg-red-500 hover:bg-red-600"} disabled:bg-red-400 disabled:cursor-wait`,children:d?l.jsxs(l.Fragment,{children:[l.jsx(qs,{className:"w-5 h-5"}),l.jsx("span",{children:"Eliminant..."})]}):m?"Confirmar eliminaci":l.jsxs(l.Fragment,{children:[l.jsx(VE,{className:"w-5 h-5"}),l.jsx("span",{children:"Elimina"})]})})]})]})]})]})]})},$5=()=>{const[t,e]=R.useState("home"),[n,r]=R.useState([]),[s,i]=R.useState([]),[o,c]=R.useState(null),[u,d]=R.useState(null),[f,m]=R.useState(null),[g,T]=R.useState(null),[C,P]=R.useState(null),[S,I]=R.useState(null),[E,A]=R.useState([]),[D,V]=R.useState(!1),[B,y]=R.useState([]),[v,b]=R.useState(null),[k,_]=R.useState([]),[N,x]=R.useState(0),ie=R.useRef(new Set),[Ve,nn]=R.useState(!1);R.useEffect(()=>{if(!S)return;if((async()=>{var U;if(!kl){console.log("Firebase Messaging no est disponible en aquest navegador.");return}try{if(await window.Notification.requestPermission()==="granted"){const W=await jE(kl,{vapidKey:"BL2B5V3vjPkyyPrTo-aW-5s5t7oW3_Ni_M9XANqYdM1uO9jY3yA9k84Xo7Z-yL3p0M_sF3g4d2c1qWj9k7l4z5k"});if(W){const H=Ge(Ke,"users",S.id);(((U=(await Hc(H)).data())==null?void 0:U.fcmTokens)||[]).includes(W)||await St(H,{fcmTokens:Wc(W)})}else console.log("No s'ha pogut obtenir el token de registre.")}}catch(F){console.error("Ha ocorregut un error en configurar les notificacions:",F)}})(),kl){const U=DE(kl,F=>{var O,W;console.log("Missatge rebut en primer pla: ",F),c({message:`${(O=F.notification)==null?void 0:O.title}: ${(W=F.notification)==null?void 0:W.body}`,type:"success"})});return()=>U()}},[S]),R.useEffect(()=>{let L=null;const U=g1(ws,F=>{if(L&&(L(),L=null),F){const O=Ge(Ke,"users",F.uid);L=bn(O,W=>{W.exists()?I({id:F.uid,...W.data()}):(ki(ws),I(null))},W=>{console.error("Error en escoltar el document d'usuari:",W),ki(ws),I(null)})}else I(null)});return()=>{U(),L&&L()}},[]),R.useEffect(()=>{if((S==null?void 0:S.role)==="admin"){const L=Tn(Be(Ke,"users")),U=bn(L,F=>{const O=F.docs.map(W=>({id:W.id,...W.data()}));A(O.filter(W=>W.id!==S.id))});return()=>U()}else A([])},[S]),R.useEffect(()=>{const L=Tn(Be(Ke,"products")),U=bn(L,F=>{const O=F.docs.map(q=>{var ue;const J=q.data(),te=(ue=J.createdAt)!=null&&ue.toDate?J.createdAt.toDate():new Date;return{id:q.id,...J,createdAt:te}}),W=O.filter(q=>q.isMerchandise),H=O.filter(q=>!q.isMerchandise);W.sort((q,J)=>J.createdAt.getTime()-q.createdAt.getTime()),H.sort((q,J)=>{const te=q.tag==="vendido",ue=J.tag==="vendido";return te&&!ue?1:!te&&ue?-1:J.createdAt.getTime()-q.createdAt.getTime()}),i(W),r(H),T(null)},F=>{console.error("Error en el listener de Firestore (products):",F),T(F),c({message:"Error de connexi. Mostrant articles d'exemple.",type:"error"});const O=dv.filter(H=>H.isMerchandise).map(H=>({...H,createdAt:new Date(H.createdAt)})),W=dv.filter(H=>!H.isMerchandise).map(H=>({...H,createdAt:new Date(H.createdAt)}));O.sort((H,q)=>q.createdAt.getTime()-H.createdAt.getTime()),W.sort((H,q)=>q.createdAt.getTime()-H.createdAt.getTime()),i(O),r(W)});return()=>U()},[]),R.useEffect(()=>{if(!S){y([]);return}const L=Tn(Be(Ke,"chats"),Pi("participantIds","array-contains",S.id)),U=bn(L,F=>{let O=F.docs.map(H=>({id:H.id,...H.data()}));O=O.filter(H=>{var q;return!((q=H.hiddenFor)!=null&&q.includes(S.id))&&!ie.current.has(H.id)}),O.sort((H,q)=>{var ue,Dt;const J=((ue=H.updatedAt)==null?void 0:ue.toMillis())||0;return(((Dt=q.updatedAt)==null?void 0:Dt.toMillis())||0)-J});const W=O.reduce((H,q)=>H+(q.unreadCount[S.id]||0),0);x(W),y(O),T(null)},F=>{console.error("Error fetching chats:",F),T(F)});return()=>U()},[S]),R.useEffect(()=>{if(!v){_([]);return}const L=Tn(Be(Ke,"chats",v.id,"messages")),U=bn(L,F=>{const O=F.docs.map(W=>({id:W.id,...W.data()}));O.sort((W,H)=>{var te,ue;const q=((te=W.timestamp)==null?void 0:te.toMillis())||0,J=((ue=H.timestamp)==null?void 0:ue.toMillis())||0;return q-J}),_(O)});return()=>U()},[v]),R.useEffect(()=>{if(o){const L=setTimeout(()=>c(null),8e3);return()=>clearTimeout(L)}},[o]),R.useEffect(()=>{const L="LABOTIGA";N>0?document.title=`(${N}) ${L}`:document.title=L},[N]),R.useEffect(()=>(u||D||!S||Ve||C?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[u,D,S,Ve,C]);const Vn=async(L,U)=>{await p1(ws,L,U),c({message:"Benvingut/da de nou!",type:"success"})},Q=(L,U)=>{const W=`<svg xmlns="http://www.w3.org/2000/svg" width="150" height="150" viewBox="0 0 150 150">
                    <rect width="100%" height="100%" fill="${(H=>{let q=0;for(let te=0;te<H.length;te++)q=H.charCodeAt(te)+((q<<5)-q);let J="#";for(let te=0;te<3;te++){const ue=q>>te*8&255;J+=("00"+ue.toString(16)).substr(-2)}return J})(U)}" />
                    <text x="50%" y="55%" dominant-baseline="middle" text-anchor="middle" font-family="Arial, sans-serif" font-size="60" fill="#ffffff">${L}</text>
                 </svg>`;return`data:image/svg+xml;base64,${btoa(W)}`},ne=async(L,U,F,O)=>{let W="",H=O;if(!H){const ue=L.split(" ").map(Dt=>Dt[0]).slice(0,2).join("").toUpperCase();H=Q(ue,L)}try{W=await Zl(H)}catch(ue){throw console.error("La pujada de la imatge ha fallat:",ue),new Error("No s'ha pogut pujar la imatge. Revisa la teva configuraci de Cloudinary i que el 'preset' sigui 'unsigned'.")}if(!W)throw new Error("Cloudinary no ha retornat una URL vlida.");const J=(await m1(ws,U,F)).user,te={name:L,email:U,avatarUrl:W,joinDate:new Date().toISOString(),role:"user",fcmTokens:[]};await iE(Ge(Ke,"users",J.uid),te),I({id:J.uid,...te}),c({message:`Benvingut/da, ${L}! El teu compte ha estat creat.`,type:"success"})},ae=async L=>{try{await f1(ws,L),c({message:"S'ha enviat un correu per restablir la contrasenya. Revisa la teva bstia d'entrada.",type:"success"})}catch(U){throw console.error("Error en restablir la contrasenya:",U),U}},we=async()=>{e("home"),await ki(ws),c({message:"Sessi tancada correctament.",type:"success"})},Te=()=>{e("home"),m(null)},rn=()=>{m(null),e("listing")},lt=()=>{S&&e("profile")},sn=async(L,U,F)=>{if(!S||S.id!==L)throw c({message:"No autoritzat.",type:"error"}),new Error("No autoritzat.");if(U===S.name&&!F){c({message:"No s'han detectat canvis.",type:"success"});return}try{const O={name:U};F&&(O.avatarUrl=await Zl(F));const W=Ge(Ke,"users",L);await St(W,O),c({message:"Perfil actualitzat correctament!",type:"success"})}catch(O){throw console.error("Error actualitzant l'usuari:",O),c({message:`Error en actualitzar: ${O.message||"Error desconegut."}`,type:"error"}),O}},wt=async(L,U)=>{var F;if(!S)throw c({message:"Has d'iniciar la sessi per desar un producte.",type:"error"}),new Error("L'usuari no ha iniciat la sessi.");try{const O=L.imageUrls.map(q=>q.startsWith("data:image")?Zl(q):Promise.resolve(q)),W=await Promise.all(O),H={...L,imageUrls:W};if(U){const q=Ge(Ke,"products",U),J=(F=(await Hc(q)).data())==null?void 0:F.seller;await St(q,{...H,seller:J}),c({message:"Anunci actualitzat correctament!",type:"success"})}else{const q={...H,seller:{id:S.id,name:S.name,avatarUrl:S.avatarUrl},createdAt:new Date};await In(Be(Ke,"products"),q),c({message:"Anunci publicat amb xit!",type:"success"})}e("home"),m(null)}catch(O){throw console.error("Error al desar el producte:",O),c({message:`Error en desar: ${O.message||"Error desconegut."}`,type:"error"}),O}},Ht=L=>{m(L),d(null),e("listing")},as=async L=>{try{return await oE(Ge(Ke,"products",L)),c({message:"Anunci eliminat correctament.",type:"success"}),d(null),!0}catch(U){console.error("Error en eliminar el producte: ",U);const F=`Error en eliminar: ${U.code||U.message||"Error desconegut."}`;return c({message:F,type:"error"}),!1}},Xs=L=>{d(L)},io=()=>{d(null)},oo=async L=>{if(!S)return;const U=L.seller.id,F=S.id,O=Be(Ke,"chats"),W=Tn(O,Pi("productId","==",L.id),Pi("participantIds","array-contains",F)),H=await sE(W);let q=null;if(H.forEach(J=>{const te={id:J.id,...J.data()};te.participantIds.includes(U)&&(q=te)}),q)await dr(q);else{const J={participantIds:[F,U],participants:{[F]:{name:S.name,avatarUrl:S.avatarUrl},[U]:{name:L.seller.name,avatarUrl:L.seller.avatarUrl}},productId:L.id,productTitle:L.title,productImageUrl:L.imageUrls[0]||"",lastMessage:null,createdAt:ft(),updatedAt:ft(),unreadCount:{[F]:0,[U]:0},hiddenFor:[]},te=await In(Be(Ke,"chats"),J);b({id:te.id,...J})}d(null),V(!0)},dr=async L=>{if(b(L),S&&(L.unreadCount[S.id]||0)>0){const U=Ge(Ke,"chats",L.id);await St(U,{[`unreadCount.${S.id}`]:0})}},ls=async(L,U)=>{if(!S||!v)return;const F=S.id,O=v.participantIds.find(q=>q!==F);if(!O)return;const W={senderId:F,text:L,timestamp:ft(),...U&&{imageUrl:U}};await In(Be(Ke,"chats",v.id,"messages"),W);const H=Ge(Ke,"chats",v.id);await St(H,{lastMessage:{...W,timestamp:new Date},updatedAt:ft(),[`unreadCount.${O}`]:Kc(1)})},Js=()=>{b(null)},ao=()=>{V(!1),b(null)},cs=async L=>{if(!S)return;ie.current.add(L),y(F=>F.filter(O=>O.id!==L)),(v==null?void 0:v.id)===L&&b(null);const U=Ge(Ke,"chats",L);try{await St(U,{hiddenFor:Wc(S.id)}),ie.current.delete(L)}catch(F){console.error("Error en eliminar el xat:",F),c({message:"No s'ha pogut eliminar el xat. La conversa es restaurar.",type:"error"}),ie.current.delete(L)}},us=async(L,U)=>{if(!S||S.role!=="admin"){c({message:"No autoritzat.",type:"error"});return}const F=L==="all"?E:E.filter(O=>O.id===L);if(F.length===0){c({message:"No s'han trobat destinataris.",type:"error"});return}try{for(const O of F){const W=`admin-message-${S.id}-${O.id}-${Date.now()}`,H={participantIds:[S.id,O.id],participants:{[S.id]:{name:S.name,avatarUrl:S.avatarUrl},[O.id]:{name:O.name,avatarUrl:O.avatarUrl}},productId:W,productTitle:"Missatge de l'administrador",productImageUrl:S.avatarUrl,lastMessage:null,createdAt:ft(),updatedAt:ft(),unreadCount:{[S.id]:0,[O.id]:0},hiddenFor:[]},q=await In(Be(Ke,"chats"),H),J={senderId:S.id,text:U,timestamp:ft()};await In(Be(Ke,"chats",q.id,"messages"),J),await St(q,{lastMessage:{...J,timestamp:new Date},updatedAt:ft(),[`unreadCount.${O.id}`]:Kc(1)})}c({message:`Missatge enviat a ${F.length} usuari(s).`,type:"success"})}catch(O){throw console.error("Error en enviar el missatge d'administrador:",O),c({message:"No s'ha pogut enviar el missatge.",type:"error"}),O}};return S?l.jsxs("div",{className:"min-h-screen bg-gray-50 font-sans text-gray-800",children:[l.jsx(h5,{user:S,onNavigateHome:Te,onNavigateToListing:rn,onNavigateToProfile:lt,onOpenTutorial:()=>nn(!0)}),l.jsx(A5,{message:(o==null?void 0:o.message)||null,type:o==null?void 0:o.type,onClose:()=>c(null)}),t==="home"&&l.jsx(f5,{userProducts:n,merchProducts:s,onProductSelect:Xs,firebaseError:g,currentUser:S}),t==="listing"&&l.jsx(S5,{onSave:wt,productToEdit:f,currentUser:S}),t==="profile"&&l.jsx(R5,{user:S,onUpdateUser:sn,onBack:()=>e("home"),onLogout:we,allUsers:E,onSendAdminMessage:us}),u&&l.jsx(B5,{product:u,currentUser:S,onClose:io,onEdit:Ht,onContactSeller:oo,onDelete:as,onOpenImageViewer:(L,U)=>P({images:L,startIndex:U})}),Ve&&l.jsx(O5,{onClose:()=>nn(!1)}),C&&l.jsx(F5,{images:C.images,startIndex:C.startIndex,onClose:()=>P(null)}),l.jsx(j5,{isOpen:D,onClick:()=>V(!D),unreadCount:N}),l.jsx(V5,{isOpen:D,onClose:ao,chats:B,activeChat:v,messages:k,currentUser:S,onSendMessage:ls,onSelectChat:dr,onBackToList:Js,onDeleteChat:cs})]}):l.jsxs("div",{className:"min-h-screen bg-cover bg-center flex items-center justify-center p-4",style:{backgroundImage:"url('https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/Bandera%20Club%20Handbol%20Molins.png')"},children:[l.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"}),l.jsx("div",{className:"relative z-10",children:l.jsx(k5,{onLogin:Vn,onRegister:ne,onPasswordReset:ae,isDismissable:!1})})]})},UE=document.getElementById("root");if(!UE)throw new Error("Could not find root element to mount to");const z5=ec.createRoot(UE);z5.render(l.jsx(Ev.StrictMode,{children:l.jsx($5,{})}));
